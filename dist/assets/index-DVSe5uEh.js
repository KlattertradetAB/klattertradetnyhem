function kD(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in n)){const r=Object.getOwnPropertyDescriptor(i,s);r&&Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function Lb(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xw={exports:{}},ug={};var OE;function ID(){if(OE)return ug;OE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,r){var o=null;if(r!==void 0&&(o=""+r),s.key!==void 0&&(o=""+s.key),"key"in s){r={};for(var c in s)c!=="key"&&(r[c]=s[c])}else r=s;return s=r.ref,{$$typeof:n,type:i,key:o,ref:s!==void 0?s:null,props:r}}return ug.Fragment=e,ug.jsx=t,ug.jsxs=t,ug}var zE;function DD(){return zE||(zE=1,xw.exports=ID()),xw.exports}var d=DD(),vw={exports:{}},nn={};var jE;function PD(){if(jE)return nn;jE=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),y=Symbol.iterator;function w($){return $===null||typeof $!="object"?null:($=y&&$[y]||$["@@iterator"],typeof $=="function"?$:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,N={};function A($,de,Ne){this.props=$,this.context=de,this.refs=N,this.updater=Ne||E}A.prototype.isReactComponent={},A.prototype.setState=function($,de){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,de,"setState")},A.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function I(){}I.prototype=A.prototype;function D($,de,Ne){this.props=$,this.context=de,this.refs=N,this.updater=Ne||E}var U=D.prototype=new I;U.constructor=D,R(U,A.prototype),U.isPureReactComponent=!0;var j=Array.isArray;function F(){}var z={H:null,A:null,T:null,S:null},W=Object.prototype.hasOwnProperty;function L($,de,Ne){var Fe=Ne.ref;return{$$typeof:n,type:$,key:de,ref:Fe!==void 0?Fe:null,props:Ne}}function B($,de){return L($.type,de,$.props)}function Y($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function ee($){var de={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(Ne){return de[Ne]})}var Q=/\/+/g;function ce($,de){return typeof $=="object"&&$!==null&&$.key!=null?ee(""+$.key):de.toString(36)}function oe($){switch($.status){case"fulfilled":return $.value;case"rejected":throw $.reason;default:switch(typeof $.status=="string"?$.then(F,F):($.status="pending",$.then(function(de){$.status==="pending"&&($.status="fulfilled",$.value=de)},function(de){$.status==="pending"&&($.status="rejected",$.reason=de)})),$.status){case"fulfilled":return $.value;case"rejected":throw $.reason}}throw $}function J($,de,Ne,Fe,lt){var ge=typeof $;(ge==="undefined"||ge==="boolean")&&($=null);var Ce=!1;if($===null)Ce=!0;else switch(ge){case"bigint":case"string":case"number":Ce=!0;break;case"object":switch($.$$typeof){case n:case e:Ce=!0;break;case g:return Ce=$._init,J(Ce($._payload),de,Ne,Fe,lt)}}if(Ce)return lt=lt($),Ce=Fe===""?"."+ce($,0):Fe,j(lt)?(Ne="",Ce!=null&&(Ne=Ce.replace(Q,"$&/")+"/"),J(lt,de,Ne,"",function(mt){return mt})):lt!=null&&(Y(lt)&&(lt=B(lt,Ne+(lt.key==null||$&&$.key===lt.key?"":(""+lt.key).replace(Q,"$&/")+"/")+Ce)),de.push(lt)),1;Ce=0;var nt=Fe===""?".":Fe+":";if(j($))for(var rt=0;rt<$.length;rt++)Fe=$[rt],ge=nt+ce(Fe,rt),Ce+=J(Fe,de,Ne,ge,lt);else if(rt=w($),typeof rt=="function")for($=rt.call($),rt=0;!(Fe=$.next()).done;)Fe=Fe.value,ge=nt+ce(Fe,rt++),Ce+=J(Fe,de,Ne,ge,lt);else if(ge==="object"){if(typeof $.then=="function")return J(oe($),de,Ne,Fe,lt);throw de=String($),Error("Objects are not valid as a React child (found: "+(de==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":de)+"). If you meant to render a collection of children, use an array instead.")}return Ce}function te($,de,Ne){if($==null)return $;var Fe=[],lt=0;return J($,Fe,"","",function(ge){return de.call(Ne,ge,lt++)}),Fe}function me($){if($._status===-1){var de=$._result;de=de(),de.then(function(Ne){($._status===0||$._status===-1)&&($._status=1,$._result=Ne)},function(Ne){($._status===0||$._status===-1)&&($._status=2,$._result=Ne)}),$._status===-1&&($._status=0,$._result=de)}if($._status===1)return $._result.default;throw $._result}var Re=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var de=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(de))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)},Ie={map:te,forEach:function($,de,Ne){te($,function(){de.apply(this,arguments)},Ne)},count:function($){var de=0;return te($,function(){de++}),de},toArray:function($){return te($,function(de){return de})||[]},only:function($){if(!Y($))throw Error("React.Children.only expected to receive a single React element child.");return $}};return nn.Activity=v,nn.Children=Ie,nn.Component=A,nn.Fragment=t,nn.Profiler=s,nn.PureComponent=D,nn.StrictMode=i,nn.Suspense=h,nn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=z,nn.__COMPILER_RUNTIME={__proto__:null,c:function($){return z.H.useMemoCache($)}},nn.cache=function($){return function(){return $.apply(null,arguments)}},nn.cacheSignal=function(){return null},nn.cloneElement=function($,de,Ne){if($==null)throw Error("The argument must be a React element, but you passed "+$+".");var Fe=R({},$.props),lt=$.key;if(de!=null)for(ge in de.key!==void 0&&(lt=""+de.key),de)!W.call(de,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&de.ref===void 0||(Fe[ge]=de[ge]);var ge=arguments.length-2;if(ge===1)Fe.children=Ne;else if(1<ge){for(var Ce=Array(ge),nt=0;nt<ge;nt++)Ce[nt]=arguments[nt+2];Fe.children=Ce}return L($.type,lt,Fe)},nn.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null},$.Provider=$,$.Consumer={$$typeof:r,_context:$},$},nn.createElement=function($,de,Ne){var Fe,lt={},ge=null;if(de!=null)for(Fe in de.key!==void 0&&(ge=""+de.key),de)W.call(de,Fe)&&Fe!=="key"&&Fe!=="__self"&&Fe!=="__source"&&(lt[Fe]=de[Fe]);var Ce=arguments.length-2;if(Ce===1)lt.children=Ne;else if(1<Ce){for(var nt=Array(Ce),rt=0;rt<Ce;rt++)nt[rt]=arguments[rt+2];lt.children=nt}if($&&$.defaultProps)for(Fe in Ce=$.defaultProps,Ce)lt[Fe]===void 0&&(lt[Fe]=Ce[Fe]);return L($,ge,lt)},nn.createRef=function(){return{current:null}},nn.forwardRef=function($){return{$$typeof:c,render:$}},nn.isValidElement=Y,nn.lazy=function($){return{$$typeof:g,_payload:{_status:-1,_result:$},_init:me}},nn.memo=function($,de){return{$$typeof:p,type:$,compare:de===void 0?null:de}},nn.startTransition=function($){var de=z.T,Ne={};z.T=Ne;try{var Fe=$(),lt=z.S;lt!==null&&lt(Ne,Fe),typeof Fe=="object"&&Fe!==null&&typeof Fe.then=="function"&&Fe.then(F,Re)}catch(ge){Re(ge)}finally{de!==null&&Ne.types!==null&&(de.types=Ne.types),z.T=de}},nn.unstable_useCacheRefresh=function(){return z.H.useCacheRefresh()},nn.use=function($){return z.H.use($)},nn.useActionState=function($,de,Ne){return z.H.useActionState($,de,Ne)},nn.useCallback=function($,de){return z.H.useCallback($,de)},nn.useContext=function($){return z.H.useContext($)},nn.useDebugValue=function(){},nn.useDeferredValue=function($,de){return z.H.useDeferredValue($,de)},nn.useEffect=function($,de){return z.H.useEffect($,de)},nn.useEffectEvent=function($){return z.H.useEffectEvent($)},nn.useId=function(){return z.H.useId()},nn.useImperativeHandle=function($,de,Ne){return z.H.useImperativeHandle($,de,Ne)},nn.useInsertionEffect=function($,de){return z.H.useInsertionEffect($,de)},nn.useLayoutEffect=function($,de){return z.H.useLayoutEffect($,de)},nn.useMemo=function($,de){return z.H.useMemo($,de)},nn.useOptimistic=function($,de){return z.H.useOptimistic($,de)},nn.useReducer=function($,de,Ne){return z.H.useReducer($,de,Ne)},nn.useRef=function($){return z.H.useRef($)},nn.useState=function($){return z.H.useState($)},nn.useSyncExternalStore=function($,de,Ne){return z.H.useSyncExternalStore($,de,Ne)},nn.useTransition=function(){return z.H.useTransition()},nn.version="19.2.3",nn}var FE;function b0(){return FE||(FE=1,vw.exports=PD()),vw.exports}var ue=b0();const Ob=Lb(ue),UD=kD({__proto__:null,default:Ob},[ue]);var yw={exports:{}},dg={},bw={exports:{}},_w={};var BE;function LD(){return BE||(BE=1,(function(n){function e(J,te){var me=J.length;J.push(te);e:for(;0<me;){var Re=me-1>>>1,Ie=J[Re];if(0<s(Ie,te))J[Re]=te,J[me]=Ie,me=Re;else break e}}function t(J){return J.length===0?null:J[0]}function i(J){if(J.length===0)return null;var te=J[0],me=J.pop();if(me!==te){J[0]=me;e:for(var Re=0,Ie=J.length,$=Ie>>>1;Re<$;){var de=2*(Re+1)-1,Ne=J[de],Fe=de+1,lt=J[Fe];if(0>s(Ne,me))Fe<Ie&&0>s(lt,Ne)?(J[Re]=lt,J[Fe]=me,Re=Fe):(J[Re]=Ne,J[de]=me,Re=de);else if(Fe<Ie&&0>s(lt,me))J[Re]=lt,J[Fe]=me,Re=Fe;else break e}}return te}function s(J,te){var me=J.sortIndex-te.sortIndex;return me!==0?me:J.id-te.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,c=o.now();n.unstable_now=function(){return o.now()-c}}var h=[],p=[],g=1,v=null,y=3,w=!1,E=!1,R=!1,N=!1,A=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function U(J){for(var te=t(p);te!==null;){if(te.callback===null)i(p);else if(te.startTime<=J)i(p),te.sortIndex=te.expirationTime,e(h,te);else break;te=t(p)}}function j(J){if(R=!1,U(J),!E)if(t(h)!==null)E=!0,F||(F=!0,ee());else{var te=t(p);te!==null&&oe(j,te.startTime-J)}}var F=!1,z=-1,W=5,L=-1;function B(){return N?!0:!(n.unstable_now()-L<W)}function Y(){if(N=!1,F){var J=n.unstable_now();L=J;var te=!0;try{e:{E=!1,R&&(R=!1,I(z),z=-1),w=!0;var me=y;try{t:{for(U(J),v=t(h);v!==null&&!(v.expirationTime>J&&B());){var Re=v.callback;if(typeof Re=="function"){v.callback=null,y=v.priorityLevel;var Ie=Re(v.expirationTime<=J);if(J=n.unstable_now(),typeof Ie=="function"){v.callback=Ie,U(J),te=!0;break t}v===t(h)&&i(h),U(J)}else i(h);v=t(h)}if(v!==null)te=!0;else{var $=t(p);$!==null&&oe(j,$.startTime-J),te=!1}}break e}finally{v=null,y=me,w=!1}te=void 0}}finally{te?ee():F=!1}}}var ee;if(typeof D=="function")ee=function(){D(Y)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,ce=Q.port2;Q.port1.onmessage=Y,ee=function(){ce.postMessage(null)}}else ee=function(){A(Y,0)};function oe(J,te){z=A(function(){J(n.unstable_now())},te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function(J){switch(y){case 1:case 2:case 3:var te=3;break;default:te=y}var me=y;y=te;try{return J()}finally{y=me}},n.unstable_requestPaint=function(){N=!0},n.unstable_runWithPriority=function(J,te){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var me=y;y=J;try{return te()}finally{y=me}},n.unstable_scheduleCallback=function(J,te,me){var Re=n.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Re+me:Re):me=Re,J){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=me+Ie,J={id:g++,callback:te,priorityLevel:J,startTime:me,expirationTime:Ie,sortIndex:-1},me>Re?(J.sortIndex=me,e(p,J),t(h)===null&&J===t(p)&&(R?(I(z),z=-1):R=!0,oe(j,me-Re))):(J.sortIndex=Ie,e(h,J),E||w||(E=!0,F||(F=!0,ee()))),J},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(J){var te=y;return function(){var me=y;y=te;try{return J.apply(this,arguments)}finally{y=me}}}})(_w)),_w}var VE;function iR(){return VE||(VE=1,bw.exports=LD()),bw.exports}var ww={exports:{}},er={};var HE;function OD(){if(HE)return er;HE=1;var n=b0();function e(h){var p="https://react.dev/errors/"+h;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)p+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function r(h,p,g){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:h,containerInfo:p,implementation:g}}var o=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,p){if(h==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return er.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,er.createPortal=function(h,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return r(h,p,null,g)},er.flushSync=function(h){var p=o.T,g=i.p;try{if(o.T=null,i.p=2,h)return h()}finally{o.T=p,i.p=g,i.d.f()}},er.preconnect=function(h,p){typeof h=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(h,p))},er.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},er.preinit=function(h,p){if(typeof h=="string"&&p&&typeof p.as=="string"){var g=p.as,v=c(g,p.crossOrigin),y=typeof p.integrity=="string"?p.integrity:void 0,w=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;g==="style"?i.d.S(h,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:y,fetchPriority:w}):g==="script"&&i.d.X(h,{crossOrigin:v,integrity:y,fetchPriority:w,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},er.preinitModule=function(h,p){if(typeof h=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var g=c(p.as,p.crossOrigin);i.d.M(h,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(h)},er.preload=function(h,p){if(typeof h=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var g=p.as,v=c(g,p.crossOrigin);i.d.L(h,g,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},er.preloadModule=function(h,p){if(typeof h=="string")if(p){var g=c(p.as,p.crossOrigin);i.d.m(h,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(h)},er.requestFormReset=function(h){i.d.r(h)},er.unstable_batchedUpdates=function(h,p){return h(p)},er.useFormState=function(h,p,g){return o.H.useFormState(h,p,g)},er.useFormStatus=function(){return o.H.useHostTransitionStatus()},er.version="19.2.3",er}var GE;function zD(){if(GE)return ww.exports;GE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ww.exports=OD(),ww.exports}var qE;function jD(){if(qE)return dg;qE=1;var n=iR(),e=b0(),t=zD();function i(a){var l="https://react.dev/errors/"+a;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)l+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function r(a){var l=a,m=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(m=l.return),a=l.return;while(a)}return l.tag===3?m:null}function o(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function c(a){if(a.tag===31){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function h(a){if(r(a)!==a)throw Error(i(188))}function p(a){var l=a.alternate;if(!l){if(l=r(a),l===null)throw Error(i(188));return l!==a?null:a}for(var m=a,x=l;;){var M=m.return;if(M===null)break;var C=M.alternate;if(C===null){if(x=M.return,x!==null){m=x;continue}break}if(M.child===C.child){for(C=M.child;C;){if(C===m)return h(M),a;if(C===x)return h(M),l;C=C.sibling}throw Error(i(188))}if(m.return!==x.return)m=M,x=C;else{for(var O=!1,q=M.child;q;){if(q===m){O=!0,m=M,x=C;break}if(q===x){O=!0,x=M,m=C;break}q=q.sibling}if(!O){for(q=C.child;q;){if(q===m){O=!0,m=C,x=M;break}if(q===x){O=!0,x=C,m=M;break}q=q.sibling}if(!O)throw Error(i(189))}}if(m.alternate!==x)throw Error(i(190))}if(m.tag!==3)throw Error(i(188));return m.stateNode.current===m?a:l}function g(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a;for(a=a.child;a!==null;){if(l=g(a),l!==null)return l;a=a.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),D=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function ee(a){return a===null||typeof a!="object"?null:(a=Y&&a[Y]||a["@@iterator"],typeof a=="function"?a:null)}var Q=Symbol.for("react.client.reference");function ce(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===Q?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case R:return"Fragment";case A:return"Profiler";case N:return"StrictMode";case j:return"Suspense";case F:return"SuspenseList";case L:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case E:return"Portal";case D:return a.displayName||"Context";case I:return(a._context.displayName||"Context")+".Consumer";case U:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case z:return l=a.displayName||null,l!==null?l:ce(a.type)||"Memo";case W:l=a._payload,a=a._init;try{return ce(a(l))}catch{}}return null}var oe=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},Re=[],Ie=-1;function $(a){return{current:a}}function de(a){0>Ie||(a.current=Re[Ie],Re[Ie]=null,Ie--)}function Ne(a,l){Ie++,Re[Ie]=a.current,a.current=l}var Fe=$(null),lt=$(null),ge=$(null),Ce=$(null);function nt(a,l){switch(Ne(ge,l),Ne(lt,a),Ne(Fe,null),l.nodeType){case 9:case 11:a=(a=l.documentElement)&&(a=a.namespaceURI)?aE(a):0;break;default:if(a=l.tagName,l=l.namespaceURI)l=aE(l),a=oE(l,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}de(Fe),Ne(Fe,a)}function rt(){de(Fe),de(lt),de(ge)}function mt(a){a.memoizedState!==null&&Ne(Ce,a);var l=Fe.current,m=oE(l,a.type);l!==m&&(Ne(lt,a),Ne(Fe,m))}function ln(a){lt.current===a&&(de(Fe),de(lt)),Ce.current===a&&(de(Ce),ag._currentValue=me)}var vn,zt;function Pe(a){if(vn===void 0)try{throw Error()}catch(m){var l=m.stack.trim().match(/\n( *(at )?)/);vn=l&&l[1]||"",zt=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+vn+a+zt}var qe=!1;function Oe(a,l){if(!a||qe)return"";qe=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(l){var je=function(){throw Error()};if(Object.defineProperty(je.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(je,[])}catch(Ae){var _e=Ae}Reflect.construct(a,[],je)}else{try{je.call()}catch(Ae){_e=Ae}a.call(je.prototype)}}else{try{throw Error()}catch(Ae){_e=Ae}(je=a())&&typeof je.catch=="function"&&je.catch(function(){})}}catch(Ae){if(Ae&&_e&&typeof Ae.stack=="string")return[Ae.stack,_e.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=x.DetermineComponentFrameRoot(),O=C[0],q=C[1];if(O&&q){var ne=O.split(`
`),ve=q.split(`
`);for(M=x=0;x<ne.length&&!ne[x].includes("DetermineComponentFrameRoot");)x++;for(;M<ve.length&&!ve[M].includes("DetermineComponentFrameRoot");)M++;if(x===ne.length||M===ve.length)for(x=ne.length-1,M=ve.length-1;1<=x&&0<=M&&ne[x]!==ve[M];)M--;for(;1<=x&&0<=M;x--,M--)if(ne[x]!==ve[M]){if(x!==1||M!==1)do if(x--,M--,0>M||ne[x]!==ve[M]){var ke=`
`+ne[x].replace(" at new "," at ");return a.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",a.displayName)),ke}while(1<=x&&0<=M);break}}}finally{qe=!1,Error.prepareStackTrace=m}return(m=a?a.displayName||a.name:"")?Pe(m):""}function it(a,l){switch(a.tag){case 26:case 27:case 5:return Pe(a.type);case 16:return Pe("Lazy");case 13:return a.child!==l&&l!==null?Pe("Suspense Fallback"):Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 15:return Oe(a.type,!1);case 11:return Oe(a.type.render,!1);case 1:return Oe(a.type,!0);case 31:return Pe("Activity");default:return""}}function Z(a){try{var l="",m=null;do l+=it(a,m),m=a,a=a.return;while(a);return l}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}var Nt=Object.prototype.hasOwnProperty,ot=n.unstable_scheduleCallback,Rt=n.unstable_cancelCallback,Je=n.unstable_shouldYield,X=n.unstable_requestPaint,V=n.unstable_now,ae=n.unstable_getCurrentPriorityLevel,Ee=n.unstable_ImmediatePriority,ze=n.unstable_UserBlockingPriority,Me=n.unstable_NormalPriority,gt=n.unstable_LowPriority,Qe=n.unstable_IdlePriority,St=n.log,Ut=n.unstable_setDisableYieldValue,He=null,Ye=null;function xt(a){if(typeof St=="function"&&Ut(a),Ye&&typeof Ye.setStrictMode=="function")try{Ye.setStrictMode(He,a)}catch{}}var pt=Math.clz32?Math.clz32:re,st=Math.log,rn=Math.LN2;function re(a){return a>>>=0,a===0?32:31-(st(a)/rn|0)|0}var ct=256,Xe=262144,dt=4194304;function Ge(a){var l=a&42;if(l!==0)return l;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Le(a,l,m){var x=a.pendingLanes;if(x===0)return 0;var M=0,C=a.suspendedLanes,O=a.pingedLanes;a=a.warmLanes;var q=x&134217727;return q!==0?(x=q&~C,x!==0?M=Ge(x):(O&=q,O!==0?M=Ge(O):m||(m=q&~a,m!==0&&(M=Ge(m))))):(q=x&~C,q!==0?M=Ge(q):O!==0?M=Ge(O):m||(m=x&~a,m!==0&&(M=Ge(m)))),M===0?0:l!==0&&l!==M&&(l&C)===0&&(C=M&-M,m=l&-l,C>=m||C===32&&(m&4194048)!==0)?l:M}function et(a,l){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&l)===0}function $t(a,l){switch(a){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tn(){var a=dt;return dt<<=1,(dt&62914560)===0&&(dt=4194304),a}function An(a){for(var l=[],m=0;31>m;m++)l.push(a);return l}function ls(a,l){a.pendingLanes|=l,l!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Hs(a,l,m,x,M,C){var O=a.pendingLanes;a.pendingLanes=m,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=m,a.entangledLanes&=m,a.errorRecoveryDisabledLanes&=m,a.shellSuspendCounter=0;var q=a.entanglements,ne=a.expirationTimes,ve=a.hiddenUpdates;for(m=O&~m;0<m;){var ke=31-pt(m),je=1<<ke;q[ke]=0,ne[ke]=-1;var _e=ve[ke];if(_e!==null)for(ve[ke]=null,ke=0;ke<_e.length;ke++){var Ae=_e[ke];Ae!==null&&(Ae.lane&=-536870913)}m&=~je}x!==0&&Oo(a,x,0),C!==0&&M===0&&a.tag!==0&&(a.suspendedLanes|=C&~(O&~l))}function Oo(a,l,m){a.pendingLanes|=l,a.suspendedLanes&=~l;var x=31-pt(l);a.entangledLanes|=l,a.entanglements[x]=a.entanglements[x]|1073741824|m&261930}function zo(a,l){var m=a.entangledLanes|=l;for(a=a.entanglements;m;){var x=31-pt(m),M=1<<x;M&l|a[x]&l&&(a[x]|=l),m&=~M}}function Cl(a,l){var m=l&-l;return m=(m&42)!==0?1:jo(m),(m&(a.suspendedLanes|l))!==0?0:m}function jo(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function to(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Rl(){var a=te.p;return a!==0?a:(a=window.event,a===void 0?32:RE(a.type))}function xs(a,l){var m=te.p;try{return te.p=a,l()}finally{te.p=m}}var lr=Math.random().toString(36).slice(2),ui="__reactFiber$"+lr,Vi="__reactProps$"+lr,cr="__reactContainer$"+lr,ur="__reactEvents$"+lr,dr="__reactListeners$"+lr,Fo="__reactHandles$"+lr,kl="__reactResources$"+lr,sa="__reactMarker$"+lr;function no(a){delete a[ui],delete a[Vi],delete a[ur],delete a[dr],delete a[Fo]}function io(a){var l=a[ui];if(l)return l;for(var m=a.parentNode;m;){if(l=m[cr]||m[ui]){if(m=l.alternate,l.child!==null||m!==null&&m.child!==null)for(a=pE(a);a!==null;){if(m=a[ui])return m;a=pE(a)}return l}a=m,m=a.parentNode}return null}function so(a){if(a=a[ui]||a[cr]){var l=a.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return a}return null}function Bo(a){var l=a.tag;if(l===5||l===26||l===27||l===6)return a.stateNode;throw Error(i(33))}function ba(a){var l=a[kl];return l||(l=a[kl]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function G(a){a[sa]=!0}var le=new Set,we={};function ye(a,l){fe(a,l),fe(a+"Capture",l)}function fe(a,l){for(we[a]=l,a=0;a<l.length;a++)le.add(l[a])}var Ke=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vt={},$e={};function wt(a){return Nt.call($e,a)?!0:Nt.call(vt,a)?!1:Ke.test(a)?$e[a]=!0:(vt[a]=!0,!1)}function Tt(a,l,m){if(wt(l))if(m===null)a.removeAttribute(l);else{switch(typeof m){case"undefined":case"function":case"symbol":a.removeAttribute(l);return;case"boolean":var x=l.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){a.removeAttribute(l);return}}a.setAttribute(l,""+m)}}function Pt(a,l,m){if(m===null)a.removeAttribute(l);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttribute(l,""+m)}}function Mt(a,l,m,x){if(x===null)a.removeAttribute(m);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(m);return}a.setAttributeNS(l,m,""+x)}}function Ft(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function In(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Xn(a,l,m){var x=Object.getOwnPropertyDescriptor(a.constructor.prototype,l);if(!a.hasOwnProperty(l)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var M=x.get,C=x.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return M.call(this)},set:function(O){m=""+O,C.call(this,O)}}),Object.defineProperty(a,l,{enumerable:x.enumerable}),{getValue:function(){return m},setValue:function(O){m=""+O},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Gn(a){if(!a._valueTracker){var l=In(a)?"checked":"value";a._valueTracker=Xn(a,l,""+a[l])}}function Kt(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var m=l.getValue(),x="";return a&&(x=In(a)?a.checked?"true":"false":a.value),a=x,a!==m?(l.setValue(a),!0):!1}function ut(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Nn=/[\n"\\]/g;function Vt(a){return a.replace(Nn,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Di(a,l,m,x,M,C,O,q){a.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?a.type=O:a.removeAttribute("type"),l!=null?O==="number"?(l===0&&a.value===""||a.value!=l)&&(a.value=""+Ft(l)):a.value!==""+Ft(l)&&(a.value=""+Ft(l)):O!=="submit"&&O!=="reset"||a.removeAttribute("value"),l!=null?ti(a,O,Ft(l)):m!=null?ti(a,O,Ft(m)):x!=null&&a.removeAttribute("value"),M==null&&C!=null&&(a.defaultChecked=!!C),M!=null&&(a.checked=M&&typeof M!="function"&&typeof M!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?a.name=""+Ft(q):a.removeAttribute("name")}function ra(a,l,m,x,M,C,O,q){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(a.type=C),l!=null||m!=null){if(!(C!=="submit"&&C!=="reset"||l!=null)){Gn(a);return}m=m!=null?""+Ft(m):"",l=l!=null?""+Ft(l):m,q||l===a.value||(a.value=l),a.defaultValue=l}x=x??M,x=typeof x!="function"&&typeof x!="symbol"&&!!x,a.checked=q?a.checked:!!x,a.defaultChecked=!!x,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(a.name=O),Gn(a)}function ti(a,l,m){l==="number"&&ut(a.ownerDocument)===a||a.defaultValue===""+m||(a.defaultValue=""+m)}function As(a,l,m,x){if(a=a.options,l){l={};for(var M=0;M<m.length;M++)l["$"+m[M]]=!0;for(m=0;m<a.length;m++)M=l.hasOwnProperty("$"+a[m].value),a[m].selected!==M&&(a[m].selected=M),M&&x&&(a[m].defaultSelected=!0)}else{for(m=""+Ft(m),l=null,M=0;M<a.length;M++){if(a[M].value===m){a[M].selected=!0,x&&(a[M].defaultSelected=!0);return}l!==null||a[M].disabled||(l=a[M])}l!==null&&(l.selected=!0)}}function Un(a,l,m){if(l!=null&&(l=""+Ft(l),l!==a.value&&(a.value=l),m==null)){a.defaultValue!==l&&(a.defaultValue=l);return}a.defaultValue=m!=null?""+Ft(m):""}function Hi(a,l,m,x){if(l==null){if(x!=null){if(m!=null)throw Error(i(92));if(oe(x)){if(1<x.length)throw Error(i(93));x=x[0]}m=x}m==null&&(m=""),l=m}m=Ft(l),a.defaultValue=m,x=a.textContent,x===m&&x!==""&&x!==null&&(a.value=x),Gn(a)}function Pi(a,l){if(l){var m=a.firstChild;if(m&&m===a.lastChild&&m.nodeType===3){m.nodeValue=l;return}}a.textContent=l}var Ki=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zi(a,l,m){var x=l.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?x?a.setProperty(l,""):l==="float"?a.cssFloat="":a[l]="":x?a.setProperty(l,m):typeof m!="number"||m===0||Ki.has(l)?l==="float"?a.cssFloat=m:a[l]=(""+m).trim():a[l]=m+"px"}function Il(a,l,m){if(l!=null&&typeof l!="object")throw Error(i(62));if(a=a.style,m!=null){for(var x in m)!m.hasOwnProperty(x)||l!=null&&l.hasOwnProperty(x)||(x.indexOf("--")===0?a.setProperty(x,""):x==="float"?a.cssFloat="":a[x]="");for(var M in l)x=l[M],l.hasOwnProperty(M)&&m[M]!==x&&Zi(a,M,x)}else for(var C in l)l.hasOwnProperty(C)&&Zi(a,C,l[C])}function Rr(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $u(a){return Fp.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function ro(){}var _h=null;function wh(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Dl=null,Vo=null;function Bp(a){var l=so(a);if(l&&(a=l.stateNode)){var m=a[Vi]||null;e:switch(a=l.stateNode,l.type){case"input":if(Di(a,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),l=m.name,m.type==="radio"&&l!=null){for(m=a;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+Vt(""+l)+'"][type="radio"]'),l=0;l<m.length;l++){var x=m[l];if(x!==a&&x.form===a.form){var M=x[Vi]||null;if(!M)throw Error(i(90));Di(x,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(l=0;l<m.length;l++)x=m[l],x.form===a.form&&Kt(x)}break e;case"textarea":Un(a,m.value,m.defaultValue);break e;case"select":l=m.value,l!=null&&As(a,!!m.multiple,l,!1)}}}var Sh=!1;function Vp(a,l,m){if(Sh)return a(l,m);Sh=!0;try{var x=a(l);return x}finally{if(Sh=!1,(Dl!==null||Vo!==null)&&(ua(),Dl&&(l=Dl,a=Vo,Vo=Dl=null,Bp(l),a)))for(l=0;l<a.length;l++)Bp(a[l])}}function Ac(a,l){var m=a.stateNode;if(m===null)return null;var x=m[Vi]||null;if(x===null)return null;m=x[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(a=a.type,x=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!x;break e;default:a=!1}if(a)return null;if(m&&typeof m!="function")throw Error(i(231,l,typeof m));return m}var _a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hp=!1;if(_a)try{var Nc={};Object.defineProperty(Nc,"passive",{get:function(){Hp=!0}}),window.addEventListener("test",Nc,Nc),window.removeEventListener("test",Nc,Nc)}catch{Hp=!1}var hr=null,Th=null,Pl=null;function Xu(){if(Pl)return Pl;var a,l=Th,m=l.length,x,M="value"in hr?hr.value:hr.textContent,C=M.length;for(a=0;a<m&&l[a]===M[a];a++);var O=m-a;for(x=1;x<=O&&l[m-x]===M[C-x];x++);return Pl=M.slice(a,1<x?1-x:void 0)}function Yu(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Cc(){return!0}function U0(){return!1}function Ns(a){function l(m,x,M,C,O){this._reactName=m,this._targetInst=M,this.type=x,this.nativeEvent=C,this.target=O,this.currentTarget=null;for(var q in a)a.hasOwnProperty(q)&&(m=a[q],this[q]=m?m(C):C[q]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Cc:U0,this.isPropagationStopped=U0,this}return v(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Cc)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Cc)},persist:function(){},isPersistent:Cc}),l}var Ho={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ju=Ns(Ho),Rc=v({},Ho,{view:0,detail:0}),L0=Ns(Rc),Ku,Eh,kc,Ic=v({},Rc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ch,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==kc&&(kc&&a.type==="mousemove"?(Ku=a.screenX-kc.screenX,Eh=a.screenY-kc.screenY):Eh=Ku=0,kc=a),Ku)},movementY:function(a){return"movementY"in a?a.movementY:Eh}}),Gp=Ns(Ic),O0=v({},Ic,{dataTransfer:0}),z0=Ns(O0),qp=v({},Rc,{relatedTarget:0}),Mh=Ns(qp),j0=v({},Ho,{animationName:0,elapsedTime:0,pseudoElement:0}),O_=Ns(j0),z_=v({},Ho,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),F0=Ns(z_),Zu=v({},Ho,{data:0}),Ah=Ns(Zu),Nh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wp(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=V0[a])?!!l[a]:!1}function Ch(){return Wp}var H0=v({},Rc,{key:function(a){if(a.key){var l=Nh[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Yu(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?B0[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ch,charCode:function(a){return a.type==="keypress"?Yu(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Yu(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Ul=Ns(H0),Rh=v({},Ic,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$p=Ns(Rh),Xp=v({},Rc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ch}),G0=Ns(Xp),q0=v({},Ho,{propertyName:0,elapsedTime:0,pseudoElement:0}),j_=Ns(q0),cs=v({},Ic,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),W0=Ns(cs),$0=v({},Ho,{newState:0,oldState:0}),X0=Ns($0),Y0=[9,13,27,32],Ll=_a&&"CompositionEvent"in window,Dc=null;_a&&"documentMode"in document&&(Dc=document.documentMode);var kh=_a&&"TextEvent"in window&&!Dc,Yp=_a&&(!Ll||Dc&&8<Dc&&11>=Dc),J0=" ",Qu=!1;function Ih(a,l){switch(a){case"keyup":return Y0.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jp(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ol=!1;function K0(a,l){switch(a){case"compositionend":return Jp(l);case"keypress":return l.which!==32?null:(Qu=!0,J0);case"textInput":return a=l.data,a===J0&&Qu?null:a;default:return null}}function Kp(a,l){if(Ol)return a==="compositionend"||!Ll&&Ih(a,l)?(a=Xu(),Pl=Th=hr=null,Ol=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Yp&&l.locale!=="ko"?null:l.data;default:return null}}var Zp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qp(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!Zp[a.type]:l==="textarea"}function Dh(a,l,m,x){Dl?Vo?Vo.push(x):Vo=[x]:Dl=x,l=nv(l,"onChange"),0<l.length&&(m=new Ju("onChange","change",null,m,x),a.push({event:m,listeners:l}))}var Go=null,zl=null;function Z0(a){eE(a,0)}function Pc(a){var l=Bo(a);if(Kt(l))return a}function em(a,l){if(a==="change")return l}var wa=!1;if(_a){var ed;if(_a){var tm="oninput"in document;if(!tm){var nm=document.createElement("div");nm.setAttribute("oninput","return;"),tm=typeof nm.oninput=="function"}ed=tm}else ed=!1;wa=ed&&(!document.documentMode||9<document.documentMode)}function kr(){Go&&(Go.detachEvent("onpropertychange",td),zl=Go=null)}function td(a){if(a.propertyName==="value"&&Pc(zl)){var l=[];Dh(l,zl,a,wh(a)),Vp(Z0,l)}}function Q0(a,l,m){a==="focusin"?(kr(),Go=l,zl=m,Go.attachEvent("onpropertychange",td)):a==="focusout"&&kr()}function im(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Pc(zl)}function ex(a,l){if(a==="click")return Pc(l)}function tx(a,l){if(a==="input"||a==="change")return Pc(l)}function sm(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Cs=typeof Object.is=="function"?Object.is:sm;function Uc(a,l){if(Cs(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var m=Object.keys(a),x=Object.keys(l);if(m.length!==x.length)return!1;for(x=0;x<m.length;x++){var M=m[x];if(!Nt.call(l,M)||!Cs(a[M],l[M]))return!1}return!0}function nd(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Lc(a,l){var m=nd(a);a=0;for(var x;m;){if(m.nodeType===3){if(x=a+m.textContent.length,a<=l&&x>=l)return{node:m,offset:l-a};a=x}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=nd(m)}}function Yn(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Yn(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function nx(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var l=ut(a.document);l instanceof a.HTMLIFrameElement;){try{var m=typeof l.contentWindow.location.href=="string"}catch{m=!1}if(m)a=l.contentWindow;else break;l=ut(a.document)}return l}function rm(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}var ix=_a&&"documentMode"in document&&11>=document.documentMode,Sa=null,Ta=null,Oc=null,Ph=!1;function zc(a,l,m){var x=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Ph||Sa==null||Sa!==ut(x)||(x=Sa,"selectionStart"in x&&rm(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Oc&&Uc(Oc,x)||(Oc=x,x=nv(Ta,"onSelect"),0<x.length&&(l=new Ju("onSelect","select",null,l,m),a.push({event:l,listeners:x}),l.target=Sa)))}function vs(a,l){var m={};return m[a.toLowerCase()]=l.toLowerCase(),m["Webkit"+a]="webkit"+l,m["Moz"+a]="moz"+l,m}var jl={animationend:vs("Animation","AnimationEnd"),animationiteration:vs("Animation","AnimationIteration"),animationstart:vs("Animation","AnimationStart"),transitionrun:vs("Transition","TransitionRun"),transitionstart:vs("Transition","TransitionStart"),transitioncancel:vs("Transition","TransitionCancel"),transitionend:vs("Transition","TransitionEnd")},id={},am={};_a&&(am=document.createElement("div").style,"AnimationEvent"in window||(delete jl.animationend.animation,delete jl.animationiteration.animation,delete jl.animationstart.animation),"TransitionEvent"in window||delete jl.transitionend.transition);function ao(a){if(id[a])return id[a];if(!jl[a])return a;var l=jl[a],m;for(m in l)if(l.hasOwnProperty(m)&&m in am)return id[a]=l[m];return a}var Uh=ao("animationend"),sd=ao("animationiteration"),om=ao("animationstart"),sx=ao("transitionrun"),F_=ao("transitionstart"),rx=ao("transitioncancel"),lm=ao("transitionend"),Ir=new Map,rd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rd.push("scrollEnd");function Dr(a,l){Ir.set(a,l),ye(l,[a])}var ad=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Pr=[],oo=0,Qi=0;function od(){for(var a=oo,l=Qi=oo=0;l<a;){var m=Pr[l];Pr[l++]=null;var x=Pr[l];Pr[l++]=null;var M=Pr[l];Pr[l++]=null;var C=Pr[l];if(Pr[l++]=null,x!==null&&M!==null){var O=x.pending;O===null?M.next=M:(M.next=O.next,O.next=M),x.pending=M}C!==0&&qo(m,M,C)}}function es(a,l,m,x){Pr[oo++]=a,Pr[oo++]=l,Pr[oo++]=m,Pr[oo++]=x,Qi|=x,a.lanes|=x,a=a.alternate,a!==null&&(a.lanes|=x)}function Lh(a,l,m,x){return es(a,l,m,x),Ur(a)}function Rs(a,l){return es(a,null,null,l),Ur(a)}function qo(a,l,m){a.lanes|=m;var x=a.alternate;x!==null&&(x.lanes|=m);for(var M=!1,C=a.return;C!==null;)C.childLanes|=m,x=C.alternate,x!==null&&(x.childLanes|=m),C.tag===22&&(a=C.stateNode,a===null||a._visibility&1||(M=!0)),a=C,C=C.return;return a.tag===3?(C=a.stateNode,M&&l!==null&&(M=31-pt(m),a=C.hiddenUpdates,x=a[M],x===null?a[M]=[l]:x.push(l),l.lane=m|536870912),C):null}function Ur(a){if(50<ul)throw ul=0,sc=null,Error(i(185));for(var l=a.return;l!==null;)a=l,l=a.return;return a.tag===3?a.stateNode:null}var Wo={};function cm(a,l,m,x){this.tag=a,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function di(a,l,m,x){return new cm(a,l,m,x)}function Oh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Gs(a,l){var m=a.alternate;return m===null?(m=di(a.tag,l,a.key,a.mode),m.elementType=a.elementType,m.type=a.type,m.stateNode=a.stateNode,m.alternate=a,a.alternate=m):(m.pendingProps=l,m.type=a.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=a.flags&65011712,m.childLanes=a.childLanes,m.lanes=a.lanes,m.child=a.child,m.memoizedProps=a.memoizedProps,m.memoizedState=a.memoizedState,m.updateQueue=a.updateQueue,l=a.dependencies,m.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},m.sibling=a.sibling,m.index=a.index,m.ref=a.ref,m.refCleanup=a.refCleanup,m}function jc(a,l){a.flags&=65011714;var m=a.alternate;return m===null?(a.childLanes=0,a.lanes=l,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=m.childLanes,a.lanes=m.lanes,a.child=m.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=m.memoizedProps,a.memoizedState=m.memoizedState,a.updateQueue=m.updateQueue,a.type=m.type,l=m.dependencies,a.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),a}function Ea(a,l,m,x,M,C){var O=0;if(x=a,typeof a=="function")Oh(a)&&(O=1);else if(typeof a=="string")O=yD(a,m,Fe.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case L:return a=di(31,m,l,M),a.elementType=L,a.lanes=C,a;case R:return $o(m.children,M,C,l);case N:O=8,M|=24;break;case A:return a=di(12,m,l,M|2),a.elementType=A,a.lanes=C,a;case j:return a=di(13,m,l,M),a.elementType=j,a.lanes=C,a;case F:return a=di(19,m,l,M),a.elementType=F,a.lanes=C,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case D:O=10;break e;case I:O=9;break e;case U:O=11;break e;case z:O=14;break e;case W:O=16,x=null;break e}O=29,m=Error(i(130,a===null?"null":typeof a,"")),x=null}return l=di(O,m,l,M),l.elementType=a,l.type=x,l.lanes=C,l}function $o(a,l,m,x){return a=di(7,a,x,l),a.lanes=m,a}function zh(a,l,m){return a=di(6,a,null,l),a.lanes=m,a}function Fc(a){var l=di(18,null,null,0);return l.stateNode=a,l}function jh(a,l,m){return l=di(4,a.children!==null?a.children:[],a.key,l),l.lanes=m,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}var ld=new WeakMap;function fr(a,l){if(typeof a=="object"&&a!==null){var m=ld.get(a);return m!==void 0?m:(l={value:a,source:l,stack:Z(l)},ld.set(a,l),l)}return{value:a,source:l,stack:Z(l)}}var Xo=[],Yo=0,Bc=null,Vc=0,qs=[],ri=0,lo=null,hi=1,aa="";function Ma(a,l){Xo[Yo++]=Vc,Xo[Yo++]=Bc,Bc=a,Vc=l}function ax(a,l,m){qs[ri++]=hi,qs[ri++]=aa,qs[ri++]=lo,lo=a;var x=hi;a=aa;var M=32-pt(x)-1;x&=~(1<<M),m+=1;var C=32-pt(l)+M;if(30<C){var O=M-M%5;C=(x&(1<<O)-1).toString(32),x>>=O,M-=O,hi=1<<32-pt(l)+M|m<<M|x,aa=C+a}else hi=1<<C|m<<M|x,aa=a}function Aa(a){a.return!==null&&(Ma(a,1),ax(a,1,0))}function Fh(a){for(;a===Bc;)Bc=Xo[--Yo],Xo[Yo]=null,Vc=Xo[--Yo],Xo[Yo]=null;for(;a===lo;)lo=qs[--ri],qs[ri]=null,aa=qs[--ri],qs[ri]=null,hi=qs[--ri],qs[ri]=null}function Bh(a,l){qs[ri++]=hi,qs[ri++]=aa,qs[ri++]=lo,hi=l.id,aa=l.overflow,lo=a}var yi=null,Jn=null,wn=!1,co=null,pr=!1,Hc=Error(i(519));function Na(a){var l=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ca(fr(l,a)),Hc}function ox(a){var l=a.stateNode,m=a.type,x=a.memoizedProps;switch(l[ui]=a,l[Vi]=x,m){case"dialog":Mn("cancel",l),Mn("close",l);break;case"iframe":case"object":case"embed":Mn("load",l);break;case"video":case"audio":for(m=0;m<Xr.length;m++)Mn(Xr[m],l);break;case"source":Mn("error",l);break;case"img":case"image":case"link":Mn("error",l),Mn("load",l);break;case"details":Mn("toggle",l);break;case"input":Mn("invalid",l),ra(l,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0);break;case"select":Mn("invalid",l);break;case"textarea":Mn("invalid",l),Hi(l,x.value,x.defaultValue,x.children)}m=x.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||l.textContent===""+m||x.suppressHydrationWarning===!0||sE(l.textContent,m)?(x.popover!=null&&(Mn("beforetoggle",l),Mn("toggle",l)),x.onScroll!=null&&Mn("scroll",l),x.onScrollEnd!=null&&Mn("scrollend",l),x.onClick!=null&&(l.onclick=ro),l=!0):l=!1,l||Na(a,!0)}function lx(a){for(yi=a.return;yi;)switch(yi.tag){case 5:case 31:case 13:pr=!1;return;case 27:case 3:pr=!0;return;default:yi=yi.return}}function Gc(a){if(a!==yi)return!1;if(!wn)return lx(a),wn=!0,!1;var l=a.tag,m;if((m=l!==3&&l!==27)&&((m=l===5)&&(m=a.type,m=!(m!=="form"&&m!=="button")||nw(a.type,a.memoizedProps)),m=!m),m&&Jn&&Na(a),lx(a),l===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));Jn=fE(a)}else if(l===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));Jn=fE(a)}else l===27?(l=Jn,uu(a.type)?(a=ow,ow=null,Jn=a):Jn=l):Jn=yi?Ha(a.stateNode.nextSibling):null;return!0}function Jo(){Jn=yi=null,wn=!1}function Vh(){var a=co;return a!==null&&(_i===null?_i=a:_i.push.apply(_i,a),co=null),a}function Ca(a){co===null?co=[a]:co.push(a)}var qc=$(null),Ko=null,Ra=null;function uo(a,l,m){Ne(qc,l._currentValue),l._currentValue=m}function ka(a){a._currentValue=qc.current,de(qc)}function Hh(a,l,m){for(;a!==null;){var x=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,x!==null&&(x.childLanes|=l)):x!==null&&(x.childLanes&l)!==l&&(x.childLanes|=l),a===m)break;a=a.return}}function Gh(a,l,m,x){var M=a.child;for(M!==null&&(M.return=a);M!==null;){var C=M.dependencies;if(C!==null){var O=M.child;C=C.firstContext;e:for(;C!==null;){var q=C;C=M;for(var ne=0;ne<l.length;ne++)if(q.context===l[ne]){C.lanes|=m,q=C.alternate,q!==null&&(q.lanes|=m),Hh(C.return,m,a),x||(O=null);break e}C=q.next}}else if(M.tag===18){if(O=M.return,O===null)throw Error(i(341));O.lanes|=m,C=O.alternate,C!==null&&(C.lanes|=m),Hh(O,m,a),O=null}else O=M.child;if(O!==null)O.return=M;else for(O=M;O!==null;){if(O===a){O=null;break}if(M=O.sibling,M!==null){M.return=O.return,O=M;break}O=O.return}M=O}}function Ia(a,l,m,x){a=null;for(var M=l,C=!1;M!==null;){if(!C){if((M.flags&524288)!==0)C=!0;else if((M.flags&262144)!==0)break}if(M.tag===10){var O=M.alternate;if(O===null)throw Error(i(387));if(O=O.memoizedProps,O!==null){var q=M.type;Cs(M.pendingProps.value,O.value)||(a!==null?a.push(q):a=[q])}}else if(M===Ce.current){if(O=M.alternate,O===null)throw Error(i(387));O.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(a!==null?a.push(ag):a=[ag])}M=M.return}a!==null&&Gh(l,a,m,x),l.flags|=262144}function cd(a){for(a=a.firstContext;a!==null;){if(!Cs(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Zo(a){Ko=a,Ra=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function Gt(a){return cx(Ko,a)}function Wc(a,l){return Ko===null&&Zo(a),cx(a,l)}function cx(a,l){var m=l._currentValue;if(l={context:l,memoizedValue:m,next:null},Ra===null){if(a===null)throw Error(i(308));Ra=l,a.dependencies={lanes:0,firstContext:l},a.flags|=524288}else Ra=Ra.next=l;return m}var ux=typeof AbortController<"u"?AbortController:function(){var a=[],l=this.signal={aborted:!1,addEventListener:function(m,x){a.push(x)}};this.abort=function(){l.aborted=!0,a.forEach(function(m){return m()})}},B_=n.unstable_scheduleCallback,V_=n.unstable_NormalPriority,Ui={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function um(){return{controller:new ux,data:new Map,refCount:0}}function Fl(a){a.refCount--,a.refCount===0&&B_(V_,function(){a.controller.abort()})}var mr=null,qh=0,ho=0,Lr=null;function dm(a,l){if(mr===null){var m=mr=[];qh=0,ho=Se(),Lr={status:"pending",value:void 0,then:function(x){m.push(x)}}}return qh++,l.then(hm,hm),l}function hm(){if(--qh===0&&mr!==null){Lr!==null&&(Lr.status="fulfilled");var a=mr;mr=null,ho=0,Lr=null;for(var l=0;l<a.length;l++)(0,a[l])()}}function fm(a,l){var m=[],x={status:"pending",value:null,reason:null,then:function(M){m.push(M)}};return a.then(function(){x.status="fulfilled",x.value=l;for(var M=0;M<m.length;M++)(0,m[M])(l)},function(M){for(x.status="rejected",x.reason=M,M=0;M<m.length;M++)(0,m[M])(void 0)}),x}var dx=J.S;J.S=function(a,l){eg=V(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&dm(a,l),dx!==null&&dx(a,l)};var Qo=$(null);function Wh(){var a=Qo.current;return a!==null?a:Yt.pooledCache}function ud(a,l){l===null?Ne(Qo,Qo.current):Ne(Qo,l.pool)}function pm(){var a=Wh();return a===null?null:{parent:Ui._currentValue,pool:a}}var Bl=Error(i(460)),dd=Error(i(474)),cn=Error(i(542)),$h={then:function(){}};function Ws(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Xh(a,l,m){switch(m=a[m],m===void 0?a.push(l):m!==l&&(l.then(ro,ro),l=m),l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,Gl(a),a;default:if(typeof l.status=="string")l.then(ro,ro);else{if(a=Yt,a!==null&&100<a.shellSuspendCounter)throw Error(i(482));a=l,a.status="pending",a.then(function(x){if(l.status==="pending"){var M=l;M.status="fulfilled",M.value=x}},function(x){if(l.status==="pending"){var M=l;M.status="rejected",M.reason=x}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw a=l.reason,Gl(a),a}throw Da=l,Bl}}function Vl(a){try{var l=a._init;return l(a._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?(Da=m,Bl):m}}var Da=null;function Hl(){if(Da===null)throw Error(i(459));var a=Da;return Da=null,a}function Gl(a){if(a===Bl||a===cn)throw Error(i(483))}var ql=null,Wl=0;function hd(a){var l=Wl;return Wl+=1,ql===null&&(ql=[]),Xh(ql,a,l)}function Or(a,l){l=l.props.ref,a.ref=l!==void 0?l:null}function $c(a,l){throw l.$$typeof===y?Error(i(525)):(a=Object.prototype.toString.call(l),Error(i(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a)))}function Yh(a){function l(he,se){if(a){var xe=he.deletions;xe===null?(he.deletions=[se],he.flags|=16):xe.push(se)}}function m(he,se){if(!a)return null;for(;se!==null;)l(he,se),se=se.sibling;return null}function x(he){for(var se=new Map;he!==null;)he.key!==null?se.set(he.key,he):se.set(he.index,he),he=he.sibling;return se}function M(he,se){return he=Gs(he,se),he.index=0,he.sibling=null,he}function C(he,se,xe){return he.index=xe,a?(xe=he.alternate,xe!==null?(xe=xe.index,xe<se?(he.flags|=67108866,se):xe):(he.flags|=67108866,se)):(he.flags|=1048576,se)}function O(he){return a&&he.alternate===null&&(he.flags|=67108866),he}function q(he,se,xe,Ue){return se===null||se.tag!==6?(se=zh(xe,he.mode,Ue),se.return=he,se):(se=M(se,xe),se.return=he,se)}function ne(he,se,xe,Ue){var Ot=xe.type;return Ot===R?ke(he,se,xe.props.children,Ue,xe.key):se!==null&&(se.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===W&&Vl(Ot)===se.type)?(se=M(se,xe.props),Or(se,xe),se.return=he,se):(se=Ea(xe.type,xe.key,xe.props,null,he.mode,Ue),Or(se,xe),se.return=he,se)}function ve(he,se,xe,Ue){return se===null||se.tag!==4||se.stateNode.containerInfo!==xe.containerInfo||se.stateNode.implementation!==xe.implementation?(se=jh(xe,he.mode,Ue),se.return=he,se):(se=M(se,xe.children||[]),se.return=he,se)}function ke(he,se,xe,Ue,Ot){return se===null||se.tag!==7?(se=$o(xe,he.mode,Ue,Ot),se.return=he,se):(se=M(se,xe),se.return=he,se)}function je(he,se,xe){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=zh(""+se,he.mode,xe),se.return=he,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case w:return xe=Ea(se.type,se.key,se.props,null,he.mode,xe),Or(xe,se),xe.return=he,xe;case E:return se=jh(se,he.mode,xe),se.return=he,se;case W:return se=Vl(se),je(he,se,xe)}if(oe(se)||ee(se))return se=$o(se,he.mode,xe,null),se.return=he,se;if(typeof se.then=="function")return je(he,hd(se),xe);if(se.$$typeof===D)return je(he,Wc(he,se),xe);$c(he,se)}return null}function _e(he,se,xe,Ue){var Ot=se!==null?se.key:null;if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return Ot!==null?null:q(he,se,""+xe,Ue);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case w:return xe.key===Ot?ne(he,se,xe,Ue):null;case E:return xe.key===Ot?ve(he,se,xe,Ue):null;case W:return xe=Vl(xe),_e(he,se,xe,Ue)}if(oe(xe)||ee(xe))return Ot!==null?null:ke(he,se,xe,Ue,null);if(typeof xe.then=="function")return _e(he,se,hd(xe),Ue);if(xe.$$typeof===D)return _e(he,se,Wc(he,xe),Ue);$c(he,xe)}return null}function Ae(he,se,xe,Ue,Ot){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return he=he.get(xe)||null,q(se,he,""+Ue,Ot);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case w:return he=he.get(Ue.key===null?xe:Ue.key)||null,ne(se,he,Ue,Ot);case E:return he=he.get(Ue.key===null?xe:Ue.key)||null,ve(se,he,Ue,Ot);case W:return Ue=Vl(Ue),Ae(he,se,xe,Ue,Ot)}if(oe(Ue)||ee(Ue))return he=he.get(xe)||null,ke(se,he,Ue,Ot,null);if(typeof Ue.then=="function")return Ae(he,se,xe,hd(Ue),Ot);if(Ue.$$typeof===D)return Ae(he,se,xe,Wc(se,Ue),Ot);$c(se,Ue)}return null}function At(he,se,xe,Ue){for(var Ot=null,zn=null,Ct=se,fn=se=0,Rn=null;Ct!==null&&fn<xe.length;fn++){Ct.index>fn?(Rn=Ct,Ct=null):Rn=Ct.sibling;var jn=_e(he,Ct,xe[fn],Ue);if(jn===null){Ct===null&&(Ct=Rn);break}a&&Ct&&jn.alternate===null&&l(he,Ct),se=C(jn,se,fn),zn===null?Ot=jn:zn.sibling=jn,zn=jn,Ct=Rn}if(fn===xe.length)return m(he,Ct),wn&&Ma(he,fn),Ot;if(Ct===null){for(;fn<xe.length;fn++)Ct=je(he,xe[fn],Ue),Ct!==null&&(se=C(Ct,se,fn),zn===null?Ot=Ct:zn.sibling=Ct,zn=Ct);return wn&&Ma(he,fn),Ot}for(Ct=x(Ct);fn<xe.length;fn++)Rn=Ae(Ct,he,fn,xe[fn],Ue),Rn!==null&&(a&&Rn.alternate!==null&&Ct.delete(Rn.key===null?fn:Rn.key),se=C(Rn,se,fn),zn===null?Ot=Rn:zn.sibling=Rn,zn=Rn);return a&&Ct.forEach(function(mu){return l(he,mu)}),wn&&Ma(he,fn),Ot}function Ht(he,se,xe,Ue){if(xe==null)throw Error(i(151));for(var Ot=null,zn=null,Ct=se,fn=se=0,Rn=null,jn=xe.next();Ct!==null&&!jn.done;fn++,jn=xe.next()){Ct.index>fn?(Rn=Ct,Ct=null):Rn=Ct.sibling;var mu=_e(he,Ct,jn.value,Ue);if(mu===null){Ct===null&&(Ct=Rn);break}a&&Ct&&mu.alternate===null&&l(he,Ct),se=C(mu,se,fn),zn===null?Ot=mu:zn.sibling=mu,zn=mu,Ct=Rn}if(jn.done)return m(he,Ct),wn&&Ma(he,fn),Ot;if(Ct===null){for(;!jn.done;fn++,jn=xe.next())jn=je(he,jn.value,Ue),jn!==null&&(se=C(jn,se,fn),zn===null?Ot=jn:zn.sibling=jn,zn=jn);return wn&&Ma(he,fn),Ot}for(Ct=x(Ct);!jn.done;fn++,jn=xe.next())jn=Ae(Ct,he,fn,jn.value,Ue),jn!==null&&(a&&jn.alternate!==null&&Ct.delete(jn.key===null?fn:jn.key),se=C(jn,se,fn),zn===null?Ot=jn:zn.sibling=jn,zn=jn);return a&&Ct.forEach(function(RD){return l(he,RD)}),wn&&Ma(he,fn),Ot}function Qn(he,se,xe,Ue){if(typeof xe=="object"&&xe!==null&&xe.type===R&&xe.key===null&&(xe=xe.props.children),typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case w:e:{for(var Ot=xe.key;se!==null;){if(se.key===Ot){if(Ot=xe.type,Ot===R){if(se.tag===7){m(he,se.sibling),Ue=M(se,xe.props.children),Ue.return=he,he=Ue;break e}}else if(se.elementType===Ot||typeof Ot=="object"&&Ot!==null&&Ot.$$typeof===W&&Vl(Ot)===se.type){m(he,se.sibling),Ue=M(se,xe.props),Or(Ue,xe),Ue.return=he,he=Ue;break e}m(he,se);break}else l(he,se);se=se.sibling}xe.type===R?(Ue=$o(xe.props.children,he.mode,Ue,xe.key),Ue.return=he,he=Ue):(Ue=Ea(xe.type,xe.key,xe.props,null,he.mode,Ue),Or(Ue,xe),Ue.return=he,he=Ue)}return O(he);case E:e:{for(Ot=xe.key;se!==null;){if(se.key===Ot)if(se.tag===4&&se.stateNode.containerInfo===xe.containerInfo&&se.stateNode.implementation===xe.implementation){m(he,se.sibling),Ue=M(se,xe.children||[]),Ue.return=he,he=Ue;break e}else{m(he,se);break}else l(he,se);se=se.sibling}Ue=jh(xe,he.mode,Ue),Ue.return=he,he=Ue}return O(he);case W:return xe=Vl(xe),Qn(he,se,xe,Ue)}if(oe(xe))return At(he,se,xe,Ue);if(ee(xe)){if(Ot=ee(xe),typeof Ot!="function")throw Error(i(150));return xe=Ot.call(xe),Ht(he,se,xe,Ue)}if(typeof xe.then=="function")return Qn(he,se,hd(xe),Ue);if(xe.$$typeof===D)return Qn(he,se,Wc(he,xe),Ue);$c(he,xe)}return typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint"?(xe=""+xe,se!==null&&se.tag===6?(m(he,se.sibling),Ue=M(se,xe),Ue.return=he,he=Ue):(m(he,se),Ue=zh(xe,he.mode,Ue),Ue.return=he,he=Ue),O(he)):m(he,se)}return function(he,se,xe,Ue){try{Wl=0;var Ot=Qn(he,se,xe,Ue);return ql=null,Ot}catch(Ct){if(Ct===Bl||Ct===cn)throw Ct;var zn=di(29,Ct,null,he.mode);return zn.lanes=Ue,zn.return=he,zn}}}var fo=Yh(!0),Jh=Yh(!1),ks=!1;function fd(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mm(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function po(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function el(a,l,m){var x=a.updateQueue;if(x===null)return null;if(x=x.shared,(kt&2)!==0){var M=x.pending;return M===null?l.next=l:(l.next=M.next,M.next=l),x.pending=l,l=Ur(a),qo(a,null,m),l}return es(a,x,l,m),Ur(a)}function tl(a,l,m){if(l=l.updateQueue,l!==null&&(l=l.shared,(m&4194048)!==0)){var x=l.lanes;x&=a.pendingLanes,m|=x,l.lanes=m,zo(a,m)}}function Lt(a,l){var m=a.updateQueue,x=a.alternate;if(x!==null&&(x=x.updateQueue,m===x)){var M=null,C=null;if(m=m.firstBaseUpdate,m!==null){do{var O={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};C===null?M=C=O:C=C.next=O,m=m.next}while(m!==null);C===null?M=C=l:C=C.next=l}else M=C=l;m={baseState:x.baseState,firstBaseUpdate:M,lastBaseUpdate:C,shared:x.shared,callbacks:x.callbacks},a.updateQueue=m;return}a=m.lastBaseUpdate,a===null?m.firstBaseUpdate=l:a.next=l,m.lastBaseUpdate=l}var gm=!1;function pd(){if(gm){var a=Lr;if(a!==null)throw a}}function Xc(a,l,m,x){gm=!1;var M=a.updateQueue;ks=!1;var C=M.firstBaseUpdate,O=M.lastBaseUpdate,q=M.shared.pending;if(q!==null){M.shared.pending=null;var ne=q,ve=ne.next;ne.next=null,O===null?C=ve:O.next=ve,O=ne;var ke=a.alternate;ke!==null&&(ke=ke.updateQueue,q=ke.lastBaseUpdate,q!==O&&(q===null?ke.firstBaseUpdate=ve:q.next=ve,ke.lastBaseUpdate=ne))}if(C!==null){var je=M.baseState;O=0,ke=ve=ne=null,q=C;do{var _e=q.lane&-536870913,Ae=_e!==q.lane;if(Ae?(an&_e)===_e:(x&_e)===_e){_e!==0&&_e===ho&&(gm=!0),ke!==null&&(ke=ke.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var At=a,Ht=q;_e=l;var Qn=m;switch(Ht.tag){case 1:if(At=Ht.payload,typeof At=="function"){je=At.call(Qn,je,_e);break e}je=At;break e;case 3:At.flags=At.flags&-65537|128;case 0:if(At=Ht.payload,_e=typeof At=="function"?At.call(Qn,je,_e):At,_e==null)break e;je=v({},je,_e);break e;case 2:ks=!0}}_e=q.callback,_e!==null&&(a.flags|=64,Ae&&(a.flags|=8192),Ae=M.callbacks,Ae===null?M.callbacks=[_e]:Ae.push(_e))}else Ae={lane:_e,tag:q.tag,payload:q.payload,callback:q.callback,next:null},ke===null?(ve=ke=Ae,ne=je):ke=ke.next=Ae,O|=_e;if(q=q.next,q===null){if(q=M.shared.pending,q===null)break;Ae=q,q=Ae.next,Ae.next=null,M.lastBaseUpdate=Ae,M.shared.pending=null}}while(!0);ke===null&&(ne=je),M.baseState=ne,M.firstBaseUpdate=ve,M.lastBaseUpdate=ke,C===null&&(M.shared.lanes=0),Fa|=O,a.lanes=O,a.memoizedState=je}}function Yc(a,l){if(typeof a!="function")throw Error(i(191,a));a.call(l)}function hx(a,l){var m=a.callbacks;if(m!==null)for(a.callbacks=null,a=0;a<m.length;a++)Yc(m[a],l)}var Jc=$(null),Kh=$(0);function fx(a,l){a=yr,Ne(Kh,a),Ne(Jc,l),yr=a|l.baseLanes}function xm(){Ne(Kh,yr),Ne(Jc,Jc.current)}function md(){yr=Kh.current,de(Jc),de(Kh)}var $s=$(null),Is=null;function mo(a){var l=a.alternate;Ne(Sn,Sn.current&1),Ne($s,a),Is===null&&(l===null||Jc.current!==null||l.memoizedState!==null)&&(Is=a)}function vm(a){Ne(Sn,Sn.current),Ne($s,a),Is===null&&(Is=a)}function px(a){a.tag===22?(Ne(Sn,Sn.current),Ne($s,a),Is===null&&(Is=a)):Xs()}function Xs(){Ne(Sn,Sn.current),Ne($s,$s.current)}function Si(a){de($s),Is===a&&(Is=null),de(Sn)}var Sn=$(0);function gr(a){for(var l=a;l!==null;){if(l.tag===13){var m=l.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||rw(m)||aw(m)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ai=0,en=null,qn=null,yn=null,zr=!1,Kc=!1,$l=!1,Zh=0,gd=0,Zc=null,ym=0;function fi(){throw Error(i(321))}function bm(a,l){if(l===null)return!1;for(var m=0;m<l.length&&m<a.length;m++)if(!Cs(a[m],l[m]))return!1;return!0}function Qh(a,l,m,x,M,C){return ai=C,en=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,J.H=a===null||a.memoizedState===null?Wx:Fm,$l=!1,C=m(x,M),$l=!1,Kc&&(C=Xl(l,m,x,M)),mx(a),C}function mx(a){J.H=Qc;var l=qn!==null&&qn.next!==null;if(ai=0,yn=qn=en=null,zr=!1,gd=0,Zc=null,l)throw Error(i(300));a===null||Li||(a=a.dependencies,a!==null&&cd(a)&&(Li=!0))}function Xl(a,l,m,x){en=a;var M=0;do{if(Kc&&(Zc=null),gd=0,Kc=!1,25<=M)throw Error(i(301));if(M+=1,yn=qn=null,a.updateQueue!=null){var C=a.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}J.H=jr,C=l(m,x)}while(Kc);return C}function Yl(){var a=J.H,l=a.useState()[0];return l=typeof l.then=="function"?xd(l):l,a=a.useState()[0],(qn!==null?qn.memoizedState:null)!==a&&(en.flags|=1024),l}function _m(){var a=Zh!==0;return Zh=0,a}function wm(a,l,m){l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~m}function Sm(a){if(zr){for(a=a.memoizedState;a!==null;){var l=a.queue;l!==null&&(l.pending=null),a=a.next}zr=!1}ai=0,yn=qn=en=null,Kc=!1,gd=Zh=0,Zc=null}function Gi(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yn===null?en.memoizedState=yn=a:yn=yn.next=a,yn}function Ti(){if(qn===null){var a=en.alternate;a=a!==null?a.memoizedState:null}else a=qn.next;var l=yn===null?en.memoizedState:yn.next;if(l!==null)yn=l,qn=a;else{if(a===null)throw en.alternate===null?Error(i(467)):Error(i(310));qn=a,a={memoizedState:qn.memoizedState,baseState:qn.baseState,baseQueue:qn.baseQueue,queue:qn.queue,next:null},yn===null?en.memoizedState=yn=a:yn=yn.next=a}return yn}function ef(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function xd(a){var l=gd;return gd+=1,Zc===null&&(Zc=[]),a=Xh(Zc,a,l),l=en,(yn===null?l.memoizedState:yn.next)===null&&(l=l.alternate,J.H=l===null||l.memoizedState===null?Wx:Fm),a}function nl(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return xd(a);if(a.$$typeof===D)return Gt(a)}throw Error(i(438,String(a)))}function Tm(a){var l=null,m=en.updateQueue;if(m!==null&&(l=m.memoCache),l==null){var x=en.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(l={data:x.data.map(function(M){return M.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),m===null&&(m=ef(),en.updateQueue=m),m.memoCache=l,m=l.data[l.index],m===void 0)for(m=l.data[l.index]=Array(a),x=0;x<a;x++)m[x]=B;return l.index++,m}function go(a,l){return typeof l=="function"?l(a):l}function tf(a){var l=Ti();return Em(l,qn,a)}function Em(a,l,m){var x=a.queue;if(x===null)throw Error(i(311));x.lastRenderedReducer=m;var M=a.baseQueue,C=x.pending;if(C!==null){if(M!==null){var O=M.next;M.next=C.next,C.next=O}l.baseQueue=M=C,x.pending=null}if(C=a.baseState,M===null)a.memoizedState=C;else{l=M.next;var q=O=null,ne=null,ve=l,ke=!1;do{var je=ve.lane&-536870913;if(je!==ve.lane?(an&je)===je:(ai&je)===je){var _e=ve.revertLane;if(_e===0)ne!==null&&(ne=ne.next={lane:0,revertLane:0,gesture:null,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null}),je===ho&&(ke=!0);else if((ai&_e)===_e){ve=ve.next,_e===ho&&(ke=!0);continue}else je={lane:0,revertLane:ve.revertLane,gesture:null,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},ne===null?(q=ne=je,O=C):ne=ne.next=je,en.lanes|=_e,Fa|=_e;je=ve.action,$l&&m(C,je),C=ve.hasEagerState?ve.eagerState:m(C,je)}else _e={lane:je,revertLane:ve.revertLane,gesture:ve.gesture,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},ne===null?(q=ne=_e,O=C):ne=ne.next=_e,en.lanes|=je,Fa|=je;ve=ve.next}while(ve!==null&&ve!==l);if(ne===null?O=C:ne.next=q,!Cs(C,a.memoizedState)&&(Li=!0,ke&&(m=Lr,m!==null)))throw m;a.memoizedState=C,a.baseState=O,a.baseQueue=ne,x.lastRenderedState=C}return M===null&&(x.lanes=0),[a.memoizedState,x.dispatch]}function Mm(a){var l=Ti(),m=l.queue;if(m===null)throw Error(i(311));m.lastRenderedReducer=a;var x=m.dispatch,M=m.pending,C=l.memoizedState;if(M!==null){m.pending=null;var O=M=M.next;do C=a(C,O.action),O=O.next;while(O!==M);Cs(C,l.memoizedState)||(Li=!0),l.memoizedState=C,l.baseQueue===null&&(l.baseState=C),m.lastRenderedState=C}return[C,x]}function gx(a,l,m){var x=en,M=Ti(),C=wn;if(C){if(m===void 0)throw Error(i(407));m=m()}else m=l();var O=!Cs((qn||M).memoizedState,m);if(O&&(M.memoizedState=m,Li=!0),M=M.queue,Pm(yx.bind(null,x,M,a),[a]),M.getSnapshot!==l||O||yn!==null&&yn.memoizedState.tag&1){if(x.flags|=2048,il(9,{destroy:void 0},vx.bind(null,x,M,m,l),null),Yt===null)throw Error(i(349));C||(ai&127)!==0||xx(x,l,m)}return m}function xx(a,l,m){a.flags|=16384,a={getSnapshot:l,value:m},l=en.updateQueue,l===null?(l=ef(),en.updateQueue=l,l.stores=[a]):(m=l.stores,m===null?l.stores=[a]:m.push(a))}function vx(a,l,m,x){l.value=m,l.getSnapshot=x,bx(l)&&_x(a)}function yx(a,l,m){return m(function(){bx(l)&&_x(a)})}function bx(a){var l=a.getSnapshot;a=a.value;try{var m=l();return!Cs(a,m)}catch{return!0}}function _x(a){var l=Rs(a,2);l!==null&&dn(l,a,2)}function Am(a){var l=Gi();if(typeof a=="function"){var m=a;if(a=m(),$l){xt(!0);try{m()}finally{xt(!1)}}}return l.memoizedState=l.baseState=a,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:a},l}function Nm(a,l,m,x){return a.baseState=m,Em(a,qn,typeof x=="function"?x:go)}function H_(a,l,m,x,M){if(af(a))throw Error(i(485));if(a=l.action,a!==null){var C={payload:M,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){C.listeners.push(O)}};J.T!==null?m(!0):C.isTransition=!1,x(C),m=l.pending,m===null?(C.next=l.pending=C,wx(l,C)):(C.next=m.next,l.pending=m.next=C)}}function wx(a,l){var m=l.action,x=l.payload,M=a.state;if(l.isTransition){var C=J.T,O={};J.T=O;try{var q=m(M,x),ne=J.S;ne!==null&&ne(O,q),Sx(a,l,q)}catch(ve){Cm(a,l,ve)}finally{C!==null&&O.types!==null&&(C.types=O.types),J.T=C}}else try{C=m(M,x),Sx(a,l,C)}catch(ve){Cm(a,l,ve)}}function Sx(a,l,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(x){Tx(a,l,x)},function(x){return Cm(a,l,x)}):Tx(a,l,m)}function Tx(a,l,m){l.status="fulfilled",l.value=m,Ex(l),a.state=m,l=a.pending,l!==null&&(m=l.next,m===l?a.pending=null:(m=m.next,l.next=m,wx(a,m)))}function Cm(a,l,m){var x=a.pending;if(a.pending=null,x!==null){x=x.next;do l.status="rejected",l.reason=m,Ex(l),l=l.next;while(l!==x)}a.action=null}function Ex(a){a=a.listeners;for(var l=0;l<a.length;l++)(0,a[l])()}function Rm(a,l){return l}function km(a,l){if(wn){var m=Yt.formState;if(m!==null){e:{var x=en;if(wn){if(Jn){t:{for(var M=Jn,C=pr;M.nodeType!==8;){if(!C){M=null;break t}if(M=Ha(M.nextSibling),M===null){M=null;break t}}C=M.data,M=C==="F!"||C==="F"?M:null}if(M){Jn=Ha(M.nextSibling),x=M.data==="F!";break e}}Na(x)}x=!1}x&&(l=m[0])}}return m=Gi(),m.memoizedState=m.baseState=l,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rm,lastRenderedState:l},m.queue=x,m=Hx.bind(null,en,x),x.dispatch=m,x=Am(!1),C=jm.bind(null,en,!1,x.queue),x=Gi(),M={state:l,dispatch:null,action:a,pending:null},x.queue=M,m=H_.bind(null,en,M,C,m),M.dispatch=m,x.memoizedState=a,[l,m,!1]}function Mx(a){var l=Ti();return Im(l,qn,a)}function Im(a,l,m){if(l=Em(a,l,Rm)[0],a=tf(go)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var x=xd(l)}catch(O){throw O===Bl?cn:O}else x=l;l=Ti();var M=l.queue,C=M.dispatch;return m!==l.memoizedState&&(en.flags|=2048,il(9,{destroy:void 0},Ax.bind(null,M,m),null)),[x,C,a]}function Ax(a,l){a.action=l}function Dm(a){var l=Ti(),m=qn;if(m!==null)return Im(l,m,a);Ti(),l=l.memoizedState,m=Ti();var x=m.queue.dispatch;return m.memoizedState=a,[l,x,!1]}function il(a,l,m,x){return a={tag:a,create:m,deps:x,inst:l,next:null},l=en.updateQueue,l===null&&(l=ef(),en.updateQueue=l),m=l.lastEffect,m===null?l.lastEffect=a.next=a:(x=m.next,m.next=a,a.next=x,l.lastEffect=a),a}function nf(){return Ti().memoizedState}function sf(a,l,m,x){var M=Gi();en.flags|=a,M.memoizedState=il(1|l,{destroy:void 0},m,x===void 0?null:x)}function rf(a,l,m,x){var M=Ti();x=x===void 0?null:x;var C=M.memoizedState.inst;qn!==null&&x!==null&&bm(x,qn.memoizedState.deps)?M.memoizedState=il(l,C,m,x):(en.flags|=a,M.memoizedState=il(1|l,C,m,x))}function Nx(a,l){sf(8390656,8,a,l)}function Pm(a,l){rf(2048,8,a,l)}function Cx(a){en.flags|=4;var l=en.updateQueue;if(l===null)l=ef(),en.updateQueue=l,l.events=[a];else{var m=l.events;m===null?l.events=[a]:m.push(a)}}function Rx(a){var l=Ti().memoizedState;return Cx({ref:l,nextImpl:a}),function(){if((kt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}function kx(a,l){return rf(4,2,a,l)}function Ix(a,l){return rf(4,4,a,l)}function Dx(a,l){if(typeof l=="function"){a=a();var m=l(a);return function(){typeof m=="function"?m():l(null)}}if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Px(a,l,m){m=m!=null?m.concat([a]):null,rf(4,4,Dx.bind(null,l,a),m)}function Um(){}function Ux(a,l){var m=Ti();l=l===void 0?null:l;var x=m.memoizedState;return l!==null&&bm(l,x[1])?x[0]:(m.memoizedState=[a,l],a)}function Lx(a,l){var m=Ti();l=l===void 0?null:l;var x=m.memoizedState;if(l!==null&&bm(l,x[1]))return x[0];if(x=a(),$l){xt(!0);try{a()}finally{xt(!1)}}return m.memoizedState=[x,l],x}function Lm(a,l,m){return m===void 0||(ai&1073741824)!==0&&(an&261930)===0?a.memoizedState=l:(a.memoizedState=m,a=gn(),en.lanes|=a,Fa|=a,m)}function Ox(a,l,m,x){return Cs(m,l)?m:Jc.current!==null?(a=Lm(a,m,x),Cs(a,l)||(Li=!0),a):(ai&42)===0||(ai&1073741824)!==0&&(an&261930)===0?(Li=!0,a.memoizedState=m):(a=gn(),en.lanes|=a,Fa|=a,l)}function zx(a,l,m,x,M){var C=te.p;te.p=C!==0&&8>C?C:8;var O=J.T,q={};J.T=q,jm(a,!1,l,m);try{var ne=M(),ve=J.S;if(ve!==null&&ve(q,ne),ne!==null&&typeof ne=="object"&&typeof ne.then=="function"){var ke=fm(ne,x);vd(a,l,ke,_r(a))}else vd(a,l,x,_r(a))}catch(je){vd(a,l,{then:function(){},status:"rejected",reason:je},_r())}finally{te.p=C,O!==null&&q.types!==null&&(O.types=q.types),J.T=O}}function G_(){}function Om(a,l,m,x){if(a.tag!==5)throw Error(i(476));var M=jx(a).queue;zx(a,M,l,me,m===null?G_:function(){return Fx(a),m(x)})}function jx(a){var l=a.memoizedState;if(l!==null)return l;l={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:me},next:null};var m={};return l.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:m},next:null},a.memoizedState=l,a=a.alternate,a!==null&&(a.memoizedState=l),l}function Fx(a){var l=jx(a);l.next===null&&(l=a.alternate.memoizedState),vd(a,l.next.queue,{},_r())}function zm(){return Gt(ag)}function Bx(){return Ti().memoizedState}function Vx(){return Ti().memoizedState}function q_(a){for(var l=a.return;l!==null;){switch(l.tag){case 24:case 3:var m=_r();a=po(m);var x=el(l,a,m);x!==null&&(dn(x,l,m),tl(x,l,m)),l={cache:um()},a.payload=l;return}l=l.return}}function W_(a,l,m){var x=_r();m={lane:x,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},af(a)?Gx(l,m):(m=Lh(a,l,m,x),m!==null&&(dn(m,a,x),qx(m,l,x)))}function Hx(a,l,m){var x=_r();vd(a,l,m,x)}function vd(a,l,m,x){var M={lane:x,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(af(a))Gx(l,M);else{var C=a.alternate;if(a.lanes===0&&(C===null||C.lanes===0)&&(C=l.lastRenderedReducer,C!==null))try{var O=l.lastRenderedState,q=C(O,m);if(M.hasEagerState=!0,M.eagerState=q,Cs(q,O))return es(a,l,M,0),Yt===null&&od(),!1}catch{}if(m=Lh(a,l,M,x),m!==null)return dn(m,a,x),qx(m,l,x),!0}return!1}function jm(a,l,m,x){if(x={lane:2,revertLane:Se(),gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},af(a)){if(l)throw Error(i(479))}else l=Lh(a,m,x,2),l!==null&&dn(l,a,2)}function af(a){var l=a.alternate;return a===en||l!==null&&l===en}function Gx(a,l){Kc=zr=!0;var m=a.pending;m===null?l.next=l:(l.next=m.next,m.next=l),a.pending=l}function qx(a,l,m){if((m&4194048)!==0){var x=l.lanes;x&=a.pendingLanes,m|=x,l.lanes=m,zo(a,m)}}var Qc={readContext:Gt,use:nl,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useLayoutEffect:fi,useInsertionEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useSyncExternalStore:fi,useId:fi,useHostTransitionStatus:fi,useFormState:fi,useActionState:fi,useOptimistic:fi,useMemoCache:fi,useCacheRefresh:fi};Qc.useEffectEvent=fi;var Wx={readContext:Gt,use:nl,useCallback:function(a,l){return Gi().memoizedState=[a,l===void 0?null:l],a},useContext:Gt,useEffect:Nx,useImperativeHandle:function(a,l,m){m=m!=null?m.concat([a]):null,sf(4194308,4,Dx.bind(null,l,a),m)},useLayoutEffect:function(a,l){return sf(4194308,4,a,l)},useInsertionEffect:function(a,l){sf(4,2,a,l)},useMemo:function(a,l){var m=Gi();l=l===void 0?null:l;var x=a();if($l){xt(!0);try{a()}finally{xt(!1)}}return m.memoizedState=[x,l],x},useReducer:function(a,l,m){var x=Gi();if(m!==void 0){var M=m(l);if($l){xt(!0);try{m(l)}finally{xt(!1)}}}else M=l;return x.memoizedState=x.baseState=M,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:M},x.queue=a,a=a.dispatch=W_.bind(null,en,a),[x.memoizedState,a]},useRef:function(a){var l=Gi();return a={current:a},l.memoizedState=a},useState:function(a){a=Am(a);var l=a.queue,m=Hx.bind(null,en,l);return l.dispatch=m,[a.memoizedState,m]},useDebugValue:Um,useDeferredValue:function(a,l){var m=Gi();return Lm(m,a,l)},useTransition:function(){var a=Am(!1);return a=zx.bind(null,en,a.queue,!0,!1),Gi().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,l,m){var x=en,M=Gi();if(wn){if(m===void 0)throw Error(i(407));m=m()}else{if(m=l(),Yt===null)throw Error(i(349));(an&127)!==0||xx(x,l,m)}M.memoizedState=m;var C={value:m,getSnapshot:l};return M.queue=C,Nx(yx.bind(null,x,C,a),[a]),x.flags|=2048,il(9,{destroy:void 0},vx.bind(null,x,C,m,l),null),m},useId:function(){var a=Gi(),l=Yt.identifierPrefix;if(wn){var m=aa,x=hi;m=(x&~(1<<32-pt(x)-1)).toString(32)+m,l="_"+l+"R_"+m,m=Zh++,0<m&&(l+="H"+m.toString(32)),l+="_"}else m=ym++,l="_"+l+"r_"+m.toString(32)+"_";return a.memoizedState=l},useHostTransitionStatus:zm,useFormState:km,useActionState:km,useOptimistic:function(a){var l=Gi();l.memoizedState=l.baseState=a;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=m,l=jm.bind(null,en,!0,m),m.dispatch=l,[a,l]},useMemoCache:Tm,useCacheRefresh:function(){return Gi().memoizedState=q_.bind(null,en)},useEffectEvent:function(a){var l=Gi(),m={impl:a};return l.memoizedState=m,function(){if((kt&2)!==0)throw Error(i(440));return m.impl.apply(void 0,arguments)}}},Fm={readContext:Gt,use:nl,useCallback:Ux,useContext:Gt,useEffect:Pm,useImperativeHandle:Px,useInsertionEffect:kx,useLayoutEffect:Ix,useMemo:Lx,useReducer:tf,useRef:nf,useState:function(){return tf(go)},useDebugValue:Um,useDeferredValue:function(a,l){var m=Ti();return Ox(m,qn.memoizedState,a,l)},useTransition:function(){var a=tf(go)[0],l=Ti().memoizedState;return[typeof a=="boolean"?a:xd(a),l]},useSyncExternalStore:gx,useId:Bx,useHostTransitionStatus:zm,useFormState:Mx,useActionState:Mx,useOptimistic:function(a,l){var m=Ti();return Nm(m,qn,a,l)},useMemoCache:Tm,useCacheRefresh:Vx};Fm.useEffectEvent=Rx;var jr={readContext:Gt,use:nl,useCallback:Ux,useContext:Gt,useEffect:Pm,useImperativeHandle:Px,useInsertionEffect:kx,useLayoutEffect:Ix,useMemo:Lx,useReducer:Mm,useRef:nf,useState:function(){return Mm(go)},useDebugValue:Um,useDeferredValue:function(a,l){var m=Ti();return qn===null?Lm(m,a,l):Ox(m,qn.memoizedState,a,l)},useTransition:function(){var a=Mm(go)[0],l=Ti().memoizedState;return[typeof a=="boolean"?a:xd(a),l]},useSyncExternalStore:gx,useId:Bx,useHostTransitionStatus:zm,useFormState:Dm,useActionState:Dm,useOptimistic:function(a,l){var m=Ti();return qn!==null?Nm(m,qn,a,l):(m.baseState=a,[a,m.queue.dispatch])},useMemoCache:Tm,useCacheRefresh:Vx};jr.useEffectEvent=Rx;function of(a,l,m,x){l=a.memoizedState,m=m(x,l),m=m==null?l:v({},l,m),a.memoizedState=m,a.lanes===0&&(a.updateQueue.baseState=m)}var yd={enqueueSetState:function(a,l,m){a=a._reactInternals;var x=_r(),M=po(x);M.payload=l,m!=null&&(M.callback=m),l=el(a,M,x),l!==null&&(dn(l,a,x),tl(l,a,x))},enqueueReplaceState:function(a,l,m){a=a._reactInternals;var x=_r(),M=po(x);M.tag=1,M.payload=l,m!=null&&(M.callback=m),l=el(a,M,x),l!==null&&(dn(l,a,x),tl(l,a,x))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var m=_r(),x=po(m);x.tag=2,l!=null&&(x.callback=l),l=el(a,x,m),l!==null&&(dn(l,a,m),tl(l,a,m))}};function Bm(a,l,m,x,M,C,O){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(x,C,O):l.prototype&&l.prototype.isPureReactComponent?!Uc(m,x)||!Uc(M,C):!0}function Vm(a,l,m,x){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(m,x),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(m,x),l.state!==a&&yd.enqueueReplaceState(l,l.state,null)}function sl(a,l){var m=l;if("ref"in l){m={};for(var x in l)x!=="ref"&&(m[x]=l[x])}if(a=a.defaultProps){m===l&&(m=v({},m));for(var M in a)m[M]===void 0&&(m[M]=a[M])}return m}function $x(a){ad(a)}function Hm(a){console.error(a)}function Gm(a){ad(a)}function lf(a,l){try{var m=a.onUncaughtError;m(l.value,{componentStack:l.stack})}catch(x){setTimeout(function(){throw x})}}function Xx(a,l,m){try{var x=a.onCaughtError;x(m.value,{componentStack:m.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function qm(a,l,m){return m=po(m),m.tag=3,m.payload={element:null},m.callback=function(){lf(a,l)},m}function Wm(a){return a=po(a),a.tag=3,a}function Yx(a,l,m,x){var M=m.type.getDerivedStateFromError;if(typeof M=="function"){var C=x.value;a.payload=function(){return M(C)},a.callback=function(){Xx(l,m,x)}}var O=m.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(a.callback=function(){Xx(l,m,x),typeof M!="function"&&(Ai===null?Ai=new Set([this]):Ai.add(this));var q=x.stack;this.componentDidCatch(x.value,{componentStack:q!==null?q:""})})}function qi(a,l,m,x,M){if(m.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(l=m.alternate,l!==null&&Ia(l,m,M,!0),m=$s.current,m!==null){switch(m.tag){case 31:case 13:return Is===null?au():m.alternate===null&&pi===0&&(pi=3),m.flags&=-257,m.flags|=65536,m.lanes=M,x===$h?m.flags|=16384:(l=m.updateQueue,l===null?m.updateQueue=new Set([x]):l.add(x),kd(a,x,M)),!1;case 22:return m.flags|=65536,x===$h?m.flags|=16384:(l=m.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([x])},m.updateQueue=l):(m=l.retryQueue,m===null?l.retryQueue=new Set([x]):m.add(x)),kd(a,x,M)),!1}throw Error(i(435,m.tag))}return kd(a,x,M),au(),!1}if(wn)return l=$s.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=M,x!==Hc&&(a=Error(i(422),{cause:x}),Ca(fr(a,m)))):(x!==Hc&&(l=Error(i(423),{cause:x}),Ca(fr(l,m))),a=a.current.alternate,a.flags|=65536,M&=-M,a.lanes|=M,x=fr(x,m),M=qm(a.stateNode,x,M),Lt(a,M),pi!==4&&(pi=2)),!1;var C=Error(i(520),{cause:x});if(C=fr(C,m),ic===null?ic=[C]:ic.push(C),pi!==4&&(pi=2),l===null)return!0;x=fr(x,m),m=l;do{switch(m.tag){case 3:return m.flags|=65536,a=M&-M,m.lanes|=a,a=qm(m.stateNode,x,a),Lt(m,a),!1;case 1:if(l=m.type,C=m.stateNode,(m.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Ai===null||!Ai.has(C))))return m.flags|=65536,M&=-M,m.lanes|=M,M=Wm(M),Yx(M,a,m,x),Lt(m,M),!1}m=m.return}while(m!==null);return!1}var cf=Error(i(461)),Li=!1;function ts(a,l,m,x){l.child=a===null?Jh(l,null,m,x):fo(l,a.child,m,x)}function $m(a,l,m,x,M){m=m.render;var C=l.ref;if("ref"in x){var O={};for(var q in x)q!=="ref"&&(O[q]=x[q])}else O=x;return Zo(l),x=Qh(a,l,m,O,C,M),q=_m(),a!==null&&!Li?(wm(a,l,M),Ei(a,l,M)):(wn&&q&&Aa(l),l.flags|=1,ts(a,l,x,M),l.child)}function Jl(a,l,m,x,M){if(a===null){var C=m.type;return typeof C=="function"&&!Oh(C)&&C.defaultProps===void 0&&m.compare===null?(l.tag=15,l.type=C,uf(a,l,C,x,M)):(a=Ea(m.type,null,x,l,l.mode,M),a.ref=l.ref,a.return=l,l.child=a)}if(C=a.child,!gf(a,M)){var O=C.memoizedProps;if(m=m.compare,m=m!==null?m:Uc,m(O,x)&&a.ref===l.ref)return Ei(a,l,M)}return l.flags|=1,a=Gs(C,x),a.ref=l.ref,a.return=l,l.child=a}function uf(a,l,m,x,M){if(a!==null){var C=a.memoizedProps;if(Uc(C,x)&&a.ref===l.ref)if(Li=!1,l.pendingProps=x=C,gf(a,M))(a.flags&131072)!==0&&(Li=!0);else return l.lanes=a.lanes,Ei(a,l,M)}return eu(a,l,m,x,M)}function Kl(a,l,m,x){var M=x.children,C=a!==null?a.memoizedState:null;if(a===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),x.mode==="hidden"){if((l.flags&128)!==0){if(C=C!==null?C.baseLanes|m:m,a!==null){for(x=l.child=a.child,M=0;x!==null;)M=M|x.lanes|x.childLanes,x=x.sibling;x=M&~C}else x=0,l.child=null;return Ys(a,l,C,m,x)}if((m&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},a!==null&&ud(l,C!==null?C.cachePool:null),C!==null?fx(l,C):xm(),px(l);else return x=l.lanes=536870912,Ys(a,l,C!==null?C.baseLanes|m:m,m,x)}else C!==null?(ud(l,C.cachePool),fx(l,C),Xs(),l.memoizedState=null):(a!==null&&ud(l,null),xm(),Xs());return ts(a,l,M,m),l.child}function Pa(a,l){return a!==null&&a.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function Ys(a,l,m,x,M){var C=Wh();return C=C===null?null:{parent:Ui._currentValue,pool:C},l.memoizedState={baseLanes:m,cachePool:C},a!==null&&ud(l,null),xm(),px(l),a!==null&&Ia(a,l,x,!0),l.childLanes=M,null}function df(a,l){return l=mf({mode:l.mode,children:l.children},a.mode),l.ref=a.ref,a.child=l,l.return=a,l}function Jx(a,l,m){return fo(l,a.child,null,m),a=df(l,l.pendingProps),a.flags|=2,Si(l),l.memoizedState=null,a}function hf(a,l,m){var x=l.pendingProps,M=(l.flags&128)!==0;if(l.flags&=-129,a===null){if(wn){if(x.mode==="hidden")return a=df(l,x),l.lanes=536870912,Pa(null,a);if(vm(l),(a=Jn)?(a=hE(a,pr),a=a!==null&&a.data==="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:lo!==null?{id:hi,overflow:aa}:null,retryLane:536870912,hydrationErrors:null},m=Fc(a),m.return=l,l.child=m,yi=l,Jn=null)):a=null,a===null)throw Na(l);return l.lanes=536870912,null}return df(l,x)}var C=a.memoizedState;if(C!==null){var O=C.dehydrated;if(vm(l),M)if(l.flags&256)l.flags&=-257,l=Jx(a,l,m);else if(l.memoizedState!==null)l.child=a.child,l.flags|=128,l=null;else throw Error(i(558));else if(Li||Ia(a,l,m,!1),M=(m&a.childLanes)!==0,Li||M){if(x=Yt,x!==null&&(O=Cl(x,m),O!==0&&O!==C.retryLane))throw C.retryLane=O,Rs(a,O),dn(x,a,O),cf;au(),l=Jx(a,l,m)}else a=C.treeContext,Jn=Ha(O.nextSibling),yi=l,wn=!0,co=null,pr=!1,a!==null&&Bh(l,a),l=df(l,x),l.flags|=4096;return l}return a=Gs(a.child,{mode:x.mode,children:x.children}),a.ref=l.ref,l.child=a,a.return=l,a}function Zl(a,l){var m=l.ref;if(m===null)a!==null&&a.ref!==null&&(l.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(i(284));(a===null||a.ref!==m)&&(l.flags|=4194816)}}function eu(a,l,m,x,M){return Zo(l),m=Qh(a,l,m,x,void 0,M),x=_m(),a!==null&&!Li?(wm(a,l,M),Ei(a,l,M)):(wn&&x&&Aa(l),l.flags|=1,ts(a,l,m,M),l.child)}function bd(a,l,m,x,M,C){return Zo(l),l.updateQueue=null,m=Xl(l,x,m,M),mx(a),x=_m(),a!==null&&!Li?(wm(a,l,C),Ei(a,l,C)):(wn&&x&&Aa(l),l.flags|=1,ts(a,l,m,C),l.child)}function ff(a,l,m,x,M){if(Zo(l),l.stateNode===null){var C=Wo,O=m.contextType;typeof O=="object"&&O!==null&&(C=Gt(O)),C=new m(x,C),l.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=yd,l.stateNode=C,C._reactInternals=l,C=l.stateNode,C.props=x,C.state=l.memoizedState,C.refs={},fd(l),O=m.contextType,C.context=typeof O=="object"&&O!==null?Gt(O):Wo,C.state=l.memoizedState,O=m.getDerivedStateFromProps,typeof O=="function"&&(of(l,m,O,x),C.state=l.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(O=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),O!==C.state&&yd.enqueueReplaceState(C,C.state,null),Xc(l,x,C,M),pd(),C.state=l.memoizedState),typeof C.componentDidMount=="function"&&(l.flags|=4194308),x=!0}else if(a===null){C=l.stateNode;var q=l.memoizedProps,ne=sl(m,q);C.props=ne;var ve=C.context,ke=m.contextType;O=Wo,typeof ke=="object"&&ke!==null&&(O=Gt(ke));var je=m.getDerivedStateFromProps;ke=typeof je=="function"||typeof C.getSnapshotBeforeUpdate=="function",q=l.pendingProps!==q,ke||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(q||ve!==O)&&Vm(l,C,x,O),ks=!1;var _e=l.memoizedState;C.state=_e,Xc(l,x,C,M),pd(),ve=l.memoizedState,q||_e!==ve||ks?(typeof je=="function"&&(of(l,m,je,x),ve=l.memoizedState),(ne=ks||Bm(l,m,ne,x,_e,ve,O))?(ke||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(l.flags|=4194308)):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=x,l.memoizedState=ve),C.props=x,C.state=ve,C.context=O,x=ne):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),x=!1)}else{C=l.stateNode,mm(a,l),O=l.memoizedProps,ke=sl(m,O),C.props=ke,je=l.pendingProps,_e=C.context,ve=m.contextType,ne=Wo,typeof ve=="object"&&ve!==null&&(ne=Gt(ve)),q=m.getDerivedStateFromProps,(ve=typeof q=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(O!==je||_e!==ne)&&Vm(l,C,x,ne),ks=!1,_e=l.memoizedState,C.state=_e,Xc(l,x,C,M),pd();var Ae=l.memoizedState;O!==je||_e!==Ae||ks||a!==null&&a.dependencies!==null&&cd(a.dependencies)?(typeof q=="function"&&(of(l,m,q,x),Ae=l.memoizedState),(ke=ks||Bm(l,m,ke,x,_e,Ae,ne)||a!==null&&a.dependencies!==null&&cd(a.dependencies))?(ve||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(x,Ae,ne),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(x,Ae,ne)),typeof C.componentDidUpdate=="function"&&(l.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof C.componentDidUpdate!="function"||O===a.memoizedProps&&_e===a.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||O===a.memoizedProps&&_e===a.memoizedState||(l.flags|=1024),l.memoizedProps=x,l.memoizedState=Ae),C.props=x,C.state=Ae,C.context=ne,x=ke):(typeof C.componentDidUpdate!="function"||O===a.memoizedProps&&_e===a.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||O===a.memoizedProps&&_e===a.memoizedState||(l.flags|=1024),x=!1)}return C=x,Zl(a,l),x=(l.flags&128)!==0,C||x?(C=l.stateNode,m=x&&typeof m.getDerivedStateFromError!="function"?null:C.render(),l.flags|=1,a!==null&&x?(l.child=fo(l,a.child,null,M),l.child=fo(l,null,m,M)):ts(a,l,m,M),l.memoizedState=C.state,a=l.child):a=Ei(a,l,M),a}function Kx(a,l,m,x){return Jo(),l.flags|=256,ts(a,l,m,x),l.child}var Xm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ys(a){return{baseLanes:a,cachePool:pm()}}function pf(a,l,m){return a=a!==null?a.childLanes&~m:0,l&&(a|=Us),a}function Zx(a,l,m){var x=l.pendingProps,M=!1,C=(l.flags&128)!==0,O;if((O=C)||(O=a!==null&&a.memoizedState===null?!1:(Sn.current&2)!==0),O&&(M=!0,l.flags&=-129),O=(l.flags&32)!==0,l.flags&=-33,a===null){if(wn){if(M?mo(l):Xs(),(a=Jn)?(a=hE(a,pr),a=a!==null&&a.data!=="&"?a:null,a!==null&&(l.memoizedState={dehydrated:a,treeContext:lo!==null?{id:hi,overflow:aa}:null,retryLane:536870912,hydrationErrors:null},m=Fc(a),m.return=l,l.child=m,yi=l,Jn=null)):a=null,a===null)throw Na(l);return aw(a)?l.lanes=32:l.lanes=536870912,null}var q=x.children;return x=x.fallback,M?(Xs(),M=l.mode,q=mf({mode:"hidden",children:q},M),x=$o(x,M,m,null),q.return=l,x.return=l,q.sibling=x,l.child=q,x=l.child,x.memoizedState=ys(m),x.childLanes=pf(a,O,m),l.memoizedState=Xm,Pa(null,x)):(mo(l),_d(l,q))}var ne=a.memoizedState;if(ne!==null&&(q=ne.dehydrated,q!==null)){if(C)l.flags&256?(mo(l),l.flags&=-257,l=Ym(a,l,m)):l.memoizedState!==null?(Xs(),l.child=a.child,l.flags|=128,l=null):(Xs(),q=x.fallback,M=l.mode,x=mf({mode:"visible",children:x.children},M),q=$o(q,M,m,null),q.flags|=2,x.return=l,q.return=l,x.sibling=q,l.child=x,fo(l,a.child,null,m),x=l.child,x.memoizedState=ys(m),x.childLanes=pf(a,O,m),l.memoizedState=Xm,l=Pa(null,x));else if(mo(l),aw(q)){if(O=q.nextSibling&&q.nextSibling.dataset,O)var ve=O.dgst;O=ve,x=Error(i(419)),x.stack="",x.digest=O,Ca({value:x,source:null,stack:null}),l=Ym(a,l,m)}else if(Li||Ia(a,l,m,!1),O=(m&a.childLanes)!==0,Li||O){if(O=Yt,O!==null&&(x=Cl(O,m),x!==0&&x!==ne.retryLane))throw ne.retryLane=x,Rs(a,x),dn(O,a,x),cf;rw(q)||au(),l=Ym(a,l,m)}else rw(q)?(l.flags|=192,l.child=a.child,l=null):(a=ne.treeContext,Jn=Ha(q.nextSibling),yi=l,wn=!0,co=null,pr=!1,a!==null&&Bh(l,a),l=_d(l,x.children),l.flags|=4096);return l}return M?(Xs(),q=x.fallback,M=l.mode,ne=a.child,ve=ne.sibling,x=Gs(ne,{mode:"hidden",children:x.children}),x.subtreeFlags=ne.subtreeFlags&65011712,ve!==null?q=Gs(ve,q):(q=$o(q,M,m,null),q.flags|=2),q.return=l,x.return=l,x.sibling=q,l.child=x,Pa(null,x),x=l.child,q=a.child.memoizedState,q===null?q=ys(m):(M=q.cachePool,M!==null?(ne=Ui._currentValue,M=M.parent!==ne?{parent:ne,pool:ne}:M):M=pm(),q={baseLanes:q.baseLanes|m,cachePool:M}),x.memoizedState=q,x.childLanes=pf(a,O,m),l.memoizedState=Xm,Pa(a.child,x)):(mo(l),m=a.child,a=m.sibling,m=Gs(m,{mode:"visible",children:x.children}),m.return=l,m.sibling=null,a!==null&&(O=l.deletions,O===null?(l.deletions=[a],l.flags|=16):O.push(a)),l.child=m,l.memoizedState=null,m)}function _d(a,l){return l=mf({mode:"visible",children:l},a.mode),l.return=a,a.child=l}function mf(a,l){return a=di(22,a,null,l),a.lanes=0,a}function Ym(a,l,m){return fo(l,a.child,null,m),a=_d(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function Qx(a,l,m){a.lanes|=l;var x=a.alternate;x!==null&&(x.lanes|=l),Hh(a.return,l,m)}function Ql(a,l,m,x,M,C){var O=a.memoizedState;O===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:x,tail:m,tailMode:M,treeForkCount:C}:(O.isBackwards=l,O.rendering=null,O.renderingStartTime=0,O.last=x,O.tail=m,O.tailMode=M,O.treeForkCount=C)}function Js(a,l,m){var x=l.pendingProps,M=x.revealOrder,C=x.tail;x=x.children;var O=Sn.current,q=(O&2)!==0;if(q?(O=O&1|2,l.flags|=128):O&=1,Ne(Sn,O),ts(a,l,x,m),x=wn?Vc:0,!q&&a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Qx(a,m,l);else if(a.tag===19)Qx(a,m,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(M){case"forwards":for(m=l.child,M=null;m!==null;)a=m.alternate,a!==null&&gr(a)===null&&(M=m),m=m.sibling;m=M,m===null?(M=l.child,l.child=null):(M=m.sibling,m.sibling=null),Ql(l,!1,M,m,C,x);break;case"backwards":case"unstable_legacy-backwards":for(m=null,M=l.child,l.child=null;M!==null;){if(a=M.alternate,a!==null&&gr(a)===null){l.child=M;break}a=M.sibling,M.sibling=m,m=M,M=a}Ql(l,!0,m,null,C,x);break;case"together":Ql(l,!1,null,null,void 0,x);break;default:l.memoizedState=null}return l.child}function Ei(a,l,m){if(a!==null&&(l.dependencies=a.dependencies),Fa|=l.lanes,(m&l.childLanes)===0)if(a!==null){if(Ia(a,l,m,!1),(m&l.childLanes)===0)return null}else return null;if(a!==null&&l.child!==a.child)throw Error(i(153));if(l.child!==null){for(a=l.child,m=Gs(a,a.pendingProps),l.child=m,m.return=l;a.sibling!==null;)a=a.sibling,m=m.sibling=Gs(a,a.pendingProps),m.return=l;m.sibling=null}return l.child}function gf(a,l){return(a.lanes&l)!==0?!0:(a=a.dependencies,!!(a!==null&&cd(a)))}function $_(a,l,m){switch(l.tag){case 3:nt(l,l.stateNode.containerInfo),uo(l,Ui,a.memoizedState.cache),Jo();break;case 27:case 5:mt(l);break;case 4:nt(l,l.stateNode.containerInfo);break;case 10:uo(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,vm(l),null;break;case 13:var x=l.memoizedState;if(x!==null)return x.dehydrated!==null?(mo(l),l.flags|=128,null):(m&l.child.childLanes)!==0?Zx(a,l,m):(mo(l),a=Ei(a,l,m),a!==null?a.sibling:null);mo(l);break;case 19:var M=(a.flags&128)!==0;if(x=(m&l.childLanes)!==0,x||(Ia(a,l,m,!1),x=(m&l.childLanes)!==0),M){if(x)return Js(a,l,m);l.flags|=128}if(M=l.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),Ne(Sn,Sn.current),x)break;return null;case 22:return l.lanes=0,Kl(a,l,m,l.pendingProps);case 24:uo(l,Ui,a.memoizedState.cache)}return Ei(a,l,m)}function xf(a,l,m){if(a!==null)if(a.memoizedProps!==l.pendingProps)Li=!0;else{if(!gf(a,m)&&(l.flags&128)===0)return Li=!1,$_(a,l,m);Li=(a.flags&131072)!==0}else Li=!1,wn&&(l.flags&1048576)!==0&&ax(l,Vc,l.index);switch(l.lanes=0,l.tag){case 16:e:{var x=l.pendingProps;if(a=Vl(l.elementType),l.type=a,typeof a=="function")Oh(a)?(x=sl(a,x),l.tag=1,l=ff(null,l,a,x,m)):(l.tag=0,l=eu(null,l,a,x,m));else{if(a!=null){var M=a.$$typeof;if(M===U){l.tag=11,l=$m(null,l,a,x,m);break e}else if(M===z){l.tag=14,l=Jl(null,l,a,x,m);break e}}throw l=ce(a)||a,Error(i(306,l,""))}}return l;case 0:return eu(a,l,l.type,l.pendingProps,m);case 1:return x=l.type,M=sl(x,l.pendingProps),ff(a,l,x,M,m);case 3:e:{if(nt(l,l.stateNode.containerInfo),a===null)throw Error(i(387));x=l.pendingProps;var C=l.memoizedState;M=C.element,mm(a,l),Xc(l,x,null,m);var O=l.memoizedState;if(x=O.cache,uo(l,Ui,x),x!==C.cache&&Gh(l,[Ui],m,!0),pd(),x=O.element,C.isDehydrated)if(C={element:x,isDehydrated:!1,cache:O.cache},l.updateQueue.baseState=C,l.memoizedState=C,l.flags&256){l=Kx(a,l,x,m);break e}else if(x!==M){M=fr(Error(i(424)),l),Ca(M),l=Kx(a,l,x,m);break e}else for(a=l.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,Jn=Ha(a.firstChild),yi=l,wn=!0,co=null,pr=!0,m=Jh(l,null,x,m),l.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Jo(),x===M){l=Ei(a,l,m);break e}ts(a,l,x,m)}l=l.child}return l;case 26:return Zl(a,l),a===null?(m=vE(l.type,null,l.pendingProps,null))?l.memoizedState=m:wn||(m=l.type,a=l.pendingProps,x=iv(ge.current).createElement(m),x[ui]=l,x[Vi]=a,Os(x,m,a),G(x),l.stateNode=x):l.memoizedState=vE(l.type,a.memoizedProps,l.pendingProps,a.memoizedState),null;case 27:return mt(l),a===null&&wn&&(x=l.stateNode=mE(l.type,l.pendingProps,ge.current),yi=l,pr=!0,M=Jn,uu(l.type)?(ow=M,Jn=Ha(x.firstChild)):Jn=M),ts(a,l,l.pendingProps.children,m),Zl(a,l),a===null&&(l.flags|=4194304),l.child;case 5:return a===null&&wn&&((M=x=Jn)&&(x=aD(x,l.type,l.pendingProps,pr),x!==null?(l.stateNode=x,yi=l,Jn=Ha(x.firstChild),pr=!1,M=!0):M=!1),M||Na(l)),mt(l),M=l.type,C=l.pendingProps,O=a!==null?a.memoizedProps:null,x=C.children,nw(M,C)?x=null:O!==null&&nw(M,O)&&(l.flags|=32),l.memoizedState!==null&&(M=Qh(a,l,Yl,null,null,m),ag._currentValue=M),Zl(a,l),ts(a,l,x,m),l.child;case 6:return a===null&&wn&&((a=m=Jn)&&(m=oD(m,l.pendingProps,pr),m!==null?(l.stateNode=m,yi=l,Jn=null,a=!0):a=!1),a||Na(l)),null;case 13:return Zx(a,l,m);case 4:return nt(l,l.stateNode.containerInfo),x=l.pendingProps,a===null?l.child=fo(l,null,x,m):ts(a,l,x,m),l.child;case 11:return $m(a,l,l.type,l.pendingProps,m);case 7:return ts(a,l,l.pendingProps,m),l.child;case 8:return ts(a,l,l.pendingProps.children,m),l.child;case 12:return ts(a,l,l.pendingProps.children,m),l.child;case 10:return x=l.pendingProps,uo(l,l.type,x.value),ts(a,l,x.children,m),l.child;case 9:return M=l.type._context,x=l.pendingProps.children,Zo(l),M=Gt(M),x=x(M),l.flags|=1,ts(a,l,x,m),l.child;case 14:return Jl(a,l,l.type,l.pendingProps,m);case 15:return uf(a,l,l.type,l.pendingProps,m);case 19:return Js(a,l,m);case 31:return hf(a,l,m);case 22:return Kl(a,l,m,l.pendingProps);case 24:return Zo(l),x=Gt(Ui),a===null?(M=Wh(),M===null&&(M=Yt,C=um(),M.pooledCache=C,C.refCount++,C!==null&&(M.pooledCacheLanes|=m),M=C),l.memoizedState={parent:x,cache:M},fd(l),uo(l,Ui,M)):((a.lanes&m)!==0&&(mm(a,l),Xc(l,null,null,m),pd()),M=a.memoizedState,C=l.memoizedState,M.parent!==x?(M={parent:x,cache:x},l.memoizedState=M,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=M),uo(l,Ui,x)):(x=C.cache,uo(l,Ui,x),x!==M.cache&&Gh(l,[Ui],m,!0))),ts(a,l,l.pendingProps.children,m),l.child;case 29:throw l.pendingProps}throw Error(i(156,l.tag))}function Ua(a){a.flags|=4}function wd(a,l,m,x,M){if((l=(a.mode&32)!==0)&&(l=!1),l){if(a.flags|=16777216,(M&335544128)===M)if(a.stateNode.complete)a.flags|=8192;else if(gi())a.flags|=8192;else throw Da=$h,dd}else a.flags&=-16777217}function Jm(a,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!SE(l))if(gi())a.flags|=8192;else throw Da=$h,dd}function xo(a,l){l!==null&&(a.flags|=4),a.flags&16384&&(l=a.tag!==22?Tn():536870912,a.lanes|=l,ni|=l)}function La(a,l){if(!wn)switch(a.tailMode){case"hidden":l=a.tail;for(var m=null;l!==null;)l.alternate!==null&&(m=l),l=l.sibling;m===null?a.tail=null:m.sibling=null;break;case"collapsed":m=a.tail;for(var x=null;m!==null;)m.alternate!==null&&(x=m),m=m.sibling;x===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:x.sibling=null}}function Wn(a){var l=a.alternate!==null&&a.alternate.child===a.child,m=0,x=0;if(l)for(var M=a.child;M!==null;)m|=M.lanes|M.childLanes,x|=M.subtreeFlags&65011712,x|=M.flags&65011712,M.return=a,M=M.sibling;else for(M=a.child;M!==null;)m|=M.lanes|M.childLanes,x|=M.subtreeFlags,x|=M.flags,M.return=a,M=M.sibling;return a.subtreeFlags|=x,a.childLanes=m,l}function Sd(a,l,m){var x=l.pendingProps;switch(Fh(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wn(l),null;case 1:return Wn(l),null;case 3:return m=l.stateNode,x=null,a!==null&&(x=a.memoizedState.cache),l.memoizedState.cache!==x&&(l.flags|=2048),ka(Ui),rt(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(a===null||a.child===null)&&(Gc(l)?Ua(l):a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Vh())),Wn(l),null;case 26:var M=l.type,C=l.memoizedState;return a===null?(Ua(l),C!==null?(Wn(l),Jm(l,C)):(Wn(l),wd(l,M,null,x,m))):C?C!==a.memoizedState?(Ua(l),Wn(l),Jm(l,C)):(Wn(l),l.flags&=-16777217):(a=a.memoizedProps,a!==x&&Ua(l),Wn(l),wd(l,M,a,x,m)),null;case 27:if(ln(l),m=ge.current,M=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==x&&Ua(l);else{if(!x){if(l.stateNode===null)throw Error(i(166));return Wn(l),null}a=Fe.current,Gc(l)?ox(l):(a=mE(M,x,m),l.stateNode=a,Ua(l))}return Wn(l),null;case 5:if(ln(l),M=l.type,a!==null&&l.stateNode!=null)a.memoizedProps!==x&&Ua(l);else{if(!x){if(l.stateNode===null)throw Error(i(166));return Wn(l),null}if(C=Fe.current,Gc(l))ox(l);else{var O=iv(ge.current);switch(C){case 1:C=O.createElementNS("http://www.w3.org/2000/svg",M);break;case 2:C=O.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;default:switch(M){case"svg":C=O.createElementNS("http://www.w3.org/2000/svg",M);break;case"math":C=O.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;case"script":C=O.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof x.is=="string"?O.createElement("select",{is:x.is}):O.createElement("select"),x.multiple?C.multiple=!0:x.size&&(C.size=x.size);break;default:C=typeof x.is=="string"?O.createElement(M,{is:x.is}):O.createElement(M)}}C[ui]=l,C[Vi]=x;e:for(O=l.child;O!==null;){if(O.tag===5||O.tag===6)C.appendChild(O.stateNode);else if(O.tag!==4&&O.tag!==27&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===l)break e;for(;O.sibling===null;){if(O.return===null||O.return===l)break e;O=O.return}O.sibling.return=O.return,O=O.sibling}l.stateNode=C;e:switch(Os(C,M,x),M){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}x&&Ua(l)}}return Wn(l),wd(l,l.type,a===null?null:a.memoizedProps,l.pendingProps,m),null;case 6:if(a&&l.stateNode!=null)a.memoizedProps!==x&&Ua(l);else{if(typeof x!="string"&&l.stateNode===null)throw Error(i(166));if(a=ge.current,Gc(l)){if(a=l.stateNode,m=l.memoizedProps,x=null,M=yi,M!==null)switch(M.tag){case 27:case 5:x=M.memoizedProps}a[ui]=l,a=!!(a.nodeValue===m||x!==null&&x.suppressHydrationWarning===!0||sE(a.nodeValue,m)),a||Na(l,!0)}else a=iv(a).createTextNode(x),a[ui]=l,l.stateNode=a}return Wn(l),null;case 31:if(m=l.memoizedState,a===null||a.memoizedState!==null){if(x=Gc(l),m!==null){if(a===null){if(!x)throw Error(i(318));if(a=l.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(557));a[ui]=l}else Jo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Wn(l),a=!1}else m=Vh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),a=!0;if(!a)return l.flags&256?(Si(l),l):(Si(l),null);if((l.flags&128)!==0)throw Error(i(558))}return Wn(l),null;case 13:if(x=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(M=Gc(l),x!==null&&x.dehydrated!==null){if(a===null){if(!M)throw Error(i(318));if(M=l.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(i(317));M[ui]=l}else Jo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Wn(l),M=!1}else M=Vh(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=M),M=!0;if(!M)return l.flags&256?(Si(l),l):(Si(l),null)}return Si(l),(l.flags&128)!==0?(l.lanes=m,l):(m=x!==null,a=a!==null&&a.memoizedState!==null,m&&(x=l.child,M=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(M=x.alternate.memoizedState.cachePool.pool),C=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(C=x.memoizedState.cachePool.pool),C!==M&&(x.flags|=2048)),m!==a&&m&&(l.child.flags|=8192),xo(l,l.updateQueue),Wn(l),null);case 4:return rt(),a===null&&K_(l.stateNode.containerInfo),Wn(l),null;case 10:return ka(l.type),Wn(l),null;case 19:if(de(Sn),x=l.memoizedState,x===null)return Wn(l),null;if(M=(l.flags&128)!==0,C=x.rendering,C===null)if(M)La(x,!1);else{if(pi!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(C=gr(a),C!==null){for(l.flags|=128,La(x,!1),a=C.updateQueue,l.updateQueue=a,xo(l,a),l.subtreeFlags=0,a=m,m=l.child;m!==null;)jc(m,a),m=m.sibling;return Ne(Sn,Sn.current&1|2),wn&&Ma(l,x.treeForkCount),l.child}a=a.sibling}x.tail!==null&&V()>Mi&&(l.flags|=128,M=!0,La(x,!1),l.lanes=4194304)}else{if(!M)if(a=gr(C),a!==null){if(l.flags|=128,M=!0,a=a.updateQueue,l.updateQueue=a,xo(l,a),La(x,!0),x.tail===null&&x.tailMode==="hidden"&&!C.alternate&&!wn)return Wn(l),null}else 2*V()-x.renderingStartTime>Mi&&m!==536870912&&(l.flags|=128,M=!0,La(x,!1),l.lanes=4194304);x.isBackwards?(C.sibling=l.child,l.child=C):(a=x.last,a!==null?a.sibling=C:l.child=C,x.last=C)}return x.tail!==null?(a=x.tail,x.rendering=a,x.tail=a.sibling,x.renderingStartTime=V(),a.sibling=null,m=Sn.current,Ne(Sn,M?m&1|2:m&1),wn&&Ma(l,x.treeForkCount),a):(Wn(l),null);case 22:case 23:return Si(l),md(),x=l.memoizedState!==null,a!==null?a.memoizedState!==null!==x&&(l.flags|=8192):x&&(l.flags|=8192),x?(m&536870912)!==0&&(l.flags&128)===0&&(Wn(l),l.subtreeFlags&6&&(l.flags|=8192)):Wn(l),m=l.updateQueue,m!==null&&xo(l,m.retryQueue),m=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),x=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(x=l.memoizedState.cachePool.pool),x!==m&&(l.flags|=2048),a!==null&&de(Qo),null;case 24:return m=null,a!==null&&(m=a.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),ka(Ui),Wn(l),null;case 25:return null;case 30:return null}throw Error(i(156,l.tag))}function Fr(a,l){switch(Fh(l),l.tag){case 1:return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return ka(Ui),rt(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 26:case 27:case 5:return ln(l),null;case 31:if(l.memoizedState!==null){if(Si(l),l.alternate===null)throw Error(i(340));Jo()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 13:if(Si(l),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(i(340));Jo()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return de(Sn),null;case 4:return rt(),null;case 10:return ka(l.type),null;case 22:case 23:return Si(l),md(),a!==null&&de(Qo),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 24:return ka(Ui),null;case 25:return null;default:return null}}function xr(a,l){switch(Fh(l),l.tag){case 3:ka(Ui),rt();break;case 26:case 27:case 5:ln(l);break;case 4:rt();break;case 31:l.memoizedState!==null&&Si(l);break;case 13:Si(l);break;case 19:de(Sn);break;case 10:ka(l.type);break;case 22:case 23:Si(l),md(),a!==null&&de(Qo);break;case 24:ka(Ui)}}function Br(a,l){try{var m=l.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var M=x.next;m=M;do{if((m.tag&a)===a){x=void 0;var C=m.create,O=m.inst;x=C(),O.destroy=x}m=m.next}while(m!==M)}}catch(q){Dn(l,l.return,q)}}function us(a,l,m){try{var x=l.updateQueue,M=x!==null?x.lastEffect:null;if(M!==null){var C=M.next;x=C;do{if((x.tag&a)===a){var O=x.inst,q=O.destroy;if(q!==void 0){O.destroy=void 0,M=l;var ne=m,ve=q;try{ve()}catch(ke){Dn(M,ne,ke)}}}x=x.next}while(x!==C)}}catch(ke){Dn(l,l.return,ke)}}function oa(a){var l=a.updateQueue;if(l!==null){var m=a.stateNode;try{hx(l,m)}catch(x){Dn(a,a.return,x)}}}function ns(a,l,m){m.props=sl(a.type,a.memoizedProps),m.state=a.memoizedState;try{m.componentWillUnmount()}catch(x){Dn(a,l,x)}}function vo(a,l){try{var m=a.ref;if(m!==null){switch(a.tag){case 26:case 27:case 5:var x=a.stateNode;break;case 30:x=a.stateNode;break;default:x=a.stateNode}typeof m=="function"?a.refCleanup=m(x):m.current=x}}catch(M){Dn(a,l,M)}}function ds(a,l){var m=a.ref,x=a.refCleanup;if(m!==null)if(typeof x=="function")try{x()}catch(M){Dn(a,l,M)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(M){Dn(a,l,M)}else m.current=null}function Td(a){var l=a.type,m=a.memoizedProps,x=a.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":m.autoFocus&&x.focus();break e;case"img":m.src?x.src=m.src:m.srcSet&&(x.srcset=m.srcSet)}}catch(M){Dn(a,a.return,M)}}function Wi(a,l,m){try{var x=a.stateNode;eD(x,a.type,m,l),x[Vi]=l}catch(M){Dn(a,a.return,M)}}function oi(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&uu(a.type)||a.tag===4}function bn(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||oi(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&uu(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Oa(a,l,m){var x=a.tag;if(x===5||x===6)a=a.stateNode,l?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(a,l):(l=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,l.appendChild(a),m=m._reactRootContainer,m!=null||l.onclick!==null||(l.onclick=ro));else if(x!==4&&(x===27&&uu(a.type)&&(m=a.stateNode,l=null),a=a.child,a!==null))for(Oa(a,l,m),a=a.sibling;a!==null;)Oa(a,l,m),a=a.sibling}function Ds(a,l,m){var x=a.tag;if(x===5||x===6)a=a.stateNode,l?m.insertBefore(a,l):m.appendChild(a);else if(x!==4&&(x===27&&uu(a.type)&&(m=a.stateNode),a=a.child,a!==null))for(Ds(a,l,m),a=a.sibling;a!==null;)Ds(a,l,m),a=a.sibling}function vf(a){var l=a.stateNode,m=a.memoizedProps;try{for(var x=a.type,M=l.attributes;M.length;)l.removeAttributeNode(M[0]);Os(l,x,m),l[ui]=a,l[Vi]=m}catch(C){Dn(a,a.return,C)}}var Vr=!1,Kn=!1,la=!1,ev=typeof WeakSet=="function"?WeakSet:Set,is=null;function X_(a,l){if(a=a.containerInfo,ew=uv,a=nx(a),rm(a)){if("selectionStart"in a)var m={start:a.selectionStart,end:a.selectionEnd};else e:{m=(m=a.ownerDocument)&&m.defaultView||window;var x=m.getSelection&&m.getSelection();if(x&&x.rangeCount!==0){m=x.anchorNode;var M=x.anchorOffset,C=x.focusNode;x=x.focusOffset;try{m.nodeType,C.nodeType}catch{m=null;break e}var O=0,q=-1,ne=-1,ve=0,ke=0,je=a,_e=null;t:for(;;){for(var Ae;je!==m||M!==0&&je.nodeType!==3||(q=O+M),je!==C||x!==0&&je.nodeType!==3||(ne=O+x),je.nodeType===3&&(O+=je.nodeValue.length),(Ae=je.firstChild)!==null;)_e=je,je=Ae;for(;;){if(je===a)break t;if(_e===m&&++ve===M&&(q=O),_e===C&&++ke===x&&(ne=O),(Ae=je.nextSibling)!==null)break;je=_e,_e=je.parentNode}je=Ae}m=q===-1||ne===-1?null:{start:q,end:ne}}else m=null}m=m||{start:0,end:0}}else m=null;for(tw={focusedElem:a,selectionRange:m},uv=!1,is=l;is!==null;)if(l=is,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,is=a;else for(;is!==null;){switch(l=is,C=l.alternate,a=l.flags,l.tag){case 0:if((a&4)!==0&&(a=l.updateQueue,a=a!==null?a.events:null,a!==null))for(m=0;m<a.length;m++)M=a[m],M.ref.impl=M.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&C!==null){a=void 0,m=l,M=C.memoizedProps,C=C.memoizedState,x=m.stateNode;try{var At=sl(m.type,M);a=x.getSnapshotBeforeUpdate(At,C),x.__reactInternalSnapshotBeforeUpdate=a}catch(Ht){Dn(m,m.return,Ht)}}break;case 3:if((a&1024)!==0){if(a=l.stateNode.containerInfo,m=a.nodeType,m===9)sw(a);else if(m===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":sw(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(i(163))}if(a=l.sibling,a!==null){a.return=l.return,is=a;break}is=l.return}}function li(a,l,m){var x=m.flags;switch(m.tag){case 0:case 11:case 15:qr(a,m),x&4&&Br(5,m);break;case 1:if(qr(a,m),x&4)if(a=m.stateNode,l===null)try{a.componentDidMount()}catch(O){Dn(m,m.return,O)}else{var M=sl(m.type,l.memoizedProps);l=l.memoizedState;try{a.componentDidUpdate(M,l,a.__reactInternalSnapshotBeforeUpdate)}catch(O){Dn(m,m.return,O)}}x&64&&oa(m),x&512&&vo(m,m.return);break;case 3:if(qr(a,m),x&64&&(a=m.updateQueue,a!==null)){if(l=null,m.child!==null)switch(m.child.tag){case 27:case 5:l=m.child.stateNode;break;case 1:l=m.child.stateNode}try{hx(a,l)}catch(O){Dn(m,m.return,O)}}break;case 27:l===null&&x&4&&vf(m);case 26:case 5:qr(a,m),l===null&&x&4&&Td(m),x&512&&vo(m,m.return);break;case 12:qr(a,m);break;case 31:qr(a,m),x&4&&rl(a,m);break;case 13:qr(a,m),x&4&&tu(a,m),x&64&&(a=m.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(m=b.bind(null,m),lD(a,m))));break;case 22:if(x=m.memoizedState!==null||Vr,!x){l=l!==null&&l.memoizedState!==null||Kn,M=Vr;var C=Kn;Vr=x,(Kn=l)&&!C?Ps(a,m,(m.subtreeFlags&8772)!==0):qr(a,m),Vr=M,Kn=C}break;case 30:break;default:qr(a,m)}}function Ed(a){var l=a.alternate;l!==null&&(a.alternate=null,Ed(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&no(l)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Bn=null,bs=!1;function Hr(a,l,m){for(m=m.child;m!==null;)yf(a,l,m),m=m.sibling}function yf(a,l,m){if(Ye&&typeof Ye.onCommitFiberUnmount=="function")try{Ye.onCommitFiberUnmount(He,m)}catch{}switch(m.tag){case 26:Kn||ds(m,l),Hr(a,l,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Kn||ds(m,l);var x=Bn,M=bs;uu(m.type)&&(Bn=m.stateNode,bs=!1),Hr(a,l,m),ig(m.stateNode),Bn=x,bs=M;break;case 5:Kn||ds(m,l);case 6:if(x=Bn,M=bs,Bn=null,Hr(a,l,m),Bn=x,bs=M,Bn!==null)if(bs)try{(Bn.nodeType===9?Bn.body:Bn.nodeName==="HTML"?Bn.ownerDocument.body:Bn).removeChild(m.stateNode)}catch(C){Dn(m,l,C)}else try{Bn.removeChild(m.stateNode)}catch(C){Dn(m,l,C)}break;case 18:Bn!==null&&(bs?(a=Bn,uE(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,m.stateNode),Af(a)):uE(Bn,m.stateNode));break;case 4:x=Bn,M=bs,Bn=m.stateNode.containerInfo,bs=!0,Hr(a,l,m),Bn=x,bs=M;break;case 0:case 11:case 14:case 15:us(2,m,l),Kn||us(4,m,l),Hr(a,l,m);break;case 1:Kn||(ds(m,l),x=m.stateNode,typeof x.componentWillUnmount=="function"&&ns(m,l,x)),Hr(a,l,m);break;case 21:Hr(a,l,m);break;case 22:Kn=(x=Kn)||m.memoizedState!==null,Hr(a,l,m),Kn=x;break;default:Hr(a,l,m)}}function rl(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Af(a)}catch(m){Dn(l,l.return,m)}}}function tu(a,l){if(l.memoizedState===null&&(a=l.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Af(a)}catch(m){Dn(l,l.return,m)}}function Km(a){switch(a.tag){case 31:case 13:case 19:var l=a.stateNode;return l===null&&(l=a.stateNode=new ev),l;case 22:return a=a.stateNode,l=a._retryCache,l===null&&(l=a._retryCache=new ev),l;default:throw Error(i(435,a.tag))}}function yo(a,l){var m=Km(a);l.forEach(function(x){if(!m.has(x)){m.add(x);var M=T.bind(null,a,x);x.then(M,M)}})}function $i(a,l){var m=l.deletions;if(m!==null)for(var x=0;x<m.length;x++){var M=m[x],C=a,O=l,q=O;e:for(;q!==null;){switch(q.tag){case 27:if(uu(q.type)){Bn=q.stateNode,bs=!1;break e}break;case 5:Bn=q.stateNode,bs=!1;break e;case 3:case 4:Bn=q.stateNode.containerInfo,bs=!0;break e}q=q.return}if(Bn===null)throw Error(i(160));yf(C,O,M),Bn=null,bs=!1,C=M.alternate,C!==null&&(C.return=null),M.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)al(l,a),l=l.sibling}var Gr=null;function al(a,l){var m=a.alternate,x=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:$i(l,a),Xi(a),x&4&&(us(3,a,a.return),Br(3,a),us(5,a,a.return));break;case 1:$i(l,a),Xi(a),x&512&&(Kn||m===null||ds(m,m.return)),x&64&&Vr&&(a=a.updateQueue,a!==null&&(x=a.callbacks,x!==null&&(m=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=m===null?x:m.concat(x))));break;case 26:var M=Gr;if($i(l,a),Xi(a),x&512&&(Kn||m===null||ds(m,m.return)),x&4){var C=m!==null?m.memoizedState:null;if(x=a.memoizedState,m===null)if(x===null)if(a.stateNode===null){e:{x=a.type,m=a.memoizedProps,M=M.ownerDocument||M;t:switch(x){case"title":C=M.getElementsByTagName("title")[0],(!C||C[sa]||C[ui]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=M.createElement(x),M.head.insertBefore(C,M.querySelector("head > title"))),Os(C,x,m),C[ui]=a,G(C),x=C;break e;case"link":var O=_E("link","href",M).get(x+(m.href||""));if(O){for(var q=0;q<O.length;q++)if(C=O[q],C.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&C.getAttribute("rel")===(m.rel==null?null:m.rel)&&C.getAttribute("title")===(m.title==null?null:m.title)&&C.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){O.splice(q,1);break t}}C=M.createElement(x),Os(C,x,m),M.head.appendChild(C);break;case"meta":if(O=_E("meta","content",M).get(x+(m.content||""))){for(q=0;q<O.length;q++)if(C=O[q],C.getAttribute("content")===(m.content==null?null:""+m.content)&&C.getAttribute("name")===(m.name==null?null:m.name)&&C.getAttribute("property")===(m.property==null?null:m.property)&&C.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&C.getAttribute("charset")===(m.charSet==null?null:m.charSet)){O.splice(q,1);break t}}C=M.createElement(x),Os(C,x,m),M.head.appendChild(C);break;default:throw Error(i(468,x))}C[ui]=a,G(C),x=C}a.stateNode=x}else wE(M,a.type,a.stateNode);else a.stateNode=bE(M,x,a.memoizedProps);else C!==x?(C===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):C.count--,x===null?wE(M,a.type,a.stateNode):bE(M,x,a.memoizedProps)):x===null&&a.stateNode!==null&&Wi(a,a.memoizedProps,m.memoizedProps)}break;case 27:$i(l,a),Xi(a),x&512&&(Kn||m===null||ds(m,m.return)),m!==null&&x&4&&Wi(a,a.memoizedProps,m.memoizedProps);break;case 5:if($i(l,a),Xi(a),x&512&&(Kn||m===null||ds(m,m.return)),a.flags&32){M=a.stateNode;try{Pi(M,"")}catch(At){Dn(a,a.return,At)}}x&4&&a.stateNode!=null&&(M=a.memoizedProps,Wi(a,M,m!==null?m.memoizedProps:M)),x&1024&&(la=!0);break;case 6:if($i(l,a),Xi(a),x&4){if(a.stateNode===null)throw Error(i(162));x=a.memoizedProps,m=a.stateNode;try{m.nodeValue=x}catch(At){Dn(a,a.return,At)}}break;case 3:if(av=null,M=Gr,Gr=sv(l.containerInfo),$i(l,a),Gr=M,Xi(a),x&4&&m!==null&&m.memoizedState.isDehydrated)try{Af(l.containerInfo)}catch(At){Dn(a,a.return,At)}la&&(la=!1,bf(a));break;case 4:x=Gr,Gr=sv(a.stateNode.containerInfo),$i(l,a),Xi(a),Gr=x;break;case 12:$i(l,a),Xi(a);break;case 31:$i(l,a),Xi(a),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,yo(a,x)));break;case 13:$i(l,a),Xi(a),a.child.flags&8192&&a.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(nu=V()),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,yo(a,x)));break;case 22:M=a.memoizedState!==null;var ne=m!==null&&m.memoizedState!==null,ve=Vr,ke=Kn;if(Vr=ve||M,Kn=ke||ne,$i(l,a),Kn=ke,Vr=ve,Xi(a),x&8192)e:for(l=a.stateNode,l._visibility=M?l._visibility&-2:l._visibility|1,M&&(m===null||ne||Vr||Kn||za(a)),m=null,l=a;;){if(l.tag===5||l.tag===26){if(m===null){ne=m=l;try{if(C=ne.stateNode,M)O=C.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{q=ne.stateNode;var je=ne.memoizedProps.style,_e=je!=null&&je.hasOwnProperty("display")?je.display:null;q.style.display=_e==null||typeof _e=="boolean"?"":(""+_e).trim()}}catch(At){Dn(ne,ne.return,At)}}}else if(l.tag===6){if(m===null){ne=l;try{ne.stateNode.nodeValue=M?"":ne.memoizedProps}catch(At){Dn(ne,ne.return,At)}}}else if(l.tag===18){if(m===null){ne=l;try{var Ae=ne.stateNode;M?dE(Ae,!0):dE(ne.stateNode,!1)}catch(At){Dn(ne,ne.return,At)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===a)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;m===l&&(m=null),l=l.return}m===l&&(m=null),l.sibling.return=l.return,l=l.sibling}x&4&&(x=a.updateQueue,x!==null&&(m=x.retryQueue,m!==null&&(x.retryQueue=null,yo(a,m))));break;case 19:$i(l,a),Xi(a),x&4&&(x=a.updateQueue,x!==null&&(a.updateQueue=null,yo(a,x)));break;case 30:break;case 21:break;default:$i(l,a),Xi(a)}}function Xi(a){var l=a.flags;if(l&2){try{for(var m,x=a.return;x!==null;){if(oi(x)){m=x;break}x=x.return}if(m==null)throw Error(i(160));switch(m.tag){case 27:var M=m.stateNode,C=bn(a);Ds(a,C,M);break;case 5:var O=m.stateNode;m.flags&32&&(Pi(O,""),m.flags&=-33);var q=bn(a);Ds(a,q,O);break;case 3:case 4:var ne=m.stateNode.containerInfo,ve=bn(a);Oa(a,ve,ne);break;default:throw Error(i(161))}}catch(ke){Dn(a,a.return,ke)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function bf(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var l=a;bf(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),a=a.sibling}}function qr(a,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)li(a,l.alternate,l),l=l.sibling}function za(a){for(a=a.child;a!==null;){var l=a;switch(l.tag){case 0:case 11:case 14:case 15:us(4,l,l.return),za(l);break;case 1:ds(l,l.return);var m=l.stateNode;typeof m.componentWillUnmount=="function"&&ns(l,l.return,m),za(l);break;case 27:ig(l.stateNode);case 26:case 5:ds(l,l.return),za(l);break;case 22:l.memoizedState===null&&za(l);break;case 30:za(l);break;default:za(l)}a=a.sibling}}function Ps(a,l,m){for(m=m&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var x=l.alternate,M=a,C=l,O=C.flags;switch(C.tag){case 0:case 11:case 15:Ps(M,C,m),Br(4,C);break;case 1:if(Ps(M,C,m),x=C,M=x.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(ve){Dn(x,x.return,ve)}if(x=C,M=x.updateQueue,M!==null){var q=x.stateNode;try{var ne=M.shared.hiddenCallbacks;if(ne!==null)for(M.shared.hiddenCallbacks=null,M=0;M<ne.length;M++)Yc(ne[M],q)}catch(ve){Dn(x,x.return,ve)}}m&&O&64&&oa(C),vo(C,C.return);break;case 27:vf(C);case 26:case 5:Ps(M,C,m),m&&x===null&&O&4&&Td(C),vo(C,C.return);break;case 12:Ps(M,C,m);break;case 31:Ps(M,C,m),m&&O&4&&rl(M,C);break;case 13:Ps(M,C,m),m&&O&4&&tu(M,C);break;case 22:C.memoizedState===null&&Ps(M,C,m),vo(C,C.return);break;case 30:break;default:Ps(M,C,m)}l=l.sibling}}function ol(a,l){var m=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(m=a.memoizedState.cachePool.pool),a=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(a=l.memoizedState.cachePool.pool),a!==m&&(a!=null&&a.refCount++,m!=null&&Fl(m))}function ec(a,l){a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&Fl(a))}function hs(a,l,m,x){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Zm(a,l,m,x),l=l.sibling}function Zm(a,l,m,x){var M=l.flags;switch(l.tag){case 0:case 11:case 15:hs(a,l,m,x),M&2048&&Br(9,l);break;case 1:hs(a,l,m,x);break;case 3:hs(a,l,m,x),M&2048&&(a=null,l.alternate!==null&&(a=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==a&&(l.refCount++,a!=null&&Fl(a)));break;case 12:if(M&2048){hs(a,l,m,x),a=l.stateNode;try{var C=l.memoizedProps,O=C.id,q=C.onPostCommit;typeof q=="function"&&q(O,l.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ne){Dn(l,l.return,ne)}}else hs(a,l,m,x);break;case 31:hs(a,l,m,x);break;case 13:hs(a,l,m,x);break;case 23:break;case 22:C=l.stateNode,O=l.alternate,l.memoizedState!==null?C._visibility&2?hs(a,l,m,x):ja(a,l):C._visibility&2?hs(a,l,m,x):(C._visibility|=2,fs(a,l,m,x,(l.subtreeFlags&10256)!==0||!1)),M&2048&&ol(O,l);break;case 24:hs(a,l,m,x),M&2048&&ec(l.alternate,l);break;default:hs(a,l,m,x)}}function fs(a,l,m,x,M){for(M=M&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var C=a,O=l,q=m,ne=x,ve=O.flags;switch(O.tag){case 0:case 11:case 15:fs(C,O,q,ne,M),Br(8,O);break;case 23:break;case 22:var ke=O.stateNode;O.memoizedState!==null?ke._visibility&2?fs(C,O,q,ne,M):ja(C,O):(ke._visibility|=2,fs(C,O,q,ne,M)),M&&ve&2048&&ol(O.alternate,O);break;case 24:fs(C,O,q,ne,M),M&&ve&2048&&ec(O.alternate,O);break;default:fs(C,O,q,ne,M)}l=l.sibling}}function ja(a,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var m=a,x=l,M=x.flags;switch(x.tag){case 22:ja(m,x),M&2048&&ol(x.alternate,x);break;case 24:ja(m,x),M&2048&&ec(x.alternate,x);break;default:ja(m,x)}l=l.sibling}}var tc=8192;function vr(a,l,m){if(a.subtreeFlags&tc)for(a=a.child;a!==null;)_f(a,l,m),a=a.sibling}function _f(a,l,m){switch(a.tag){case 26:vr(a,l,m),a.flags&tc&&a.memoizedState!==null&&bD(m,Gr,a.memoizedState,a.memoizedProps);break;case 5:vr(a,l,m);break;case 3:case 4:var x=Gr;Gr=sv(a.stateNode.containerInfo),vr(a,l,m),Gr=x;break;case 22:a.memoizedState===null&&(x=a.alternate,x!==null&&x.memoizedState!==null?(x=tc,tc=16777216,vr(a,l,m),tc=x):vr(a,l,m));break;default:vr(a,l,m)}}function nc(a){var l=a.alternate;if(l!==null&&(a=l.child,a!==null)){l.child=null;do l=a.sibling,a.sibling=null,a=l;while(a!==null)}}function ll(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var m=0;m<l.length;m++){var x=l[m];is=x,bi(x,a)}nc(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Ks(a),a=a.sibling}function Ks(a){switch(a.tag){case 0:case 11:case 15:ll(a),a.flags&2048&&us(9,a,a.return);break;case 3:ll(a);break;case 12:ll(a);break;case 22:var l=a.stateNode;a.memoizedState!==null&&l._visibility&2&&(a.return===null||a.return.tag!==13)?(l._visibility&=-3,Zs(a)):ll(a);break;default:ll(a)}}function Zs(a){var l=a.deletions;if((a.flags&16)!==0){if(l!==null)for(var m=0;m<l.length;m++){var x=l[m];is=x,bi(x,a)}nc(a)}for(a=a.child;a!==null;){switch(l=a,l.tag){case 0:case 11:case 15:us(8,l,l.return),Zs(l);break;case 22:m=l.stateNode,m._visibility&2&&(m._visibility&=-3,Zs(l));break;default:Zs(l)}a=a.sibling}}function bi(a,l){for(;is!==null;){var m=is;switch(m.tag){case 0:case 11:case 15:us(8,m,l);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var x=m.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Fl(m.memoizedState.cache)}if(x=m.child,x!==null)x.return=m,is=x;else e:for(m=a;is!==null;){x=is;var M=x.sibling,C=x.return;if(Ed(x),x===m){is=null;break e}if(M!==null){M.return=C,is=M;break e}is=C}}}var bo={getCacheForType:function(a){var l=Gt(Ui),m=l.data.get(a);return m===void 0&&(m=a(),l.data.set(a,m)),m},cacheSignal:function(){return Gt(Ui).controller.signal}},tn=typeof WeakMap=="function"?WeakMap:Map,kt=0,Yt=null,un=null,an=0,En=0,_s=null,Wr=!1,ca=!1,Qm=!1,yr=0,pi=0,Fa=0,cl=0,Md=0,Us=0,ni=0,ic=null,_i=null,wi=!1,nu=0,eg=0,Mi=1/0,mi=null,Ai=null,Vn=0,br=null,iu=null,$r=0,su=0,ru=null,Ad=null,ul=0,sc=null;function _r(){return(kt&2)!==0&&an!==0?an&-an:J.T!==null?Se():Rl()}function gn(){if(Us===0)if((an&536870912)===0||wn){var a=Xe;Xe<<=1,(Xe&3932160)===0&&(Xe=262144),Us=a}else Us=536870912;return a=$s.current,a!==null&&(a.flags|=32),Us}function dn(a,l,m){(a===Yt&&(En===2||En===9)||a.cancelPendingCommit!==null)&&(hl(a,0),Oi(a,an,Us,!1)),ls(a,m),((kt&2)===0||a!==Yt)&&(a===Yt&&((kt&2)===0&&(cl|=m),pi===4&&Oi(a,an,Us,!1)),We(a))}function xn(a,l,m){if((kt&6)!==0)throw Error(i(327));var x=!m&&(l&127)===0&&(l&a.expiredLanes)===0||et(a,l),M=x?Nd(a,l):Ls(a,l,!0),C=x;do{if(M===0){ca&&!x&&Oi(a,l,0,!1);break}else{if(m=a.current.alternate,C&&!Hn(m)){M=Ls(a,l,!1),C=!1;continue}if(M===2){if(C=l,a.errorRecoveryDisabledLanes&C)var O=0;else O=a.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){l=O;e:{var q=a;M=ic;var ne=q.current.memoizedState.isDehydrated;if(ne&&(hl(q,O).flags|=256),O=Ls(q,O,!1),O!==2){if(Qm&&!ne){q.errorRecoveryDisabledLanes|=C,cl|=C,M=4;break e}C=_i,_i=M,C!==null&&(_i===null?_i=C:_i.push.apply(_i,C))}M=O}if(C=!1,M!==2)continue}}if(M===1){hl(a,0),Oi(a,l,0,!0);break}e:{switch(x=a,C=M,C){case 0:case 1:throw Error(i(345));case 4:if((l&4194048)!==l)break;case 6:Oi(x,l,Us,!Wr);break e;case 2:_i=null;break;case 3:case 5:break;default:throw Error(i(329))}if((l&62914560)===l&&(M=nu+300-V(),10<M)){if(Oi(x,l,Us,!Wr),Le(x,0,!0)!==0)break e;$r=l,x.timeoutHandle=lE(_n.bind(null,x,m,_i,mi,wi,l,Us,cl,ni,Wr,C,"Throttled",-0,0),M);break e}_n(x,m,_i,mi,wi,l,Us,cl,ni,Wr,C,null,-0,0)}}break}while(!0);We(a)}function _n(a,l,m,x,M,C,O,q,ne,ve,ke,je,_e,Ae){if(a.timeoutHandle=-1,je=l.subtreeFlags,je&8192||(je&16785408)===16785408){je={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ro},_f(l,C,je);var At=(C&62914560)===C?nu-V():(C&4194048)===C?eg-V():0;if(At=_D(je,At),At!==null){$r=C,a.cancelPendingCommit=At(wo.bind(null,a,l,C,m,x,M,O,q,ne,ke,je,null,_e,Ae)),Oi(a,C,O,!ve);return}}wo(a,l,C,m,x,M,O,q,ne)}function Hn(a){for(var l=a;;){var m=l.tag;if((m===0||m===11||m===15)&&l.flags&16384&&(m=l.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var x=0;x<m.length;x++){var M=m[x],C=M.getSnapshot;M=M.value;try{if(!Cs(C(),M))return!1}catch{return!1}}if(m=l.child,l.subtreeFlags&16384&&m!==null)m.return=l,l=m;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Oi(a,l,m,x){l&=~Md,l&=~cl,a.suspendedLanes|=l,a.pingedLanes&=~l,x&&(a.warmLanes|=l),x=a.expirationTimes;for(var M=l;0<M;){var C=31-pt(M),O=1<<C;x[C]=-1,M&=~O}m!==0&&Oo(a,m,l)}function ua(){return(kt&6)===0?(yt(0),!1):!0}function dl(){if(un!==null){if(En===0)var a=un.return;else a=un,Ra=Ko=null,Sm(a),ql=null,Wl=0,a=un;for(;a!==null;)xr(a.alternate,a),a=a.return;un=null}}function hl(a,l){var m=a.timeoutHandle;m!==-1&&(a.timeoutHandle=-1,iD(m)),m=a.cancelPendingCommit,m!==null&&(a.cancelPendingCommit=null,m()),$r=0,dl(),Yt=a,un=m=Gs(a.current,null),an=l,En=0,_s=null,Wr=!1,ca=et(a,l),Qm=!1,ni=Us=Md=cl=Fa=pi=0,_i=ic=null,wi=!1,(l&8)!==0&&(l|=l&32);var x=a.entangledLanes;if(x!==0)for(a=a.entanglements,x&=l;0<x;){var M=31-pt(x),C=1<<M;l|=a[M],x&=~C}return yr=l,od(),m}function Ba(a,l){en=null,J.H=Qc,l===Bl||l===cn?(l=Hl(),En=3):l===dd?(l=Hl(),En=4):En=l===cf?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,_s=l,un===null&&(pi=1,lf(a,fr(l,a.current)))}function gi(){var a=$s.current;return a===null?!0:(an&4194048)===an?Is===null:(an&62914560)===an||(an&536870912)!==0?a===Is:!1}function _o(){var a=J.H;return J.H=Qc,a===null?Qc:a}function fl(){var a=J.A;return J.A=bo,a}function au(){pi=4,Wr||(an&4194048)!==an&&$s.current!==null||(ca=!0),(Fa&134217727)===0&&(cl&134217727)===0||Yt===null||Oi(Yt,an,Us,!1)}function Ls(a,l,m){var x=kt;kt|=2;var M=_o(),C=fl();(Yt!==a||an!==l)&&(mi=null,hl(a,l)),l=!1;var O=pi;e:do try{if(En!==0&&un!==null){var q=un,ne=_s;switch(En){case 8:dl(),O=6;break e;case 3:case 2:case 9:case 6:$s.current===null&&(l=!0);var ve=En;if(En=0,_s=null,rc(a,q,ne,ve),m&&ca){O=0;break e}break;default:ve=En,En=0,_s=null,rc(a,q,ne,ve)}}ou(),O=pi;break}catch(ke){Ba(a,ke)}while(!0);return l&&a.shellSuspendCounter++,Ra=Ko=null,kt=x,J.H=M,J.A=C,un===null&&(Yt=null,an=0,od()),O}function ou(){for(;un!==null;)wf(un)}function Nd(a,l){var m=kt;kt|=2;var x=_o(),M=fl();Yt!==a||an!==l?(mi=null,Mi=V()+500,hl(a,l)):ca=et(a,l);e:do try{if(En!==0&&un!==null){l=un;var C=_s;t:switch(En){case 1:En=0,_s=null,rc(a,l,C,1);break;case 2:case 9:if(Ws(C)){En=0,_s=null,Cd(l);break}l=function(){En!==2&&En!==9||Yt!==a||(En=7),We(a)},C.then(l,l);break e;case 3:En=7;break e;case 4:En=5;break e;case 7:Ws(C)?(En=0,_s=null,Cd(l)):(En=0,_s=null,rc(a,l,C,7));break;case 5:var O=null;switch(un.tag){case 26:O=un.memoizedState;case 5:case 27:var q=un;if(O?SE(O):q.stateNode.complete){En=0,_s=null;var ne=q.sibling;if(ne!==null)un=ne;else{var ve=q.return;ve!==null?(un=ve,pl(ve)):un=null}break t}}En=0,_s=null,rc(a,l,C,5);break;case 6:En=0,_s=null,rc(a,l,C,6);break;case 8:dl(),pi=6;break e;default:throw Error(i(462))}}Qs();break}catch(ke){Ba(a,ke)}while(!0);return Ra=Ko=null,J.H=x,J.A=M,kt=m,un!==null?0:(Yt=null,an=0,od(),pi)}function Qs(){for(;un!==null&&!Je();)wf(un)}function wf(a){var l=xf(a.alternate,a,yr);a.memoizedProps=a.pendingProps,l===null?pl(a):un=l}function Cd(a){var l=a,m=l.alternate;switch(l.tag){case 15:case 0:l=bd(m,l,l.pendingProps,l.type,void 0,an);break;case 11:l=bd(m,l,l.pendingProps,l.type.render,l.ref,an);break;case 5:Sm(l);default:xr(m,l),l=un=jc(l,yr),l=xf(m,l,yr)}a.memoizedProps=a.pendingProps,l===null?pl(a):un=l}function rc(a,l,m,x){Ra=Ko=null,Sm(l),ql=null,Wl=0;var M=l.return;try{if(qi(a,M,l,m,an)){pi=1,lf(a,fr(m,a.current)),un=null;return}}catch(C){if(M!==null)throw un=M,C;pi=1,lf(a,fr(m,a.current)),un=null;return}l.flags&32768?(wn||x===1?a=!0:ca||(an&536870912)!==0?a=!1:(Wr=a=!0,(x===2||x===9||x===3||x===6)&&(x=$s.current,x!==null&&x.tag===13&&(x.flags|=16384))),Rd(l,a)):pl(l)}function pl(a){var l=a;do{if((l.flags&32768)!==0){Rd(l,Wr);return}a=l.return;var m=Sd(l.alternate,l,yr);if(m!==null){un=m;return}if(l=l.sibling,l!==null){un=l;return}un=l=a}while(l!==null);pi===0&&(pi=5)}function Rd(a,l){do{var m=Fr(a.alternate,a);if(m!==null){m.flags&=32767,un=m;return}if(m=a.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!l&&(a=a.sibling,a!==null)){un=a;return}un=a=m}while(a!==null);pi=6,un=null}function wo(a,l,m,x,M,C,O,q,ne){a.cancelPendingCommit=null;do lu();while(Vn!==0);if((kt&6)!==0)throw Error(i(327));if(l!==null){if(l===a.current)throw Error(i(177));if(C=l.lanes|l.childLanes,C|=Qi,Hs(a,m,C,O,q,ne),a===Yt&&(un=Yt=null,an=0),iu=l,br=a,$r=m,su=C,ru=M,Ad=x,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,k(Me,function(){return Sf(),null})):(a.callbackNode=null,a.callbackPriority=0),x=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||x){x=J.T,J.T=null,M=te.p,te.p=2,O=kt,kt|=4;try{X_(a,l,m)}finally{kt=O,te.p=M,J.T=x}}Vn=1,zi(),So(),ac()}}function zi(){if(Vn===1){Vn=0;var a=br,l=iu,m=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||m){m=J.T,J.T=null;var x=te.p;te.p=2;var M=kt;kt|=4;try{al(l,a);var C=tw,O=nx(a.containerInfo),q=C.focusedElem,ne=C.selectionRange;if(O!==q&&q&&q.ownerDocument&&Yn(q.ownerDocument.documentElement,q)){if(ne!==null&&rm(q)){var ve=ne.start,ke=ne.end;if(ke===void 0&&(ke=ve),"selectionStart"in q)q.selectionStart=ve,q.selectionEnd=Math.min(ke,q.value.length);else{var je=q.ownerDocument||document,_e=je&&je.defaultView||window;if(_e.getSelection){var Ae=_e.getSelection(),At=q.textContent.length,Ht=Math.min(ne.start,At),Qn=ne.end===void 0?Ht:Math.min(ne.end,At);!Ae.extend&&Ht>Qn&&(O=Qn,Qn=Ht,Ht=O);var he=Lc(q,Ht),se=Lc(q,Qn);if(he&&se&&(Ae.rangeCount!==1||Ae.anchorNode!==he.node||Ae.anchorOffset!==he.offset||Ae.focusNode!==se.node||Ae.focusOffset!==se.offset)){var xe=je.createRange();xe.setStart(he.node,he.offset),Ae.removeAllRanges(),Ht>Qn?(Ae.addRange(xe),Ae.extend(se.node,se.offset)):(xe.setEnd(se.node,se.offset),Ae.addRange(xe))}}}}for(je=[],Ae=q;Ae=Ae.parentNode;)Ae.nodeType===1&&je.push({element:Ae,left:Ae.scrollLeft,top:Ae.scrollTop});for(typeof q.focus=="function"&&q.focus(),q=0;q<je.length;q++){var Ue=je[q];Ue.element.scrollLeft=Ue.left,Ue.element.scrollTop=Ue.top}}uv=!!ew,tw=ew=null}finally{kt=M,te.p=x,J.T=m}}a.current=l,Vn=2}}function So(){if(Vn===2){Vn=0;var a=br,l=iu,m=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||m){m=J.T,J.T=null;var x=te.p;te.p=2;var M=kt;kt|=4;try{li(a,l.alternate,l)}finally{kt=M,te.p=x,J.T=m}}Vn=3}}function ac(){if(Vn===4||Vn===3){Vn=0,X();var a=br,l=iu,m=$r,x=Ad;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Vn=5:(Vn=0,iu=br=null,Va(a,a.pendingLanes));var M=a.pendingLanes;if(M===0&&(Ai=null),to(m),l=l.stateNode,Ye&&typeof Ye.onCommitFiberRoot=="function")try{Ye.onCommitFiberRoot(He,l,void 0,(l.current.flags&128)===128)}catch{}if(x!==null){l=J.T,M=te.p,te.p=2,J.T=null;try{for(var C=a.onRecoverableError,O=0;O<x.length;O++){var q=x[O];C(q.value,{componentStack:q.stack})}}finally{J.T=l,te.p=M}}($r&3)!==0&&lu(),We(a),M=a.pendingLanes,(m&261930)!==0&&(M&42)!==0?a===sc?ul++:(ul=0,sc=a):ul=0,yt(0)}}function Va(a,l){(a.pooledCacheLanes&=l)===0&&(l=a.pooledCache,l!=null&&(a.pooledCache=null,Fl(l)))}function lu(){return zi(),So(),ac(),Sf()}function Sf(){if(Vn!==5)return!1;var a=br,l=su;su=0;var m=to($r),x=J.T,M=te.p;try{te.p=32>m?32:m,J.T=null,m=ru,ru=null;var C=br,O=$r;if(Vn=0,iu=br=null,$r=0,(kt&6)!==0)throw Error(i(331));var q=kt;if(kt|=4,Ks(C.current),Zm(C,C.current,O,m),kt=q,yt(0,!1),Ye&&typeof Ye.onPostCommitFiberRoot=="function")try{Ye.onPostCommitFiberRoot(He,C)}catch{}return!0}finally{te.p=M,J.T=x,Va(a,l)}}function tg(a,l,m){l=fr(m,l),l=qm(a.stateNode,l,2),a=el(a,l,2),a!==null&&(ls(a,2),We(a))}function Dn(a,l,m){if(a.tag===3)tg(a,a,m);else for(;l!==null;){if(l.tag===3){tg(l,a,m);break}else if(l.tag===1){var x=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ai===null||!Ai.has(x))){a=fr(m,a),m=Wm(2),x=el(l,m,2),x!==null&&(Yx(m,x,l,a),ls(x,2),We(x));break}}l=l.return}}function kd(a,l,m){var x=a.pingCache;if(x===null){x=a.pingCache=new tn;var M=new Set;x.set(l,M)}else M=x.get(l),M===void 0&&(M=new Set,x.set(l,M));M.has(m)||(Qm=!0,M.add(m),a=u.bind(null,a,l,m),l.then(a,a))}function u(a,l,m){var x=a.pingCache;x!==null&&x.delete(l),a.pingedLanes|=a.suspendedLanes&m,a.warmLanes&=~m,Yt===a&&(an&m)===m&&(pi===4||pi===3&&(an&62914560)===an&&300>V()-nu?(kt&2)===0&&hl(a,0):Md|=m,ni===an&&(ni=0)),We(a)}function f(a,l){l===0&&(l=Tn()),a=Rs(a,l),a!==null&&(ls(a,l),We(a))}function b(a){var l=a.memoizedState,m=0;l!==null&&(m=l.retryLane),f(a,m)}function T(a,l){var m=0;switch(a.tag){case 31:case 13:var x=a.stateNode,M=a.memoizedState;M!==null&&(m=M.retryLane);break;case 19:x=a.stateNode;break;case 22:x=a.stateNode._retryCache;break;default:throw Error(i(314))}x!==null&&x.delete(l),f(a,m)}function k(a,l){return ot(a,l)}var P=null,H=null,ie=!1,Te=!1,Ve=!1,tt=0;function We(a){a!==H&&a.next===null&&(H===null?P=H=a:H=H.next=a),Te=!0,ie||(ie=!0,pe())}function yt(a,l){if(!Ve&&Te){Ve=!0;do for(var m=!1,x=P;x!==null;){if(a!==0){var M=x.pendingLanes;if(M===0)var C=0;else{var O=x.suspendedLanes,q=x.pingedLanes;C=(1<<31-pt(42|a)+1)-1,C&=M&~(O&~q),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(m=!0,be(x,C))}else C=an,C=Le(x,x===Yt?C:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(C&3)===0||et(x,C)||(m=!0,be(x,C));x=x.next}while(m);Ve=!1}}function Zt(){Ni()}function Ni(){Te=ie=!1;var a=0;tt!==0&&nD()&&(a=tt);for(var l=V(),m=null,x=P;x!==null;){var M=x.next,C=cu(x,l);C===0?(x.next=null,m===null?P=M:m.next=M,M===null&&(H=m)):(m=x,(a!==0||(C&3)!==0)&&(Te=!0)),x=M}Vn!==0&&Vn!==5||yt(a),tt!==0&&(tt=0)}function cu(a,l){for(var m=a.suspendedLanes,x=a.pingedLanes,M=a.expirationTimes,C=a.pendingLanes&-62914561;0<C;){var O=31-pt(C),q=1<<O,ne=M[O];ne===-1?((q&m)===0||(q&x)!==0)&&(M[O]=$t(q,l)):ne<=l&&(a.expiredLanes|=q),C&=~q}if(l=Yt,m=an,m=Le(a,a===l?m:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),x=a.callbackNode,m===0||a===l&&(En===2||En===9)||a.cancelPendingCommit!==null)return x!==null&&x!==null&&Rt(x),a.callbackNode=null,a.callbackPriority=0;if((m&3)===0||et(a,m)){if(l=m&-m,l===a.callbackPriority)return l;switch(x!==null&&Rt(x),to(m)){case 2:case 8:m=ze;break;case 32:m=Me;break;case 268435456:m=Qe;break;default:m=Me}return x=ml.bind(null,a),m=ot(m,x),a.callbackPriority=l,a.callbackNode=m,l}return x!==null&&x!==null&&Rt(x),a.callbackPriority=2,a.callbackNode=null,2}function ml(a,l){if(Vn!==0&&Vn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var m=a.callbackNode;if(lu()&&a.callbackNode!==m)return null;var x=an;return x=Le(a,a===Yt?x:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),x===0?null:(xn(a,x,l),cu(a,V()),a.callbackNode!=null&&a.callbackNode===m?ml.bind(null,a):null)}function be(a,l){if(lu())return null;xn(a,l,!0)}function pe(){sD(function(){(kt&6)!==0?ot(Ee,Zt):Ni()})}function Se(){if(tt===0){var a=ho;a===0&&(a=ct,ct<<=1,(ct&261888)===0&&(ct=256)),tt=a}return tt}function Ze(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:$u(""+a)}function jt(a,l){var m=l.ownerDocument.createElement("input");return m.name=l.name,m.value=l.value,a.id&&m.setAttribute("form",a.id),l.parentNode.insertBefore(m,l),a=new FormData(a),m.parentNode.removeChild(m),a}function xi(a,l,m,x,M){if(l==="submit"&&m&&m.stateNode===M){var C=Ze((M[Vi]||null).action),O=x.submitter;O&&(l=(l=O[Vi]||null)?Ze(l.formAction):O.getAttribute("formAction"),l!==null&&(C=l,O=null));var q=new Ju("action","action",null,x,M);a.push({event:q,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(tt!==0){var ne=O?jt(M,O):new FormData(M);Om(m,{pending:!0,data:ne,method:M.method,action:C},null,ne)}}else typeof C=="function"&&(q.preventDefault(),ne=O?jt(M,O):new FormData(M),Om(m,{pending:!0,data:ne,method:M.method,action:C},C,ne))},currentTarget:M}]})}}for(var Bt=0;Bt<rd.length;Bt++){var Cn=rd[Bt],ss=Cn.toLowerCase(),Pn=Cn[0].toUpperCase()+Cn.slice(1);Dr(ss,"on"+Pn)}Dr(Uh,"onAnimationEnd"),Dr(sd,"onAnimationIteration"),Dr(om,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(sx,"onTransitionRun"),Dr(F_,"onTransitionStart"),Dr(rx,"onTransitionCancel"),Dr(lm,"onTransitionEnd"),fe("onMouseEnter",["mouseout","mouseover"]),fe("onMouseLeave",["mouseout","mouseover"]),fe("onPointerEnter",["pointerout","pointerover"]),fe("onPointerLeave",["pointerout","pointerover"]),ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xr));function eE(a,l){l=(l&4)!==0;for(var m=0;m<a.length;m++){var x=a[m],M=x.event;x=x.listeners;e:{var C=void 0;if(l)for(var O=x.length-1;0<=O;O--){var q=x[O],ne=q.instance,ve=q.currentTarget;if(q=q.listener,ne!==C&&M.isPropagationStopped())break e;C=q,M.currentTarget=ve;try{C(M)}catch(ke){ad(ke)}M.currentTarget=null,C=ne}else for(O=0;O<x.length;O++){if(q=x[O],ne=q.instance,ve=q.currentTarget,q=q.listener,ne!==C&&M.isPropagationStopped())break e;C=q,M.currentTarget=ve;try{C(M)}catch(ke){ad(ke)}M.currentTarget=null,C=ne}}}}function Mn(a,l){var m=l[ur];m===void 0&&(m=l[ur]=new Set);var x=a+"__bubble";m.has(x)||(tE(l,a,2,!1),m.add(x))}function J_(a,l,m){var x=0;l&&(x|=4),tE(m,a,x,l)}var tv="_reactListening"+Math.random().toString(36).slice(2);function K_(a){if(!a[tv]){a[tv]=!0,le.forEach(function(m){m!=="selectionchange"&&(Y_.has(m)||J_(m,!1,a),J_(m,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[tv]||(l[tv]=!0,J_("selectionchange",!1,l))}}function tE(a,l,m,x){switch(RE(l)){case 2:var M=TD;break;case 8:M=ED;break;default:M=hw}m=M.bind(null,l,m,a),M=void 0,!Hp||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(M=!0),x?M!==void 0?a.addEventListener(l,m,{capture:!0,passive:M}):a.addEventListener(l,m,!0):M!==void 0?a.addEventListener(l,m,{passive:M}):a.addEventListener(l,m,!1)}function Z_(a,l,m,x,M){var C=x;if((l&1)===0&&(l&2)===0&&x!==null)e:for(;;){if(x===null)return;var O=x.tag;if(O===3||O===4){var q=x.stateNode.containerInfo;if(q===M)break;if(O===4)for(O=x.return;O!==null;){var ne=O.tag;if((ne===3||ne===4)&&O.stateNode.containerInfo===M)return;O=O.return}for(;q!==null;){if(O=io(q),O===null)return;if(ne=O.tag,ne===5||ne===6||ne===26||ne===27){x=C=O;continue e}q=q.parentNode}}x=x.return}Vp(function(){var ve=C,ke=wh(m),je=[];e:{var _e=Ir.get(a);if(_e!==void 0){var Ae=Ju,At=a;switch(a){case"keypress":if(Yu(m)===0)break e;case"keydown":case"keyup":Ae=Ul;break;case"focusin":At="focus",Ae=Mh;break;case"focusout":At="blur",Ae=Mh;break;case"beforeblur":case"afterblur":Ae=Mh;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ae=Gp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ae=z0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ae=G0;break;case Uh:case sd:case om:Ae=O_;break;case lm:Ae=j_;break;case"scroll":case"scrollend":Ae=L0;break;case"wheel":Ae=W0;break;case"copy":case"cut":case"paste":Ae=F0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ae=$p;break;case"toggle":case"beforetoggle":Ae=X0}var Ht=(l&4)!==0,Qn=!Ht&&(a==="scroll"||a==="scrollend"),he=Ht?_e!==null?_e+"Capture":null:_e;Ht=[];for(var se=ve,xe;se!==null;){var Ue=se;if(xe=Ue.stateNode,Ue=Ue.tag,Ue!==5&&Ue!==26&&Ue!==27||xe===null||he===null||(Ue=Ac(se,he),Ue!=null&&Ht.push(ng(se,Ue,xe))),Qn)break;se=se.return}0<Ht.length&&(_e=new Ae(_e,At,null,m,ke),je.push({event:_e,listeners:Ht}))}}if((l&7)===0){e:{if(_e=a==="mouseover"||a==="pointerover",Ae=a==="mouseout"||a==="pointerout",_e&&m!==_h&&(At=m.relatedTarget||m.fromElement)&&(io(At)||At[cr]))break e;if((Ae||_e)&&(_e=ke.window===ke?ke:(_e=ke.ownerDocument)?_e.defaultView||_e.parentWindow:window,Ae?(At=m.relatedTarget||m.toElement,Ae=ve,At=At?io(At):null,At!==null&&(Qn=r(At),Ht=At.tag,At!==Qn||Ht!==5&&Ht!==27&&Ht!==6)&&(At=null)):(Ae=null,At=ve),Ae!==At)){if(Ht=Gp,Ue="onMouseLeave",he="onMouseEnter",se="mouse",(a==="pointerout"||a==="pointerover")&&(Ht=$p,Ue="onPointerLeave",he="onPointerEnter",se="pointer"),Qn=Ae==null?_e:Bo(Ae),xe=At==null?_e:Bo(At),_e=new Ht(Ue,se+"leave",Ae,m,ke),_e.target=Qn,_e.relatedTarget=xe,Ue=null,io(ke)===ve&&(Ht=new Ht(he,se+"enter",At,m,ke),Ht.target=xe,Ht.relatedTarget=Qn,Ue=Ht),Qn=Ue,Ae&&At)t:{for(Ht=K3,he=Ae,se=At,xe=0,Ue=he;Ue;Ue=Ht(Ue))xe++;Ue=0;for(var Ot=se;Ot;Ot=Ht(Ot))Ue++;for(;0<xe-Ue;)he=Ht(he),xe--;for(;0<Ue-xe;)se=Ht(se),Ue--;for(;xe--;){if(he===se||se!==null&&he===se.alternate){Ht=he;break t}he=Ht(he),se=Ht(se)}Ht=null}else Ht=null;Ae!==null&&nE(je,_e,Ae,Ht,!1),At!==null&&Qn!==null&&nE(je,Qn,At,Ht,!0)}}e:{if(_e=ve?Bo(ve):window,Ae=_e.nodeName&&_e.nodeName.toLowerCase(),Ae==="select"||Ae==="input"&&_e.type==="file")var zn=em;else if(Qp(_e))if(wa)zn=tx;else{zn=im;var Ct=Q0}else Ae=_e.nodeName,!Ae||Ae.toLowerCase()!=="input"||_e.type!=="checkbox"&&_e.type!=="radio"?ve&&Rr(ve.elementType)&&(zn=em):zn=ex;if(zn&&(zn=zn(a,ve))){Dh(je,zn,m,ke);break e}Ct&&Ct(a,_e,ve),a==="focusout"&&ve&&_e.type==="number"&&ve.memoizedProps.value!=null&&ti(_e,"number",_e.value)}switch(Ct=ve?Bo(ve):window,a){case"focusin":(Qp(Ct)||Ct.contentEditable==="true")&&(Sa=Ct,Ta=ve,Oc=null);break;case"focusout":Oc=Ta=Sa=null;break;case"mousedown":Ph=!0;break;case"contextmenu":case"mouseup":case"dragend":Ph=!1,zc(je,m,ke);break;case"selectionchange":if(ix)break;case"keydown":case"keyup":zc(je,m,ke)}var fn;if(Ll)e:{switch(a){case"compositionstart":var Rn="onCompositionStart";break e;case"compositionend":Rn="onCompositionEnd";break e;case"compositionupdate":Rn="onCompositionUpdate";break e}Rn=void 0}else Ol?Ih(a,m)&&(Rn="onCompositionEnd"):a==="keydown"&&m.keyCode===229&&(Rn="onCompositionStart");Rn&&(Yp&&m.locale!=="ko"&&(Ol||Rn!=="onCompositionStart"?Rn==="onCompositionEnd"&&Ol&&(fn=Xu()):(hr=ke,Th="value"in hr?hr.value:hr.textContent,Ol=!0)),Ct=nv(ve,Rn),0<Ct.length&&(Rn=new Ah(Rn,a,null,m,ke),je.push({event:Rn,listeners:Ct}),fn?Rn.data=fn:(fn=Jp(m),fn!==null&&(Rn.data=fn)))),(fn=kh?K0(a,m):Kp(a,m))&&(Rn=nv(ve,"onBeforeInput"),0<Rn.length&&(Ct=new Ah("onBeforeInput","beforeinput",null,m,ke),je.push({event:Ct,listeners:Rn}),Ct.data=fn)),xi(je,a,ve,m,ke)}eE(je,l)})}function ng(a,l,m){return{instance:a,listener:l,currentTarget:m}}function nv(a,l){for(var m=l+"Capture",x=[];a!==null;){var M=a,C=M.stateNode;if(M=M.tag,M!==5&&M!==26&&M!==27||C===null||(M=Ac(a,m),M!=null&&x.unshift(ng(a,M,C)),M=Ac(a,l),M!=null&&x.push(ng(a,M,C))),a.tag===3)return x;a=a.return}return[]}function K3(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function nE(a,l,m,x,M){for(var C=l._reactName,O=[];m!==null&&m!==x;){var q=m,ne=q.alternate,ve=q.stateNode;if(q=q.tag,ne!==null&&ne===x)break;q!==5&&q!==26&&q!==27||ve===null||(ne=ve,M?(ve=Ac(m,C),ve!=null&&O.unshift(ng(m,ve,ne))):M||(ve=Ac(m,C),ve!=null&&O.push(ng(m,ve,ne)))),m=m.return}O.length!==0&&a.push({event:l,listeners:O})}var Z3=/\r\n?/g,Q3=/\u0000|\uFFFD/g;function iE(a){return(typeof a=="string"?a:""+a).replace(Z3,`
`).replace(Q3,"")}function sE(a,l){return l=iE(l),iE(a)===l}function Zn(a,l,m,x,M,C){switch(m){case"children":typeof x=="string"?l==="body"||l==="textarea"&&x===""||Pi(a,x):(typeof x=="number"||typeof x=="bigint")&&l!=="body"&&Pi(a,""+x);break;case"className":Pt(a,"class",x);break;case"tabIndex":Pt(a,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":Pt(a,m,x);break;case"style":Il(a,x,C);break;case"data":if(l!=="object"){Pt(a,"data",x);break}case"src":case"href":if(x===""&&(l!=="a"||m!=="href")){a.removeAttribute(m);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){a.removeAttribute(m);break}x=$u(""+x),a.setAttribute(m,x);break;case"action":case"formAction":if(typeof x=="function"){a.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(m==="formAction"?(l!=="input"&&Zn(a,l,"name",M.name,M,null),Zn(a,l,"formEncType",M.formEncType,M,null),Zn(a,l,"formMethod",M.formMethod,M,null),Zn(a,l,"formTarget",M.formTarget,M,null)):(Zn(a,l,"encType",M.encType,M,null),Zn(a,l,"method",M.method,M,null),Zn(a,l,"target",M.target,M,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){a.removeAttribute(m);break}x=$u(""+x),a.setAttribute(m,x);break;case"onClick":x!=null&&(a.onclick=ro);break;case"onScroll":x!=null&&Mn("scroll",a);break;case"onScrollEnd":x!=null&&Mn("scrollend",a);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(i(61));if(m=x.__html,m!=null){if(M.children!=null)throw Error(i(60));a.innerHTML=m}}break;case"multiple":a.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":a.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){a.removeAttribute("xlink:href");break}m=$u(""+x),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(m,""+x):a.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(m,""):a.removeAttribute(m);break;case"capture":case"download":x===!0?a.setAttribute(m,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?a.setAttribute(m,x):a.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?a.setAttribute(m,x):a.removeAttribute(m);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?a.removeAttribute(m):a.setAttribute(m,x);break;case"popover":Mn("beforetoggle",a),Mn("toggle",a),Tt(a,"popover",x);break;case"xlinkActuate":Mt(a,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Mt(a,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Mt(a,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Mt(a,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Mt(a,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Mt(a,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Mt(a,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Mt(a,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Mt(a,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Tt(a,"is",x);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=P0.get(m)||m,Tt(a,m,x))}}function Q_(a,l,m,x,M,C){switch(m){case"style":Il(a,x,C);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(i(61));if(m=x.__html,m!=null){if(M.children!=null)throw Error(i(60));a.innerHTML=m}}break;case"children":typeof x=="string"?Pi(a,x):(typeof x=="number"||typeof x=="bigint")&&Pi(a,""+x);break;case"onScroll":x!=null&&Mn("scroll",a);break;case"onScrollEnd":x!=null&&Mn("scrollend",a);break;case"onClick":x!=null&&(a.onclick=ro);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!we.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(M=m.endsWith("Capture"),l=m.slice(2,M?m.length-7:void 0),C=a[Vi]||null,C=C!=null?C[m]:null,typeof C=="function"&&a.removeEventListener(l,C,M),typeof x=="function")){typeof C!="function"&&C!==null&&(m in a?a[m]=null:a.hasAttribute(m)&&a.removeAttribute(m)),a.addEventListener(l,x,M);break e}m in a?a[m]=x:x===!0?a.setAttribute(m,""):Tt(a,m,x)}}}function Os(a,l,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Mn("error",a),Mn("load",a);var x=!1,M=!1,C;for(C in m)if(m.hasOwnProperty(C)){var O=m[C];if(O!=null)switch(C){case"src":x=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:Zn(a,l,C,O,m,null)}}M&&Zn(a,l,"srcSet",m.srcSet,m,null),x&&Zn(a,l,"src",m.src,m,null);return;case"input":Mn("invalid",a);var q=C=O=M=null,ne=null,ve=null;for(x in m)if(m.hasOwnProperty(x)){var ke=m[x];if(ke!=null)switch(x){case"name":M=ke;break;case"type":O=ke;break;case"checked":ne=ke;break;case"defaultChecked":ve=ke;break;case"value":C=ke;break;case"defaultValue":q=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(i(137,l));break;default:Zn(a,l,x,ke,m,null)}}ra(a,C,q,ne,ve,O,M,!1);return;case"select":Mn("invalid",a),x=O=C=null;for(M in m)if(m.hasOwnProperty(M)&&(q=m[M],q!=null))switch(M){case"value":C=q;break;case"defaultValue":O=q;break;case"multiple":x=q;default:Zn(a,l,M,q,m,null)}l=C,m=O,a.multiple=!!x,l!=null?As(a,!!x,l,!1):m!=null&&As(a,!!x,m,!0);return;case"textarea":Mn("invalid",a),C=M=x=null;for(O in m)if(m.hasOwnProperty(O)&&(q=m[O],q!=null))switch(O){case"value":x=q;break;case"defaultValue":M=q;break;case"children":C=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(i(91));break;default:Zn(a,l,O,q,m,null)}Hi(a,x,M,C);return;case"option":for(ne in m)m.hasOwnProperty(ne)&&(x=m[ne],x!=null)&&(ne==="selected"?a.selected=x&&typeof x!="function"&&typeof x!="symbol":Zn(a,l,ne,x,m,null));return;case"dialog":Mn("beforetoggle",a),Mn("toggle",a),Mn("cancel",a),Mn("close",a);break;case"iframe":case"object":Mn("load",a);break;case"video":case"audio":for(x=0;x<Xr.length;x++)Mn(Xr[x],a);break;case"image":Mn("error",a),Mn("load",a);break;case"details":Mn("toggle",a);break;case"embed":case"source":case"link":Mn("error",a),Mn("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ve in m)if(m.hasOwnProperty(ve)&&(x=m[ve],x!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:Zn(a,l,ve,x,m,null)}return;default:if(Rr(l)){for(ke in m)m.hasOwnProperty(ke)&&(x=m[ke],x!==void 0&&Q_(a,l,ke,x,m,void 0));return}}for(q in m)m.hasOwnProperty(q)&&(x=m[q],x!=null&&Zn(a,l,q,x,m,null))}function eD(a,l,m,x){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,C=null,O=null,q=null,ne=null,ve=null,ke=null;for(Ae in m){var je=m[Ae];if(m.hasOwnProperty(Ae)&&je!=null)switch(Ae){case"checked":break;case"value":break;case"defaultValue":ne=je;default:x.hasOwnProperty(Ae)||Zn(a,l,Ae,null,x,je)}}for(var _e in x){var Ae=x[_e];if(je=m[_e],x.hasOwnProperty(_e)&&(Ae!=null||je!=null))switch(_e){case"type":C=Ae;break;case"name":M=Ae;break;case"checked":ve=Ae;break;case"defaultChecked":ke=Ae;break;case"value":O=Ae;break;case"defaultValue":q=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(i(137,l));break;default:Ae!==je&&Zn(a,l,_e,Ae,x,je)}}Di(a,O,q,ne,ve,ke,C,M);return;case"select":Ae=O=q=_e=null;for(C in m)if(ne=m[C],m.hasOwnProperty(C)&&ne!=null)switch(C){case"value":break;case"multiple":Ae=ne;default:x.hasOwnProperty(C)||Zn(a,l,C,null,x,ne)}for(M in x)if(C=x[M],ne=m[M],x.hasOwnProperty(M)&&(C!=null||ne!=null))switch(M){case"value":_e=C;break;case"defaultValue":q=C;break;case"multiple":O=C;default:C!==ne&&Zn(a,l,M,C,x,ne)}l=q,m=O,x=Ae,_e!=null?As(a,!!m,_e,!1):!!x!=!!m&&(l!=null?As(a,!!m,l,!0):As(a,!!m,m?[]:"",!1));return;case"textarea":Ae=_e=null;for(q in m)if(M=m[q],m.hasOwnProperty(q)&&M!=null&&!x.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:Zn(a,l,q,null,x,M)}for(O in x)if(M=x[O],C=m[O],x.hasOwnProperty(O)&&(M!=null||C!=null))switch(O){case"value":_e=M;break;case"defaultValue":Ae=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(i(91));break;default:M!==C&&Zn(a,l,O,M,x,C)}Un(a,_e,Ae);return;case"option":for(var At in m)_e=m[At],m.hasOwnProperty(At)&&_e!=null&&!x.hasOwnProperty(At)&&(At==="selected"?a.selected=!1:Zn(a,l,At,null,x,_e));for(ne in x)_e=x[ne],Ae=m[ne],x.hasOwnProperty(ne)&&_e!==Ae&&(_e!=null||Ae!=null)&&(ne==="selected"?a.selected=_e&&typeof _e!="function"&&typeof _e!="symbol":Zn(a,l,ne,_e,x,Ae));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ht in m)_e=m[Ht],m.hasOwnProperty(Ht)&&_e!=null&&!x.hasOwnProperty(Ht)&&Zn(a,l,Ht,null,x,_e);for(ve in x)if(_e=x[ve],Ae=m[ve],x.hasOwnProperty(ve)&&_e!==Ae&&(_e!=null||Ae!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(i(137,l));break;default:Zn(a,l,ve,_e,x,Ae)}return;default:if(Rr(l)){for(var Qn in m)_e=m[Qn],m.hasOwnProperty(Qn)&&_e!==void 0&&!x.hasOwnProperty(Qn)&&Q_(a,l,Qn,void 0,x,_e);for(ke in x)_e=x[ke],Ae=m[ke],!x.hasOwnProperty(ke)||_e===Ae||_e===void 0&&Ae===void 0||Q_(a,l,ke,_e,x,Ae);return}}for(var he in m)_e=m[he],m.hasOwnProperty(he)&&_e!=null&&!x.hasOwnProperty(he)&&Zn(a,l,he,null,x,_e);for(je in x)_e=x[je],Ae=m[je],!x.hasOwnProperty(je)||_e===Ae||_e==null&&Ae==null||Zn(a,l,je,_e,x,Ae)}function rE(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function tD(){if(typeof performance.getEntriesByType=="function"){for(var a=0,l=0,m=performance.getEntriesByType("resource"),x=0;x<m.length;x++){var M=m[x],C=M.transferSize,O=M.initiatorType,q=M.duration;if(C&&q&&rE(O)){for(O=0,q=M.responseEnd,x+=1;x<m.length;x++){var ne=m[x],ve=ne.startTime;if(ve>q)break;var ke=ne.transferSize,je=ne.initiatorType;ke&&rE(je)&&(ne=ne.responseEnd,O+=ke*(ne<q?1:(q-ve)/(ne-ve)))}if(--x,l+=8*(C+O)/(M.duration/1e3),a++,10<a)break}}if(0<a)return l/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var ew=null,tw=null;function iv(a){return a.nodeType===9?a:a.ownerDocument}function aE(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function oE(a,l){if(a===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&l==="foreignObject"?0:a}function nw(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var iw=null;function nD(){var a=window.event;return a&&a.type==="popstate"?a===iw?!1:(iw=a,!0):(iw=null,!1)}var lE=typeof setTimeout=="function"?setTimeout:void 0,iD=typeof clearTimeout=="function"?clearTimeout:void 0,cE=typeof Promise=="function"?Promise:void 0,sD=typeof queueMicrotask=="function"?queueMicrotask:typeof cE<"u"?function(a){return cE.resolve(null).then(a).catch(rD)}:lE;function rD(a){setTimeout(function(){throw a})}function uu(a){return a==="head"}function uE(a,l){var m=l,x=0;do{var M=m.nextSibling;if(a.removeChild(m),M&&M.nodeType===8)if(m=M.data,m==="/$"||m==="/&"){if(x===0){a.removeChild(M),Af(l);return}x--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")x++;else if(m==="html")ig(a.ownerDocument.documentElement);else if(m==="head"){m=a.ownerDocument.head,ig(m);for(var C=m.firstChild;C;){var O=C.nextSibling,q=C.nodeName;C[sa]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&C.rel.toLowerCase()==="stylesheet"||m.removeChild(C),C=O}}else m==="body"&&ig(a.ownerDocument.body);m=M}while(m);Af(l)}function dE(a,l){var m=a;a=0;do{var x=m.nextSibling;if(m.nodeType===1?l?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(l?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),x&&x.nodeType===8)if(m=x.data,m==="/$"){if(a===0)break;a--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||a++;m=x}while(m)}function sw(a){var l=a.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var m=l;switch(l=l.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":sw(m),no(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}a.removeChild(m)}}function aD(a,l,m,x){for(;a.nodeType===1;){var M=m;if(a.nodeName.toLowerCase()!==l.toLowerCase()){if(!x&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(x){if(!a[sa])switch(l){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(C=a.getAttribute("rel"),C==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(C!==M.rel||a.getAttribute("href")!==(M.href==null||M.href===""?null:M.href)||a.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||a.getAttribute("title")!==(M.title==null?null:M.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(C=a.getAttribute("src"),(C!==(M.src==null?null:M.src)||a.getAttribute("type")!==(M.type==null?null:M.type)||a.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&C&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(l==="input"&&a.type==="hidden"){var C=M.name==null?null:""+M.name;if(M.type==="hidden"&&a.getAttribute("name")===C)return a}else return a;if(a=Ha(a.nextSibling),a===null)break}return null}function oD(a,l,m){if(l==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!m||(a=Ha(a.nextSibling),a===null))return null;return a}function hE(a,l){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=Ha(a.nextSibling),a===null))return null;return a}function rw(a){return a.data==="$?"||a.data==="$~"}function aw(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function lD(a,l){var m=a.ownerDocument;if(a.data==="$~")a._reactRetry=l;else if(a.data!=="$?"||m.readyState!=="loading")l();else{var x=function(){l(),m.removeEventListener("DOMContentLoaded",x)};m.addEventListener("DOMContentLoaded",x),a._reactRetry=x}}function Ha(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return a}var ow=null;function fE(a){a=a.nextSibling;for(var l=0;a;){if(a.nodeType===8){var m=a.data;if(m==="/$"||m==="/&"){if(l===0)return Ha(a.nextSibling);l--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||l++}a=a.nextSibling}return null}function pE(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var m=a.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(l===0)return a;l--}else m!=="/$"&&m!=="/&"||l++}a=a.previousSibling}return null}function mE(a,l,m){switch(l=iv(m),a){case"html":if(a=l.documentElement,!a)throw Error(i(452));return a;case"head":if(a=l.head,!a)throw Error(i(453));return a;case"body":if(a=l.body,!a)throw Error(i(454));return a;default:throw Error(i(451))}}function ig(a){for(var l=a.attributes;l.length;)a.removeAttributeNode(l[0]);no(a)}var Ga=new Map,gE=new Set;function sv(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var oc=te.d;te.d={f:cD,r:uD,D:dD,C:hD,L:fD,m:pD,X:gD,S:mD,M:xD};function cD(){var a=oc.f(),l=ua();return a||l}function uD(a){var l=so(a);l!==null&&l.tag===5&&l.type==="form"?Fx(l):oc.r(a)}var Tf=typeof document>"u"?null:document;function xE(a,l,m){var x=Tf;if(x&&typeof l=="string"&&l){var M=Vt(l);M='link[rel="'+a+'"][href="'+M+'"]',typeof m=="string"&&(M+='[crossorigin="'+m+'"]'),gE.has(M)||(gE.add(M),a={rel:a,crossOrigin:m,href:l},x.querySelector(M)===null&&(l=x.createElement("link"),Os(l,"link",a),G(l),x.head.appendChild(l)))}}function dD(a){oc.D(a),xE("dns-prefetch",a,null)}function hD(a,l){oc.C(a,l),xE("preconnect",a,l)}function fD(a,l,m){oc.L(a,l,m);var x=Tf;if(x&&a&&l){var M='link[rel="preload"][as="'+Vt(l)+'"]';l==="image"&&m&&m.imageSrcSet?(M+='[imagesrcset="'+Vt(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(M+='[imagesizes="'+Vt(m.imageSizes)+'"]')):M+='[href="'+Vt(a)+'"]';var C=M;switch(l){case"style":C=Ef(a);break;case"script":C=Mf(a)}Ga.has(C)||(a=v({rel:"preload",href:l==="image"&&m&&m.imageSrcSet?void 0:a,as:l},m),Ga.set(C,a),x.querySelector(M)!==null||l==="style"&&x.querySelector(sg(C))||l==="script"&&x.querySelector(rg(C))||(l=x.createElement("link"),Os(l,"link",a),G(l),x.head.appendChild(l)))}}function pD(a,l){oc.m(a,l);var m=Tf;if(m&&a){var x=l&&typeof l.as=="string"?l.as:"script",M='link[rel="modulepreload"][as="'+Vt(x)+'"][href="'+Vt(a)+'"]',C=M;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Mf(a)}if(!Ga.has(C)&&(a=v({rel:"modulepreload",href:a},l),Ga.set(C,a),m.querySelector(M)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(rg(C)))return}x=m.createElement("link"),Os(x,"link",a),G(x),m.head.appendChild(x)}}}function mD(a,l,m){oc.S(a,l,m);var x=Tf;if(x&&a){var M=ba(x).hoistableStyles,C=Ef(a);l=l||"default";var O=M.get(C);if(!O){var q={loading:0,preload:null};if(O=x.querySelector(sg(C)))q.loading=5;else{a=v({rel:"stylesheet",href:a,"data-precedence":l},m),(m=Ga.get(C))&&lw(a,m);var ne=O=x.createElement("link");G(ne),Os(ne,"link",a),ne._p=new Promise(function(ve,ke){ne.onload=ve,ne.onerror=ke}),ne.addEventListener("load",function(){q.loading|=1}),ne.addEventListener("error",function(){q.loading|=2}),q.loading|=4,rv(O,l,x)}O={type:"stylesheet",instance:O,count:1,state:q},M.set(C,O)}}}function gD(a,l){oc.X(a,l);var m=Tf;if(m&&a){var x=ba(m).hoistableScripts,M=Mf(a),C=x.get(M);C||(C=m.querySelector(rg(M)),C||(a=v({src:a,async:!0},l),(l=Ga.get(M))&&cw(a,l),C=m.createElement("script"),G(C),Os(C,"link",a),m.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},x.set(M,C))}}function xD(a,l){oc.M(a,l);var m=Tf;if(m&&a){var x=ba(m).hoistableScripts,M=Mf(a),C=x.get(M);C||(C=m.querySelector(rg(M)),C||(a=v({src:a,async:!0,type:"module"},l),(l=Ga.get(M))&&cw(a,l),C=m.createElement("script"),G(C),Os(C,"link",a),m.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},x.set(M,C))}}function vE(a,l,m,x){var M=(M=ge.current)?sv(M):null;if(!M)throw Error(i(446));switch(a){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(l=Ef(m.href),m=ba(M).hoistableStyles,x=m.get(l),x||(x={type:"style",instance:null,count:0,state:null},m.set(l,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){a=Ef(m.href);var C=ba(M).hoistableStyles,O=C.get(a);if(O||(M=M.ownerDocument||M,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(a,O),(C=M.querySelector(sg(a)))&&!C._p&&(O.instance=C,O.state.loading=5),Ga.has(a)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},Ga.set(a,m),C||vD(M,a,m,O.state))),l&&x===null)throw Error(i(528,""));return O}if(l&&x!==null)throw Error(i(529,""));return null;case"script":return l=m.async,m=m.src,typeof m=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Mf(m),m=ba(M).hoistableScripts,x=m.get(l),x||(x={type:"script",instance:null,count:0,state:null},m.set(l,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,a))}}function Ef(a){return'href="'+Vt(a)+'"'}function sg(a){return'link[rel="stylesheet"]['+a+"]"}function yE(a){return v({},a,{"data-precedence":a.precedence,precedence:null})}function vD(a,l,m,x){a.querySelector('link[rel="preload"][as="style"]['+l+"]")?x.loading=1:(l=a.createElement("link"),x.preload=l,l.addEventListener("load",function(){return x.loading|=1}),l.addEventListener("error",function(){return x.loading|=2}),Os(l,"link",m),G(l),a.head.appendChild(l))}function Mf(a){return'[src="'+Vt(a)+'"]'}function rg(a){return"script[async]"+a}function bE(a,l,m){if(l.count++,l.instance===null)switch(l.type){case"style":var x=a.querySelector('style[data-href~="'+Vt(m.href)+'"]');if(x)return l.instance=x,G(x),x;var M=v({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return x=(a.ownerDocument||a).createElement("style"),G(x),Os(x,"style",M),rv(x,m.precedence,a),l.instance=x;case"stylesheet":M=Ef(m.href);var C=a.querySelector(sg(M));if(C)return l.state.loading|=4,l.instance=C,G(C),C;x=yE(m),(M=Ga.get(M))&&lw(x,M),C=(a.ownerDocument||a).createElement("link"),G(C);var O=C;return O._p=new Promise(function(q,ne){O.onload=q,O.onerror=ne}),Os(C,"link",x),l.state.loading|=4,rv(C,m.precedence,a),l.instance=C;case"script":return C=Mf(m.src),(M=a.querySelector(rg(C)))?(l.instance=M,G(M),M):(x=m,(M=Ga.get(C))&&(x=v({},m),cw(x,M)),a=a.ownerDocument||a,M=a.createElement("script"),G(M),Os(M,"link",x),a.head.appendChild(M),l.instance=M);case"void":return null;default:throw Error(i(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(x=l.instance,l.state.loading|=4,rv(x,m.precedence,a));return l.instance}function rv(a,l,m){for(var x=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=x.length?x[x.length-1]:null,C=M,O=0;O<x.length;O++){var q=x[O];if(q.dataset.precedence===l)C=q;else if(C!==M)break}C?C.parentNode.insertBefore(a,C.nextSibling):(l=m.nodeType===9?m.head:m,l.insertBefore(a,l.firstChild))}function lw(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.title==null&&(a.title=l.title)}function cw(a,l){a.crossOrigin==null&&(a.crossOrigin=l.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=l.referrerPolicy),a.integrity==null&&(a.integrity=l.integrity)}var av=null;function _E(a,l,m){if(av===null){var x=new Map,M=av=new Map;M.set(m,x)}else M=av,x=M.get(m),x||(x=new Map,M.set(m,x));if(x.has(a))return x;for(x.set(a,null),m=m.getElementsByTagName(a),M=0;M<m.length;M++){var C=m[M];if(!(C[sa]||C[ui]||a==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var O=C.getAttribute(l)||"";O=a+O;var q=x.get(O);q?q.push(C):x.set(O,[C])}}return x}function wE(a,l,m){a=a.ownerDocument||a,a.head.insertBefore(m,l==="title"?a.querySelector("head > title"):null)}function yD(a,l,m){if(m===1||l.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;return l.rel==="stylesheet"?(a=l.disabled,typeof l.precedence=="string"&&a==null):!0;case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function SE(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function bD(a,l,m,x){if(m.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var M=Ef(x.href),C=l.querySelector(sg(M));if(C){l=C._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(a.count++,a=ov.bind(a),l.then(a,a)),m.state.loading|=4,m.instance=C,G(C);return}C=l.ownerDocument||l,x=yE(x),(M=Ga.get(M))&&lw(x,M),C=C.createElement("link"),G(C);var O=C;O._p=new Promise(function(q,ne){O.onload=q,O.onerror=ne}),Os(C,"link",x),m.instance=C}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(m,l),(l=m.state.preload)&&(m.state.loading&3)===0&&(a.count++,m=ov.bind(a),l.addEventListener("load",m),l.addEventListener("error",m))}}var uw=0;function _D(a,l){return a.stylesheets&&a.count===0&&cv(a,a.stylesheets),0<a.count||0<a.imgCount?function(m){var x=setTimeout(function(){if(a.stylesheets&&cv(a,a.stylesheets),a.unsuspend){var C=a.unsuspend;a.unsuspend=null,C()}},6e4+l);0<a.imgBytes&&uw===0&&(uw=62500*tD());var M=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&cv(a,a.stylesheets),a.unsuspend)){var C=a.unsuspend;a.unsuspend=null,C()}},(a.imgBytes>uw?50:800)+l);return a.unsuspend=m,function(){a.unsuspend=null,clearTimeout(x),clearTimeout(M)}}:null}function ov(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)cv(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var lv=null;function cv(a,l){a.stylesheets=null,a.unsuspend!==null&&(a.count++,lv=new Map,l.forEach(wD,a),lv=null,ov.call(a))}function wD(a,l){if(!(l.state.loading&4)){var m=lv.get(a);if(m)var x=m.get(null);else{m=new Map,lv.set(a,m);for(var M=a.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<M.length;C++){var O=M[C];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(m.set(O.dataset.precedence,O),x=O)}x&&m.set(null,x)}M=l.instance,O=M.getAttribute("data-precedence"),C=m.get(O)||x,C===x&&m.set(null,M),m.set(O,M),this.count++,x=ov.bind(this),M.addEventListener("load",x),M.addEventListener("error",x),C?C.parentNode.insertBefore(M,C.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(M,a.firstChild)),l.state.loading|=4}}var ag={$$typeof:D,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function SD(a,l,m,x,M,C,O,q,ne){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=An(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=An(0),this.hiddenUpdates=An(null),this.identifierPrefix=x,this.onUncaughtError=M,this.onCaughtError=C,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ne,this.incompleteTransitions=new Map}function TE(a,l,m,x,M,C,O,q,ne,ve,ke,je){return a=new SD(a,l,m,O,ne,ve,ke,je,q),l=1,C===!0&&(l|=24),C=di(3,null,null,l),a.current=C,C.stateNode=a,l=um(),l.refCount++,a.pooledCache=l,l.refCount++,C.memoizedState={element:x,isDehydrated:m,cache:l},fd(C),a}function EE(a){return a?(a=Wo,a):Wo}function ME(a,l,m,x,M,C){M=EE(M),x.context===null?x.context=M:x.pendingContext=M,x=po(l),x.payload={element:m},C=C===void 0?null:C,C!==null&&(x.callback=C),m=el(a,x,l),m!==null&&(dn(m,a,l),tl(m,a,l))}function AE(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var m=a.retryLane;a.retryLane=m!==0&&m<l?m:l}}function dw(a,l){AE(a,l),(a=a.alternate)&&AE(a,l)}function NE(a){if(a.tag===13||a.tag===31){var l=Rs(a,67108864);l!==null&&dn(l,a,67108864),dw(a,67108864)}}function CE(a){if(a.tag===13||a.tag===31){var l=_r();l=jo(l);var m=Rs(a,l);m!==null&&dn(m,a,l),dw(a,l)}}var uv=!0;function TD(a,l,m,x){var M=J.T;J.T=null;var C=te.p;try{te.p=2,hw(a,l,m,x)}finally{te.p=C,J.T=M}}function ED(a,l,m,x){var M=J.T;J.T=null;var C=te.p;try{te.p=8,hw(a,l,m,x)}finally{te.p=C,J.T=M}}function hw(a,l,m,x){if(uv){var M=fw(x);if(M===null)Z_(a,l,x,dv,m),kE(a,x);else if(AD(M,a,l,m,x))x.stopPropagation();else if(kE(a,x),l&4&&-1<MD.indexOf(a)){for(;M!==null;){var C=so(M);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var O=Ge(C.pendingLanes);if(O!==0){var q=C;for(q.pendingLanes|=2,q.entangledLanes|=2;O;){var ne=1<<31-pt(O);q.entanglements[1]|=ne,O&=~ne}We(C),(kt&6)===0&&(Mi=V()+500,yt(0))}}break;case 31:case 13:q=Rs(C,2),q!==null&&dn(q,C,2),ua(),dw(C,2)}if(C=fw(x),C===null&&Z_(a,l,x,dv,m),C===M)break;M=C}M!==null&&x.stopPropagation()}else Z_(a,l,x,null,m)}}function fw(a){return a=wh(a),pw(a)}var dv=null;function pw(a){if(dv=null,a=io(a),a!==null){var l=r(a);if(l===null)a=null;else{var m=l.tag;if(m===13){if(a=o(l),a!==null)return a;a=null}else if(m===31){if(a=c(l),a!==null)return a;a=null}else if(m===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null)}}return dv=a,null}function RE(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ae()){case Ee:return 2;case ze:return 8;case Me:case gt:return 32;case Qe:return 268435456;default:return 32}default:return 32}}var mw=!1,du=null,hu=null,fu=null,og=new Map,lg=new Map,pu=[],MD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function kE(a,l){switch(a){case"focusin":case"focusout":du=null;break;case"dragenter":case"dragleave":hu=null;break;case"mouseover":case"mouseout":fu=null;break;case"pointerover":case"pointerout":og.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":lg.delete(l.pointerId)}}function cg(a,l,m,x,M,C){return a===null||a.nativeEvent!==C?(a={blockedOn:l,domEventName:m,eventSystemFlags:x,nativeEvent:C,targetContainers:[M]},l!==null&&(l=so(l),l!==null&&NE(l)),a):(a.eventSystemFlags|=x,l=a.targetContainers,M!==null&&l.indexOf(M)===-1&&l.push(M),a)}function AD(a,l,m,x,M){switch(l){case"focusin":return du=cg(du,a,l,m,x,M),!0;case"dragenter":return hu=cg(hu,a,l,m,x,M),!0;case"mouseover":return fu=cg(fu,a,l,m,x,M),!0;case"pointerover":var C=M.pointerId;return og.set(C,cg(og.get(C)||null,a,l,m,x,M)),!0;case"gotpointercapture":return C=M.pointerId,lg.set(C,cg(lg.get(C)||null,a,l,m,x,M)),!0}return!1}function IE(a){var l=io(a.target);if(l!==null){var m=r(l);if(m!==null){if(l=m.tag,l===13){if(l=o(m),l!==null){a.blockedOn=l,xs(a.priority,function(){CE(m)});return}}else if(l===31){if(l=c(m),l!==null){a.blockedOn=l,xs(a.priority,function(){CE(m)});return}}else if(l===3&&m.stateNode.current.memoizedState.isDehydrated){a.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}a.blockedOn=null}function hv(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var m=fw(a.nativeEvent);if(m===null){m=a.nativeEvent;var x=new m.constructor(m.type,m);_h=x,m.target.dispatchEvent(x),_h=null}else return l=so(m),l!==null&&NE(l),a.blockedOn=m,!1;l.shift()}return!0}function DE(a,l,m){hv(a)&&m.delete(l)}function ND(){mw=!1,du!==null&&hv(du)&&(du=null),hu!==null&&hv(hu)&&(hu=null),fu!==null&&hv(fu)&&(fu=null),og.forEach(DE),lg.forEach(DE)}function fv(a,l){a.blockedOn===l&&(a.blockedOn=null,mw||(mw=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,ND)))}var pv=null;function PE(a){pv!==a&&(pv=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){pv===a&&(pv=null);for(var l=0;l<a.length;l+=3){var m=a[l],x=a[l+1],M=a[l+2];if(typeof x!="function"){if(pw(x||m)===null)continue;break}var C=so(m);C!==null&&(a.splice(l,3),l-=3,Om(C,{pending:!0,data:M,method:m.method,action:x},x,M))}}))}function Af(a){function l(ne){return fv(ne,a)}du!==null&&fv(du,a),hu!==null&&fv(hu,a),fu!==null&&fv(fu,a),og.forEach(l),lg.forEach(l);for(var m=0;m<pu.length;m++){var x=pu[m];x.blockedOn===a&&(x.blockedOn=null)}for(;0<pu.length&&(m=pu[0],m.blockedOn===null);)IE(m),m.blockedOn===null&&pu.shift();if(m=(a.ownerDocument||a).$$reactFormReplay,m!=null)for(x=0;x<m.length;x+=3){var M=m[x],C=m[x+1],O=M[Vi]||null;if(typeof C=="function")O||PE(m);else if(O){var q=null;if(C&&C.hasAttribute("formAction")){if(M=C,O=C[Vi]||null)q=O.formAction;else if(pw(M)!==null)continue}else q=O.action;typeof q=="function"?m[x+1]=q:(m.splice(x,3),x-=3),PE(m)}}}function UE(){function a(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(O){return M=O})},focusReset:"manual",scroll:"manual"})}function l(){M!==null&&(M(),M=null),x||setTimeout(m,20)}function m(){if(!x&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var x=!1,M=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(m,100),function(){x=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),M!==null&&(M(),M=null)}}}function gw(a){this._internalRoot=a}mv.prototype.render=gw.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(i(409));var m=l.current,x=_r();ME(m,x,a,l,null,null)},mv.prototype.unmount=gw.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;ME(a.current,2,null,a,null,null),ua(),l[cr]=null}};function mv(a){this._internalRoot=a}mv.prototype.unstable_scheduleHydration=function(a){if(a){var l=Rl();a={blockedOn:null,target:a,priority:l};for(var m=0;m<pu.length&&l!==0&&l<pu[m].priority;m++);pu.splice(m,0,a),m===0&&IE(a)}};var LE=e.version;if(LE!=="19.2.3")throw Error(i(527,LE,"19.2.3"));te.findDOMNode=function(a){var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(i(188)):(a=Object.keys(a).join(","),Error(i(268,a)));return a=p(l),a=a!==null?g(a):null,a=a===null?null:a.stateNode,a};var CD={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gv.isDisabled&&gv.supportsFiber)try{He=gv.inject(CD),Ye=gv}catch{}}return dg.createRoot=function(a,l){if(!s(a))throw Error(i(299));var m=!1,x="",M=$x,C=Hm,O=Gm;return l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(x=l.identifierPrefix),l.onUncaughtError!==void 0&&(M=l.onUncaughtError),l.onCaughtError!==void 0&&(C=l.onCaughtError),l.onRecoverableError!==void 0&&(O=l.onRecoverableError)),l=TE(a,1,!1,null,null,m,x,null,M,C,O,UE),a[cr]=l.current,K_(a),new gw(l)},dg.hydrateRoot=function(a,l,m){if(!s(a))throw Error(i(299));var x=!1,M="",C=$x,O=Hm,q=Gm,ne=null;return m!=null&&(m.unstable_strictMode===!0&&(x=!0),m.identifierPrefix!==void 0&&(M=m.identifierPrefix),m.onUncaughtError!==void 0&&(C=m.onUncaughtError),m.onCaughtError!==void 0&&(O=m.onCaughtError),m.onRecoverableError!==void 0&&(q=m.onRecoverableError),m.formState!==void 0&&(ne=m.formState)),l=TE(a,1,!0,l,m??null,x,M,ne,C,O,q,UE),l.context=EE(null),m=l.current,x=_r(),x=jo(x),M=po(x),M.callback=null,el(m,M,x),m=x,l.current.lanes=m,ls(l,m),We(l),a[cr]=l.current,K_(a),new mv(l)},dg.version="19.2.3",dg}var WE;function FD(){if(WE)return yw.exports;WE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),yw.exports=jD(),yw.exports}var BD=FD();const VD=Lb(BD);var De=(n=>(n.HOME="HOME",n.ABOUT="ABOUT",n.CHAT="CHAT",n.THERAPY="THERAPY",n.GROUP_THERAPY="GROUP_THERAPY",n.GESTALT_TRAINING="GESTALT_TRAINING",n.BEHANDLINGS_ASSISTENT="BEHANDLINGS_ASSISTENT",n.BLOG="BLOG",n.COMMUNITY="COMMUNITY",n.CONTACT="CONTACT",n.SURVEY="SURVEY",n.DOWNLOADS="DOWNLOADS",n.LOGIN="LOGIN",n.GEMENSKAP_APP="GEMENSKAP_APP",n.BOOK="BOOK",n.CHECKOUT="CHECKOUT",n.PRIVACY="PRIVACY",n.TERMS="TERMS",n.COOKIE_POLICY="COOKIE_POLICY",n.PREMIUM_APPLICATION="PREMIUM_APPLICATION",n))(De||{});const HD=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sR=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();var GD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qD=ue.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:s="",children:r,iconNode:o,...c},h)=>ue.createElement("svg",{ref:h,...GD,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:sR("lucide",s),...c},[...o.map(([p,g])=>ue.createElement(p,g)),...Array.isArray(r)?r:[r]]));const at=(n,e)=>{const t=ue.forwardRef(({className:i,...s},r)=>ue.createElement(qD,{ref:r,iconNode:e,className:sR(`lucide-${HD(n)}`,i),...s}));return t.displayName=`${n}`,t};const WD=at("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const rR=at("Anchor",[["path",{d:"M12 22V8",key:"qkxhtm"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}],["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}]]);const yc=at("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const Fs=at("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const Kd=at("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);const Cg=at("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const zb=at("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);const Sw=at("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const $D=at("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);const aR=at("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);const $a=at("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const oR=at("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const XD=at("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);const YD=at("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const My=at("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const lR=at("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const ch=at("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const cR=at("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const JD=at("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const bc=at("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const OS=at("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const KD=at("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);const ZD=at("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const uR=at("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const Tw=at("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const QD=at("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);const dR=at("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const eP=at("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);const hR=at("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const tP=at("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);const jb=at("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const nP=at("Gem",[["path",{d:"M6 3h12l4 6-10 13L2 9Z",key:"1pcd5k"}],["path",{d:"M11 3 8 9l4 13 4-13-3-6",key:"1fcu3u"}],["path",{d:"M2 9h20",key:"16fsjt"}]]);const iP=at("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const sP=at("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);const Ka=at("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);const $E=at("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const _0=at("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const rP=at("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);const XE=at("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);const aP=at("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);const oP=at("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);const fR=at("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const Fb=at("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const YE=at("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const JE=at("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const w0=at("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const Bb=at("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const lP=at("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const pR=at("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);const Ay=at("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);const mR=at("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const cP=at("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);const uP=at("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);const Ny=at("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);const dP=at("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);const hP=at("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);const fP=at("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const pP=at("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const KE=at("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);const mP=at("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);const gP=at("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);const ZE=at("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const Ml=at("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);const gR=at("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Sl=at("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const Fu=at("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const xR=at("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const xP=at("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);const va=at("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);const Xg=at("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);const zS=at("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const Vb=at("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);const vP=at("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);const yP=at("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const jS=at("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const bP=at("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const _P=at("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);const Vs=at("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const QE=at("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const eM=at("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const Bu=at("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const wP=at("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),SP=({currentPage:n,setPage:e,isDarkMode:t,toggleTheme:i})=>{const[s,r]=ue.useState(!1),[o,c]=ue.useState(!1),[h,p]=ue.useState(!1),g=ue.useRef(null),v=ue.useRef(null),y=R=>{e(R),r(!1),c(!1),p(!1)};ue.useEffect(()=>{const R=N=>{g.current&&!g.current.contains(N.target)&&c(!1),v.current&&!v.current.contains(N.target)&&p(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const w=[De.CHAT,De.THERAPY,De.GROUP_THERAPY,De.GESTALT_TRAINING,De.BEHANDLINGS_ASSISTENT].includes(n),E=[De.COMMUNITY,De.SURVEY,De.DOWNLOADS].includes(n);return d.jsx("header",{className:"p-4 md:p-5",children:d.jsx("div",{className:"max-w-[1600px] mx-auto",children:d.jsxs("nav",{className:"glass bg-white/15 backdrop-blur-xl border border-white/20 rounded-2xl shadow-lg flex justify-between items-center px-8 py-4 relative z-50",children:[d.jsxs("button",{className:"flex items-center gap-4 cursor-pointer group rounded-lg focus:outline-none",onClick:()=>y(De.HOME),children:[d.jsx("div",{className:"w-16 h-16 flex items-center justify-center transition-all duration-500 group-hover:scale-110 group-hover:rotate-3",children:d.jsx("img",{src:"/assets/logo2.png",alt:"Logo",className:"w-full h-full object-contain opacity-90 group-hover:opacity-100"})}),d.jsxs("span",{className:"text-xl md:text-2xl font-bold text-white drop-shadow-md hidden sm:block tracking-tight",children:["Klttertrdet ",d.jsx("span",{className:"text-orange-400 font-light mx-1",children:"&"})," Horizonten"]})]}),d.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[d.jsx("button",{onClick:()=>y(De.HOME),className:`px-4 py-2 rounded-xl transition-all font-medium ${n===De.HOME?"bg-white/20 text-white shadow-sm":"text-white/80 hover:bg-white/10 hover:text-white"}`,children:"Hem"}),d.jsx("button",{onClick:()=>y(De.ABOUT),className:`px-4 py-2 rounded-xl transition-all font-medium ${n===De.ABOUT?"bg-white/20 text-white shadow-sm":"text-white/80 hover:bg-white/10 hover:text-white"}`,children:"Om oss"}),d.jsxs("div",{className:"relative",ref:g,children:[d.jsxs("button",{onMouseEnter:()=>{c(!0),p(!1)},onClick:()=>c(!o),className:`flex items-center gap-1 px-4 py-2 rounded-xl transition-all font-medium ${w?"bg-white/20 text-white shadow-sm":"text-white/80 hover:bg-white/10 hover:text-white"}`,children:["Tjnster ",d.jsx(My,{size:16,className:`transition-transform duration-300 ${o?"rotate-180":""}`})]}),o&&d.jsxs("div",{className:"absolute top-full left-0 mt-3 w-80 glass bg-black/90 backdrop-blur-2xl border border-white/20 rounded-2xl shadow-2xl p-4 animate-fade-in flex flex-col gap-4",onMouseLeave:()=>c(!1),children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-2 px-3 mb-2 text-white/40 text-[10px] uppercase tracking-widest font-bold",children:[d.jsx(zb,{size:12})," Utbildningar"]}),d.jsxs("div",{className:"space-y-1",children:[d.jsxs("button",{onClick:()=>y(De.BEHANDLINGS_ASSISTENT),className:`w-full text-left px-3 py-2 rounded-xl transition-colors flex flex-col ${n===De.BEHANDLINGS_ASSISTENT?"bg-orange-600/20 text-orange-400":"hover:bg-white/5 text-white/90"}`,children:[d.jsx("span",{className:"font-bold text-sm",children:"Behandlingsassistent"}),d.jsx("span",{className:"text-[10px] opacity-60",children:"Yrkesutbildning"})]}),d.jsxs("button",{onClick:()=>y(De.CHAT),className:`w-full text-left px-3 py-2 rounded-xl transition-colors flex flex-col ${n===De.CHAT?"bg-orange-600/20 text-orange-400":"hover:bg-white/5 text-white/90"}`,children:[d.jsx("span",{className:"font-bold text-sm",children:"Myndighetsinducerat trauma"}),d.jsx("span",{className:"text-[10px] opacity-60",children:"Specialistutbildning (MiT)"})]}),d.jsxs("button",{onClick:()=>y(De.GESTALT_TRAINING),className:`w-full text-left px-3 py-2 rounded-xl transition-colors flex flex-col ${n===De.GESTALT_TRAINING?"bg-orange-600/20 text-orange-400":"hover:bg-white/5 text-white/90"}`,children:[d.jsx("span",{className:"font-bold text-sm",children:"Gestaltterapi"}),d.jsx("span",{className:"text-[10px] opacity-60",children:"Grundutbildning & metodik"})]})]})]}),d.jsx("div",{className:"h-px bg-white/10 mx-2"}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-2 px-3 mb-2 text-white/40 text-[10px] uppercase tracking-widest font-bold",children:[d.jsx(Ka,{size:12})," Terapi"]}),d.jsxs("div",{className:"space-y-1",children:[d.jsxs("button",{onClick:()=>y(De.THERAPY),className:`w-full text-left px-3 py-2 rounded-xl transition-colors flex flex-col ${n===De.THERAPY?"bg-orange-600/20 text-orange-400":"hover:bg-white/5 text-white/90"}`,children:[d.jsx("span",{className:"font-bold text-sm",children:"Enskild Terapi"}),d.jsx("span",{className:"text-[10px] opacity-60",children:"Std & utveckling"})]}),d.jsxs("button",{onClick:()=>y(De.GROUP_THERAPY),className:`w-full text-left px-3 py-2 rounded-xl transition-colors flex flex-col ${n===De.GROUP_THERAPY?"bg-orange-600/20 text-orange-400":"hover:bg-white/5 text-white/90"}`,children:[d.jsx("span",{className:"font-bold text-sm",children:"Grupp- och parterapi"}),d.jsx("span",{className:"text-[10px] opacity-60",children:"Gemensam lkning"})]})]})]})]})]}),d.jsxs("div",{className:"relative",ref:v,children:[d.jsxs("button",{onMouseEnter:()=>{p(!0),c(!1)},onClick:()=>p(!h),className:`flex items-center gap-1 px-4 py-2 rounded-xl transition-all font-medium ${E?"bg-white/20 text-white shadow-sm":"text-white/80 hover:bg-white/10 hover:text-white"}`,children:["Resurser ",d.jsx(My,{size:16,className:`transition-transform duration-300 ${h?"rotate-180":""}`})]}),h&&d.jsxs("div",{className:"absolute top-full left-0 mt-3 w-72 glass bg-black/90 backdrop-blur-2xl border border-white/20 rounded-2xl shadow-2xl p-4 animate-fade-in flex flex-col gap-2",onMouseLeave:()=>p(!1),children:[d.jsxs("div",{className:"flex items-center gap-2 px-3 mb-1 text-white/40 text-[10px] uppercase tracking-widest font-bold",children:[d.jsx(oP,{size:12})," Bibliotek & Verktyg"]}),d.jsxs("button",{onClick:()=>y(De.COMMUNITY),className:`w-full text-left px-3 py-3 rounded-xl transition-colors flex items-center gap-3 ${n===De.COMMUNITY?"bg-amber-600/20 text-amber-400":"hover:bg-white/5 text-white/90"}`,children:[d.jsx("div",{className:"p-2 bg-white/5 rounded-lg",children:d.jsx(Vs,{size:18})}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-bold text-sm",children:"Gemenskap"}),d.jsx("span",{className:"text-[10px] opacity-60",children:"Appen & community"})]})]}),d.jsxs("button",{onClick:()=>y(De.SURVEY),className:`w-full text-left px-3 py-3 rounded-xl transition-colors flex items-center gap-3 ${n===De.SURVEY?"bg-blue-600/20 text-blue-400":"hover:bg-white/5 text-white/90"}`,children:[d.jsx("div",{className:"p-2 bg-white/5 rounded-lg",children:d.jsx(ZD,{size:18})}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-bold text-sm",children:"Enkt och utredning"}),d.jsx("span",{className:"text-[10px] opacity-60",children:"Kraftsamling fr barnens bsta"})]})]}),d.jsxs("button",{onClick:()=>y(De.DOWNLOADS),className:`w-full text-left px-3 py-3 rounded-xl transition-colors flex items-center gap-3 ${n===De.DOWNLOADS?"bg-emerald-600/20 text-emerald-400":"hover:bg-white/5 text-white/90"}`,children:[d.jsx("div",{className:"p-2 bg-white/5 rounded-lg",children:d.jsx(dR,{size:18})}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-bold text-sm",children:"Nedladdningar"}),d.jsx("span",{className:"text-[10px] opacity-60",children:"E-bcker & material"})]})]})]})]}),d.jsx("button",{onClick:()=>y(De.BLOG),className:`px-4 py-2 rounded-xl transition-all font-medium ${n===De.BLOG?"bg-white/20 text-white shadow-sm":"text-white/80 hover:bg-white/10 hover:text-white"}`,children:"Blogg"}),d.jsx("button",{onClick:()=>y(De.CONTACT),className:`px-4 py-2 rounded-xl transition-all font-medium ${n===De.CONTACT?"bg-white/20 text-white shadow-sm":"text-white/80 hover:bg-white/10 hover:text-white"}`,children:"Kontakt & bokning"}),d.jsxs("div",{className:"relative group/badge",children:[d.jsxs("button",{onClick:()=>y(De.LOGIN),className:`px-4 py-2 rounded-xl transition-all font-medium flex items-center gap-2 ${n===De.LOGIN?"bg-orange-600/20 text-orange-400 shadow-sm":"text-white/80 hover:bg-white/10 hover:text-white"}`,children:[d.jsx(YE,{size:18})," Logga in"]}),d.jsx("div",{className:"absolute -top-3 -right-3 pointer-events-none",children:d.jsx("div",{className:"bg-red-600 text-[7px] font-black text-white px-2 py-1 rounded-lg shadow-[0_4px_12px_rgba(220,38,38,0.5)] animate-pulse whitespace-nowrap uppercase tracking-widest border border-white/20 -rotate-6 group-hover/badge:rotate-0 transition-transform duration-500",children:"Nytt frn oss"})})]}),d.jsx("div",{className:"w-px h-6 bg-white/20 mx-2"}),d.jsx("button",{onClick:i,className:"p-3 rounded-xl text-white/80 hover:bg-white/10 hover:text-white transition-all hover:scale-105",children:t?d.jsx(zS,{size:20}):d.jsx(Ny,{size:20})})]}),d.jsxs("div",{className:"md:hidden flex items-center gap-4",children:[d.jsx("button",{onClick:i,className:"p-2 text-white/80",children:t?d.jsx(zS,{size:24}):d.jsx(Ny,{size:24})}),d.jsx("button",{onClick:()=>r(!s),className:"text-white p-2",children:s?d.jsx(Bu,{size:28}):d.jsx(pR,{size:28})})]}),s&&d.jsx("div",{className:"absolute top-full left-0 w-full mt-4 p-4 md:hidden",children:d.jsxs("div",{className:"glass bg-black/95 backdrop-blur-3xl border border-white/20 rounded-xl p-6 flex flex-col gap-3 shadow-2xl",children:[d.jsx("button",{onClick:()=>y(De.HOME),className:`w-full py-3 rounded-lg font-medium text-left px-4 ${n===De.HOME?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Hem"}),d.jsx("button",{onClick:()=>y(De.ABOUT),className:`w-full py-3 rounded-lg font-medium text-left px-4 ${n===De.ABOUT?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Om oss"}),d.jsxs("div",{className:"border-y border-white/10 py-2 my-2",children:[d.jsx("div",{className:"px-4 py-2 text-[10px] font-bold text-white/40 uppercase tracking-widest",children:"Tjnster"}),d.jsx("button",{onClick:()=>y(De.BEHANDLINGS_ASSISTENT),className:`w-full py-3 rounded-lg font-medium text-left px-6 ${n===De.BEHANDLINGS_ASSISTENT?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Behandlingsassistent"}),d.jsx("button",{onClick:()=>y(De.CHAT),className:`w-full py-3 rounded-lg font-medium text-left px-6 ${n===De.CHAT?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Myndighetsinducerat trauma"}),d.jsx("button",{onClick:()=>y(De.GESTALT_TRAINING),className:`w-full py-3 rounded-lg font-medium text-left px-6 ${n===De.GESTALT_TRAINING?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Gestaltterapi"}),d.jsx("button",{onClick:()=>y(De.THERAPY),className:`w-full py-3 rounded-lg font-medium text-left px-6 ${n===De.THERAPY?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Enskild Terapi"}),d.jsx("button",{onClick:()=>y(De.GROUP_THERAPY),className:`w-full py-3 rounded-lg font-medium text-left px-6 ${n===De.GROUP_THERAPY?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Grupp- och parterapi"})]}),d.jsxs("div",{className:"border-b border-white/10 pb-2 mb-2",children:[d.jsx("div",{className:"px-4 py-2 text-[10px] font-bold text-white/40 uppercase tracking-widest",children:"Resurser"}),d.jsx("button",{onClick:()=>y(De.COMMUNITY),className:`w-full py-3 rounded-lg font-medium text-left px-6 ${n===De.COMMUNITY?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Gemenskap"}),d.jsx("button",{onClick:()=>y(De.SURVEY),className:`w-full py-3 rounded-lg font-medium text-left px-6 ${n===De.SURVEY?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Enkt och utredning"}),d.jsx("button",{onClick:()=>y(De.DOWNLOADS),className:`w-full py-3 rounded-lg font-medium text-left px-6 ${n===De.DOWNLOADS?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Nedladdningar"})]}),d.jsx("button",{onClick:()=>y(De.BLOG),className:`w-full py-3 rounded-lg font-medium text-left px-4 ${n===De.BLOG?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Blogg"}),d.jsx("button",{onClick:()=>y(De.CONTACT),className:`w-full py-3 rounded-lg font-medium text-left px-4 ${n===De.CONTACT?"text-orange-400 bg-white/5":"text-white/80"}`,children:"Kontakt & bokning"}),d.jsx("div",{className:"border-t border-white/10 mt-2 pt-2",children:d.jsxs("button",{onClick:()=>y(De.LOGIN),className:`w-full py-3 rounded-lg font-bold text-left px-4 flex items-center gap-3 ${n===De.LOGIN?"text-orange-400 bg-white/5":"text-white"}`,children:[d.jsx(YE,{size:20})," Logga in"]})})]})})]})})})},TP=()=>d.jsxs("div",{className:"fixed inset-0 -z-10 overflow-hidden pointer-events-none",children:[d.jsx("div",{className:"absolute bg-white/10 rounded-2xl shadow-[0_8px_32px_rgba(255,255,255,0.1)] animate-float",style:{width:"120px",height:"80px",top:"20%",left:"10%",transform:"rotate(15deg)",animationDelay:"0s"}}),d.jsx("div",{className:"absolute bg-white/10 rounded-xl shadow-[0_8px_32px_rgba(255,255,255,0.1)] animate-float",style:{width:"90px",height:"140px",top:"60%",right:"15%",transform:"rotate(-20deg)",animationDelay:"2s"}}),d.jsx("div",{className:"absolute bg-white/10 rounded-lg shadow-[0_8px_32px_rgba(255,255,255,0.1)] animate-float",style:{width:"100px",height:"60px",bottom:"20%",left:"20%",transform:"rotate(25deg)",animationDelay:"4s"}}),d.jsx("div",{className:"absolute bg-white/10 rounded-lg shadow-[0_8px_32px_rgba(255,255,255,0.1)] animate-float",style:{width:"80px",height:"120px",top:"10%",right:"30%",transform:"rotate(-10deg)",animationDelay:"1s"}}),d.jsx("div",{className:"absolute bg-white/10 rounded-2xl shadow-[0_8px_32px_rgba(255,255,255,0.1)] animate-float",style:{width:"110px",height:"70px",bottom:"40%",right:"20%",transform:"rotate(30deg)",animationDelay:"3s"}}),d.jsx("div",{className:"absolute bg-white/10 rounded-[20px] shadow-[0_8px_32px_rgba(255,255,255,0.1)] animate-float",style:{width:"95px",height:"95px",top:"40%",left:"5%",transform:"rotate(-15deg)",animationDelay:"5s"}})]});function Hb(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function EP(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function c(g){try{p(i.next(g))}catch(v){o(v)}}function h(g){try{p(i.throw(g))}catch(v){o(v)}}function p(g){g.done?r(g.value):s(g.value).then(c,h)}p((i=i.apply(n,e||[])).next())})}const MP=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class O1 extends Error{constructor(e,t="FunctionsError",i){super(e),this.name=t,this.context=i}}class AP extends O1{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class tM extends O1{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class nM extends O1{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var FS;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(FS||(FS={}));class NP{constructor(e,{headers:t={},customFetch:i,region:s=FS.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=MP(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return EP(this,arguments,void 0,function*(t,i={}){var s;let r,o;try{const{headers:c,method:h,body:p,signal:g,timeout:v}=i;let y={},{region:w}=i;w||(w=this.region);const E=new URL(`${this.url}/${t}`);w&&w!=="any"&&(y["x-region"]=w,E.searchParams.set("forceFunctionRegion",w));let R;p&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&p instanceof Blob||p instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",R=p):typeof p=="string"?(y["Content-Type"]="text/plain",R=p):typeof FormData<"u"&&p instanceof FormData?R=p:(y["Content-Type"]="application/json",R=JSON.stringify(p)):p&&typeof p!="string"&&!(typeof Blob<"u"&&p instanceof Blob)&&!(p instanceof ArrayBuffer)&&!(typeof FormData<"u"&&p instanceof FormData)?R=JSON.stringify(p):R=p;let N=g;v&&(o=new AbortController,r=setTimeout(()=>o.abort(),v),g?(N=o.signal,g.addEventListener("abort",()=>o.abort())):N=o.signal);const A=yield this.fetch(E.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),c),body:R,signal:N}).catch(j=>{throw new AP(j)}),I=A.headers.get("x-relay-error");if(I&&I==="true")throw new tM(A);if(!A.ok)throw new nM(A);let D=((s=A.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),U;return D==="application/json"?U=yield A.json():D==="application/octet-stream"||D==="application/pdf"?U=yield A.blob():D==="text/event-stream"?U=A:D==="multipart/form-data"?U=yield A.formData():U=yield A.text(),{data:U,error:null,response:A}}catch(c){return{data:null,error:c,response:c instanceof nM||c instanceof tM?c.context:void 0}}finally{r&&clearTimeout(r)}})}}var CP=class extends Error{constructor(n){super(n.message),this.name="PostgrestError",this.details=n.details,this.hint=n.hint,this.code=n.code}},RP=class{constructor(n){var e,t;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(e=n.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=n.signal,this.isMaybeSingle=(t=n.isMaybeSingle)!==null&&t!==void 0?t:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,e){return this.headers=new Headers(this.headers),this.headers.set(n,e),this}then(n,e){var t=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let s=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{let o=null,c=null,h=null,p=r.status,g=r.statusText;if(r.ok){var v,y;if(t.method!=="HEAD"){var w;const A=await r.text();A===""||(t.headers.get("Accept")==="text/csv"||t.headers.get("Accept")&&(!((w=t.headers.get("Accept"))===null||w===void 0)&&w.includes("application/vnd.pgrst.plan+text"))?c=A:c=JSON.parse(A))}const R=(v=t.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),N=(y=r.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");R&&N&&N.length>1&&(h=parseInt(N[1])),t.isMaybeSingle&&t.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,p=406,g="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var E;const R=await r.text();try{o=JSON.parse(R),Array.isArray(o)&&r.status===404&&(c=[],o=null,p=200,g="OK")}catch{r.status===404&&R===""?(p=204,g="No Content"):o={message:R}}if(o&&t.isMaybeSingle&&(!(o==null||(E=o.details)===null||E===void 0)&&E.includes("0 rows"))&&(o=null,p=200,g="OK"),o&&t.shouldThrowOnError)throw new CP(o)}return{error:o,data:c,count:h,status:p,statusText:g}});return this.shouldThrowOnError||(s=s.catch(r=>{var o;let c="";const h=r?.cause;if(h){var p,g,v,y;const E=(p=h?.message)!==null&&p!==void 0?p:"",R=(g=h?.code)!==null&&g!==void 0?g:"";c=`${(v=r?.name)!==null&&v!==void 0?v:"FetchError"}: ${r?.message}`,c+=`

Caused by: ${(y=h?.name)!==null&&y!==void 0?y:"Error"}: ${E}`,R&&(c+=` (${R})`),h?.stack&&(c+=`
${h.stack}`)}else{var w;c=(w=r?.stack)!==null&&w!==void 0?w:""}return{error:{message:`${(o=r?.name)!==null&&o!==void 0?o:"FetchError"}: ${r?.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(n,e)}returns(){return this}overrideTypes(){return this}},kP=class extends RP{select(n){let e=!1;const t=(n??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",t),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:e=!0,nullsFirst:t,foreignTable:i,referencedTable:s=i}={}){const r=s?`${s}.order`:"order",o=this.url.searchParams.get(r);return this.url.searchParams.set(r,`${o?`${o},`:""}${n}.${e?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:e,referencedTable:t=e}={}){const i=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(i,`${n}`),this}range(n,e,{foreignTable:t,referencedTable:i=t}={}){const s=typeof i>"u"?"offset":`${i}.offset`,r=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${n}`),this.url.searchParams.set(r,`${e-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:e=!1,settings:t=!1,buffers:i=!1,wal:s=!1,format:r="text"}={}){var o;const c=[n?"analyze":null,e?"verbose":null,t?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),h=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${r}; for="${h}"; options=${c};`),r==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}};const iM=new RegExp("[,()]");var sp=class extends kP{eq(n,e){return this.url.searchParams.append(n,`eq.${e}`),this}neq(n,e){return this.url.searchParams.append(n,`neq.${e}`),this}gt(n,e){return this.url.searchParams.append(n,`gt.${e}`),this}gte(n,e){return this.url.searchParams.append(n,`gte.${e}`),this}lt(n,e){return this.url.searchParams.append(n,`lt.${e}`),this}lte(n,e){return this.url.searchParams.append(n,`lte.${e}`),this}like(n,e){return this.url.searchParams.append(n,`like.${e}`),this}likeAllOf(n,e){return this.url.searchParams.append(n,`like(all).{${e.join(",")}}`),this}likeAnyOf(n,e){return this.url.searchParams.append(n,`like(any).{${e.join(",")}}`),this}ilike(n,e){return this.url.searchParams.append(n,`ilike.${e}`),this}ilikeAllOf(n,e){return this.url.searchParams.append(n,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(n,e){return this.url.searchParams.append(n,`ilike(any).{${e.join(",")}}`),this}regexMatch(n,e){return this.url.searchParams.append(n,`match.${e}`),this}regexIMatch(n,e){return this.url.searchParams.append(n,`imatch.${e}`),this}is(n,e){return this.url.searchParams.append(n,`is.${e}`),this}isDistinct(n,e){return this.url.searchParams.append(n,`isdistinct.${e}`),this}in(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&iM.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`in.(${t})`),this}notIn(n,e){const t=Array.from(new Set(e)).map(i=>typeof i=="string"&&iM.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(n,`not.in.(${t})`),this}contains(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cs.{${e.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(e)}`),this}containedBy(n,e){return typeof e=="string"?this.url.searchParams.append(n,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(n,`cd.{${e.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(e)}`),this}rangeGt(n,e){return this.url.searchParams.append(n,`sr.${e}`),this}rangeGte(n,e){return this.url.searchParams.append(n,`nxl.${e}`),this}rangeLt(n,e){return this.url.searchParams.append(n,`sl.${e}`),this}rangeLte(n,e){return this.url.searchParams.append(n,`nxr.${e}`),this}rangeAdjacent(n,e){return this.url.searchParams.append(n,`adj.${e}`),this}overlaps(n,e){return typeof e=="string"?this.url.searchParams.append(n,`ov.${e}`):this.url.searchParams.append(n,`ov.{${e.join(",")}}`),this}textSearch(n,e,{config:t,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const r=t===void 0?"":`(${t})`;return this.url.searchParams.append(n,`${s}fts${r}.${e}`),this}match(n){return Object.entries(n).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(n,e,t){return this.url.searchParams.append(n,`not.${e}.${t}`),this}or(n,{foreignTable:e,referencedTable:t=e}={}){const i=t?`${t}.or`:"or";return this.url.searchParams.append(i,`(${n})`),this}filter(n,e,t){return this.url.searchParams.append(n,`${e}.${t}`),this}},IP=class{constructor(n,{headers:e={},schema:t,fetch:i}){this.url=n,this.headers=new Headers(e),this.schema=t,this.fetch=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(n,e){const{head:t=!1,count:i}=e??{},s=t?"HEAD":"GET";let r=!1;const o=(n??"*").split("").map(p=>/\s/.test(p)&&!r?"":(p==='"'&&(r=!r),p)).join(""),{url:c,headers:h}=this.cloneRequestState();return c.searchParams.set("select",o),i&&h.append("Prefer",`count=${i}`),new sp({method:s,url:c,headers:h,schema:this.schema,fetch:this.fetch})}insert(n,{count:e,defaultToNull:t=!0}={}){var i;const s="POST",{url:r,headers:o}=this.cloneRequestState();if(e&&o.append("Prefer",`count=${e}`),t||o.append("Prefer","missing=default"),Array.isArray(n)){const c=n.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(c.length>0){const h=[...new Set(c)].map(p=>`"${p}"`);r.searchParams.set("columns",h.join(","))}}return new sp({method:s,url:r,headers:o,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(n,{onConflict:e,ignoreDuplicates:t=!1,count:i,defaultToNull:s=!0}={}){var r;const o="POST",{url:c,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${t?"ignore":"merge"}-duplicates`),e!==void 0&&c.searchParams.set("on_conflict",e),i&&h.append("Prefer",`count=${i}`),s||h.append("Prefer","missing=default"),Array.isArray(n)){const p=n.reduce((g,v)=>g.concat(Object.keys(v)),[]);if(p.length>0){const g=[...new Set(p)].map(v=>`"${v}"`);c.searchParams.set("columns",g.join(","))}}return new sp({method:o,url:c,headers:h,schema:this.schema,body:n,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}update(n,{count:e}={}){var t;const i="PATCH",{url:s,headers:r}=this.cloneRequestState();return e&&r.append("Prefer",`count=${e}`),new sp({method:i,url:s,headers:r,schema:this.schema,body:n,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}delete({count:n}={}){var e;const t="DELETE",{url:i,headers:s}=this.cloneRequestState();return n&&s.append("Prefer",`count=${n}`),new sp({method:t,url:i,headers:s,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},DP=class vR{constructor(e,{headers:t={},schema:i,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=i,this.fetch=s}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new IP(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new vR(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:i=!1,get:s=!1,count:r}={}){var o;let c;const h=new URL(`${this.url}/rpc/${e}`);let p;const g=w=>w!==null&&typeof w=="object"&&(!Array.isArray(w)||w.some(g)),v=i&&Object.values(t).some(g);v?(c="POST",p=t):i||s?(c=i?"HEAD":"GET",Object.entries(t).filter(([w,E])=>E!==void 0).map(([w,E])=>[w,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([w,E])=>{h.searchParams.append(w,E)})):(c="POST",p=t);const y=new Headers(this.headers);return v?y.set("Prefer",r?`count=${r},return=minimal`:"return=minimal"):r&&y.set("Prefer",`count=${r}`),new sp({method:c,url:h,headers:y,schema:this.schemaName,body:p,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class PP{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const i=t.versions;if(i&&i.node){const s=i.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const i=this.getWebSocketConstructor();return new i(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const UP="2.91.0",LP=`realtime-js/${UP}`,OP="1.0.0",yR="2.0.0",sM=yR,BS=1e4,zP=1e3,jP=100;var Au;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Au||(Au={}));var ps;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(ps||(ps={}));var Co;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Co||(Co={}));var VS;(function(n){n.websocket="websocket"})(VS||(VS={}));var Zd;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Zd||(Zd={}));class FP{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,i;const s=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,i;const s=(i=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&i!==void 0?i:{},o=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(e,t,i){var s,r;const o=e.topic,c=(s=e.ref)!==null&&s!==void 0?s:"",h=(r=e.join_ref)!==null&&r!==void 0?r:"",p=e.payload.event,g=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},v=Object.keys(g).length===0?"":JSON.stringify(g);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`userEvent length ${p.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`metadata length ${v.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+c.length+o.length+p.length+v.length,w=new ArrayBuffer(this.HEADER_LENGTH+y);let E=new DataView(w),R=0;E.setUint8(R++,this.KINDS.userBroadcastPush),E.setUint8(R++,h.length),E.setUint8(R++,c.length),E.setUint8(R++,o.length),E.setUint8(R++,p.length),E.setUint8(R++,v.length),E.setUint8(R++,t),Array.from(h,A=>E.setUint8(R++,A.charCodeAt(0))),Array.from(c,A=>E.setUint8(R++,A.charCodeAt(0))),Array.from(o,A=>E.setUint8(R++,A.charCodeAt(0))),Array.from(p,A=>E.setUint8(R++,A.charCodeAt(0))),Array.from(v,A=>E.setUint8(R++,A.charCodeAt(0)));var N=new Uint8Array(w.byteLength+i.byteLength);return N.set(new Uint8Array(w),0),N.set(new Uint8Array(i),w.byteLength),N.buffer}decode(e,t){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return t(i)}if(typeof e=="string"){const i=JSON.parse(e),[s,r,o,c,h]=i;return t({join_ref:s,ref:r,topic:o,event:c,payload:h})}return t({})}_binaryDecode(e){const t=new DataView(e),i=t.getUint8(0),s=new TextDecoder;if(i===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,i){const s=t.getUint8(1),r=t.getUint8(2),o=t.getUint8(3),c=t.getUint8(4);let h=this.HEADER_LENGTH+4;const p=i.decode(e.slice(h,h+s));h=h+s;const g=i.decode(e.slice(h,h+r));h=h+r;const v=i.decode(e.slice(h,h+o));h=h+o;const y=e.slice(h,e.byteLength),w=c===this.JSON_ENCODING?JSON.parse(i.decode(y)):y,E={type:this.BROADCAST_EVENT,event:g,payload:w};return o>0&&(E.meta=JSON.parse(v)),{join_ref:null,ref:null,topic:p,event:this.BROADCAST_EVENT,payload:E}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>t.includes(i)))}}let bR=class{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var ci;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(ci||(ci={}));const rM=(n,e,t={})=>{var i;const s=(i=t.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((r,o)=>(r[o]=BP(o,n,e,s),r),{}):{}},BP=(n,e,t,i)=>{const s=e.find(c=>c.name===n),r=s?.type,o=t[n];return r&&!i.includes(r)?_R(r,o):HS(o)},_R=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return qP(e,t)}switch(n){case ci.bool:return VP(e);case ci.float4:case ci.float8:case ci.int2:case ci.int4:case ci.int8:case ci.numeric:case ci.oid:return HP(e);case ci.json:case ci.jsonb:return GP(e);case ci.timestamp:return WP(e);case ci.abstime:case ci.date:case ci.daterange:case ci.int4range:case ci.int8range:case ci.money:case ci.reltime:case ci.text:case ci.time:case ci.timestamptz:case ci.timetz:case ci.tsrange:case ci.tstzrange:return HS(e);default:return HS(e)}},HS=n=>n,VP=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},HP=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},GP=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch{return n}return n},qP=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,i=n[t];if(n[0]==="{"&&i==="}"){let r;const o=n.slice(1,t);try{r=JSON.parse("["+o+"]")}catch{r=o?o.split(","):[]}return r.map(c=>_R(e,c))}return n},WP=n=>typeof n=="string"?n.replace(" ","T"):n,wR=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Ew{constructor(e,t,i={},s=BS){this.channel=e,this.event=t,this.payload=i,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var i;return this._hasReceived(e)&&t((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var aM;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(aM||(aM={}));class Lg{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},s=>{const{onJoin:r,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Lg.syncState(this.state,s,r,o),this.pendingDiffs.forEach(h=>{this.state=Lg.syncDiff(this.state,h,r,o)}),this.pendingDiffs=[],c()}),this.channel._on(i.diff,{},s=>{const{onJoin:r,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Lg.syncDiff(this.state,s,r,o),c())}),this.onJoin((s,r,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:r,newPresences:o})}),this.onLeave((s,r,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:r,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,i,s){const r=this.cloneDeep(e),o=this.transformState(t),c={},h={};return this.map(r,(p,g)=>{o[p]||(h[p]=g)}),this.map(o,(p,g)=>{const v=r[p];if(v){const y=g.map(N=>N.presence_ref),w=v.map(N=>N.presence_ref),E=g.filter(N=>w.indexOf(N.presence_ref)<0),R=v.filter(N=>y.indexOf(N.presence_ref)<0);E.length>0&&(c[p]=E),R.length>0&&(h[p]=R)}else c[p]=g}),this.syncDiff(r,{joins:c,leaves:h},i,s)}static syncDiff(e,t,i,s){const{joins:r,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return i||(i=()=>{}),s||(s=()=>{}),this.map(r,(c,h)=>{var p;const g=(p=e[c])!==null&&p!==void 0?p:[];if(e[c]=this.cloneDeep(h),g.length>0){const v=e[c].map(w=>w.presence_ref),y=g.filter(w=>v.indexOf(w.presence_ref)<0);e[c].unshift(...y)}i(c,g,h)}),this.map(o,(c,h)=>{let p=e[c];if(!p)return;const g=h.map(v=>v.presence_ref);p=p.filter(v=>g.indexOf(v.presence_ref)<0),e[c]=p,s(c,p,h),p.length===0&&delete e[c]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(i=>t(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,i)=>{const s=e[i];return"metas"in s?t[i]=s.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):t[i]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var oM;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(oM||(oM={}));var Og;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Og||(Og={}));var mc;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(mc||(mc={}));class lp{constructor(e,t={config:{}},i){var s,r;if(this.topic=e,this.params=t,this.socket=i,this.bindings={},this.state=ps.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ew(this,Co.join,this.params,this.timeout),this.rejoinTimer=new bR(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ps.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ps.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ps.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ps.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ps.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Co.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new Lg(this),this.broadcastEndpointURL=wR(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((r=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||r===void 0)&&r.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var i,s,r;if(this.socket.isConnected()||this.socket.connect(),this.state==ps.closed){const{config:{broadcast:o,presence:c,private:h}}=this.params,p=(s=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(w=>w.filter))!==null&&s!==void 0?s:[],g=!!this.bindings[Og.PRESENCE]&&this.bindings[Og.PRESENCE].length>0||((r=this.params.config.presence)===null||r===void 0?void 0:r.enabled)===!0,v={},y={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:g}),postgres_changes:p,private:h};this.socket.accessTokenValue&&(v.access_token=this.socket.accessTokenValue),this._onError(w=>e?.(mc.CHANNEL_ERROR,w)),this._onClose(()=>e?.(mc.CLOSED)),this.updateJoinPayload(Object.assign({config:y},v)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:w})=>{var E;if(this.socket._isManualToken()||this.socket.setAuth(),w===void 0){e?.(mc.SUBSCRIBED);return}else{const R=this.bindings.postgres_changes,N=(E=R?.length)!==null&&E!==void 0?E:0,A=[];for(let I=0;I<N;I++){const D=R[I],{filter:{event:U,schema:j,table:F,filter:z}}=D,W=w&&w[I];if(W&&W.event===U&&lp.isFilterValueEqual(W.schema,j)&&lp.isFilterValueEqual(W.table,F)&&lp.isFilterValueEqual(W.filter,z))A.push(Object.assign(Object.assign({},D),{id:W.id}));else{this.unsubscribe(),this.state=ps.errored,e?.(mc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,e&&e(mc.SUBSCRIBED);return}}).receive("error",w=>{this.state=ps.errored,e?.(mc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{e?.(mc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,i){return this.state===ps.joined&&e===Og.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,i)}async httpSend(e,t,i={}){var s;if(t==null)return Promise.reject("Payload is required for httpSend()");const r={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(r.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:r,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=i.timeout)!==null&&s!==void 0?s:this.timeout);if(c.status===202)return{success:!0};let h=c.statusText;try{const p=await c.json();h=p.error||p.message||h}catch{}return Promise.reject(new Error(h))}async send(e,t={}){var i,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:r,payload:o}=e,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:o,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(i=t.timeout)!==null&&i!==void 0?i:this.timeout);return await((s=p.body)===null||s===void 0?void 0:s.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var o,c,h;const p=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||h===void 0)&&h.ack)&&r("ok"),p.receive("ok",()=>r("ok")),p.receive("error",()=>r("error")),p.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ps.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Co.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(s=>{i=new Ew(this,Co.leave,{},e),i.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ps.closed,this.bindings={}}async _fetchWithTimeout(e,t,i){const s=new AbortController,r=setTimeout(()=>s.abort(),i),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(r),o}_push(e,t,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ew(this,e,t,i);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>jP){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,i){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,i){var s,r;const o=e.toLocaleLowerCase(),{close:c,error:h,leave:p,join:g}=Co;if(i&&[c,h,p,g].indexOf(o)>=0&&i!==this._joinRef())return;let y=this._onMessage(o,t,i);if(t&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(w=>{var E,R,N;return((E=w.filter)===null||E===void 0?void 0:E.event)==="*"||((N=(R=w.filter)===null||R===void 0?void 0:R.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===o}).map(w=>w.callback(y,i)):(r=this.bindings[o])===null||r===void 0||r.filter(w=>{var E,R,N,A,I,D,U,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in w){const F=w.id,z=(E=w.filter)===null||E===void 0?void 0:E.event;return F&&((R=t.ids)===null||R===void 0?void 0:R.includes(F))&&(z==="*"||z?.toLocaleLowerCase()===((N=t.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))&&(!(!((A=w.filter)===null||A===void 0)&&A.table)||w.filter.table===((I=t.data)===null||I===void 0?void 0:I.table))}else{const F=(U=(D=w?.filter)===null||D===void 0?void 0:D.event)===null||U===void 0?void 0:U.toLocaleLowerCase();return F==="*"||F===((j=t?.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===o}).map(w=>{if(typeof y=="object"&&"ids"in y){const E=y.data,{schema:R,table:N,commit_timestamp:A,type:I,errors:D}=E;y=Object.assign(Object.assign({},{schema:R,table:N,commit_timestamp:A,eventType:I,new:{},old:{},errors:D}),this._getPayloadRecords(E))}w.callback(y,i)})}_isClosed(){return this.state===ps.closed}_isJoined(){return this.state===ps.joined}_isJoining(){return this.state===ps.joining}_isLeaving(){return this.state===ps.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,i){const s=e.toLocaleLowerCase(),r={type:s,filter:t,callback:i};return this.bindings[s]?this.bindings[s].push(r):this.bindings[s]=[r],this}_off(e,t){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(s=>{var r;return!(((r=s.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===i&&lp.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(e[i]!==t[i])return!1;return!0}static isFilterValueEqual(e,t){return(e??void 0)===(t??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Co.close,{},e)}_onError(e){this._on(Co.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ps.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=rM(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=rM(e.columns,e.old_record)),t}}const Mw=()=>{},xv={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},$P=[1e3,2e3,5e3,1e4],XP=1e4,YP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class JP{constructor(e,t){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=BS,this.transport=null,this.heartbeatIntervalMs=xv.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Mw,this.ref=0,this.reconnectTimer=null,this.vsn=sM,this.logger=Mw,this.conn=null,this.sendBuffer=[],this.serializer=new FP,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=s=>s?(...r)=>s(...r):(...r)=>fetch(...r),!(!((i=t?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${VS.websocket}`,this.httpEndpoint=wR(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=PP.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,i){this.logger(e,t,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Au.connecting:return Zd.Connecting;case Au.open:return Zd.Open;case Au.closing:return Zd.Closing;default:return Zd.Closed}}isConnected(){return this.connectionState()===Zd.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const i=`realtime:${e}`,s=this.getChannels().find(r=>r.topic===i);if(s)return s;{const r=new lp(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:i,payload:s,ref:r}=e,o=()=>{this.encode(e,c=>{var h;(h=this.conn)===null||h===void 0||h.send(c)})};this.log("push",`${t} ${i} (${r})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(zP,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},xv.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply"&&t.ref&&t.ref===this.pendingHeartbeatRef){const p=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error",p)}catch(g){this.log("error","error in heartbeat callback",g)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:s,payload:r,ref:o}=t,c=o?`(${o})`:"",h=r.status||"";this.log("receive",`${h} ${i} ${s} ${c}`.trim(),r),this.channels.filter(p=>p._isMember(i)).forEach(p=>p._trigger(s,r,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Au.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Au.open||this.conn.readyState===Au.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this._terminateWorker()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Co.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const i=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${i}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const i=new Blob([YP],{type:"application/javascript"});t=URL.createObjectURL(i)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,i=!1;if(e)t=e,i=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),t=this.accessTokenValue}else t=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const r={access_token:t,version:LP};t&&s.updateJoinPayload(r),s.joinedOnce&&s._isJoined()&&s._push(Co.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new bR(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},xv.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,i,s,r,o,c,h,p,g,v,y,w;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:BS,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:xv.HEARTBEAT_INTERVAL,this.worker=(r=e?.worker)!==null&&r!==void 0?r:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=e?.heartbeatCallback)!==null&&c!==void 0?c:Mw,this.vsn=(h=e?.vsn)!==null&&h!==void 0?h:sM,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=e?.reconnectAfterMs)!==null&&p!==void 0?p:(E=>$P[E-1]||XP),this.vsn){case OP:this.encode=(g=e?.encode)!==null&&g!==void 0?g:((E,R)=>R(JSON.stringify(E))),this.decode=(v=e?.decode)!==null&&v!==void 0?v:((E,R)=>R(JSON.parse(E)));break;case yR:this.encode=(y=e?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(w=e?.decode)!==null&&w!==void 0?w:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Yg=class extends Error{constructor(n,e){super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function KP(n,e,t){const i=new URL(e,n);if(t)for(const[s,r]of Object.entries(t))r!==void 0&&i.searchParams.set(s,r);return i.toString()}async function ZP(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function QP(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:i,query:s,body:r,headers:o}){const c=KP(n.baseUrl,i,s),h=await ZP(n.auth),p=await e(c,{method:t,headers:{...r?{"Content-Type":"application/json"}:{},...h,...o},body:r?JSON.stringify(r):void 0}),g=await p.text(),v=(p.headers.get("content-type")||"").includes("application/json"),y=v&&g?JSON.parse(g):g;if(!p.ok){const w=v?y:void 0,E=w?.error;throw new Yg(E?.message??`Request failed with status ${p.status}`,{status:p.status,icebergType:E?.type,icebergCode:E?.code,details:w})}return{status:p.status,headers:p.headers,data:y}}}}function vv(n){return n.join("")}var eU=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:vv(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${vv(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${vv(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${vv(n.namespace)}`}),!0}catch(e){if(e instanceof Yg&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof Yg&&t.status===409)return;throw t}}};function Nf(n){return n.join("")}var tU=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Nf(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Nf(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Nf(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Nf(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Nf(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Nf(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof Yg&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof Yg&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},nU=class{constructor(n){let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=QP({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=n.accessDelegation?.join(","),this.namespaceOps=new eU(this.client,e),this.tableOps=new tU(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}},Gb=class extends Error{constructor(n){super(n),this.__isStorageError=!0,this.name="StorageError"}};function Ci(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var iU=class extends Gb{constructor(n,e,t){super(n),this.name="StorageApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},GS=class extends Gb{constructor(n,e){super(n),this.name="StorageUnknownError",this.originalError=e}};const z1=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),sU=()=>Response,qS=n=>{if(Array.isArray(n))return n.map(t=>qS(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,i])=>{const s=t.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));e[s]=qS(i)}),e},rU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},aU=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n);function Jg(n){"@babel/helpers - typeof";return Jg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jg(n)}function oU(n,e){if(Jg(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(Jg(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lU(n){var e=oU(n,"string");return Jg(e)=="symbol"?e:e+""}function cU(n,e,t){return(e=lU(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function lM(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function Wt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?lM(Object(t),!0).forEach(function(i){cU(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):lM(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const Aw=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},uU=async(n,e,t)=>{n instanceof await sU()&&!t?.noResolveJson?n.json().then(i=>{const s=n.status||500,r=i?.statusCode||s+"";e(new iU(Aw(i),s,r))}).catch(i=>{e(new GS(Aw(i),i))}):e(new GS(Aw(n),n))},dU=(n,e,t,i)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!i?s:(rU(i)?(s.headers=Wt({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(i)):s.body=i,e?.duplex&&(s.duplex=e.duplex),Wt(Wt({},s),t))};async function S0(n,e,t,i,s,r){return new Promise((o,c)=>{n(t,dU(e,i,s,r)).then(h=>{if(!h.ok)throw h;return i?.noResolveJson?h:h.json()}).then(h=>o(h)).catch(h=>uU(h,c,i))})}async function Kg(n,e,t,i){return S0(n,"GET",e,t,i)}async function No(n,e,t,i,s){return S0(n,"POST",e,i,s,t)}async function WS(n,e,t,i,s){return S0(n,"PUT",e,i,s,t)}async function hU(n,e,t,i){return S0(n,"HEAD",e,Wt(Wt({},t),{},{noResolveJson:!0}),i)}async function j1(n,e,t,i,s){return S0(n,"DELETE",e,i,s,t)}var fU=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e}then(n,e){return this.execute().then(n,e)}async execute(){var n=this;try{return{data:(await n.downloadFn()).body,error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Ci(e))return{data:null,error:e};throw e}}};let SR;SR=Symbol.toStringTag;var pU=class{constructor(n,e){this.downloadFn=n,this.shouldThrowOnError=e,this[SR]="BlobDownloadBuilder",this.promise=null}asStream(){return new fU(this.downloadFn,this.shouldThrowOnError)}then(n,e){return this.getPromise().then(n,e)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var n=this;try{return{data:await(await n.downloadFn()).blob(),error:null}}catch(e){if(n.shouldThrowOnError)throw e;if(Ci(e))return{data:null,error:e};throw e}}};const mU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cM={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var gU=class{constructor(n,e={},t,i){this.shouldThrowOnError=!1,this.url=n,this.headers=e,this.bucketId=t,this.fetch=z1(i)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(n,e,t,i){var s=this;try{let r;const o=Wt(Wt({},cM),i);let c=Wt(Wt({},s.headers),n==="POST"&&{"x-upsert":String(o.upsert)});const h=o.metadata;typeof Blob<"u"&&t instanceof Blob?(r=new FormData,r.append("cacheControl",o.cacheControl),h&&r.append("metadata",s.encodeMetadata(h)),r.append("",t)):typeof FormData<"u"&&t instanceof FormData?(r=t,r.has("cacheControl")||r.append("cacheControl",o.cacheControl),h&&!r.has("metadata")&&r.append("metadata",s.encodeMetadata(h))):(r=t,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,h&&(c["x-metadata"]=s.toBase64(s.encodeMetadata(h))),(typeof ReadableStream<"u"&&r instanceof ReadableStream||r&&typeof r=="object"&&"pipe"in r&&typeof r.pipe=="function")&&!o.duplex&&(o.duplex="half")),i?.headers&&(c=Wt(Wt({},c),i.headers));const p=s._removeEmptyFolders(e),g=s._getFinalPath(p),v=await(n=="PUT"?WS:No)(s.fetch,`${s.url}/object/${g}`,r,Wt({headers:c},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:p,id:v.Id,fullPath:v.Key},error:null}}catch(r){if(s.shouldThrowOnError)throw r;if(Ci(r))return{data:null,error:r};throw r}}async upload(n,e,t){return this.uploadOrUpdate("POST",n,e,t)}async uploadToSignedUrl(n,e,t,i){var s=this;const r=s._removeEmptyFolders(n),o=s._getFinalPath(r),c=new URL(s.url+`/object/upload/sign/${o}`);c.searchParams.set("token",e);try{let h;const p=Wt({upsert:cM.upsert},i),g=Wt(Wt({},s.headers),{"x-upsert":String(p.upsert)});return typeof Blob<"u"&&t instanceof Blob?(h=new FormData,h.append("cacheControl",p.cacheControl),h.append("",t)):typeof FormData<"u"&&t instanceof FormData?(h=t,h.append("cacheControl",p.cacheControl)):(h=t,g["cache-control"]=`max-age=${p.cacheControl}`,g["content-type"]=p.contentType),{data:{path:r,fullPath:(await WS(s.fetch,c.toString(),h,{headers:g})).Key},error:null}}catch(h){if(s.shouldThrowOnError)throw h;if(Ci(h))return{data:null,error:h};throw h}}async createSignedUploadUrl(n,e){var t=this;try{let i=t._getFinalPath(n);const s=Wt({},t.headers);e?.upsert&&(s["x-upsert"]="true");const r=await No(t.fetch,`${t.url}/object/upload/sign/${i}`,{},{headers:s}),o=new URL(t.url+r.url),c=o.searchParams.get("token");if(!c)throw new Gb("No token returned by API");return{data:{signedUrl:o.toString(),path:n,token:c},error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(Ci(i))return{data:null,error:i};throw i}}async update(n,e,t){return this.uploadOrUpdate("PUT",n,e,t)}async move(n,e,t){var i=this;try{return{data:await No(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:i.headers}),error:null}}catch(s){if(i.shouldThrowOnError)throw s;if(Ci(s))return{data:null,error:s};throw s}}async copy(n,e,t){var i=this;try{return{data:{path:(await No(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:n,destinationKey:e,destinationBucket:t?.destinationBucket},{headers:i.headers})).Key},error:null}}catch(s){if(i.shouldThrowOnError)throw s;if(Ci(s))return{data:null,error:s};throw s}}async createSignedUrl(n,e,t){var i=this;try{let s=i._getFinalPath(n),r=await No(i.fetch,`${i.url}/object/sign/${s}`,Wt({expiresIn:e},t?.transform?{transform:t.transform}:{}),{headers:i.headers});const o=t?.download?`&download=${t.download===!0?"":t.download}`:"";return r={signedUrl:encodeURI(`${i.url}${r.signedURL}${o}`)},{data:r,error:null}}catch(s){if(i.shouldThrowOnError)throw s;if(Ci(s))return{data:null,error:s};throw s}}async createSignedUrls(n,e,t){var i=this;try{const s=await No(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:n},{headers:i.headers}),r=t?.download?`&download=${t.download===!0?"":t.download}`:"";return{data:s.map(o=>Wt(Wt({},o),{},{signedUrl:o.signedURL?encodeURI(`${i.url}${o.signedURL}${r}`):null})),error:null}}catch(s){if(i.shouldThrowOnError)throw s;if(Ci(s))return{data:null,error:s};throw s}}download(n,e){const t=typeof e?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(e?.transform||{}),s=i?`?${i}`:"",r=this._getFinalPath(n),o=()=>Kg(this.fetch,`${this.url}/${t}/${r}${s}`,{headers:this.headers,noResolveJson:!0});return new pU(o,this.shouldThrowOnError)}async info(n){var e=this;const t=e._getFinalPath(n);try{return{data:qS(await Kg(e.fetch,`${e.url}/object/info/${t}`,{headers:e.headers})),error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(Ci(i))return{data:null,error:i};throw i}}async exists(n){var e=this;const t=e._getFinalPath(n);try{return await hU(e.fetch,`${e.url}/object/${t}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(Ci(i)&&i instanceof GS){const s=i.originalError;if([400,404].includes(s?.status))return{data:!1,error:i}}throw i}}getPublicUrl(n,e){const t=this._getFinalPath(n),i=[],s=e?.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&i.push(s);const r=typeof e?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(e?.transform||{});o!==""&&i.push(o);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${r}/public/${t}${c}`)}}}async remove(n){var e=this;try{return{data:await j1(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ci(t))return{data:null,error:t};throw t}}async list(n,e,t){var i=this;try{const s=Wt(Wt(Wt({},mU),e),{},{prefix:n||""});return{data:await No(i.fetch,`${i.url}/object/list/${i.bucketId}`,s,{headers:i.headers},t),error:null}}catch(s){if(i.shouldThrowOnError)throw s;if(Ci(s))return{data:null,error:s};throw s}}async listV2(n,e){var t=this;try{const i=Wt({},n);return{data:await No(t.fetch,`${t.url}/object/list-v2/${t.bucketId}`,i,{headers:t.headers},e),error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(Ci(i))return{data:null,error:i};throw i}}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const e=[];return n.width&&e.push(`width=${n.width}`),n.height&&e.push(`height=${n.height}`),n.resize&&e.push(`resize=${n.resize}`),n.format&&e.push(`format=${n.format}`),n.quality&&e.push(`quality=${n.quality}`),e.join("&")}};const TR="2.91.0",ER={"X-Client-Info":`storage-js/${TR}`};var xU=class{constructor(n,e={},t,i){this.shouldThrowOnError=!1;const s=new URL(n);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=Wt(Wt({},ER),e),this.fetch=z1(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(n){var e=this;try{const t=e.listBucketOptionsToQueryString(n);return{data:await Kg(e.fetch,`${e.url}/bucket${t}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ci(t))return{data:null,error:t};throw t}}async getBucket(n){var e=this;try{return{data:await Kg(e.fetch,`${e.url}/bucket/${n}`,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ci(t))return{data:null,error:t};throw t}}async createBucket(n,e={public:!1}){var t=this;try{return{data:await No(t.fetch,`${t.url}/bucket`,{id:n,name:n,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(Ci(i))return{data:null,error:i};throw i}}async updateBucket(n,e){var t=this;try{return{data:await WS(t.fetch,`${t.url}/bucket/${n}`,{id:n,name:n,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:t.headers}),error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(Ci(i))return{data:null,error:i};throw i}}async emptyBucket(n){var e=this;try{return{data:await No(e.fetch,`${e.url}/bucket/${n}/empty`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ci(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await j1(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ci(t))return{data:null,error:t};throw t}}listBucketOptionsToQueryString(n){const e={};return n&&("limit"in n&&(e.limit=String(n.limit)),"offset"in n&&(e.offset=String(n.offset)),n.search&&(e.search=n.search),n.sortColumn&&(e.sortColumn=n.sortColumn),n.sortOrder&&(e.sortOrder=n.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},vU=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Wt(Wt({},ER),e),this.fetch=z1(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var e=this;try{return{data:await No(e.fetch,`${e.url}/bucket`,{name:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ci(t))return{data:null,error:t};throw t}}async listBuckets(n){var e=this;try{const t=new URLSearchParams;n?.limit!==void 0&&t.set("limit",n.limit.toString()),n?.offset!==void 0&&t.set("offset",n.offset.toString()),n?.sortColumn&&t.set("sortColumn",n.sortColumn),n?.sortOrder&&t.set("sortOrder",n.sortOrder),n?.search&&t.set("search",n.search);const i=t.toString(),s=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return{data:await Kg(e.fetch,s,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ci(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await j1(e.fetch,`${e.url}/bucket/${n}`,{},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ci(t))return{data:null,error:t};throw t}}from(n){var e=this;if(!aU(n))throw new Gb("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const t=new nU({baseUrl:this.url,catalogName:n,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(t,{get(s,r){const o=s[r];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(s,c),error:null}}catch(h){if(i)throw h;return{data:null,error:h}}}}})}};const F1={"X-Client-Info":`storage-js/${TR}`,"Content-Type":"application/json"};var MR=class extends Error{constructor(n){super(n),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function pa(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}var Nw=class extends MR{constructor(n,e,t){super(n),this.name="StorageVectorsApiError",this.status=e,this.statusCode=t}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},yU=class extends MR{constructor(n,e){super(n),this.name="StorageVectorsUnknownError",this.originalError=e}};const B1=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),bU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},uM=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),_U=async(n,e,t)=>{if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const i=n.status||500,s=n;if(typeof s.json=="function")s.json().then(r=>{const o=r?.statusCode||r?.code||i+"";e(new Nw(uM(r),i,o))}).catch(()=>{const r=i+"";e(new Nw(s.statusText||`HTTP ${i} error`,i,r))});else{const r=i+"";e(new Nw(s.statusText||`HTTP ${i} error`,i,r))}}else e(new yU(uM(n),n))},wU=(n,e,t,i)=>{const s={method:n,headers:e?.headers||{}};return i?(bU(i)?(s.headers=Wt({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(i)):s.body=i,Wt(Wt({},s),t)):s};async function SU(n,e,t,i,s,r){return new Promise((o,c)=>{n(t,wU(e,i,s,r)).then(h=>{if(!h.ok)throw h;if(i?.noResolveJson)return h;const p=h.headers.get("content-type");return!p||!p.includes("application/json")?{}:h.json()}).then(h=>o(h)).catch(h=>_U(h,c,i))})}async function ma(n,e,t,i,s){return SU(n,"POST",e,i,s,t)}var TU=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Wt(Wt({},F1),e),this.fetch=B1(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(n){var e=this;try{return{data:await ma(e.fetch,`${e.url}/CreateIndex`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async getIndex(n,e){var t=this;try{return{data:await ma(t.fetch,`${t.url}/GetIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers}),error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(pa(i))return{data:null,error:i};throw i}}async listIndexes(n){var e=this;try{return{data:await ma(e.fetch,`${e.url}/ListIndexes`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async deleteIndex(n,e){var t=this;try{return{data:await ma(t.fetch,`${t.url}/DeleteIndex`,{vectorBucketName:n,indexName:e},{headers:t.headers})||{},error:null}}catch(i){if(t.shouldThrowOnError)throw i;if(pa(i))return{data:null,error:i};throw i}}},EU=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Wt(Wt({},F1),e),this.fetch=B1(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(n){var e=this;try{if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await ma(e.fetch,`${e.url}/PutVectors`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async getVectors(n){var e=this;try{return{data:await ma(e.fetch,`${e.url}/GetVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async listVectors(n){var e=this;try{if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return{data:await ma(e.fetch,`${e.url}/ListVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async queryVectors(n){var e=this;try{return{data:await ma(e.fetch,`${e.url}/QueryVectors`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async deleteVectors(n){var e=this;try{if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await ma(e.fetch,`${e.url}/DeleteVectors`,n,{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}},MU=class{constructor(n,e={},t){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Wt(Wt({},F1),e),this.fetch=B1(t)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(n){var e=this;try{return{data:await ma(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async getBucket(n){var e=this;try{return{data:await ma(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:n},{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async listBuckets(n={}){var e=this;try{return{data:await ma(e.fetch,`${e.url}/ListVectorBuckets`,n,{headers:e.headers}),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}async deleteBucket(n){var e=this;try{return{data:await ma(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:e.headers})||{},error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(pa(t))return{data:null,error:t};throw t}}},AU=class extends MU{constructor(n,e={}){super(n,e.headers||{},e.fetch)}from(n){return new NU(this.url,this.headers,n,this.fetch)}async createBucket(n){var e=()=>super.createBucket,t=this;return e().call(t,n)}async getBucket(n){var e=()=>super.getBucket,t=this;return e().call(t,n)}async listBuckets(n={}){var e=()=>super.listBuckets,t=this;return e().call(t,n)}async deleteBucket(n){var e=()=>super.deleteBucket,t=this;return e().call(t,n)}},NU=class extends TU{constructor(n,e,t,i){super(n,e,i),this.vectorBucketName=t}async createIndex(n){var e=()=>super.createIndex,t=this;return e().call(t,Wt(Wt({},n),{},{vectorBucketName:t.vectorBucketName}))}async listIndexes(n={}){var e=()=>super.listIndexes,t=this;return e().call(t,Wt(Wt({},n),{},{vectorBucketName:t.vectorBucketName}))}async getIndex(n){var e=()=>super.getIndex,t=this;return e().call(t,t.vectorBucketName,n)}async deleteIndex(n){var e=()=>super.deleteIndex,t=this;return e().call(t,t.vectorBucketName,n)}index(n){return new CU(this.url,this.headers,this.vectorBucketName,n,this.fetch)}},CU=class extends EU{constructor(n,e,t,i,s){super(n,e,s),this.vectorBucketName=t,this.indexName=i}async putVectors(n){var e=()=>super.putVectors,t=this;return e().call(t,Wt(Wt({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(n){var e=()=>super.getVectors,t=this;return e().call(t,Wt(Wt({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(n={}){var e=()=>super.listVectors,t=this;return e().call(t,Wt(Wt({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(n){var e=()=>super.queryVectors,t=this;return e().call(t,Wt(Wt({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(n){var e=()=>super.deleteVectors,t=this;return e().call(t,Wt(Wt({},n),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},RU=class extends xU{constructor(n,e={},t,i){super(n,e,t,i)}from(n){return new gU(this.url,this.headers,n,this.fetch)}get vectors(){return new AU(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new vU(this.url+"/iceberg",this.headers,this.fetch)}};const AR="2.91.0",rp=30*1e3,$S=3,Cw=$S*rp,kU="http://localhost:9999",IU="supabase.auth.token",DU={"X-Client-Info":`gotrue-js/${AR}`},XS="X-Supabase-Api-Version",NR={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},PU=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,UU=600*1e3;class Zg extends Error{constructor(e,t,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=i}}function It(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class LU extends Zg{constructor(e,t,i){super(e,t,i),this.name="AuthApiError",this.status=t,this.code=i}}function OU(n){return It(n)&&n.name==="AuthApiError"}class Qd extends Zg{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Tc extends Zg{constructor(e,t,i,s){super(e,i,s),this.name=t,this.status=i}}class fa extends Tc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function zU(n){return It(n)&&n.name==="AuthSessionMissingError"}class Cf extends Tc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class yv extends Tc{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class bv extends Tc{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function jU(n){return It(n)&&n.name==="AuthImplicitGrantRedirectError"}class dM extends Tc{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class FU extends Tc{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class YS extends Tc{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Rw(n){return It(n)&&n.name==="AuthRetryableFetchError"}class hM extends Tc{constructor(e,t,i){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=i}}class JS extends Tc{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fM=` 	
\r=`.split(""),BU=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<fM.length;e+=1)n[fM[e].charCodeAt(0)]=-2;for(let e=0;e<Cy.length;e+=1)n[Cy[e].charCodeAt(0)]=e;return n})();function pM(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Cy[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;t(Cy[i]),e.queuedBits-=6}}function CR(n,e,t){const i=BU[n];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function mM(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},i={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},r=o=>{GU(o,i,t)};for(let o=0;o<n.length;o+=1)CR(n.charCodeAt(o),s,r);return e.join("")}function VU(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function HU(n,e){for(let t=0;t<n.length;t+=1){let i=n.charCodeAt(t);if(i>55295&&i<=56319){const s=(i-55296)*1024&65535;i=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}VU(i,e)}}function GU(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function pp(n){const e=[],t={queue:0,queuedBits:0},i=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)CR(n.charCodeAt(s),t,i);return new Uint8Array(e)}function qU(n){const e=[];return HU(n,t=>e.push(t)),new Uint8Array(e)}function th(n){const e=[],t={queue:0,queuedBits:0},i=s=>{e.push(s)};return n.forEach(s=>pM(s,t,i)),pM(null,t,i),e.join("")}function WU(n){return Math.round(Date.now()/1e3)+n}function $U(){return Symbol("auth-callback")}const js=()=>typeof window<"u"&&typeof document<"u",Id={tested:!1,writable:!1},RR=()=>{if(!js())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Id.tested)return Id.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Id.tested=!0,Id.writable=!0}catch{Id.tested=!0,Id.writable=!1}return Id.writable};function XU(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,r)=>{e[r]=s})}catch{}return t.searchParams.forEach((i,s)=>{e[s]=i}),e}const kR=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),YU=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ap=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Dd=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},zs=async(n,e)=>{await n.removeItem(e)};class qb{constructor(){this.promise=new qb.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}qb.promiseConstructor=Promise;function kw(n){const e=n.split(".");if(e.length!==3)throw new JS("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!PU.test(e[i]))throw new JS("JWT not in base64url format");return{header:JSON.parse(mM(e[0])),payload:JSON.parse(mM(e[1])),signature:pp(e[2]),raw:{header:e[0],payload:e[1]}}}async function JU(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function KU(n,e){return new Promise((i,s)=>{(async()=>{for(let r=0;r<1/0;r++)try{const o=await n(r);if(!e(r,null,o)){i(o);return}}catch(o){if(!e(r,o)){s(o);return}}})()})}function ZU(n){return("0"+n.toString(16)).substr(-2)}function QU(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=t.length;let s="";for(let r=0;r<56;r++)s+=t.charAt(Math.floor(Math.random()*i));return s}return crypto.getRandomValues(e),Array.from(e,ZU).join("")}async function eL(n){const t=new TextEncoder().encode(n),i=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(i);return Array.from(s).map(r=>String.fromCharCode(r)).join("")}async function tL(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await eL(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Rf(n,e,t=!1){const i=QU();let s=i;t&&(s+="/PASSWORD_RECOVERY"),await ap(n,`${e}-code-verifier`,s);const r=await tL(i);return[r,i===r?"plain":"s256"]}const nL=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function iL(n){const e=n.headers.get(XS);if(!e||!e.match(nL))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function sL(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function rL(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const aL=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function kf(n){if(!aL.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Iw(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const i=t.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function oL(n,e){return new Proxy(n,{get:(t,i,s)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const r=i.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)"||r==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,i,s)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,i,s)}})}function gM(n){return JSON.parse(JSON.stringify(n))}const Xd=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),lL=[502,503,504];async function xM(n){var e;if(!YU(n))throw new YS(Xd(n),0);if(lL.includes(n.status))throw new YS(Xd(n),n.status);let t;try{t=await n.json()}catch(r){throw new Qd(Xd(r),r)}let i;const s=iL(n);if(s&&s.getTime()>=NR["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?i=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(i=t.error_code),i){if(i==="weak_password")throw new hM(Xd(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new fa}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((r,o)=>r&&typeof o=="string",!0))throw new hM(Xd(t),n.status,t.weak_password.reasons);throw new LU(Xd(t),n.status||500,i)}const cL=(n,e,t,i)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(i),Object.assign(Object.assign({},s),t))};async function qt(n,e,t,i){var s;const r=Object.assign({},i?.headers);r[XS]||(r[XS]=NR["2024-01-01"].name),i?.jwt&&(r.Authorization=`Bearer ${i.jwt}`);const o=(s=i?.query)!==null&&s!==void 0?s:{};i?.redirectTo&&(o.redirect_to=i.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",h=await uL(n,e,t+c,{headers:r,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(h):{data:Object.assign({},h),error:null}}async function uL(n,e,t,i,s,r){const o=cL(e,i,s,r);let c;try{c=await n(t,Object.assign({},o))}catch(h){throw console.error(h),new YS(Xd(h),0)}if(c.ok||await xM(c),i?.noResolveJson)return c;try{return await c.json()}catch(h){await xM(h)}}function Ao(n){var e;let t=null;fL(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=WU(n.expires_in)));const i=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:i},error:null}}function vM(n){const e=Ao(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,i)=>t&&typeof i=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Cu(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function dL(n){return{data:n,error:null}}function hL(n){const{action_link:e,email_otp:t,hashed_token:i,redirect_to:s,verification_type:r}=n,o=Hb(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:t,hashed_token:i,redirect_to:s,verification_type:r},h=Object.assign({},o);return{data:{properties:c,user:h},error:null}}function yM(n){return n}function fL(n){return n.access_token&&n.refresh_token&&n.expires_in}const Dw=["global","local","others"];class pL{constructor({url:e="",headers:t={},fetch:i}){this.url=e,this.headers=t,this.fetch=kR(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Dw[0]){if(Dw.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Dw.join(", ")}`);try{return await qt(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(It(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,t={}){try{return await qt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Cu})}catch(i){if(It(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:t}=e,i=Hb(e,["options"]),s=Object.assign(Object.assign({},i),t);return"newEmail"in i&&(s.new_email=i?.newEmail,delete s.newEmail),await qt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:hL,redirectTo:t?.redirectTo})}catch(t){if(It(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await qt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Cu})}catch(t){if(It(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,i,s,r,o,c,h;try{const p={nextPage:null,lastPage:0,total:0},g=await qt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(r=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:""},xform:yM});if(g.error)throw g.error;const v=await g.json(),y=(o=g.headers.get("x-total-count"))!==null&&o!==void 0?o:0,w=(h=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return w.length>0&&(w.forEach(E=>{const R=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(E.split(";")[1].split("=")[1]);p[`${N}Page`]=R}),p.total=parseInt(y)),{data:Object.assign(Object.assign({},v),p),error:null}}catch(p){if(It(p))return{data:{users:[]},error:p};throw p}}async getUserById(e){kf(e);try{return await qt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Cu})}catch(t){if(It(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){kf(e);try{return await qt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Cu})}catch(i){if(It(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,t=!1){kf(e);try{return await qt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Cu})}catch(i){if(It(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){kf(e.userId);try{const{data:t,error:i}=await qt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:i}}catch(t){if(It(t))return{data:null,error:t};throw t}}async _deleteFactor(e){kf(e.userId),kf(e.id);try{return{data:await qt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(It(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,i,s,r,o,c,h;try{const p={nextPage:null,lastPage:0,total:0},g=await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:"",per_page:(r=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:""},xform:yM});if(g.error)throw g.error;const v=await g.json(),y=(o=g.headers.get("x-total-count"))!==null&&o!==void 0?o:0,w=(h=(c=g.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return w.length>0&&(w.forEach(E=>{const R=parseInt(E.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(E.split(";")[1].split("=")[1]);p[`${N}Page`]=R}),p.total=parseInt(y)),{data:Object.assign(Object.assign({},v),p),error:null}}catch(p){if(It(p))return{data:{clients:[]},error:p};throw p}}async _createOAuthClient(e){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(It(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await qt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(It(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await qt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(It(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await qt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(It(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await qt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(It(t))return{data:null,error:t};throw t}}}function bM(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const If={debug:!!(globalThis&&RR()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class IR extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class mL extends IR{}async function gL(n,e,t){If.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),If.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async s=>{if(s){If.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{If.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw If.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new mL(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(If.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function xL(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function DR(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function vL(n){return parseInt(n,16)}function yL(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function bL(n){var e;const{chainId:t,domain:i,expirationTime:s,issuedAt:r=new Date,nonce:o,notBefore:c,requestId:h,resources:p,scheme:g,uri:v,version:y}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!v)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const w=DR(n.address),E=g?`${g}://${i}`:i,R=n.statement?`${n.statement}
`:"",N=`${E} wants you to sign in with your Ethereum account:
${w}

${R}`;let A=`URI: ${v}
Version: ${y}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${r.toISOString()}`;if(s&&(A+=`
Expiration Time: ${s.toISOString()}`),c&&(A+=`
Not Before: ${c.toISOString()}`),h&&(A+=`
Request ID: ${h}`),p){let I=`
Resources:`;for(const D of p){if(!D||typeof D!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${D}`);I+=`
- ${D}`}A+=I}return`${N}
${A}`}class as extends Error{constructor({message:e,code:t,cause:i,name:s}){var r;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(r=s??(i instanceof Error?i.name:void 0))!==null&&r!==void 0?r:"Unknown Error",this.code=t}}class Ry extends as{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function _L({error:n,options:e}){var t,i,s;const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new as({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=r.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new as({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((i=r.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new as({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=r.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new as({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new as({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new as({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return r.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new as({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new as({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(PR(o)){if(r.rp.id!==o)return new as({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new as({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new as({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new as({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new as({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function wL({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new as({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new as({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const i=window.location.hostname;if(PR(i)){if(t.rpId!==i)return new as({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new as({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new as({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new as({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class SL{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const TL=new SL;function EL(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:i}=n,s=Hb(n,["challenge","user","excludeCredentials"]),r=pp(e).buffer,o=Object.assign(Object.assign({},t),{id:pp(t.id).buffer}),c=Object.assign(Object.assign({},s),{challenge:r,user:o});if(i&&i.length>0){c.excludeCredentials=new Array(i.length);for(let h=0;h<i.length;h++){const p=i[h];c.excludeCredentials[h]=Object.assign(Object.assign({},p),{id:pp(p.id).buffer,type:p.type||"public-key",transports:p.transports})}}return c}function ML(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,i=Hb(n,["challenge","allowCredentials"]),s=pp(e).buffer,r=Object.assign(Object.assign({},i),{challenge:s});if(t&&t.length>0){r.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const c=t[o];r.allowCredentials[o]=Object.assign(Object.assign({},c),{id:pp(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return r}function AL(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:th(new Uint8Array(n.response.attestationObject)),clientDataJSON:th(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function NL(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,i=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:th(new Uint8Array(s.authenticatorData)),clientDataJSON:th(new Uint8Array(s.clientDataJSON)),signature:th(new Uint8Array(s.signature)),userHandle:s.userHandle?th(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function PR(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function _M(){var n,e;return!!(js()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function CL(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Ry("Browser returned unexpected credential type",e)}:{data:null,error:new Ry("Empty credential response",e)}}catch(e){return{data:null,error:_L({error:e,options:n})}}}async function RL(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Ry("Browser returned unexpected credential type",e)}:{data:null,error:new Ry("Empty credential response",e)}}catch(e){return{data:null,error:wL({error:e,options:n})}}}const kL={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},IL={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ky(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),i={};for(const s of n)if(s)for(const r in s){const o=s[r];if(o!==void 0)if(Array.isArray(o))i[r]=o;else if(t(o))i[r]=o;else if(e(o)){const c=i[r];e(c)?i[r]=ky(c,o):i[r]=ky(o)}else i[r]=o}return i}function DL(n,e){return ky(kL,n,e||{})}function PL(n,e){return ky(IL,n,e||{})}class UL{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:i,signal:s},r){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:c};const h=s??TL.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:p}=o.webauthn.credential_options.publicKey;p.name||(p.name=`${p.id}:${i}`),p.displayName||(p.displayName=p.name)}switch(o.webauthn.type){case"create":{const p=DL(o.webauthn.credential_options.publicKey,r?.create),{data:g,error:v}=await CL({publicKey:p,signal:h});return g?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:g}},error:null}:{data:null,error:v}}case"request":{const p=PL(o.webauthn.credential_options.publicKey,r?.request),{data:g,error:v}=await RL(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:p,signal:h}));return g?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:g}},error:null}:{data:null,error:v}}}}catch(o){return It(o)?{data:null,error:o}:{data:null,error:new Qd("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:i}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},r){if(!t)return{data:null,error:new Zg("rpId is required for WebAuthn authentication")};try{if(!_M())return{data:null,error:new Qd("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:i},signal:s},{request:r});if(!o)return{data:null,error:c};const{webauthn:h}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:h.type,rpId:t,rpOrigins:i,credential_response:h.credential_response}})}catch(o){return It(o)?{data:null,error:o}:{data:null,error:new Qd("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},r){if(!t)return{data:null,error:new Zg("rpId is required for WebAuthn registration")};try{if(!_M())return{data:null,error:new Qd("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(g=>{var v;return(v=g.data)===null||v===void 0?void 0:v.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:c};const{data:h,error:p}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:i},signal:s},{create:r});return h?this._verify({factorId:o.id,challengeId:h.challengeId,webauthn:{rpId:t,rpOrigins:i,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:p}}catch(o){return It(o)?{data:null,error:o}:{data:null,error:new Qd("Unexpected error in register",o)}}}}xL();const LL={url:kU,storageKey:IU,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DU,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function wM(n,e,t){return await t()}const Df={};class Qg{get jwks(){var e,t;return(t=(e=Df[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Df[this.storageKey]=Object.assign(Object.assign({},Df[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Df[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Df[this.storageKey]=Object.assign(Object.assign({},Df[this.storageKey]),{cachedAt:e})}constructor(e){var t,i,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},LL),e);if(this.storageKey=r.storageKey,this.instanceID=(t=Qg.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Qg.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.instanceID>0&&js()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new pL({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=kR(r.fetch),this.lock=r.lock||wM,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,this.lockAcquireTimeout=r.lockAcquireTimeout,r.lock?this.lock=r.lock:this.persistSession&&js()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=gL:this.lock=wM,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new UL(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:RR()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=bM(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=bM(this.memoryStorage)),js()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${AR}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},i="none";if(js()&&(t=XU(window.location.href),this._isImplicitGrantCallback(t)?i="implicit":await this._isPKCECallback(t)&&(i="pkce")),js()&&this.detectSessionInUrl&&i!=="none"){const{data:s,error:r}=await this._getSessionFromURL(t,i);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),jU(r)){const h=(e=r.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:r}}return{error:r}}const{session:o,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return It(t)?this._returnResult({error:t}):this._returnResult({error:new Qd("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,i,s;try{const r=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Ao}),{data:o,error:c}=r;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const h=o.session,p=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:p,session:h},error:null})}catch(r){if(It(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signUp(e){var t,i,s;try{let r;if("email"in e){const{email:g,password:v,options:y}=e;let w=null,E=null;this.flowType==="pkce"&&([w,E]=await Rf(this.storage,this.storageKey)),r=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:g,password:v,data:(t=y?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:w,code_challenge_method:E},xform:Ao})}else if("phone"in e){const{phone:g,password:v,options:y}=e;r=await qt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:v,data:(i=y?.data)!==null&&i!==void 0?i:{},channel:(s=y?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Ao})}else throw new yv("You must provide either an email or phone number and a password");const{data:o,error:c}=r;if(c||!o)return await zs(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const h=o.session,p=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:p,session:h},error:null})}catch(r){if(await zs(this.storage,`${this.storageKey}-code-verifier`),It(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:o,options:c}=e;t=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:vM})}else if("phone"in e){const{phone:r,password:o,options:c}=e;t=await qt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:vM})}else throw new yv("You must provide either an email or phone number and a password");const{data:i,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!i||!i.session||!i.user){const r=new Cf;return this._returnResult({data:{user:null,session:null},error:r})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:s})}catch(t){if(It(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,i,s,r;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,i,s,r,o,c,h,p,g,v,y;let w,E;if("message"in e)w=e.message,E=e.signature;else{const{chain:R,wallet:N,statement:A,options:I}=e;let D;if(js())if(typeof N=="object")D=N;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")D=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!I?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");D=N}const U=new URL((t=I?.url)!==null&&t!==void 0?t:window.location.href),j=await D.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!j||j.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const F=DR(j[0]);let z=(i=I?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!z){const L=await D.request({method:"eth_chainId"});z=vL(L)}const W={domain:U.host,address:F,statement:A,uri:U.href,version:"1",chainId:z,nonce:(s=I?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(r=I?.signInWithEthereum)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=I?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(h=I?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(p=I?.signInWithEthereum)===null||p===void 0?void 0:p.requestId,resources:(g=I?.signInWithEthereum)===null||g===void 0?void 0:g.resources};w=bL(W),E=await D.request({method:"personal_sign",params:[yL(w),F]})}try{const{data:R,error:N}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:w,signature:E},!((v=e.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Ao});if(N)throw N;if(!R||!R.session||!R.user){const A=new Cf;return this._returnResult({data:{user:null,session:null},error:A})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:N})}catch(R){if(It(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async signInWithSolana(e){var t,i,s,r,o,c,h,p,g,v,y,w;let E,R;if("message"in e)E=e.message,R=e.signature;else{const{chain:N,wallet:A,statement:I,options:D}=e;let U;if(js())if(typeof A=="object")U=A;else{const F=window;if("solana"in F&&typeof F.solana=="object"&&("signIn"in F.solana&&typeof F.solana.signIn=="function"||"signMessage"in F.solana&&typeof F.solana.signMessage=="function"))U=F.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof A!="object"||!D?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");U=A}const j=new URL((t=D?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in U&&U.signIn){const F=await U.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},D?.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),I?{statement:I}:null));let z;if(Array.isArray(F)&&F[0]&&typeof F[0]=="object")z=F[0];else if(F&&typeof F=="object"&&"signedMessage"in F&&"signature"in F)z=F;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in z&&"signature"in z&&(typeof z.signedMessage=="string"||z.signedMessage instanceof Uint8Array)&&z.signature instanceof Uint8Array)E=typeof z.signedMessage=="string"?z.signedMessage:new TextDecoder().decode(z.signedMessage),R=z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in U)||typeof U.signMessage!="function"||!("publicKey"in U)||typeof U!="object"||!U.publicKey||!("toBase58"in U.publicKey)||typeof U.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");E=[`${j.host} wants you to sign in with your Solana account:`,U.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(s=(i=D?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((r=D?.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${D.signInWithSolana.notBefore}`]:[],...!((o=D?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${D.signInWithSolana.expirationTime}`]:[],...!((c=D?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${D.signInWithSolana.chainId}`]:[],...!((h=D?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${D.signInWithSolana.nonce}`]:[],...!((p=D?.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${D.signInWithSolana.requestId}`]:[],...!((v=(g=D?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||v===void 0)&&v.length?["Resources",...D.signInWithSolana.resources.map(z=>`- ${z}`)]:[]].join(`
`);const F=await U.signMessage(new TextEncoder().encode(E),"utf8");if(!F||!(F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");R=F}}try{const{data:N,error:A}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:E,signature:th(R)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:Ao});if(A)throw A;if(!N||!N.session||!N.user){const I=new Cf;return this._returnResult({data:{user:null,session:null},error:I})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:A})}catch(N){if(It(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(e){const t=await Dd(this.storage,`${this.storageKey}-code-verifier`),[i,s]=(t??"").split("/");try{if(!i&&this.flowType==="pkce")throw new FU;const{data:r,error:o}=await qt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:Ao});if(await zs(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!r||!r.session||!r.user){const c=new Cf;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return r.session&&(await this._saveSession(r.session),setTimeout(async()=>{await this._notifyAllSubscribers("SIGNED_IN",r.session)},0)),this._returnResult({data:Object.assign(Object.assign({},r),{redirectType:s??null}),error:o})}catch(r){if(await zs(this.storage,`${this.storageKey}-code-verifier`),It(r))return this._returnResult({data:{user:null,session:null,redirectType:null},error:r});throw r}}async signInWithIdToken(e){try{const{options:t,provider:i,token:s,access_token:r,nonce:o}=e,c=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:s,access_token:r,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Ao}),{data:h,error:p}=c;if(p)return this._returnResult({data:{user:null,session:null},error:p});if(!h||!h.session||!h.user){const g=new Cf;return this._returnResult({data:{user:null,session:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:p})}catch(t){if(It(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,i,s,r,o;try{if("email"in e){const{email:c,options:h}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await Rf(this.storage,this.storageKey));const{error:v}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(t=h?.data)!==null&&t!==void 0?t:{},create_user:(i=h?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:p,code_challenge_method:g},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:v})}if("phone"in e){const{phone:c,options:h}=e,{data:p,error:g}=await qt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=h?.data)!==null&&s!==void 0?s:{},create_user:(r=h?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(o=h?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:p?.message_id},error:g})}throw new yv("You must provide either an email or phone number.")}catch(c){if(await zs(this.storage,`${this.storageKey}-code-verifier`),It(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(e){var t,i;try{let s,r;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,r=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:o,error:c}=await qt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:s,xform:Ao});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const h=o.session,p=o.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:p,session:h},error:null})}catch(s){if(It(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,i,s,r,o;try{let c=null,h=null;this.flowType==="pkce"&&([c,h]=await Rf(this.storage,this.storageKey));const p=await qt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&i!==void 0?i:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:h}),headers:this.headers,xform:dL});return!((r=p.data)===null||r===void 0)&&r.url&&js()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(p.data.url),this._returnResult(p)}catch(c){if(await zs(this.storage,`${this.storageKey}-code-verifier`),It(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;if(i)throw i;if(!t)throw new fa;const{error:s}=await qt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(It(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:i,type:s,options:r}=e,{error:o}=await qt(this.fetch,"POST",t,{headers:this.headers,body:{email:i,type:s,gotrue_meta_security:{captcha_token:r?.captchaToken}},redirectTo:r?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:i,type:s,options:r}=e,{data:o,error:c}=await qt(this.fetch,"POST",t,{headers:this.headers,body:{phone:i,type:s,gotrue_meta_security:{captcha_token:r?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:c})}throw new yv("You must provide either an email or phone number and a type")}catch(t){if(It(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await i,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=t();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Dd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<Cw:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const o=await Dd(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Iw()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=oL(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{session:null},error:r}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Cu}):await this._useSession(async t=>{var i,s,r;const{data:o,error:c}=t;if(c)throw c;return!(!((i=o.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new fa}:await qt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0,xform:Cu})})}catch(t){if(It(t))return zU(t)&&(await this._removeSession(),await zs(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async i=>{const{data:s,error:r}=i;if(r)throw r;if(!s.session)throw new fa;const o=s.session;let c=null,h=null;this.flowType==="pkce"&&e.email!=null&&([c,h]=await Rf(this.storage,this.storageKey));const{data:p,error:g}=await qt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:h}),jwt:o.access_token,xform:Cu});if(g)throw g;return o.user=p.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(i){if(await zs(this.storage,`${this.storageKey}-code-verifier`),It(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new fa;const t=Date.now()/1e3;let i=t,s=!0,r=null;const{payload:o}=kw(e.access_token);if(o.exp&&(i=o.exp,s=i<=t),s){const{data:c,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!c)return{data:{user:null,session:null},error:null};r=c}else{const{data:c,error:h}=await this._getUser(e.access_token);if(h)throw h;r={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:i-t,expires_at:i},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return this._returnResult({data:{user:r.user,session:r},error:null})}catch(t){if(It(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var i;if(!e){const{data:o,error:c}=t;if(c)throw c;e=(i=o.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new fa;const{data:s,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{user:null,session:null},error:r}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(It(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!js())throw new bv("No browser detected.");if(e.error||e.error_description||e.error_code)throw new bv(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new dM("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new bv("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new dM("No code detected.");const{data:I,error:D}=await this._exchangeCodeForSession(e.code);if(D)throw D;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:s,access_token:r,refresh_token:o,expires_in:c,expires_at:h,token_type:p}=e;if(!r||!c||!o||!p)throw new bv("No session defined in URL");const g=Math.round(Date.now()/1e3),v=parseInt(c);let y=g+v;h&&(y=parseInt(h));const w=y-g;w*1e3<=rp&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${v}s`);const E=y-v;g-E>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",E,y,g):g-E<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",E,y,g);const{data:R,error:N}=await this._getUser(r);if(N)throw N;const A={provider_token:i,provider_refresh_token:s,access_token:r,expires_in:v,expires_at:y,refresh_token:o,token_type:p,user:R.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:A,redirectType:e.type},error:null})}catch(i){if(It(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Dd(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var i;const{data:s,error:r}=t;if(r)return this._returnResult({error:r});const o=(i=s.session)===null||i===void 0?void 0:i.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(OU(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return e!=="others"&&(await this._removeSession(),await zs(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=$U(),i={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async t=>{var i,s;try{const{data:{session:r},error:o}=t;if(o)throw o;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,t={}){let i=null,s=null;this.flowType==="pkce"&&([i,s]=await Rf(this.storage,this.storageKey,!0));try{return await qt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(await zs(this.storage,`${this.storageKey}-code-verifier`),It(r))return this._returnResult({data:null,error:r});throw r}}async getUserIdentities(){var e;try{const{data:t,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:i,error:s}=await this._useSession(async r=>{var o,c,h,p,g;const{data:v,error:y}=r;if(y)throw y;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await qt(this.fetch,"GET",w,{headers:this.headers,jwt:(g=(p=v.session)===null||p===void 0?void 0:p.access_token)!==null&&g!==void 0?g:void 0})});if(s)throw s;return js()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(i?.url),this._returnResult({data:{provider:e.provider,url:i?.url},error:null})}catch(i){if(It(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var i;try{const{error:s,data:{session:r}}=t;if(s)throw s;const{options:o,provider:c,token:h,access_token:p,nonce:g}=e,v=await qt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=r?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:c,id_token:h,access_token:p,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Ao}),{data:y,error:w}=v;return w?this._returnResult({data:{user:null,session:null},error:w}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new Cf}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:w}))}catch(s){if(await zs(this.storage,`${this.storageKey}-code-verifier`),It(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var i,s;const{data:r,error:o}=t;if(o)throw o;return await qt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(i=r.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const i=Date.now();return await KU(async s=>(s>0&&await JU(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await qt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ao})),(s,r)=>{const o=200*Math.pow(2,s);return r&&Rw(r)&&Date.now()+o-i<rp})}catch(i){if(this._debug(t,"error",i),It(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),js()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,t;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const s=await Dd(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Dd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await ap(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:Iw()}else if(s&&!s.user&&!s.user){const o=await Dd(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await zs(this.storage,this.storageKey+"-user"),await ap(this.storage,this.storageKey,s)):s.user=Iw()}if(this._debug(i,"session from storage",s),!this._isValidSession(s)){this._debug(i,"session is not valid"),s!==null&&await this._removeSession();return}const r=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Cw;if(this._debug(i,`session has${r?"":" not"} expired with margin of ${Cw}s`),r){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Rw(o)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(s.access_token);!c&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(i,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(i,"error",s),console.error(s);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var t,i;if(!e)throw new fa;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new qb;const{data:r,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!r.session)throw new fa;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const c={data:r.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(r){if(this._debug(s,"error",r),It(r)){const o={data:null,error:r};return Rw(r)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(r),r}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,i=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,t)}catch(h){r.push(h)}});if(await Promise.all(o),r.length>0){for(let c=0;c<r.length;c+=1)console.error(r[c]);throw r[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await zs(this.storage,`${this.storageKey}-code-verifier`);const t=Object.assign({},e),i=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&t.user&&await ap(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const r=gM(s);await ap(this.storage,this.storageKey,r)}else{const s=gM(t);await ap(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await zs(this.storage,this.storageKey),await zs(this.storage,this.storageKey+"-code-verifier"),await zs(this.storage,this.storageKey+"-user"),this.userStorage&&await zs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&js()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rp);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:i}}=t;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((i.expires_at*1e3-e)/rp);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${rp}ms, refresh threshold is ${$S} ticks`),s<=$S&&await this._callRefreshToken(i.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof IR)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!js()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,i){const s=[`provider=${encodeURIComponent(t)}`];if(i?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&s.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[r,o]=await Rf(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(c.toString())}if(i?.queryParams){const r=new URLSearchParams(i.queryParams);s.push(r.toString())}return i?.skipBrowserRedirect&&s.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var i;const{data:s,error:r}=t;return r?this._returnResult({data:null,error:r}):await qt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token})})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var i,s;const{data:r,error:o}=t;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:p}=await qt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(i=r?.session)===null||i===void 0?void 0:i.access_token});return p?this._returnResult({data:null,error:p}):(e.factorType==="totp"&&h.type==="totp"&&(!((s=h?.totp)===null||s===void 0)&&s.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:s,error:r}=t;if(r)return this._returnResult({data:null,error:r});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?AL(e.webauthn.credential_response):NL(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:h}=await qt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:h}))})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var i;const{data:s,error:r}=t;if(r)return this._returnResult({data:null,error:r});const o=await qt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=s?.session)===null||i===void 0?void 0:i.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:EL(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:ML(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:i}=await this.getUser();if(i)return{data:null,error:i};const s={all:[],phone:[],totp:[],webauthn:[]};for(const r of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(r),r.status==="verified"&&s[r.factor_type].push(r);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:i},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:r}=kw(i.access_token);let o=null;r.aal&&(o=r.aal);let c=o;((t=(e=i.user.factors)===null||e===void 0?void 0:e.filter(g=>g.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(c="aal2");const p=r.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:i},error:s}=t;return s?this._returnResult({data:null,error:s}):i?await qt(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:r=>({data:r,error:null})}):this._returnResult({data:null,error:new fa})})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:s},error:r}=i;if(r)return this._returnResult({data:null,error:r});if(!s)return this._returnResult({data:null,error:new fa});const o=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&js()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(i){if(It(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,t){try{return await this._useSession(async i=>{const{data:{session:s},error:r}=i;if(r)return this._returnResult({data:null,error:r});if(!s)return this._returnResult({data:null,error:new fa});const o=await qt(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&js()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(i){if(It(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:i}=e;return i?this._returnResult({data:null,error:i}):t?await qt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new fa})})}catch(e){if(It(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:i},error:s}=t;return s?this._returnResult({data:null,error:s}):i?(await qt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new fa})})}catch(t){if(It(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let i=t.keys.find(c=>c.kid===e);if(i)return i;const s=Date.now();if(i=this.jwks.keys.find(c=>c.kid===e),i&&this.jwks_cached_at+UU>s)return i;const{data:r,error:o}=await qt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=s,i=r.keys.find(c=>c.kid===e),!i)?null:i}async getClaims(e,t={}){try{let i=e;if(!i){const{data:w,error:E}=await this.getSession();if(E||!w.session)return this._returnResult({data:null,error:E});i=w.session.access_token}const{header:s,payload:r,signature:o,raw:{header:c,payload:h}}=kw(i);t?.allowExpired||sL(r.exp);const p=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!p){const{error:w}=await this.getUser(i);if(w)throw w;return{data:{claims:r,header:s,signature:o},error:null}}const g=rL(s.alg),v=await crypto.subtle.importKey("jwk",p,g,!0,["verify"]);if(!await crypto.subtle.verify(g,v,o,qU(`${c}.${h}`)))throw new JS("Invalid JWT signature");return{data:{claims:r,header:s,signature:o},error:null}}catch(i){if(It(i))return this._returnResult({data:null,error:i});throw i}}}Qg.nextInstanceID={};const OL=Qg,zL="2.91.0";let Rg="";typeof Deno<"u"?Rg="deno":typeof document<"u"?Rg="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Rg="react-native":Rg="node";const jL={"X-Client-Info":`supabase-js-${Rg}/${zL}`},FL={headers:jL},BL={schema:"public"},VL={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},HL={};function e0(n){"@babel/helpers - typeof";return e0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e0(n)}function GL(n,e){if(e0(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(e0(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function qL(n){var e=GL(n,"string");return e0(e)=="symbol"?e:e+""}function WL(n,e,t){return(e=qL(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function SM(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,i)}return t}function Fi(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?SM(Object(t),!0).forEach(function(i){WL(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):SM(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}const $L=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),XL=()=>Headers,YL=(n,e,t)=>{const i=$L(t),s=XL();return async(r,o)=>{var c;const h=(c=await e())!==null&&c!==void 0?c:n;let p=new s(o?.headers);return p.has("apikey")||p.set("apikey",n),p.has("Authorization")||p.set("Authorization",`Bearer ${h}`),i(r,Fi(Fi({},o),{},{headers:p}))}};function JL(n){return n.endsWith("/")?n:n+"/"}function KL(n,e){var t,i;const{db:s,auth:r,realtime:o,global:c}=n,{db:h,auth:p,realtime:g,global:v}=e,y={db:Fi(Fi({},h),s),auth:Fi(Fi({},p),r),realtime:Fi(Fi({},g),o),storage:{},global:Fi(Fi(Fi({},v),c),{},{headers:Fi(Fi({},(t=v?.headers)!==null&&t!==void 0?t:{}),(i=c?.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return n.accessToken?y.accessToken=n.accessToken:delete y.accessToken,y}function ZL(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(JL(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var QL=class extends OL{constructor(n){super(n)}},e4=class{constructor(n,e,t){var i,s;this.supabaseUrl=n,this.supabaseKey=e;const r=ZL(n);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",r),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",r),this.storageUrl=new URL("storage/v1",r),this.functionsUrl=new URL("functions/v1",r);const o=`sb-${r.hostname.split(".")[0]}-auth-token`,c={db:BL,realtime:HL,auth:Fi(Fi({},VL),{},{storageKey:o}),global:FL},h=KL(t??{},c);if(this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}});else{var p;this.auth=this._initSupabaseAuthClient((p=h.auth)!==null&&p!==void 0?p:{},this.headers,h.global.fetch)}this.fetch=YL(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Fi({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new DP(new URL("rest/v1",r).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new RU(this.storageUrl.href,this.headers,this.fetch,t?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new NP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,e={},t={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,e,t)}channel(n,e={config:{}}){return this.realtime.channel(n,e)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n=this,e,t;if(n.accessToken)return await n.accessToken();const{data:i}=await n.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:n.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:s,storageKey:r,flowType:o,lock:c,debug:h,throwOnError:p},g,v){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new QL({url:this.authUrl.href,headers:Fi(Fi({},y),g),storageKey:r,autoRefreshToken:n,persistSession:e,detectSessionInUrl:t,storage:i,userStorage:s,flowType:o,lock:c,debug:h,throwOnError:p,fetch:v,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new JP(this.realtimeUrl.href,Fi(Fi({},n),{},{params:Fi(Fi({},{apikey:this.supabaseKey}),n?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,e)=>{this._handleTokenChanged(n,"CLIENT",e?.access_token)})}_handleTokenChanged(n,e,t){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==t?(this.changedAccessToken=t,this.realtime.setAuth(t)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const t4=(n,e,t)=>new e4(n,e,t);function n4(){if(typeof window<"u")return!1;const n=globalThis.process;if(!n)return!1;const e=n.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}n4()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const i4="https://tkvogxqtylddfzzsgmtv.supabase.co",s4="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRrdm9neHF0eWxkZGZ6enNnbXR2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgxNTQ5MTIsImV4cCI6MjA4MzczMDkxMn0.3WKSkeFCj8BmZwBBdnMFUwJRzzp8KP42k1HmoiBZce4",Ji=t4(i4,s4),r4=({setPage:n})=>{const[e,t]=ue.useState(!1),[i,s]=ue.useState(!1);ue.useEffect(()=>{localStorage.getItem("cookie-consent-v4")||t(!0)},[]);const r=async()=>{localStorage.setItem("cookie-consent-v4","all"),t(!1);const{data:{session:c}}=await Ji.auth.getSession();c?.user&&await Ji.from("cookie_consents").upsert({user_id:c.user.id,consent_level:"all",updated_at:new Date().toISOString()})},o=async()=>{localStorage.setItem("cookie-consent-v4","necessary"),t(!1);const{data:{session:c}}=await Ji.auth.getSession();c?.user&&await Ji.from("cookie_consents").upsert({user_id:c.user.id,consent_level:"necessary",updated_at:new Date().toISOString()})};return e?d.jsx("div",{className:"fixed bottom-6 left-6 right-6 z-[100] animate-in slide-in-from-bottom-10 fade-in duration-700",children:d.jsxs("div",{className:"glass bg-slate-900/90 backdrop-blur-2xl border border-white/10 rounded-[2rem] p-4 md:p-6 shadow-[0_20px_60px_rgba(0,0,0,0.6)] max-w-5xl mx-auto overflow-hidden",children:[d.jsxs("div",{className:"flex flex-col gap-4",children:[d.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 lg:items-center",children:[d.jsxs("div",{className:"flex-grow space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-3 text-orange-400",children:[d.jsx(Sl,{size:24,className:"animate-pulse"}),d.jsx("h2",{className:"text-lg md:text-xl font-bold text-white tracking-tight",children:"Vi vrnar om din integritet"})]}),d.jsx("div",{className:"space-y-2 text-slate-300 text-xs md:text-sm leading-relaxed font-light max-w-2xl",children:d.jsx("p",{children:"Vi anvnder cookies fr att ge dig en s trygg och fungerande upplevelse som mjligt. Vissa krvs fr grundfunktionen, medan andra hjlper oss att frbttra vra verktyg fr dig."})}),d.jsxs("div",{className:"flex flex-wrap gap-4 pt-1",children:[d.jsx("button",{onClick:()=>n(De.COOKIE_POLICY),className:"text-xs font-bold text-slate-400 hover:text-orange-400 underline transition-colors uppercase tracking-widest",children:"Ls vr policy"}),d.jsxs("button",{onClick:()=>s(!i),className:"flex items-center gap-1 text-xs font-bold text-slate-400 hover:text-orange-400 underline transition-colors uppercase tracking-widest",children:[i?d.jsx(cR,{size:14}):d.jsx(My,{size:14})," ",i?"Dlj instllningar":"Instllningar"]})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row lg:flex-col gap-2 min-w-[180px]",children:[d.jsx("button",{onClick:r,className:"px-6 py-3 bg-orange-500 hover:bg-orange-400 text-slate-950 rounded-xl font-black transition-all hover:scale-105 shadow-xl shadow-orange-500/20 text-xs md:text-sm",children:"Godknn alla"}),d.jsx("button",{onClick:o,className:"px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 text-white rounded-xl font-bold transition-all text-xs md:text-sm",children:"Endast ndvndiga"})]})]}),i&&d.jsxs("div",{className:"pt-8 border-t border-white/10 grid md:grid-cols-2 gap-6 animate-in slide-in-from-top-4 duration-500",children:[d.jsxs("div",{className:"glass bg-white/5 p-6 rounded-2xl border border-white/5 space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2 text-white font-bold",children:[d.jsx(Fb,{size:16,className:"text-blue-400"})," Ndvndiga"]}),d.jsx("span",{className:"text-[10px] uppercase tracking-widest text-slate-500 font-black",children:"Alltid aktiva"})]}),d.jsx("p",{className:"text-xs text-slate-400 leading-relaxed font-light",children:'Dessa r sidans "autonoma nervsystem". Krvs fr grundlggande funktioner som skerhet och sessioner.'})]}),d.jsxs("div",{className:"glass bg-white/5 p-6 rounded-2xl border border-white/5 space-y-3 opacity-60",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2 text-white font-bold",children:[d.jsx(hR,{size:16,className:"text-orange-400"})," Analys & Statistik"]}),d.jsx("div",{className:"w-10 h-5 bg-slate-800 rounded-full relative",children:d.jsx("div",{className:"absolute right-1 top-1 bottom-1 w-3 bg-slate-600 rounded-full"})})]}),d.jsx("p",{className:"text-xs text-slate-400 leading-relaxed font-light",children:"Hjlper oss att frst hur sidan anvnds s vi kan frbttra upplevelsen. (Privacy by default: inaktiverat tills du godknner)."})]})]})]}),d.jsx("button",{onClick:()=>t(!1),className:"absolute top-6 right-6 text-slate-500 hover:text-white transition-colors","aria-label":"Stng",children:d.jsx(Bu,{size:20})})]})}):null},V1=()=>{const[n,e]=ue.useState(""),[t,i]=ue.useState(""),[s,r]=ue.useState(!1),[o,c]=ue.useState("idle"),h=p=>{p.preventDefault(),r(!0),setTimeout(()=>{r(!1),c("success"),e(""),i(""),setTimeout(()=>c("idle"),6e3)},1200)};return d.jsxs("section",{className:"relative w-screen left-1/2 right-1/2 -ml-[50vw] -mr-[50vw] my-12 overflow-hidden",children:[d.jsx("div",{className:"absolute inset-0 bg-white/[0.03] backdrop-blur-2xl border-y border-white/10"}),d.jsx("div",{className:"absolute top-0 inset-x-0 h-px bg-gradient-to-r from-transparent via-white/20 to-transparent"}),d.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-amber-500/5 blur-[120px] pointer-events-none opacity-20"}),d.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto py-10 px-6 md:px-12 flex flex-col lg:flex-row items-center justify-between gap-8 lg:gap-16",children:[d.jsxs("div",{className:"newsletter-text text-center lg:text-left space-y-2 lg:max-w-md",children:[d.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-0.5 bg-amber-500/10 rounded-full border border-amber-500/20 text-amber-500 text-[10px] font-bold uppercase tracking-widest mb-1",children:[d.jsx(w0,{size:12})," Nyhetsbrev"]}),d.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-white leading-tight",children:"Prenumerera p vrt nyhetsbrev"}),d.jsx("p",{className:"text-zinc-400 text-sm font-medium leading-relaxed",children:"Reflektioner om trauma och utveckling  direkt till din inkorg."})]}),d.jsxs("div",{className:"w-full lg:max-w-2xl",children:[o==="success"?d.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 py-4 px-8 rounded-2xl text-center animate-fade-in flex items-center justify-center gap-4",children:[d.jsx("div",{className:"w-10 h-10 bg-emerald-500 text-black rounded-full flex items-center justify-center shadow-lg",children:d.jsx(YD,{size:20,strokeWidth:3})}),d.jsx("span",{className:"text-emerald-400 font-bold",children:"Tack! Vi har lagt till dig p listan."})]}):d.jsxs("form",{className:"flex flex-col sm:flex-row gap-3 w-full",onSubmit:h,children:[d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1",children:[d.jsx("input",{type:"text",placeholder:"Ditt namn",value:t,onChange:p=>i(p.target.value),className:"flex-1 p-4 bg-black/40 border border-white/10 rounded-xl text-white placeholder-zinc-600 outline-none focus:border-amber-500 transition-all text-sm",required:!0}),d.jsx("input",{type:"email",placeholder:"Din e-postadress",value:n,onChange:p=>e(p.target.value),className:"flex-[1.2] p-4 bg-black/40 border border-white/10 rounded-xl text-white placeholder-zinc-600 outline-none focus:border-amber-500 transition-all text-sm",required:!0})]}),d.jsx("button",{type:"submit",disabled:s,className:"px-8 py-4 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-xl cursor-pointer font-bold text-sm transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:s?d.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):d.jsxs(d.Fragment,{children:["Prenumerera ",d.jsx(Ml,{size:16})]})})]}),d.jsxs("p",{className:"mt-4 text-[10px] text-zinc-500 text-center lg:text-left flex items-center justify-center lg:justify-start gap-2 italic",children:[d.jsx(va,{size:10,className:"text-amber-500"})," Din integritet r viktig. Vi hanterar dina uppgifter med strsta omsorg."]})]})]})]})},H1=({isOpen:n,onClose:e,pdfUrl:t,title:i})=>n?d.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 sm:p-6 animate-in fade-in duration-200",children:[d.jsx("div",{className:"absolute inset-0 bg-slate-950/80 backdrop-blur-sm",onClick:e}),d.jsxs("div",{className:"relative w-full max-w-5xl h-[85vh] bg-slate-900 border border-slate-700 rounded-2xl shadow-2xl flex flex-col animate-in zoom-in-95 duration-300",children:[d.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-700 bg-slate-800/50 rounded-t-2xl",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"bg-orange-500/10 p-2 rounded-lg text-orange-500",children:d.jsx(jb,{size:20})}),d.jsx("h3",{className:"font-bold text-white text-lg",children:i})]}),d.jsx("button",{onClick:e,className:"p-2 hover:bg-slate-700 rounded-full text-slate-400 hover:text-white transition-colors",children:d.jsx(Bu,{size:20})})]}),d.jsx("div",{className:"flex-1 bg-slate-800 relative",children:d.jsx("iframe",{src:`${t}#toolbar=0&view=FitH`,className:"w-full h-full border-none rounded-b-2xl",title:i})})]})]}):null,Wa=({src:n,alt:e,className:t="",imgClassName:i="object-cover",defaultRotation:s="-2deg",grayscale:r=!0,blur:o="0px",hoverBlur:c="0px"})=>{const[h,p]=ue.useState(!1);return d.jsxs("div",{className:`relative overflow-hidden rounded-2xl shadow-xl transition-all duration-500 ease-out cursor-pointer z-10 hover:z-20 ${t}`,style:{transform:`rotate(${h?"0deg":s}) scale(${h?1.05:1})`,boxShadow:h?"0 20px 40px rgba(0,0,0,0.3)":"0 10px 20px rgba(0,0,0,0.1)",filter:`blur(${h?c:o})`},onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[d.jsx("img",{src:n,alt:e,className:`w-full h-full transition-all duration-700 ${i} ${r?h?"grayscale-0":"grayscale":""}`}),d.jsx("div",{className:`absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent transition-opacity duration-500 ${h?"opacity-100":"opacity-0"}`})]})},UR=()=>d.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[d.jsxs("div",{className:"text-center space-y-4 mb-12",children:[d.jsx("h2",{className:"text-4xl font-bold text-white tracking-tight",children:"Kontakt & Bokning"}),d.jsx("p",{className:"text-slate-400 max-w-2xl mx-auto text-lg leading-relaxed",children:"Inom Horizonten har vi tillgng till legitimerade terapeuter och experter. Boka ett samtal fr att f professionell vgledning och std fr din situation."})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"group bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden hover:border-orange-500/30 transition-all hover:shadow-[0_0_40px_-10px_rgba(249,115,22,0.15)] flex flex-col",children:[d.jsxs("div",{className:"relative h-80 overflow-hidden bg-slate-800",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent z-10 opacity-60"}),d.jsx("img",{src:"/assets/minerva_profil.jpg",alt:"Minerva Kassab",className:"w-full h-full object-cover object-top opacity-60 grayscale group-hover:grayscale-0 transition-all duration-1000 group-hover:scale-105"})]}),d.jsxs("div",{className:"p-6 flex-grow flex flex-col",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:"Minerva Kassab"}),d.jsxs("p",{className:"text-orange-400 font-medium flex items-center gap-2",children:[d.jsx(Kd,{size:16}),"Psykolog!"]})]}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed mb-6 flex-grow",children:"Erbjuder stdjande samtal och terapi med fokus p personlig utveckling och relationshantering."}),d.jsxs("button",{onClick:()=>window.location.href="mailto:minerva@klattertradet.se,billy@klattertradet.se?subject=Bokningsfrfrgan via Horizonten",className:"w-full bg-slate-800 hover:bg-orange-500 hover:text-slate-900 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2 group/btn",children:[d.jsx($a,{size:18}),d.jsx("span",{children:"Boka Samtal"})]})]})]}),d.jsxs("div",{className:"group bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden hover:border-orange-500/30 transition-all hover:shadow-[0_0_40px_-10px_rgba(249,115,22,0.15)] flex flex-col",children:[d.jsxs("div",{className:"relative h-80 overflow-hidden",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent z-10 opacity-60"}),d.jsx("img",{src:"/assets/linda-matta-new.jpeg",alt:"Linda Matta",className:"w-full h-full object-cover object-top opacity-60 grayscale group-hover:grayscale-0 transition-all duration-1000 group-hover:scale-105"}),d.jsx("div",{className:"absolute bottom-4 left-4 z-20",children:d.jsx("span",{className:"inline-block px-3 py-1 bg-orange-500 text-slate-950 text-xs font-bold uppercase tracking-wider rounded-full mb-2",children:"Tillgnglig"})})]}),d.jsxs("div",{className:"p-6 flex-grow flex flex-col",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:"Linda Matta"}),d.jsxs("p",{className:"text-orange-400 font-medium flex items-center gap-2",children:[d.jsx(Kd,{size:16}),"Samtalsterapeut & Hudterapeut"]})]}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed mb-6 flex-grow",children:"Linda erbjuder en unik helhetssyn dr det inre och yttre vlmendet mts. Som samtalsterapeut ger hon std i livets utmaningar, och som hudterapeut frstr hon vikten av att ta hand om sig sjlv fysiskt fr att m bra psykiskt."}),d.jsx("div",{className:"space-y-3 mb-8 text-sm text-slate-300"}),d.jsxs("button",{onClick:()=>window.location.href="mailto:linda@klattertradet.se,billy@klattertradet.se?subject=Bokningsfrfrgan via Horizonten",className:"w-full bg-slate-800 hover:bg-orange-500 hover:text-slate-900 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2 group/btn",children:[d.jsx($a,{size:18}),d.jsx("span",{children:"Boka Samtal"})]})]})]}),d.jsxs("div",{className:"group bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden hover:border-orange-500/30 transition-all hover:shadow-[0_0_40px_-10px_rgba(249,115,22,0.15)] flex flex-col",children:[d.jsxs("div",{className:"relative h-80 overflow-hidden bg-slate-800",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent z-10 opacity-60"}),d.jsx("img",{src:"/assets/billy_profil.jpeg",alt:"Billy Ljungberg",className:"w-full h-full object-cover object-top opacity-60 grayscale group-hover:grayscale-0 transition-all duration-1000 group-hover:scale-105"}),d.jsx("div",{className:"absolute bottom-4 left-4 z-20",children:d.jsx("span",{className:"inline-block px-3 py-1 bg-green-500 text-slate-950 text-xs font-bold uppercase tracking-wider rounded-full mb-2",children:"Grundare"})})]}),d.jsxs("div",{className:"p-6 flex-grow flex flex-col",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:"Billy Ljungberg"}),d.jsxs("p",{className:"text-orange-400 font-medium flex items-center gap-2",children:[d.jsx(Kd,{size:16}),"Gestaltterapeut / Beroendeterapeut"]})]}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed mb-6 flex-grow",children:"Grundare av Klttertrdet. Specialiserad p traumamedveten omsorg, beroendeproblematik och processledning."}),d.jsxs("button",{onClick:()=>window.location.href="mailto:billy@klattertradet.se?subject=Bokningsfrfrgan via Horizonten",className:"w-full bg-slate-800 hover:bg-orange-500 hover:text-slate-900 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2 group/btn",children:[d.jsx($a,{size:18}),d.jsx("span",{children:"Boka Samtal"})]})]})]}),d.jsxs("div",{className:"group bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden hover:border-orange-500/30 transition-all hover:shadow-[0_0_40px_-10px_rgba(249,115,22,0.15)] flex flex-col",children:[d.jsxs("div",{className:"relative h-80 overflow-hidden bg-slate-800",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent z-10 opacity-60"}),d.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-700",children:d.jsx(Vs,{size:64})})]}),d.jsxs("div",{className:"p-6 flex-grow flex flex-col",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:"Mattias O Sandin"}),d.jsxs("p",{className:"text-orange-400 font-medium flex items-center gap-2",children:[d.jsx(Kd,{size:16}),"Samtalsterapeut"]})]}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed mb-6 flex-grow",children:"Erfaren terapeut som mter dig dr du r. Fokus p trygghet, insikt och frndring."}),d.jsxs("button",{onClick:()=>window.location.href="mailto:mattias@klattertradet.se,billy@klattertradet.se?subject=Bokningsfrfrgan via Horizonten",className:"w-full bg-slate-800 hover:bg-orange-500 hover:text-slate-900 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2 group/btn",children:[d.jsx($a,{size:18}),d.jsx("span",{children:"Boka Samtal"})]})]})]}),d.jsxs("div",{className:"group bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden hover:border-orange-500/30 transition-all hover:shadow-[0_0_40px_-10px_rgba(249,115,22,0.15)] flex flex-col",children:[d.jsxs("div",{className:"relative h-80 overflow-hidden bg-slate-800",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent z-10 opacity-60"}),d.jsx("img",{src:"/assets/malin-widerlov.png",alt:"Malin Widerlv",className:"w-full h-full object-cover object-top opacity-60 grayscale group-hover:grayscale-0 transition-all duration-1000 group-hover:scale-105"})]}),d.jsxs("div",{className:"p-6 flex-grow flex flex-col",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:"Malin Widerlv"}),d.jsxs("p",{className:"text-orange-400 font-medium flex items-center gap-2",children:[d.jsx(Kd,{size:16}),"Behandlingspedagog & Socialarbetare"]})]}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed mb-6 flex-grow",children:"Specialiserad p familjefrgor och socialt std. Malin fungerar ven som familjeombud och stttar i komplexa livssituationer."}),d.jsxs("button",{onClick:()=>window.location.href="mailto:malin@klattertradet.se,billy@klattertradet.se?subject=Bokningsfrfrgan via Horizonten",className:"w-full bg-slate-800 hover:bg-orange-500 hover:text-slate-900 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2 group/btn",children:[d.jsx($a,{size:18}),d.jsx("span",{children:"Boka Samtal"})]})]})]})]})]}),TM=({setPage:n})=>{const[e,t]=ue.useState(!1),[i,s]=ue.useState(0),[r,o]=ue.useState(!1),c=[{title:"Ett grundlggande attributionsfel",description:"Varfr dmer vi andra hrdare n oss sjlva? En genomgng av hur vra hjrnor snedvrider verkligheten i sociala relationer.",pdfUrl:"/Attributionsfel-narcissism.pdf"},{title:"Polarisering och personlighetsstrningar",description:"En djupanalys av hur dmande och polarisering pverkar vra relationer och vr sjlvbild i ett kliniskt sammanhang.",pdfUrl:"/Polarisering-av-personlighetsstrningar .pdf"}],h=ue.useCallback(()=>{r||(o(!0),setTimeout(()=>{s(g=>(g+1)%c.length),o(!1)},500))},[r,c.length]),p=ue.useCallback(()=>{r||(o(!0),setTimeout(()=>{s(g=>(g-1+c.length)%c.length),o(!1)},500))},[r,c.length]);return ue.useEffect(()=>{if(e)return;const g=setInterval(h,7e3);return()=>clearInterval(g)},[h,e]),d.jsxs("div",{className:"max-w-[1600px] mx-auto px-4 md:px-8 py-2 md:py-4 animate-fade-in w-full space-y-12",children:[d.jsx(H1,{isOpen:e,onClose:()=>t(!1),pdfUrl:c[i].pdfUrl,title:c[i].title}),d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-6 md:py-6 md:px-14 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-amber-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 grid md:grid-cols-2 gap-10 items-center",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsxs("h1",{className:"text-2xl md:text-4xl lg:text-6xl font-black leading-[0.95] drop-shadow-lg tracking-tight max-w-[12ch]",children:["Klttertrdet ",d.jsx("br",{}),d.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-white via-amber-200 to-zinc-500",children:"& Horizonten"})]}),d.jsx("p",{className:"text-base md:text-lg text-white/90 leading-relaxed max-w-md font-light",children:"Specialistutbildning, terapi och handledning med fokus p traumamedvetenhet och personlig mognad. Vlkommen till vr gemenskap."}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-2",children:[d.jsxs("button",{onClick:()=>n(De.CHAT),className:"px-6 md:px-8 py-2.5 bg-white text-slate-900 hover:bg-white/90 rounded-xl font-bold transition-all hover:scale-105 flex items-center gap-2 shadow-xl shadow-white/10",children:["Vra Utbildningar ",d.jsx(Fs,{size:18})]}),d.jsxs("button",{onClick:()=>n(De.CONTACT),className:"px-6 md:px-8 py-2.5 bg-white/10 hover:bg-white/20 border border-white/20 rounded-xl font-bold transition-all hover:scale-105 flex items-center gap-2",children:["Boka tid ",d.jsx($a,{size:18})]})]})]}),d.jsx("div",{className:"hidden md:flex justify-center items-center",children:d.jsx("div",{className:"relative w-56 h-64 p-4",children:d.jsx(Wa,{src:"/logo2.png",alt:"Klttertrdet Logo",className:"w-full h-full",imgClassName:"object-contain p-4",defaultRotation:"-8deg",grayscale:!1})})})]})]}),d.jsxs("div",{className:"max-w-5xl mx-auto w-full space-y-3 animate-in slide-in-from-bottom-6 duration-700 relative group/carousel",children:[d.jsx("div",{className:"flex justify-between items-center px-2",children:d.jsxs("h2",{className:"text-xl md:text-2xl font-black text-white italic tracking-tight flex items-center gap-2",children:[d.jsx(Xg,{className:"text-orange-500",size:20}),"Nytt frn oss"]})}),d.jsxs("div",{className:"relative group/carousel",children:[d.jsx("button",{onClick:g=>{g.stopPropagation(),p()},className:"absolute -left-2 top-[92%] -translate-y-1/2 z-20 px-6 py-2 bg-white/5 hover:bg-white/10 border border-white/20 rounded-2xl text-white transition-all backdrop-blur-2xl opacity-0 group-hover/carousel:opacity-100 hover:scale-105 shadow-[0_0_30px_rgba(255,255,255,0.1)] group-hover/carousel:-translate-x-2",children:d.jsx(lR,{size:20})}),d.jsx("button",{onClick:g=>{g.stopPropagation(),h()},className:"absolute -right-2 top-[92%] -translate-y-1/2 z-20 px-6 py-2 bg-white/5 hover:bg-white/10 border border-white/20 rounded-2xl text-white transition-all backdrop-blur-2xl opacity-0 group-hover/carousel:opacity-100 hover:scale-105 shadow-[0_0_30px_rgba(255,255,255,0.1)] group-hover/carousel:translate-x-2",children:d.jsx(ch,{size:20})}),d.jsxs("div",{onClick:()=>t(!0),className:`bg-gradient-to-br from-slate-900 to-slate-800 border border-orange-500/30 p-4 md:p-6 rounded-[1.5rem] group hover:border-orange-500 transition-all duration-500 cursor-pointer shadow-[0_20px_60px_rgba(0,0,0,0.4)] relative overflow-hidden ${r?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:[d.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-[15%] p-4 opacity-20 group-hover:opacity-40 transition-opacity blur-[2px]",children:d.jsx("img",{src:"/logo2.png",alt:"Klttertrdet Logo",className:"w-20 h-20 md:w-28 md:h-28 object-contain rotate-12"})}),d.jsxs("div",{className:"relative z-10",children:[d.jsx("span",{className:"text-[10px] bg-orange-500/20 text-orange-400 px-3 py-1 rounded-full font-black uppercase tracking-[0.2em] mb-2 inline-block",children:"Veckans Djupdykning"}),d.jsx("h4",{className:"text-xl md:text-2xl font-black text-white mb-1 group-hover:text-orange-400 transition-colors tracking-tight",children:c[i].title}),d.jsx("p",{className:"text-slate-400 text-xs md:text-sm mb-3 max-w-2xl font-light leading-relaxed line-clamp-1 md:line-clamp-none",children:c[i].description}),d.jsxs("div",{className:"flex items-center gap-2 text-orange-400 text-[10px] md:text-xs font-black group-hover:gap-3 transition-all",children:["Ls de nya blogginlggen ",d.jsx(ch,{size:16})]})]})]})]}),d.jsx("div",{className:"flex justify-center gap-3",children:c.map((g,v)=>d.jsx("button",{onClick:()=>s(v),className:`h-1.5 transition-all rounded-full ${i===v?"w-8 bg-orange-500 shadow-[0_0_10px_rgba(249,115,22,0.5)]":"w-1.5 bg-white/20"}`},v))})]}),d.jsxs("div",{className:"max-w-5xl mx-auto w-full glass bg-white/5 border border-white/10 rounded-[2.5rem] p-6 md:p-10 flex flex-col md:flex-row items-center gap-10 group hover:border-amber-500/20 transition-all min-h-[280px]",children:[d.jsx("div",{className:"md:w-1/4 flex justify-center",children:d.jsx(Wa,{src:"/booklet.jpeg",alt:"Myndighetsinducerat trauma bok",className:"w-40 h-56",defaultRotation:"-3deg",grayscale:!1})}),d.jsxs("div",{className:"md:w-3/4 space-y-4",children:[d.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white leading-tight",children:"Vr nya bok: Myndighetsinducerat trauma"}),d.jsx("p",{className:"text-zinc-400 text-sm md:text-base leading-relaxed",children:"En unik djupdykning i systemets pverkan p individen och vgen mot lkning. Innehller praktiska verktyg och fallstudier fr bde drabbade och professionella."}),d.jsxs("button",{onClick:()=>n(De.BOOK),className:"flex items-center gap-2 text-amber-500 font-bold hover:underline transition-all group-hover:translate-x-2 text-sm md:text-base",children:["Ls mer om boken ",d.jsx(Fs,{size:20})]})]})]}),d.jsx("div",{className:"max-w-5xl mx-auto w-full glass bg-gradient-to-r from-amber-500/20 to-orange-600/20 border border-white/10 rounded-[2.5rem] p-6 md:p-10 relative overflow-hidden group min-h-[320px] flex items-center justify-center",children:d.jsxs("div",{className:"relative z-10 max-w-2xl text-center space-y-4",children:[d.jsx("div",{className:"inline-block px-3 py-1 bg-amber-500/20 rounded-full border border-amber-500/30 text-amber-500 text-[10px] font-black uppercase tracking-widest",children:"Aktuell Specialistutbildning"}),d.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white leading-tight",children:"Myndighetsinducerat Trauma (MiT)"}),d.jsx("p",{className:"text-sm md:text-base text-amber-100/80 leading-relaxed",children:"Vr nya specialistutbildning ger dig verktygen att frst, bemta och sttta klienter som farit illa av systemet och myndighetsutvning."}),d.jsxs("button",{onClick:()=>n(De.CHAT),className:"flex items-center gap-2 px-6 py-3 bg-amber-500 hover:bg-amber-400 text-slate-950 rounded-xl font-black transition-all hover:scale-105 shadow-2xl shadow-amber-500/20 text-sm md:text-base",children:["Ls mer om MiT ",d.jsx(Fs,{size:20})]})]})}),d.jsx("div",{className:"grid md:grid-cols-3 gap-4 md:gap-6",children:[{src:"/hemsida-bild2.jpeg",title:"Empati",text:"Vi mter dig dr du r, utan dmande, med fokus p din unika livssituation.",rot:"-2deg"},{src:"/hemsida-bild3.jpeg",title:"Trygghet",text:"En trygg bas r frutsttningen fr all form av lkning och utveckling.",rot:"1deg"},{src:"/hemsida-bild4.jpeg",title:"Insikt",text:"Genom 'Hr, Nu och Hur' skapar vi medvetenhet som leder till verklig frndring.",rot:"-1deg"}].map((g,v)=>d.jsxs("div",{className:"glass bg-white/5 border border-white/10 p-5 md:p-6 rounded-3xl hover:bg-white/10 transition-colors group flex flex-col items-center text-center",children:[d.jsx(Wa,{src:g.src,alt:g.title,className:"w-32 h-32 mb-4",defaultRotation:g.rot}),d.jsx("h3",{className:"text-base md:text-lg font-bold text-white mb-1.5 md:mb-2",children:g.title}),d.jsx("p",{className:"text-zinc-400 leading-relaxed text-[11px] md:text-xs",children:g.text})]},v))}),d.jsxs("div",{className:"space-y-6 md:space-y-8",children:[d.jsxs("div",{className:"text-center space-y-1",children:[d.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white",children:"Vra Tjnster"}),d.jsx("p",{className:"text-zinc-400 text-xs md:text-sm max-w-2xl mx-auto",children:"Vi erbjuder ett brett spektrum av tjnster fr bde individer och professionella."})]}),d.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[d.jsxs("div",{className:"glass bg-gradient-to-br from-white/5 to-white/[0.02] border border-white/10 rounded-[1.5rem] p-5 md:p-8 flex flex-col justify-between group",children:[d.jsxs("div",{className:"space-y-3 md:space-y-4",children:[d.jsx(Wa,{src:"/bild-ljusbord.jpeg",alt:"Enskild Terapi",className:"w-full h-40",defaultRotation:"-2deg",grayscale:!1}),d.jsx("h3",{className:"text-xl md:text-2xl font-bold text-white",children:"Enskild Terapi"}),d.jsx("p",{className:"text-zinc-400 text-xs md:text-sm leading-relaxed",children:"Gestaltterapeutisk grund med fokus p att lsa upp knutar som str i vgen fr det liv du vill leva. Vi jobbar med stress, ngest, sorg och PTSD."})]}),d.jsxs("button",{onClick:()=>n(De.THERAPY),className:"mt-4 md:mt-6 flex items-center gap-2 text-white font-bold hover:text-red-400 transition-colors text-xs md:text-sm",children:["Ls mer om terapi ",d.jsx(Fs,{size:18})]})]}),d.jsxs("div",{className:"glass bg-gradient-to-br from-white/5 to-white/[0.02] border border-white/10 rounded-[1.5rem] p-5 md:p-8 flex flex-col justify-between group",children:[d.jsxs("div",{className:"space-y-3 md:space-y-4",children:[d.jsx(Wa,{src:"/bild-terapistol.jpeg",alt:"Parterapi",className:"w-full h-40",defaultRotation:"2deg",grayscale:!1}),d.jsx("h3",{className:"text-xl md:text-2xl font-bold text-white",children:"Grupp- & Parterapi"}),d.jsx("p",{className:"text-zinc-400 text-xs md:text-sm leading-relaxed",children:"Lkning genom relation och gemenskap. Vi erbjuder specialiserad terapi fr grupper och par."})]}),d.jsxs("button",{onClick:()=>n(De.GROUP_THERAPY),className:"mt-4 md:mt-6 flex items-center gap-2 text-white font-bold hover:text-indigo-400 transition-colors text-xs md:text-sm",children:["Ls mer om parterapi ",d.jsx(Fs,{size:18})]})]}),d.jsxs("div",{className:"glass bg-gradient-to-br from-white/5 to-white/[0.02] border border-white/10 rounded-[1.5rem] p-5 md:p-8 flex flex-col justify-between group",children:[d.jsxs("div",{className:"space-y-3 md:space-y-4",children:[d.jsx(Wa,{src:"/hemsida-bild6.jpeg",alt:"Utbildning",className:"w-full h-40",defaultRotation:"-1deg"}),d.jsx("h3",{className:"text-xl md:text-2xl font-bold text-white",children:"Utbildning"}),d.jsx("p",{className:"text-zinc-400 text-xs md:text-sm leading-relaxed",children:"Specialistutbildningar fr behandlare, inklusive Myndighetsinducerat Trauma (MiT) och Gestaltmetodik."})]}),d.jsxs("button",{onClick:()=>n(De.CHAT),className:"mt-4 md:mt-6 flex items-center gap-2 text-white font-bold hover:text-amber-400 transition-colors text-xs md:text-sm",children:["Se vra utbildningar ",d.jsx(Fs,{size:18})]})]})]})]}),d.jsxs("div",{className:"space-y-16 md:space-y-24 py-12",children:[d.jsxs("div",{className:"text-center space-y-6 max-w-4xl mx-auto",children:[d.jsxs("h2",{className:"text-4xl md:text-6xl font-black text-white italic tracking-tight leading-[1.1]",children:["Horizonten Gemenskap  ",d.jsx("br",{className:"hidden md:block"}),d.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-amber-200 to-white",children:"Din digitala flock"})]}),d.jsx("p",{className:"text-xl md:text-2xl text-amber-500/90 font-bold italic tracking-wide",children:"Ingen lker i vakuum. Vi behver varandra."}),d.jsx("div",{className:"h-1 w-24 bg-gradient-to-r from-orange-500 to-transparent mx-auto rounded-full"}),d.jsx("p",{className:"text-zinc-400 text-lg md:text-xl leading-relaxed font-light",children:"P Klttertrdet vet vi att psykisk hlsa inte bara handlar om vad som sker under en timme i terapistolen. Det handlar om vad som hnder dremellan. Det handlar om vardagen. Drfr har vi, tillsammans med vra partners Socialkraft och Twisted-stacks, skapat Horizonten Gemenskap."})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center max-w-6xl mx-auto",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"inline-block px-4 py-1.5 bg-orange-500/10 rounded-full border border-orange-500/20 text-orange-500 text-xs font-black uppercase tracking-widest",children:"Mer n bara en app"}),d.jsx("h3",{className:"text-3xl font-black text-white italic",children:"En omsorgsfullt designad plattform"}),d.jsx("p",{className:"text-zinc-400 text-lg leading-relaxed font-light",children:"Detta r inte sociala medier som stjl din energi. Det r en omsorgsfullt designad plattform fr terhmtning, igenknning och vxtkraft. Vi har flyttat in vr filosofi om Self-care, Bottom-up och trygghet i en digital milj som du alltid har med dig i fickan."})]}),d.jsxs("div",{className:"relative group flex justify-center",children:[d.jsx("div",{className:"absolute -inset-4 bg-orange-500/20 rounded-[3rem] blur-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-700"}),d.jsx(Wa,{src:"/logo2.png",alt:"Horizonten Gemenskap",className:"w-64 h-64 md:w-80 md:h-80",imgClassName:"object-contain p-8",defaultRotation:"5deg",grayscale:!1})]})]}),d.jsxs("div",{className:"space-y-12",children:[d.jsxs("div",{className:"text-center space-y-2",children:[d.jsx("h3",{className:"text-3xl font-black text-white italic tracking-tight",children:"Vad hittar du hr?"}),d.jsx("p",{className:"text-zinc-500",children:"Mngsidigt std fr din personliga resa."})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto",children:[{title:"Gratis Std",text:"En plats dr du kan dela erfarenheter med andra som frstr. Att spegla sig i andra minskar skam och bryter isolering.",icon:d.jsx(Vs,{className:"text-orange-500",size:32})},{title:"Verktyg",text:"Tillgng till material, vningar och mallar som stttar din process.",icon:d.jsx(va,{className:"text-amber-400",size:32})},{title:"Mjligheter",text:"Som medlem kan du delta i (eller sjlv hlla i) digitala sjlvhjlpsmten via vra videorum.",icon:d.jsx($a,{className:"text-white",size:32})}].map((g,v)=>d.jsxs("div",{className:"glass bg-white/5 border border-white/10 p-8 rounded-3xl hover:bg-white/10 transition-all group hover:-translate-y-2",children:[d.jsx("div",{className:"mb-6 p-4 bg-white/5 rounded-2xl w-fit group-hover:scale-110 transition-transform",children:g.icon}),d.jsx("h4",{className:"text-xl font-bold text-white mb-3",children:g.title}),d.jsx("p",{className:"text-zinc-400 leading-relaxed text-sm font-light",children:g.text})]},v))})]}),d.jsxs("div",{className:"glass bg-gradient-to-br from-white/5 to-white/[0.02] border border-white/10 rounded-[3rem] p-10 md:p-16 max-w-6xl mx-auto relative overflow-hidden group",children:[d.jsx("div",{className:"absolute -right-20 -bottom-20 w-64 h-64 bg-orange-500/5 rounded-full blur-3xl group-hover:bg-orange-500/10 transition-colors"}),d.jsxs("div",{className:"relative z-10 space-y-12 text-center",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-3xl font-black text-white italic tracking-tight",children:"Ett unikt samarbete"}),d.jsx("p",{className:"text-zinc-400 text-lg font-light",children:"Horizonten r resultatet av tre krafter som frenas fr din skull:"})]}),d.jsx("div",{className:"grid md:grid-cols-3 gap-12",children:[{name:"Klttertrdet",text:"Bidrar med den terapeutiska grunden, kunskapen om trauma och nervsystemet.",icon:d.jsx(Ka,{className:"text-red-400",size:24})},{name:"Socialkraft",text:"Skerstller perspektivet av rttvisa, std i myndighetsfrgor och empowerment.",icon:d.jsx(Fu,{className:"text-blue-400",size:24})},{name:"Twisted-stacks",text:"Mjliggr tekniken som bygger broar mellan mnniskor p ett skert stt.",icon:d.jsx(va,{className:"text-purple-400",size:24})}].map((g,v)=>d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-center gap-3",children:[g.icon,d.jsx("h4",{className:"text-xl font-black text-white tracking-tight",children:g.name})]}),d.jsx("p",{className:"text-zinc-500 text-sm leading-relaxed font-light",children:g.text})]},v))})]})]}),d.jsxs("div",{className:"space-y-24",children:[d.jsxs("div",{className:"text-center space-y-6 max-w-4xl mx-auto",children:[d.jsx("h2",{className:"text-4xl md:text-5xl font-black text-white italic tracking-tight",children:"Vrt Specialistteam"}),d.jsx("p",{className:"text-xl text-amber-500 font-bold italic",children:"Handplockad kompetens fr hela mnniskan."}),d.jsxs("div",{className:"space-y-6 text-zinc-400 text-lg md:text-xl leading-relaxed font-light text-left md:text-center",children:[d.jsx("p",{children:"Jag brukar sga att trygghet brjar med kompetens. Fr att kunna guida en annan mnniska genom svr terrng  oavsett om det handlar om djupa barndomstrauman eller stressrelaterad ohlsa  krvs en guide som r trygg, erfaren och vlutbildad."}),d.jsx("p",{children:"Drfr r jag otroligt stolt och tacksam ver det team vi har samlat hr p Klttertrdet och Horizonten."})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center max-w-6xl mx-auto",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-3xl font-black text-white italic",children:"Vi har sllat fram de bsta"}),d.jsx("p",{className:"text-zinc-400 text-lg leading-relaxed font-light",children:"Vi stller extremt hga krav p vra medarbetare. Inte bara gllande deras akademiska meriter, utan p deras frmga till nrvaro och bemtande. De terapeuter och behandlare du mter hos oss r noga utsorterade fr att de r bst inom sina respektive flt."}),d.jsx("p",{className:"text-zinc-400 text-lg leading-relaxed font-light",children:'Vi jobbar inte efter en "one-size-fits-all"-modell. Vi vet att olika nervsystem behver olika ingngar fr att lka. Drfr har vi samlat en bredd av expertis under samma tak:'})]}),d.jsx("div",{className:"relative p-8 glass bg-white/5 border border-white/10 rounded-[2.5rem] space-y-4",children:[{label:"Traumaterapi & Bottom-up",desc:"Specialister p att arbeta med kroppens minnen och nervsystemets reglering."},{label:"KBT & Beteendevetenskap",desc:"Fr dig som behver struktur, verktyg och tankemnsterfrndring."},{label:"Psykoanalys & Psychodynamic",desc:"Fr djupare frstelse av omedvetna processer och livsmnster."},{label:"Hypnos",desc:"Ett kraftfullt verktyg fr att n bortom det logiska sinnet och arbeta med djupare frndring."},{label:"Hudvrd & Somatisk omsorg",desc:"Self-care handlar ocks om att vrda kroppens grns mot omvrlden."}].map((g,v)=>d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"mt-1 w-1.5 h-1.5 bg-orange-500 rounded-full shrink-0"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-white font-bold text-sm",children:g.label}),d.jsx("p",{className:"text-zinc-500 text-xs",children:g.desc})]})]},v))})]}),d.jsxs("div",{className:"text-center space-y-12 max-w-6xl mx-auto",children:[d.jsx(UR,{}),d.jsxs("div",{className:"pt-8 space-y-8",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("p",{className:"text-2xl font-black text-white italic",children:"Vlkommen in i vrmen."}),d.jsx("p",{className:"text-orange-500 font-bold uppercase tracking-widest text-xs",children:"Det r gratis att bli medlem."})]}),d.jsxs("div",{className:"flex flex-wrap justify-center gap-6",children:[d.jsxs("button",{onClick:()=>n(De.CONTACT),className:"px-10 py-5 bg-white text-slate-900 hover:bg-white/90 rounded-2xl font-black transition-all hover:scale-105 flex items-center gap-3 shadow-2xl shadow-white/10 uppercase tracking-widest text-xs",children:["Ta kontakt med oss ",d.jsx(Fs,{size:20})]}),d.jsx("button",{onClick:()=>n(De.THERAPY,{showForm:!0}),className:"px-10 py-5 bg-white/5 hover:bg-white/10 border border-white/20 rounded-2xl text-white font-black transition-all hover:scale-105 flex items-center gap-3 uppercase tracking-widest text-xs",children:"Hjlp med att hitta en terapeut"})]})]})]})]})]}),d.jsx(V1,{})]})},a4=()=>d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-10 animate-fade-in space-y-16",children:[d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-16 text-center relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-orange-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10",children:[d.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-orange-400 leading-tight",children:"Om Klttertrdet & Horizonten"}),d.jsx("h2",{className:"text-xl md:text-2xl text-white/90 font-light italic mb-8",children:"Ett kunskapscenter fr mnsklig utveckling"}),d.jsx("p",{className:"text-lg text-white/80 leading-relaxed max-w-4xl mx-auto",children:"Vr vision har alltid varit att skapa rum fr utveckling, terhmtning och utbildning  fr mnniskor i frndring. Vi frenar djup terapeutisk kompetens med specialistutbildningar fr morgondagens behandlare."})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-10",children:[d.jsxs("div",{className:"glass bg-gradient-to-br from-orange-900/20 to-black/40 border border-orange-500/20 rounded-3xl p-8 md:p-12",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-orange-500/20 rounded-xl text-orange-400",children:d.jsx(va,{size:32})}),d.jsx("h3",{className:"text-2xl font-bold",children:"Vi startade 2020"})]}),d.jsxs("p",{className:"text-white/80 leading-relaxed mb-6",children:[d.jsx("strong",{children:"Klttertrdet AB"})," grundades av Billy Ljungberg 2020 och har sin bas i Gvle. Med lng erfarenhet som terapeut, handledare och utbildare har vi under ren ftt frmnen att mta bde individer och verksamheter i behov av std, riktning och frdjupning."]}),d.jsxs("div",{className:"flex items-start gap-4 bg-black/20 p-6 rounded-2xl border border-white/5",children:[d.jsx(mP,{className:"text-orange-400 shrink-0",size:24}),d.jsx("p",{className:"text-white/80 italic text-sm",children:'"Vi startade med en vertygelse om att kvalitet och nrvaro r nyckeln till verklig frndring."'})]})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 md:p-12 flex flex-col justify-center",children:[d.jsxs("h3",{className:"text-2xl font-bold mb-6 flex items-center gap-3",children:[d.jsx(rR,{className:"text-amber-400"})," Vr verksamhet"]}),d.jsxs("p",{className:"text-white/80 leading-relaxed mb-6",children:["Vi erbjuder utbildningar till ",d.jsx("strong",{children:"behandlingspedagog"})," och ",d.jsx("strong",{children:"socialpedagog"}),", samt handledning och kvalificerad terapi inom beroendeproblematik, trauma och relationsarbete."]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-3 text-white/90",children:[d.jsx(Kd,{className:"text-orange-400",size:20}),d.jsx("span",{children:"Handplockade frelsare frn hela Sverige"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-white/90",children:[d.jsx(Fu,{className:"text-orange-400",size:20}),d.jsx("span",{children:"Kvalitetsskrad metodik & traumafrstelse"})]}),d.jsxs("div",{className:"flex items-center gap-3 text-white/90",children:[d.jsx(Vs,{className:"text-orange-400",size:20}),d.jsx("span",{children:"Std fr bde individer och organisationer"})]})]})]})]}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-3xl font-bold text-center mb-10",children:"Vr Metodik & Filosofi"}),d.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"glass bg-white/5 p-8 rounded-2xl border border-white/10",children:[d.jsx("div",{className:"mb-4 bg-blue-500/20 w-12 h-12 rounded-lg flex items-center justify-center text-blue-300",children:d.jsx(Vb,{size:24})}),d.jsx("h4",{className:"text-xl font-bold mb-3",children:"Processinriktat Lrande"}),d.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:"Kunskap mste landa i kroppen. Vra utbildningar bygger p kvalitet, nrvaro och mngrig erfarenhet dr vi varvar teori med praktisk implementation."})]}),d.jsxs("div",{className:"glass bg-white/5 p-8 rounded-2xl border border-white/10",children:[d.jsx("div",{className:"mb-4 bg-red-500/20 w-12 h-12 rounded-lg flex items-center justify-center text-red-300",children:d.jsx(Ka,{size:24})}),d.jsx("h4",{className:"text-xl font-bold mb-3",children:"Traumamedveten Omsorg"}),d.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:"Vi utgr frn neurobiologi och traumateori (TMO) fr att frst hur man reglerar nervsystem som fastnat i kamp, flykt eller frys."})]}),d.jsxs("div",{className:"glass bg-white/5 p-8 rounded-2xl border border-white/10",children:[d.jsx("div",{className:"mb-4 bg-green-500/20 w-12 h-12 rounded-lg flex items-center justify-center text-green-300",children:d.jsx(Vs,{size:24})}),d.jsx("h4",{className:"text-xl font-bold mb-3",children:"Gestaltterapeutisk Grund"}),d.jsx("p",{className:"text-white/70 text-sm leading-relaxed",children:'Vi fokuserar p "hr och nu". Kontakt, medvetenhet och ansvar r nyckelord i vr syn p mnniskan som en helhet.'})]})]})]}),d.jsxs("div",{className:"glass bg-white/10 border border-white/20 rounded-3xl p-8 md:p-12 text-center mt-12",children:[d.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Besk oss i Gvle"}),d.jsx("p",{className:"text-white/80 max-w-2xl mx-auto mb-8",children:"Vi bedriver vr verksamhet i ljusa lokaler centralt i Gvle. Hr mts vi fr utbildningstrffar, terapi och frdjupade samtal."}),d.jsxs("div",{className:"inline-flex flex-col md:flex-row gap-6 md:gap-12 justify-center items-center text-white/90 font-medium",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Bb,{className:"text-orange-400"}),d.jsx("span",{children:"Gullregnsgatan 9A, 802 56 Gvle"})]}),d.jsx("div",{className:"hidden md:block w-1.5 h-1.5 bg-white/30 rounded-full"}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(zb,{className:"text-orange-400",size:20}),d.jsx("span",{children:"info@klattertradet.se"})]})]})]})]}),o4=()=>{const[n,e]=ue.useState("info"),[t,i]=ue.useState({type:"Anmlan till utbildning (MiT)",name:"",email:"",phone:"",workplace:"",invoiceAddress:"",message:""}),s=r=>{r.preventDefault();const o="billy@klattertradet.se",c=`Anmlan: ${t.type} - ${t.name}`,h=`
Hej Billy,

Hr kommer en anmlan/frfrgan via hemsidan.

AVSER:
${t.type}

KONTAKTUPPGIFTER:
Namn: ${t.name}
E-post: ${t.email}
Telefon: ${t.phone}
Arbetsplats/Titel: ${t.workplace}

FAKTURAADRESS (om angivet):
${t.invoiceAddress}

MEDDELANDE / VRIGT:
${t.message}
    `.trim(),p=`mailto:${o}?subject=${encodeURIComponent(c)}&body=${encodeURIComponent(h)}`;window.location.href=p,e("success")};return n==="success"?d.jsx("div",{className:"container mx-auto px-4 py-20 flex items-center justify-center animate-fade-in min-h-[70vh]",children:d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-xl border border-white/20 p-12 rounded-[40px] max-w-lg w-full text-center shadow-2xl",children:[d.jsx("div",{className:"mb-6 flex justify-center text-green-400",children:d.jsx(bc,{size:64})}),d.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Tack fr din anmlan!"}),d.jsx("p",{className:"text-lg text-white/80 mb-6",children:'Ett frifyllt mail har skapats i din mailklient. Vnligen klicka p "Skicka" fr att slutfra anmlan till Billy.'}),d.jsx("button",{onClick:()=>e("info"),className:"text-white hover:text-amber-400 font-medium underline transition-colors",children:"G tillbaka till utbildningssidan"})]})}):n==="form"?d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-10 animate-fade-in max-w-3xl",children:[d.jsxs("button",{onClick:()=>e("info"),className:"flex items-center gap-2 text-white/60 hover:text-white mb-6 transition-colors",children:[d.jsx(yc,{size:20})," Tillbaka till informationen"]}),d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-12 shadow-2xl",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Anmlan & Intresse"}),d.jsx("p",{className:"text-white/70",children:"Myndighetsinducerat Trauma (MiT)"})]}),d.jsxs("form",{onSubmit:s,className:"space-y-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Vad vill du gra?"}),d.jsxs("select",{className:"w-full p-4 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500 transition-all appearance-none",value:t.type,onChange:r=>i({...t,type:r.target.value}),children:[d.jsx("option",{value:"Bindande anmlan till utbildning (MiT)",className:"bg-zinc-900",children:"Jag vill anmla mig till utbildningen"}),d.jsx("option",{value:"Intresseanmlan (MiT)",className:"bg-zinc-900",children:"Jag r intresserad och vill veta mer (Intresseanmlan)"}),d.jsx("option",{value:"Frfrgan fr arbetsgrupp (MiT)",className:"bg-zinc-900",children:"Jag vill boka utbildning fr min arbetsgrupp"})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsxs("label",{className:"block text-sm font-medium text-white/80",children:["Namn ",d.jsx("span",{className:"text-red-400",children:"*"})]}),d.jsx("input",{required:!0,type:"text",className:"w-full p-3 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500",value:t.name,onChange:r=>i({...t,name:r.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("label",{className:"block text-sm font-medium text-white/80",children:["E-post ",d.jsx("span",{className:"text-red-400",children:"*"})]}),d.jsx("input",{required:!0,type:"email",className:"w-full p-3 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500",value:t.email,onChange:r=>i({...t,email:r.target.value})})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Telefon"}),d.jsx("input",{type:"tel",className:"w-full p-3 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500",value:t.phone,onChange:r=>i({...t,phone:r.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Arbetsplats / Titel"}),d.jsx("input",{type:"text",className:"w-full p-3 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500",placeholder:"T.ex. Socialtjnsten Gvle / Socialsekreterare",value:t.workplace,onChange:r=>i({...t,workplace:r.target.value})})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Fakturaadress (vid anmlan)"}),d.jsx("textarea",{rows:2,className:"w-full p-3 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500 resize-none",placeholder:"Adress, referens, ev. kostnadsstlle...",value:t.invoiceAddress,onChange:r=>i({...t,invoiceAddress:r.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm font-medium text-white/80",children:"Meddelande / Allergier"}),d.jsx("textarea",{rows:3,className:"w-full p-3 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500 resize-none",value:t.message,onChange:r=>i({...t,message:r.target.value})})]}),d.jsxs("button",{type:"submit",className:"w-full py-4 bg-white/10 hover:bg-white/20 border border-white/20 text-white font-bold rounded-xl transition-all hover:scale-[1.01] active:scale-95 flex items-center justify-center gap-2",children:["Skicka anmlan ",d.jsx(Ml,{size:20})]}),d.jsx("p",{className:"text-center text-xs text-white/40 mt-4",children:"Genom att skicka in godknner du att vi kontaktar dig angende utbildningen."})]})]})]}):d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-10 animate-fade-in w-full",children:[d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-12 mb-8 relative overflow-hidden flex flex-col md:flex-row items-center justify-between gap-8",children:[d.jsxs("div",{className:"relative z-10 flex-1",children:[d.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-orange-400 leading-tight",children:"Myndighetsinducerat Trauma (MiT)"}),d.jsx("h2",{className:"text-xl md:text-2xl text-white/90 italic font-light mb-6",children:" Att lka nr systemet skadar"}),d.jsx("p",{className:"text-lg md:text-xl text-white/80 leading-relaxed max-w-4xl",children:"Nr hjlpen blir ett hot. En specialistutbildning fr dig som mter mnniskor i klm mellan behov och byrkrati."})]}),d.jsx("div",{className:"relative z-10 w-full md:w-64 h-48 md:h-64 flex justify-center md:justify-end",children:d.jsx(Wa,{src:"/hemsida-bild7.jpeg",alt:"Myndighetsinducerat Trauma",className:"w-48 h-64 md:w-full md:h-full",defaultRotation:"8deg",grayscale:!1,blur:"10px",hoverBlur:"0px"})})]}),d.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-2xl p-6 md:p-8",children:[d.jsx("p",{className:"text-white/80 leading-relaxed mb-6 text-lg",children:'Har du mtt klienten som "stnger av" s fort ett myndighetsbrev landar p hallmattan? Eller ungdomen som gr in i totalt kamp-lge vid blotta tanken p ett SIP-mte? Det handlar ofta om myndighetsinducerat trauma. Fr mnga av vra klienter r mtet med vrd- och omsorgsapparaten inte en vg till lkning, utan en klla till ytterligare stress, vanmakt och retraumatiserande upplevelser.'}),d.jsx("p",{className:"text-white/80 leading-relaxed text-lg",children:"P Klttertrdet och Horizonten vet vi att vi inte kan prata bort dessa tillstnd. Vi mste jobba bottom-up. Vi mste frst nervsystemets reaktioner och erbjuda verktyg som fungerar p riktigt."})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-2xl p-6 md:p-8",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[d.jsx(aR,{className:"text-orange-400",size:32,"aria-hidden":"true"}),d.jsx("h3",{className:"text-2xl font-bold",children:"Om utbildningen"})]}),d.jsx("p",{className:"text-white/80 leading-relaxed mb-4",children:"Detta r en processinriktad specialistutbildning som strcker sig ver en termin. Vi kombinerar djupgende fysiska trffar i Gvle med flexibla, processinriktade onlinetrffar. Mlet r att gra dig till en trygg hamn i ett stormigt system."}),d.jsx("p",{className:"text-white/80 leading-relaxed",children:"Vi utgr frn vr egen Self-care modell fr att kartlgga hur bristen p agens och trygghet i kontakten med myndigheter aktiverar gamla grundsr ssom Avvisad eller Frdmjukad. Du fr lra dig att hjlpa klienten g frn maktls underkastelse till reglering och agens."})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-2xl font-bold px-2",children:"Upplgg: 3 + 3 Modellen"}),d.jsx("p",{className:"text-white/70 px-2 italic",children:'Vi tror p det "blandade lrandet"  att ses p riktigt fr att bygga allians och trygghet, och att ses digitalt fr att hlla processen levande i vardagen.'}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"glass bg-orange-900/10 border border-orange-500/20 rounded-2xl p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4 text-orange-300",children:[d.jsx(Vs,{size:24,"aria-hidden":"true"}),d.jsx("h4",{className:"text-xl font-bold",children:"Del 1: Fysiska Trffar"})]}),d.jsx("p",{className:"text-sm text-white/70 mb-4",children:"3 heldagar i Gvle. Vi ses i vra lokaler p Gullregnsgatan."}),d.jsxs("ul",{className:"space-y-3",children:[d.jsxs("li",{className:"flex gap-3 text-white/80 text-sm",children:[d.jsx("span",{className:"text-orange-400 font-bold","aria-hidden":"true",children:""}),d.jsxs("span",{children:[d.jsx("strong",{children:"Neurobiologin bakom MiT:"})," Vad hnder i hjrnan och kroppen vid strukturellt svek?"]})]}),d.jsxs("li",{className:"flex gap-3 text-white/80 text-sm",children:[d.jsx("span",{className:"text-orange-400 font-bold","aria-hidden":"true",children:""}),d.jsxs("span",{children:[d.jsx("strong",{children:"Identifiera Grundsr:"})," Hur triggar systemet sr som vergivenhet eller Orttvisa?"]})]}),d.jsxs("li",{className:"flex gap-3 text-white/80 text-sm",children:[d.jsx("span",{className:"text-orange-400 font-bold","aria-hidden":"true",children:""}),d.jsxs("span",{children:[d.jsx("strong",{children:"Praktisk Self-care:"}),' Vi var p Containment och Reglering. Hur skapar vi ett "vi" nr klienten misstror alla auktoriteter?']})]})]})]}),d.jsxs("div",{className:"glass bg-blue-900/10 border border-blue-500/20 rounded-2xl p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4 text-blue-300",children:[d.jsx(rP,{size:24,"aria-hidden":"true"}),d.jsx("h4",{className:"text-xl font-bold",children:"Del 2: Onlinetrffar"})]}),d.jsx("p",{className:"text-sm text-white/70 mb-4",children:'3 halvdagar via lnk. Din "depstopp" fr handledning och implementation.'}),d.jsxs("ul",{className:"space-y-3",children:[d.jsxs("li",{className:"flex gap-3 text-white/80 text-sm",children:[d.jsx("span",{className:"text-blue-400 font-bold","aria-hidden":"true",children:""}),d.jsxs("span",{children:[d.jsx("strong",{children:"Case-arbete:"})," Du tar med dig fall frn din vardag."]})]}),d.jsxs("li",{className:"flex gap-3 text-white/80 text-sm",children:[d.jsx("span",{className:"text-blue-400 font-bold","aria-hidden":"true",children:""}),d.jsxs("span",{children:[d.jsx("strong",{children:"Metodfrdjupning:"})," Hur applicerar vi Self-care modellen i digitala mten eller korta samtal?"]})]}),d.jsxs("li",{className:"flex gap-3 text-white/80 text-sm",children:[d.jsx("span",{className:"text-blue-400 font-bold","aria-hidden":"true",children:""}),d.jsxs("span",{children:[d.jsx("strong",{children:"Hllbarhet:"})," Hur skyddar du dig sjlv frn sekundrtraumatisering nr du stngas mot systemet?"]})]})]})]})]})]})]}),d.jsxs("div",{className:"lg:col-span-1 space-y-8",children:[d.jsxs("div",{className:"glass bg-gradient-to-br from-amber-500/10 to-orange-600/10 border border-orange-500/30 rounded-2xl p-8 relative overflow-hidden",children:[d.jsx("div",{className:"absolute -top-10 -right-10 text-orange-500/10 rotate-12","aria-hidden":"true",children:d.jsx(Kd,{size:180})}),d.jsxs("h3",{className:"text-2xl font-bold mb-4 relative z-10 flex items-center gap-2",children:[d.jsx(Fu,{className:"text-orange-400","aria-hidden":"true"})," Unikt vrde"]}),d.jsx("p",{className:"text-white/90 mb-6 relative z-10 font-medium",children:"Bli Kvalitetsmarkerad"}),d.jsx("p",{className:"text-white/70 text-sm mb-6 relative z-10 leading-relaxed",children:"Vi vet att tillit r hrdvaluta. Direkt efter godknd utbildning fr du rtten att anvnda Horizontens Kvalitetsmarkering fr MiT-kompetens."}),d.jsxs("div",{className:"space-y-3 relative z-10 bg-black/20 p-4 rounded-xl border border-white/5",children:[d.jsx("p",{className:"text-xs text-white/70 uppercase tracking-widest mb-2",children:"Bevis p kompetens"}),d.jsxs("div",{className:"flex gap-3 text-sm text-white/80",children:[d.jsx("span",{className:"font-bold text-orange-400",children:"1."}),d.jsx("span",{children:"Specialistkunskap om systeminducerad stress."})]}),d.jsxs("div",{className:"flex gap-3 text-sm text-white/80",children:[d.jsx("span",{className:"font-bold text-orange-400",children:"2."}),d.jsx("span",{children:"Evidensbaserade verktyg fr stabilisering."})]}),d.jsxs("div",{className:"flex gap-3 text-sm text-white/80",children:[d.jsx("span",{className:"font-bold text-orange-400",children:"3."}),d.jsx("span",{children:"Etiskt frhllningsstt via Self-care modellen."})]})]})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-2xl p-6 md:p-8",children:[d.jsx("h3",{className:"text-xl font-bold mb-6",children:"Praktisk information"}),d.jsxs("ul",{className:"space-y-4",children:[d.jsxs("li",{className:"flex items-start gap-4",children:[d.jsx("div",{className:"bg-white/10 p-2 rounded-lg","aria-hidden":"true",children:d.jsx(Bb,{size:20,className:"text-orange-300"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-white/70",children:"Plats"}),d.jsx("p",{className:"text-white font-medium",children:"Gullregnsgatan 9A, Gvle (Fysiska)"}),d.jsx("p",{className:"text-white font-medium",children:"Samt Zoom (Online)"})]})]}),d.jsxs("li",{className:"flex items-start gap-4",children:[d.jsx("div",{className:"bg-white/10 p-2 rounded-lg","aria-hidden":"true",children:d.jsx($a,{size:20,className:"text-orange-300"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-white/70",children:"Omfattning"}),d.jsx("p",{className:"text-white font-medium",children:"3 heldagar fysiskt"}),d.jsx("p",{className:"text-white font-medium",children:"3 halvdagar online"})]})]}),d.jsxs("li",{className:"flex items-start gap-4",children:[d.jsx("div",{className:"bg-white/10 p-2 rounded-lg","aria-hidden":"true",children:d.jsx(Vs,{size:20,className:"text-orange-300"})}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("p",{className:"text-sm text-white/70",children:"Kursledare"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-white font-medium",children:"Billy Ljungberg"}),d.jsx("p",{className:"text-xs text-white/70",children:"Traumaterapeut"})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-white font-medium",children:"Malin Widerlv"}),d.jsx("p",{className:"text-xs text-white/70",children:"Socialarbetare"})]})]})]})]}),d.jsxs("div",{className:"mt-8 pt-6 border-t border-white/10",children:[d.jsx("h4",{className:"text-sm font-bold text-white/70 mb-2",children:"Fr vem?"}),d.jsx("p",{className:"text-sm text-white/70 italic",children:"Socionomer, behandlingspedagoger, boendestdjare, terapeuter eller andra i grnssnittet mellan individ och myndighet."})]}),d.jsx("button",{onClick:()=>e("form"),className:"w-full mt-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-xl font-bold transition-all hover:scale-105 focus:outline-none","aria-label":"Anml dig till Myndighetsinducerat Trauma utbildningen",children:"Anml dig hr"})]})]})]}),d.jsxs("div",{className:"mt-12 text-center",children:[d.jsx("h3",{className:"text-2xl md:text-3xl font-bold text-white mb-2",children:"r du redo?"}),d.jsx("p",{className:"text-white/70",children:"Bli den skillnad dina klienter behver i mtet med systemet."})]})]})},l4=({setPage:n})=>{const[e,t]=ue.useState(()=>window.history.state?.showForm?"form":"splash"),[i,s]=ue.useState({tidigare_erfarenhet:"",uppskattade:"",tanke_delar:"",utmaningar:[],annan_utmaning_text:"",mal:"",annat_mal_text:"",terapeut_kon:"inte_viktigt",motesform:"",namn:"",epost:"",telefon:""}),r=ue.useRef(null);ue.useEffect(()=>{window.history.state?.showForm&&r.current&&setTimeout(()=>{r.current?.scrollIntoView({behavior:"smooth",block:"center"})},100)},[]);const o=["ngest","Fobier","Skam och rdsla","Uppvxtproblematik","Sorg","Medberoende","Vuxna-barnproblematiken","Stress","Utbrndhet","PTSD","C-PTSD (komplex PTSD)"],c=p=>{const{value:g,checked:v}=p.target;s(v?y=>({...y,utmaningar:[...y.utmaningar,g]}):y=>({...y,utmaningar:y.utmaningar.filter(w=>w!==g)}))},h=p=>{p.preventDefault();const g="billy@klattertradet.se",v="Enkt, hjlp med att hitta terapeut";let y=`Hr r svaren frn din enkt:

`;y+=`1. Dina tidigare erfarenheter av terapi:
`,y+=`   - Har skt terapi tidigare? ${i.tidigare_erfarenhet||"Inget svar"}
`,i.uppskattade&&(y+=`   - Mest/minst uppskattat: ${i.uppskattade}
`),i.tanke_delar&&(y+=`   - Tankar kring upplevelser: ${i.tanke_delar}
`),y+=`
`,y+=`2. Vad sker du hjlp fr?
`;const w=i.utmaningar.map(R=>R==="annan"?`Annan: ${i.annan_utmaning_text}`:R);y+=`   - Aktuell utmaning: ${w.length>0?w.join(", "):"Inget svar"}
`,y+=`   - Huvudsakligt ml: ${i.mal==="annat"?`Annat: ${i.annat_mal_text}`:i.mal}
`,y+=`
`,y+=`3. nskeml p terapeut:
`,y+=`   - Terapeutens kn: ${i.terapeut_kon}
`,y+=`   - Fredragen mtesform: ${i.motesform}
`,y+=`
`,y+=`4. Dina kontaktuppgifter:
`,y+=`   - Namn: ${i.namn}
`,y+=`   - E-post: ${i.epost}
`,i.telefon&&(y+=`   - Telefon: ${i.telefon}
`);const E=`mailto:${g}?subject=${encodeURIComponent(v)}&body=${encodeURIComponent(y)}`;t("confirmation"),setTimeout(()=>{window.location.href=E},1e3)};return d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-10 animate-fade-in space-y-20",children:[d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-16 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-red-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-12",children:[d.jsxs("div",{className:"max-w-2xl",children:[d.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-red-200 to-orange-400 leading-tight",children:"TERAPI"}),d.jsx("h2",{className:"text-xl md:text-3xl text-white/90 font-light italic mb-8",children:"Vi vgleder dig genom din utveckling"}),d.jsx("p",{className:"text-lg md:text-xl text-white/80 leading-relaxed font-light",children:"Enskild terapi kan g i flera olika led och tcka upp fr flera olika typer av problembilder. Det viktigaste fr oss r att vi mter dig i de problem du kommer med!"})]}),d.jsx("div",{className:"hidden lg:block shrink-0",children:d.jsx(Wa,{src:"/hemsida-bild1.jpeg",alt:"Gestaltterapi",className:"w-72 h-96",grayscale:!1,defaultRotation:"3deg"})})]})]}),d.jsxs("div",{className:"grid lg:grid-cols-2 gap-10",children:[d.jsxs("div",{className:"space-y-8",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 md:p-12 hover:bg-white/10 transition-all duration-300",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-red-500/20 rounded-2xl text-red-400",children:d.jsx(Vb,{size:32})}),d.jsx("h3",{className:"text-2xl font-bold",children:"Gestaltterapeutisk grund"})]}),d.jsxs("p",{className:"text-white/80 leading-relaxed mb-6",children:["I enskild terapi jobbar vi p en gestaltterapeutisk grund och det innebr att vi jobbar utifrn ",d.jsx("strong",{children:"Hr, Nu och Hur"}),". Gestaltterapi r en upplevelsebaserad terapiform dr vgen r mognad och fullbordan genom den egna upplevelsen."]}),d.jsx("p",{className:"text-white/80 leading-relaxed",children:"I gestaltterapi tittar vi inte bakt och brottas i intellektuella diskussioner om hur du haft det och varfr det varit som det varit utan vi jobbar utifrn hur ditt liv tar sig uttryck hr och nu och lser upp de knutar som str i vgen fr att du ska skapa och leva det liv som du vill!"})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 md:p-12 hover:bg-white/10 transition-all duration-300",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-amber-500/20 rounded-2xl text-amber-400",children:d.jsx(va,{size:32})}),d.jsx("h3",{className:"text-2xl font-bold",children:"Avsluta oavslutade mnster"})]}),d.jsx("p",{className:"text-white/80 leading-relaxed mb-6",children:"I gestaltterapi s jobbar vi fr att avsluta oavslutade mnster (gestalter) i livet som liksom gtt ut ur tid och inte lngre r nskvrda."}),d.jsxs("div",{className:"flex items-start gap-4 bg-black/20 p-6 rounded-2xl border border-white/5",children:[d.jsx(Sl,{className:"text-orange-400 shrink-0 mt-1"}),d.jsx("p",{className:"text-white/90 italic",children:"Vi jobbar alltid med kontrakt i denna typ av terapi dr du sjlv bestmmer vgen och vi stmmer av med jmna mellanrum under perioden vi ses hur det gr med mlen i kontraktet."})]})]})]}),d.jsxs("div",{className:"glass bg-gradient-to-br from-red-900/10 to-orange-900/10 border border-white/10 rounded-3xl p-8 md:p-12 h-fit",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[d.jsx("div",{className:"p-3 bg-red-500/20 rounded-2xl text-red-400",children:d.jsx(Ka,{size:32})}),d.jsx("h3",{className:"text-2xl font-bold",children:"I enskild terapi jobbar vi med t.ex:"})]}),d.jsx("div",{className:"grid sm:grid-cols-2 gap-4",children:o.map((p,g)=>d.jsxs("div",{className:"flex items-center gap-3 bg-white/5 border border-white/5 p-4 rounded-xl hover:bg-white/10 hover:border-white/10 transition-all group",children:[d.jsx(bc,{className:"text-red-400/50 group-hover:text-red-400 transition-colors shrink-0",size:18}),d.jsx("span",{className:"text-white/80 font-medium",children:p})]},g))}),d.jsxs("div",{className:"mt-10 pt-8 border-t border-white/10 space-y-4",children:[d.jsxs("div",{className:"flex items-center gap-3 text-white/70",children:[d.jsx(Vs,{size:20,className:"text-orange-300"}),d.jsx("p",{className:"text-sm",children:"Vi jobbar med olika terapiformer och gr kontinuerligt i handledning."})]}),d.jsxs("div",{className:"flex items-center gap-3 text-white/70",children:[d.jsx(WD,{size:20,className:"text-orange-300"}),d.jsx("p",{className:"text-sm",children:"Vrt fokus r att mta dig dr du r, med de specifika utmaningar du br p."})]})]})]})]}),d.jsx("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-10 text-center max-w-4xl mx-auto",children:d.jsx("p",{className:"text-2xl font-light text-white/90 leading-relaxed italic",children:'"Det viktigaste fr oss r att vi mter dig i de problem du kommer med!"'})}),d.jsxs("div",{className:"max-w-4xl mx-auto w-full",children:[e==="splash"&&d.jsxs("button",{onClick:()=>t("form"),className:"w-full glass bg-white/10 backdrop-blur-xl border border-white/20 p-12 rounded-[40px] text-center hover:bg-white/15 transition-all group shadow-2xl animate-fade-in",children:[d.jsx("div",{className:"mb-6 flex justify-center",children:d.jsx("div",{className:"p-5 bg-orange-500/20 rounded-full text-orange-400 group-hover:scale-110 transition-transform duration-500",children:d.jsx(Ka,{size:40})})}),d.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Vi finns hr fr dig."}),d.jsx("p",{className:"text-lg text-white/70 mb-8 leading-relaxed",children:"Klicka hr fr att bertta mer, helt konfidentiellt."}),d.jsx("span",{className:"inline-block px-8 py-3 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-xl font-bold transition-all hover:scale-105",children:"Hitta din terapeut"})]}),e==="form"&&d.jsxs("div",{ref:r,className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-12 shadow-2xl animate-fade-in",children:[d.jsxs("div",{className:"text-center mb-10",children:[d.jsx(mR,{className:"mx-auto text-orange-400 mb-4",size:40}),d.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-white mb-4",children:"Sker du terapi?"}),d.jsx("p",{className:"text-white/70",children:"Lt oss hjlpa dig p vgen genom att svara p ngra korta frgor."})]}),d.jsxs("form",{onSubmit:h,className:"space-y-8",children:[d.jsxs("fieldset",{className:"p-6 border border-white/10 rounded-2xl bg-white/5",children:[d.jsx("legend",{className:"text-lg font-bold text-orange-300 px-3 mb-4",children:"1. Tidigare erfarenheter"}),d.jsxs("div",{className:"space-y-4 mb-6",children:[d.jsx("p",{className:"font-medium text-white/90",children:"Har du skt terapi tidigare?"}),["Ja, jag har gtt i terapi.","Nej, det hr r frsta gngen.","Jag har skt, men inte fullfljt."].map(p=>d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[d.jsx("input",{type:"radio",name:"exp",value:p,onChange:g=>s({...i,tidigare_erfarenhet:g.target.value}),className:"w-4 h-4 text-orange-500 bg-white/10 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white transition-colors",children:p})]},p))]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"block font-medium text-white/90",children:"Vad uppskattade du mest/minst tidigare?"}),d.jsx("textarea",{rows:2,maxLength:200,className:"w-full p-4 bg-black/30 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500",value:i.uppskattade,onChange:p=>s({...i,uppskattade:p.target.value})})]})]}),d.jsxs("fieldset",{className:"p-6 border border-white/10 rounded-2xl bg-white/5",children:[d.jsx("legend",{className:"text-lg font-bold text-orange-300 px-3 mb-4",children:"2. Vad sker du hjlp fr?"}),d.jsx("div",{className:"grid sm:grid-cols-2 gap-3 mb-6",children:["Stress","ngest","Nedstmdhet","Relationer","Sorg","Annan"].map(p=>d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[d.jsx("input",{type:"checkbox",value:p,onChange:c,className:"w-4 h-4 rounded text-orange-500 bg-white/10 border-white/20"}),d.jsx("span",{className:"text-white/80",children:p})]},p))}),d.jsx("textarea",{rows:1,placeholder:"Beskriv mer hr...",className:"w-full p-4 bg-black/30 border border-white/10 rounded-xl text-white outline-none focus:ring-2 focus:ring-orange-500",value:i.annan_utmaning_text,onChange:p=>s({...i,annan_utmaning_text:p.target.value})})]}),d.jsxs("fieldset",{className:"p-6 border border-white/10 rounded-2xl bg-white/5",children:[d.jsx("legend",{className:"text-lg font-bold text-orange-300 px-3 mb-4",children:"3. nskeml & Kontakt"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("p",{className:"font-medium text-white/90 mb-3",children:"Fredragen mtesform?"}),d.jsx("div",{className:"space-y-2",children:["Fysiska mten p plats.","Digitalt via Zoom."].map(p=>d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[d.jsx("input",{type:"radio",name:"motesform",value:p,onChange:g=>s({...i,motesform:g.target.value}),className:"w-4 h-4 text-orange-500 bg-white/10 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white transition-colors",children:p})]},p))})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"Namn"}),d.jsx("input",{type:"text",required:!0,className:"w-full p-3 bg-black/30 border border-white/10 rounded-xl text-white",value:i.namn,onChange:p=>s({...i,namn:p.target.value})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"E-post"}),d.jsx("input",{type:"email",required:!0,className:"w-full p-3 bg-black/30 border border-white/10 rounded-xl text-white",value:i.epost,onChange:p=>s({...i,epost:p.target.value})})]})]})]}),d.jsxs("button",{type:"submit",className:"w-full py-5 bg-white/10 hover:bg-white/20 border border-white/20 text-white font-bold rounded-xl shadow-xl hover:scale-[1.01] active:scale-95 transition-all flex items-center justify-center gap-3",children:["Skicka in och hitta matchning ",d.jsx(Ml,{size:20})]})]})]}),e==="confirmation"&&d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-xl border border-white/20 p-12 rounded-[40px] text-center shadow-2xl animate-fade-in",children:[d.jsx(bc,{className:"mx-auto text-green-400 mb-6",size:64}),d.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Tack fr ditt frtroende!"}),d.jsx("p",{className:"text-lg text-white/80 mb-6",children:"Vi frbereder nu ett e-postmeddelande med dina svar."}),d.jsx("p",{className:"text-white/60",children:'Klicka p "Skicka" i din e-postklient nr den ppnas. Vi terkommer snarast!'}),d.jsx("button",{onClick:()=>t("splash"),className:"mt-8 text-white hover:text-amber-400 underline font-bold",children:"G tillbaka"})]})]})]})},c4=({setPage:n})=>d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-10 animate-fade-in space-y-16",children:[d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-16 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-indigo-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-12",children:[d.jsxs("div",{className:"max-w-2xl",children:[d.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-indigo-200 to-purple-400 leading-tight",children:"GRUPP- & PARTERAPI"}),d.jsx("h2",{className:"text-xl md:text-3xl text-white/90 font-light italic mb-8",children:"Lkning genom relation och gemenskap"}),d.jsx("p",{className:"text-lg md:text-xl text-white/80 leading-relaxed font-light",children:"Mnniskan r en social varelse. Mnga av vra djupaste sr uppstr i relationer, men det r ocks dr de kan lka bst. Vi erbjuder specialiserad terapi fr grupper och par som vill frdjupa sin kontakt och lsa upp lsta mnster."})]}),d.jsx("div",{className:"hidden lg:block shrink-0",children:d.jsx(Wa,{src:"/bild-terapistol.jpeg",alt:"Parterapi",className:"w-64 h-80",grayscale:!1,defaultRotation:"-3deg"})})]})]}),d.jsxs("div",{className:"grid lg:grid-cols-2 gap-10",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 md:p-12 hover:bg-white/10 transition-all duration-300",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-purple-500/20 rounded-2xl text-purple-400",children:d.jsx(Ka,{size:32})}),d.jsx("h3",{className:"text-2xl font-bold",children:"Parterapi"})]}),d.jsx("p",{className:"text-white/80 leading-relaxed mb-6",children:"I parterapi fokuserar vi p dynamiken mellan er. Vi anvnder oss av gestaltmetodik fr att titta p hur ni kommunicerar, hur ni mter varandras behov och var kontakten brister."}),d.jsx("ul",{className:"space-y-4 mb-8",children:["Lsa upp destruktiva konflikmnster","Frdjupa den emotionella kontakten","Hantering av kriser och frtroendebrott","Utforska gemensamma vrderingar och ml"].map((e,t)=>d.jsxs("li",{className:"flex items-center gap-3 text-white/70 text-sm",children:[d.jsx(bc,{size:16,className:"text-purple-400"}),e]},t))})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 md:p-12 hover:bg-white/10 transition-all duration-300",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-indigo-500/20 rounded-2xl text-indigo-400",children:d.jsx(_P,{size:32})}),d.jsx("h3",{className:"text-2xl font-bold",children:"Gruppterapi"})]}),d.jsx("p",{className:"text-white/80 leading-relaxed mb-6",children:"Gruppen fungerar som en spegel. Genom att dela sina upplevelser med andra i liknande situationer skapas en unik form av validering och igenknning som r svr att n i enskild terapi."}),d.jsxs("div",{className:"bg-black/20 p-6 rounded-2xl border border-white/5 space-y-4",children:[d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(va,{className:"text-indigo-400 mt-1",size:20}),d.jsx("p",{className:"text-sm text-white/80 italic",children:'"Att inse att jag inte r ensam r det frsta steget mot verklig frndring."'})]}),d.jsx("p",{className:"text-xs text-white/50",children:"Vi hller kontinuerligt grupper fr t.ex. anhriga, vuxna barn till missbrukare eller personer med liknande traumaupplevelser."})]})]})]}),d.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("div",{className:"mx-auto w-16 h-16 bg-white/10 rounded-full flex items-center justify-center text-indigo-300",children:d.jsx(Fu,{size:32})}),d.jsx("h4",{className:"font-bold",children:"Trygghet i rummet"}),d.jsx("p",{className:"text-sm text-white/60",children:"Vi skapar en ram dr alla parter knner sig hrda och respekterade."})]}),d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("div",{className:"mx-auto w-16 h-16 bg-white/10 rounded-full flex items-center justify-center text-indigo-300",children:d.jsx(Vs,{size:32})}),d.jsx("h4",{className:"font-bold",children:"Relationell vxt"}),d.jsx("p",{className:"text-sm text-white/60",children:"Fokus p hur vi pverkar varandra i realtid  hr och nu."})]}),d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("div",{className:"mx-auto w-16 h-16 bg-white/10 rounded-full flex items-center justify-center text-indigo-300",children:d.jsx(Vb,{size:32})}),d.jsx("h4",{className:"font-bold",children:"Mlmedvetenhet"}),d.jsx("p",{className:"text-sm text-white/60",children:"Vi arbetar med tydliga kontrakt fr att n de resultat ni nskar."})]})]}),d.jsxs("div",{className:"glass bg-gradient-to-r from-indigo-900/40 to-purple-900/40 border border-white/20 rounded-3xl p-10 text-center max-w-4xl mx-auto",children:[d.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Vill ni veta mer?"}),d.jsx("p",{className:"text-white/70 mb-8",children:"Boka ett inledande samtal fr att se om grupp- eller parterapi r rtt vg fr just er."}),d.jsxs("button",{onClick:()=>n(De.CONTACT),className:"px-10 py-4 bg-white text-indigo-900 rounded-full font-bold hover:scale-105 transition-all shadow-xl flex items-center gap-2 mx-auto",children:["Kontakta oss fr bokning ",d.jsx(Fs,{size:20})]})]})]}),u4=({setPage:n})=>d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-10 animate-fade-in space-y-16",children:[d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-16 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/3 h-full bg-gradient-to-l from-blue-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 max-w-4xl",children:[d.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-indigo-400 leading-tight",children:"Utbildning i Gestaltterapi"}),d.jsx("h2",{className:"text-xl md:text-3xl text-white/90 font-light italic mb-8",children:"Frdjupa din nrvaro och professionella skicklighet"}),d.jsx("p",{className:"text-lg md:text-xl text-white/80 leading-relaxed",children:"Vr gestaltutbildning vnder sig till dig som vill arbeta processinriktat och relationellt. Vi fokuserar p kontakten, medvetenheten och det personliga ansvaret i det terapeutiska mtet."})]})]}),d.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-2xl p-6 md:p-8",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-blue-500/20 rounded-xl text-blue-400",children:d.jsx(Vb,{size:28})}),d.jsx("h3",{className:"text-2xl font-bold",children:"Hr, Nu och Hur"})]}),d.jsx("p",{className:"text-white/80 leading-relaxed mb-6",children:"Gestaltterapi r en upplevelsebaserad metod. I utbildningen lr du dig att anvnda dig sjlv som instrument och att arbeta med det som sker i rummet just nu. Vi gr bortom intellektualiseringar och fokuserar p den direkta upplevelsen och hur den formar vra livsmnster."}),d.jsx("p",{className:"text-white/80 leading-relaxed",children:"Utbildningen ger dig verktyg att identifiera oavslutade gestalter och stdja klienten i att n fullbordan och mognad. Vi varvar teori med praktiska vningar, handledning och eget terapiarbete."})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-2xl font-bold px-2",children:"Utbildningens krnomrden"}),d.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:[{title:"Kontaktformler",desc:"Frstelse fr hur vi mter eller undviker kontakt med omvrlden."},{title:"Figur & Grund",desc:"Lr dig se vad som trder fram som mest relevant i stunden."},{title:"Kroppslig Medvetenhet",desc:"Lyssna p kroppens signaler som brare av sanning."},{title:"Den terapeutiska alliansen",desc:"Att bygga en trygg och utmanande relation."}].map((e,t)=>d.jsxs("div",{className:"glass bg-white/5 border border-white/5 p-6 rounded-xl hover:bg-white/10 transition-colors",children:[d.jsx("h4",{className:"font-bold text-blue-300 mb-2",children:e.title}),d.jsx("p",{className:"text-sm text-white/70",children:e.desc})]},t))})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"glass bg-gradient-to-br from-blue-900/20 to-indigo-900/20 border border-blue-500/30 rounded-2xl p-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[d.jsx(Xg,{className:"text-yellow-400",size:24}),d.jsx("h3",{className:"text-xl font-bold",children:"Vem br g?"})]}),d.jsx("p",{className:"text-white/80 text-sm leading-relaxed mb-6",children:"Utbildningen r skrddarsydd fr socionomer, psykologer, behandlingspedagoger och chefer som vill frdjupa sitt ledarskap och sin samtalsmetodik."}),d.jsxs("div",{className:"space-y-3 bg-black/30 p-4 rounded-xl border border-white/5",children:[d.jsxs("div",{className:"flex gap-3 text-xs text-white/70",children:[d.jsx(Sl,{className:"text-blue-400 shrink-0",size:16}),d.jsx("span",{children:"Minst 2 rs yrkeserfarenhet inom mnniskovrdande yrken."})]}),d.jsxs("div",{className:"flex gap-3 text-xs text-white/70",children:[d.jsx(Sl,{className:"text-blue-400 shrink-0",size:16}),d.jsx("span",{children:"Vilja att arbeta med sin egen personliga utveckling."})]})]})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-2xl p-6",children:[d.jsx("h3",{className:"text-xl font-bold mb-4",children:"Intresseanmlan"}),d.jsx("p",{className:"text-sm text-white/60 mb-6",children:"Vi startar nya grupper kontinuerligt. Kontakta oss fr kursstart och kursplan."}),d.jsxs("button",{onClick:()=>n(De.CONTACT),className:"w-full py-3 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-xl font-bold transition-all hover:scale-105 flex items-center justify-center gap-2",children:["Kontakta oss ",d.jsx(Fs,{size:18})]})]})]})]})]}),d4=({setPage:n})=>{const[e,t]=ue.useState(null),i=r=>{t(e===r?null:r)},s=[{id:1,title:"Block 1: Introduktion & Yrkesroll",content:"Hr lggs grunden fr yrkesrollen som behandlingsassistent. Vi gr igenom etik, vrdegrund och vad det innebr att arbeta professionellt med mnniskor i utsatta situationer. Fokus p bemtande och empatisk frmga."},{id:2,title:"Block 2: Kommunikation & Samtalsmetodik",content:"Detta block fokuserar p praktiska verktyg fr kommunikation. Vi trnar p aktivt lyssnande, MI (Motiverande Samtal) och hur man bygger brande relationer med klienter."},{id:3,title:"Block 3: Psykisk Ohlsa & Diagnoser",content:"Grundlggande kunskap om de vanligaste psykiatriska diagnoserna ssom ngest, depression, ADHD och autismspektrumtillstnd. Hur anpassar vi vrt std utifrn olika frutsttningar?"},{id:4,title:"Block 4: Beroendelra & Missbruk",content:"En djupdykning i beroendets mekanismer, bde substansberoende och beteendeberoende. Vi gr igenom olika behandlingsmodeller och terfallsprevention."},{id:5,title:"Block 5: Sociallagstiftning & Dokumentation",content:"Viktiga lagar som styr arbetet, ssom SoL och LSS. Vi lr oss ocks vikten av rttssker dokumentation och hur man skriver genomfrandeplaner."},{id:6,title:"Block 6: Konflikthantering & Lgaffektivt Bemtande",content:"Metoder fr att frebygga och hantera hotfulla situationer. Vi arbetar med lgaffektivt bemtande (LAB) fr att skapa trygghet fr bde personal och klienter."},{id:7,title:"Block 7: Gruppdynamik & Systemteori",content:"Hur fungerar grupper och familjesystem? Vi tittar p roller i grupper och hur man kan arbeta med ntverket runt individen."},{id:8,title:"Block 8: Praktisk Tillmpning & Avslutning",content:"Summering av utbildningen, fallbeskrivningar (case) och praktiska vningar dr vi vver samman kunskapen frn alla tidigare block. Diplomering."}];return d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-10 animate-fade-in space-y-16",children:[d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-16 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/3 h-full bg-gradient-to-l from-emerald-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row items-center justify-between gap-12",children:[d.jsxs("div",{className:"max-w-3xl",children:[d.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-emerald-200 to-teal-400 leading-tight",children:"Behandlingsassistent"}),d.jsx("h2",{className:"text-xl md:text-3xl text-white/90 font-light italic mb-8",children:"En yrkesutbildning fr framtidens vrd och omsorg"}),d.jsx("p",{className:"text-lg md:text-xl text-white/80 leading-relaxed font-light",children:"Vill du arbeta med mnniskor och gra verklig skillnad? Vr utbildning till behandlingsassistent ger dig den teoretiska grund och de praktiska verktyg du behver fr att st trygg i mtet med mnniskor i frndring."})]}),d.jsx("div",{className:"hidden lg:block shrink-0",children:d.jsx(Wa,{src:"/hemsida-bild6.jpeg",alt:"Behandlingsassistent",className:"w-72 h-96",grayscale:!1,defaultRotation:"3deg"})})]})]}),d.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-2xl p-6 md:p-8",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-emerald-500/20 rounded-xl text-emerald-400",children:d.jsx(iP,{size:28})}),d.jsx("h3",{className:"text-2xl font-bold",children:"Om utbildningen"})]}),d.jsx("p",{className:"text-white/80 leading-relaxed mb-6",children:"Vr utbildning r utformad fr att ge dig en bred kompetens som efterfrgas p arbetsmarknaden. Vi varvar frelsningar med grupparbeten, rollspel och reflektion. Mlet r att du efter avslutad utbildning ska knna dig redo att arbeta inom exempelvis HVB-hem, stdboende, ppenvrd eller socialpsykiatri."})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("h3",{className:"text-2xl font-bold px-2 mb-4 flex items-center gap-2",children:[d.jsx(zb,{size:24,className:"text-emerald-400"})," Kursinnehll"]}),d.jsx("div",{className:"space-y-3",children:s.map(r=>d.jsxs("div",{className:`glass border rounded-xl overflow-hidden transition-all duration-300 ${e===r.id?"bg-white/10 border-emerald-500/40 shadow-lg":"bg-white/5 border-white/5 hover:bg-white/10"}`,children:[d.jsxs("button",{onClick:()=>i(r.id),className:"w-full flex items-center justify-between p-5 text-left focus:outline-none",children:[d.jsx("span",{className:`font-bold text-lg ${e===r.id?"text-emerald-300":"text-white/90"}`,children:r.title}),e===r.id?d.jsx(cR,{className:"text-emerald-400",size:24}):d.jsx(My,{className:"text-white/50",size:24})]}),e===r.id&&d.jsxs("div",{className:"px-5 pb-6 pt-0 animate-fade-in",children:[d.jsx("div",{className:"h-px bg-white/10 mb-4 w-full"}),d.jsx("p",{className:"text-white/80 leading-relaxed",children:r.content})]})]},r.id))})]})]}),d.jsx("div",{className:"space-y-6",children:d.jsxs("div",{className:"glass bg-gradient-to-br from-emerald-900/20 to-teal-900/20 border border-emerald-500/30 rounded-2xl p-6 sticky top-6",children:[d.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[d.jsx($a,{size:20,className:"text-emerald-400"})," Kursstart & Upplgg"]}),d.jsxs("div",{className:"space-y-4 mb-8",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center shrink-0",children:d.jsx(Vs,{size:18,className:"text-emerald-300"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-white/50 uppercase font-bold",children:"Studietakt"}),d.jsx("p",{className:"text-white font-medium",children:"Halvfart (50%)"}),d.jsx("p",{className:"text-sm text-white/70",children:"Mjligt att kombinera med arbete"})]})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center shrink-0",children:d.jsx(Sl,{size:18,className:"text-emerald-300"})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs text-white/50 uppercase font-bold",children:"Behrighet"}),d.jsx("p",{className:"text-white font-medium",children:"Grundlggande behrighet"}),d.jsx("p",{className:"text-sm text-white/70",children:"Intervju kan frekomma"})]})]})]}),d.jsx("div",{className:"bg-black/20 p-4 rounded-xl border border-white/5 mb-6",children:d.jsx("p",{className:"text-sm text-white/80 italic",children:'"En utbildning som inte bara ger kunskap, utan ocks personlig utveckling."'})}),d.jsxs("button",{onClick:()=>n(De.CONTACT),className:"w-full py-4 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-xl font-bold transition-all hover:scale-[1.02] flex items-center justify-center gap-2",children:["Ansk nu ",d.jsx(Fs,{size:20})]})]})})]})]})},h4=({setPage:n})=>{const[e,t]=ue.useState(!1),[i,s]=ue.useState(!1),[r,o]=ue.useState({url:"",title:""}),c=[{title:"Ett grundlggande attributionsfel",description:"Varfr dmer vi andra hrdare n oss sjlva? En genomgng av hur vra hjrnor snedvrider verkligheten i sociala relationer.",pdfUrl:"/Attributionsfel-narcissism.pdf",category:"Psykologi",date:"2024-01-20"},{title:"Polarisering och personlighetsstrningar",description:"En djupanalys av hur dmande och polarisering pverkar vra relationer och vr sjlvbild i ett kliniskt sammanhang.",pdfUrl:"/Polarisering-av-personlighetsstrningar .pdf",category:"Klinisk analys",date:"2024-01-15"}],h=(g,v)=>{o({url:g,title:v}),s(!0)},p=()=>{t(!0),setTimeout(()=>t(!1),5e3)};return d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 animate-fade-in space-y-12",children:[d.jsx(H1,{isOpen:i,onClose:()=>s(!1),pdfUrl:r.url,title:r.title}),d.jsxs("div",{className:"text-center max-w-3xl mx-auto space-y-4",children:[d.jsx("h1",{className:"text-4xl md:text-5xl font-black tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-orange-400",children:"Blogg & Reflektion"}),d.jsx("p",{className:"text-lg text-white/70 italic font-light",children:"Tankar om trauma, terhmtning och mnsklig utveckling."})]}),d.jsxs("div",{className:"max-w-5xl mx-auto space-y-8",children:[d.jsxs("h3",{className:"text-sm font-black px-4 text-white/30 uppercase tracking-[0.3em] flex items-center gap-3",children:[d.jsx(va,{size:16,className:"text-orange-500"})," Senaste inlggen"]}),d.jsx("div",{className:"grid gap-6",children:c.map((g,v)=>d.jsxs("div",{className:"glass bg-white/[0.03] border border-white/10 rounded-[2.5rem] p-6 md:p-10 hover:bg-white/[0.05] hover:border-orange-500/30 transition-all duration-500 group relative overflow-hidden flex flex-col md:flex-row gap-8 items-center",children:[d.jsx("div",{className:"md:w-1/4 flex justify-center",children:d.jsx("div",{className:"w-24 h-24 md:w-32 md:h-32 bg-orange-500/10 rounded-3xl flex items-center justify-center text-orange-400 group-hover:scale-110 transition-transform duration-500",children:d.jsx(jb,{size:48})})}),d.jsxs("div",{className:"md:w-3/4 space-y-4 text-center md:text-left",children:[d.jsxs("div",{className:"flex flex-wrap justify-center md:justify-start gap-3 items-center",children:[d.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest bg-orange-500/20 text-orange-400 px-3 py-1 rounded-full",children:g.category}),d.jsxs("span",{className:"text-[10px] font-bold text-white/30 flex items-center gap-1",children:[d.jsx(uR,{size:12})," ",g.date]})]}),d.jsx("h2",{className:"text-2xl md:text-3xl font-black text-white leading-tight group-hover:text-amber-200 transition-colors",children:g.title}),d.jsx("p",{className:"text-white/60 text-sm md:text-base leading-relaxed max-w-2xl font-light",children:g.description}),d.jsxs("button",{onClick:()=>h(g.pdfUrl,g.title),className:"flex items-center gap-2 text-orange-400 font-black text-sm md:text-base hover:gap-4 transition-all mx-auto md:mx-0",children:["Ls hela inlgget ",d.jsx(Fs,{size:20})]})]}),d.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 right-[5%] p-4 opacity-5 group-hover:opacity-10 transition-opacity blur-[1px] pointer-events-none",children:d.jsx("img",{src:"/assets/logo2.png",alt:"Logo",className:"w-40 h-40 md:w-56 md:h-56 object-contain rotate-12"})})]},v))})]}),d.jsx("div",{className:"max-w-5xl mx-auto",children:d.jsxs("div",{className:"glass bg-gradient-to-br from-orange-600/10 to-transparent border border-white/10 rounded-[3rem] p-8 md:p-12 text-center flex flex-col items-center justify-center space-y-6 relative overflow-hidden shadow-2xl",children:[d.jsx("div",{className:"p-4 bg-orange-500/10 rounded-2xl text-orange-400",children:d.jsx(Cg,{size:32})}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("h2",{className:"text-2xl md:text-3xl font-black text-white",children:"Vill du veta nr vi publicerar nsta del?"}),d.jsx("p",{className:"text-white/60 max-w-lg mx-auto leading-relaxed font-light",children:"Registrera dig fr vra mnadsbrev s fr du bde nya artiklar och inbjudningar till vra workshops direkt i korgen."})]}),e?d.jsxs("div",{className:"flex items-center gap-3 px-8 py-3.5 bg-green-500/20 border border-green-500/40 rounded-xl text-green-400 text-sm font-black animate-fade-in uppercase tracking-widest",children:[d.jsx(bc,{size:18}),"Vi hr av oss!"]}):d.jsx("button",{onClick:p,className:"px-8 py-3.5 bg-orange-500 hover:bg-orange-400 text-slate-950 rounded-xl font-black transition-all hover:scale-105 shadow-xl shadow-orange-500/20 flex items-center gap-2 uppercase tracking-widest text-xs",children:"F notis vid nya inlgg"})]})}),d.jsx(V1,{}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto opacity-30 grayscale pointer-events-none",children:["Trauma","Gestaltterapi","Pedagogik","Reflektion"].map(g=>d.jsx("div",{className:"glass bg-white/5 border border-white/10 py-3 rounded-full text-center text-xs uppercase tracking-widest font-bold",children:g},g))})]})},f4=()=>{const[n,e]=ue.useState("info"),[t,i]=ue.useState({name:"",ssn:"",email:"",phone:"",newsletter:!0}),s=r=>{r.preventDefault(),e("success")};return d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-6 md:py-10 animate-fade-in w-full space-y-12",children:[d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-16 text-center",children:[d.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-amber-200 to-orange-400",children:"Horizonten Gemenskap"}),d.jsx("p",{className:"text-xl md:text-2xl text-white/90 font-light italic mb-8",children:"En trygg hamn fr lkning, insikt och tillsammanskap."}),d.jsxs("div",{className:"flex justify-center gap-4 flex-wrap",children:[d.jsx("div",{className:"px-6 py-2 bg-white/10 rounded-full border border-white/20 text-sm",children:"Appen"}),d.jsx("div",{className:"px-6 py-2 bg-white/10 rounded-full border border-white/20 text-sm",children:"Gemenskap"}),d.jsx("div",{className:"px-6 py-2 bg-white/10 rounded-full border border-white/20 text-sm",children:"Sjlvhjlp"})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 hover:bg-white/10 transition-all duration-300",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-orange-500/20 rounded-2xl text-orange-400",children:d.jsx(xR,{size:32})}),d.jsx("h2",{className:"text-2xl font-bold",children:"Appen frn Horizonten"})]}),d.jsx("p",{className:"text-white/80 leading-relaxed mb-6",children:"Vr egen app r hjrtat i vr gemenskap. Hr hittar du ett skert rum dr du kan dela erfarenheter, f std och vxa tillsammans med andra som frstr. Appen r designad fr att vara din fljeslagare i vardagen, fylld med verktyg fr sjlvreglering och reflektion."}),d.jsxs("ul",{className:"space-y-3",children:[d.jsxs("li",{className:"flex items-start gap-3 text-white/70",children:[d.jsx(va,{className:"text-amber-400 shrink-0 mt-1",size:18}),d.jsx("span",{children:"Interaktiv gemenskap fr erfarenhetsutbyte."})]}),d.jsxs("li",{className:"flex items-start gap-3 text-white/70",children:[d.jsx(va,{className:"text-amber-400 shrink-0 mt-1",size:18}),d.jsx("span",{children:"Exklusivt material och guidade vningar."})]})]})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 hover:bg-white/10 transition-all duration-300",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[d.jsx("div",{className:"p-3 bg-red-500/20 rounded-2xl text-red-400",children:d.jsx($a,{size:32})}),d.jsx("h2",{className:"text-2xl font-bold",children:"Terapeutledda mten"})]}),d.jsx("p",{className:"text-white/80 leading-relaxed mb-6",children:"Vi tror p kraften i det gemensamma samtalet. Varje vecka hller vi i terapeutledda sjlvhjlpsmten i appen. Hr fr du professionell guidning i en trygg gruppmilj dr vi fokuserar p praktisk tillmpning av traumafrstelse och lkning."}),d.jsxs("div",{className:"bg-black/20 p-4 rounded-2xl border border-white/5",children:[d.jsx("p",{className:"text-sm font-bold text-orange-300 mb-1",children:"Nr?"}),d.jsx("p",{className:"text-white/70 italic",children:"En gng per vecka, direkt i Horizonten-appen."})]})]})]}),d.jsxs("div",{className:"glass bg-gradient-to-br from-orange-900/20 to-amber-900/20 border border-orange-500/30 rounded-3xl p-8 md:p-12 transition-all duration-500",children:[n==="info"&&d.jsxs("div",{className:"grid md:grid-cols-3 gap-8 items-center animate-fade-in",children:[d.jsx("div",{className:"md:col-span-1 flex justify-center",children:d.jsx(Wa,{src:"/booklet.jpeg",alt:"Boken: Myndighetsinducerat trauma",className:"w-48 h-64",defaultRotation:"3deg"})}),d.jsxs("div",{className:"md:col-span-2 space-y-6",children:[d.jsx("h2",{className:"text-3xl font-bold",children:"Boken: Myndighetsinducerat trauma"}),d.jsx("p",{className:"text-lg text-white/80 leading-relaxed",children:"Vr nyutgivna bok r en djupdykning i hur systemet kan skada och hur vi kan lka. Men boken r mer n bara text  den r en guide."}),d.jsxs("div",{className:"flex items-start gap-4 bg-white/5 p-6 rounded-2xl border border-white/10",children:[d.jsx(Ka,{className:"text-red-400 shrink-0"}),d.jsx("p",{className:"text-white/90 italic",children:'"Tillhrande boken finns en stor mngd sjlvhjlpsmaterial och praktiska vningar i appen, skapade fr att ge dig verktygen att navigera i din egen lkningsprocess."'})]}),d.jsx("button",{onClick:()=>e("form"),className:"px-8 py-3 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-xl font-bold transition-all hover:scale-105",children:"Bestll boken hr"})]})]}),n==="form"&&d.jsxs("div",{className:"max-w-2xl mx-auto animate-fade-in",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsx("h2",{className:"text-3xl font-bold",children:"Bestll boken"}),d.jsx("button",{onClick:()=>e("info"),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:d.jsx(Bu,{size:24,className:"text-white/70"})})]}),d.jsxs("form",{onSubmit:s,className:"space-y-6",children:[d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-bold text-white/80 ml-1",children:"Namn"}),d.jsx("input",{required:!0,type:"text",placeholder:"Ditt namn",className:"w-full p-4 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:border-amber-500 transition-all",value:t.name,onChange:r=>i({...t,name:r.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-bold text-white/80 ml-1",children:"Personnummer"}),d.jsx("input",{required:!0,type:"text",placeholder:"MMDD-XXXX",className:"w-full p-4 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:border-amber-500 transition-all",value:t.ssn,onChange:r=>i({...t,ssn:r.target.value})})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-bold text-white/80 ml-1",children:"E-post"}),d.jsx("input",{required:!0,type:"email",placeholder:"din@epost.se",className:"w-full p-4 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:border-amber-500 transition-all",value:t.email,onChange:r=>i({...t,email:r.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-bold text-white/80 ml-1",children:"Telefon"}),d.jsx("input",{required:!0,type:"tel",placeholder:"070-XXX XX XX",className:"w-full p-4 bg-black/40 border border-white/10 rounded-xl text-white outline-none focus:border-amber-500 transition-all",value:t.phone,onChange:r=>i({...t,phone:r.target.value})})]})]}),d.jsx("div",{className:"bg-black/20 p-4 rounded-xl border border-white/5 mt-4",children:d.jsxs("label",{className:"flex items-center gap-4 cursor-pointer group",children:[d.jsxs("div",{className:"relative flex items-center",children:[d.jsx("input",{type:"checkbox",className:"peer h-6 w-6 cursor-pointer appearance-none rounded-md border border-white/20 bg-black/40 transition-all checked:border-amber-500 checked:bg-amber-500",checked:t.newsletter,onChange:r=>i({...t,newsletter:r.target.checked})}),d.jsx(bc,{size:16,className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 text-black opacity-0 peer-checked:opacity-100 pointer-events-none",strokeWidth:3})]}),d.jsx("span",{className:"text-white/90 font-medium group-hover:text-white transition-colors",children:"Jag vill prenumerera p nyhetsbrevet"})]})}),d.jsxs("button",{type:"submit",className:"w-full py-4 bg-white/10 hover:bg-white/20 border border-white/20 text-white font-bold rounded-xl transition-all hover:scale-[1.01] active:scale-95 flex items-center justify-center gap-3 mt-4",children:["Skicka bestllning ",d.jsx(Ml,{size:20})]})]})]}),n==="success"&&d.jsxs("div",{className:"text-center py-10 animate-fade-in flex flex-col items-center justify-center",children:[d.jsx("div",{className:"w-20 h-20 bg-emerald-500/20 rounded-full flex items-center justify-center mb-6 shadow-xl",children:d.jsx(bc,{size:40,className:"text-emerald-400"})}),d.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Tack fr din bestllning!"}),d.jsxs("p",{className:"text-white/70 max-w-md mx-auto mb-8",children:['Vi har mottagit din order av boken "Myndighetsinducerat trauma". En bekrftelse och faktura kommer att skickas till ',t.email,"."]}),d.jsx("button",{onClick:()=>e("info"),className:"text-white hover:text-amber-400 font-bold underline transition-colors",children:"G tillbaka"})]})]}),d.jsxs("div",{className:"text-center py-6",children:[d.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Vill du bli en del av gemenskapen?"}),d.jsx("p",{className:"text-white/60 mb-6",children:"Ladda ner appen och brja din resa tillsammans med oss."}),d.jsxs("div",{className:"flex justify-center gap-4",children:[d.jsx("button",{className:"px-6 py-2 bg-white/10 hover:bg-white/20 rounded-xl border border-white/20 font-bold transition-all hover:scale-105",children:"App Store"}),d.jsx("button",{className:"px-6 py-2 bg-white/10 hover:bg-white/20 rounded-xl border border-white/20 font-bold transition-all hover:scale-105",children:"Google Play"})]})]})]})},gu=[{id:0,name:"Minerva Kassab",email:"minerva@klattertradet.se",age:36,role:"Samtalsterapeut",subRole:"Relationsspecialist",desc:"Erbjuder stdjande samtal och terapi med fokus p personlig utveckling och relationshantering.",image:"/assets/minerva_profil.jpg"},{id:1,name:"Mattias O Sandin",email:"mattias@klattertradet.se",age:34,role:"Gestalt- & Hypnosterapeut",subRole:"Resursfokuserad samtalsterapeut",desc:"Arbetar med undermedvetna processer och kroppslig frankring i nuet.",image:"https://images.unsplash.com/photo-1500648767791-00dcc994a43e?q=80&w=1000&auto=format&fit=crop"},{id:2,name:"Billy Ljungberg",email:"billy@klattertradet.se",age:35,role:"Traumaterapeut",subRole:"Utbildare & Handledare",desc:"Specialiserad p myndighetsinducerat trauma och komplexa livssituationer.",image:"/billy-bokning.jpeg"},{id:3,name:"Linda Matta",email:"linda@klattertradet.se",age:46,role:"Samtalsterapeut & Hudterapeut",subRole:"Holistisk Hlsa",desc:"Erbjuder en unik helhetssyn dr det inre och yttre vlmendet mts.",image:"/assets/linda-matta-new.jpeg"},{id:4,name:"Malin Widerlv",email:"malin@klattertradet.se",age:42,role:"Behandlingspedagog",subRole:"Socialarbetare & Familjeombud",desc:"Expertis inom socialt arbete och familjedynamik med fokus p trygga lsningar fr hela familjen.",image:"/assets/malin-widerlov.png"}],p4=()=>{const[n,e]=ue.useState(0),[t,i]=ue.useState({x:0,y:0}),[s,r]=ue.useState(!1),[o,c]=ue.useState(null),[h,p]=ue.useState(null),[g,v]=ue.useState(1),y=ue.useRef(null),[w,E]=ue.useState(!1),[R,N]=ue.useState({name:"",email:"",phone:"",meetingForm:"Fysiskt p mottagning",reason:""}),A=z=>{if(!y.current)return;const W=y.current.getBoundingClientRect(),L=z.clientX-(W.left+W.width/2),B=z.clientY-(W.top+W.height/2);i({x:Number((B/(W.height/2)*-10).toFixed(2)),y:Number((L/(W.width/2)*10).toFixed(2))})},D=(()=>{const z=[],W=new Date;for(let L=0;L<7;L++){const B=new Date(W);if(B.setDate(W.getDate()+L),B.getDay()!==0&&(z.push({day:B.toLocaleDateString("sv-SE",{weekday:"short"}).replace(/^\w/,Y=>Y.toUpperCase()),num:B.getDate().toString(),full:B.toLocaleDateString("sv-SE",{day:"numeric",month:"short"})}),z.length>=5))break}return z})(),U=["07:00","08:00","09:00","10:30","13:00","14:45","16:00","17:30"],j=z=>{z.preventDefault();const W=gu[n],L="billy@klattertradet.se";let B=W.email;W.email!==L&&(B+=`,${L}`);const Y=W.name,ee=o?`${o} ${new Date().toLocaleDateString("sv-SE",{month:"long",year:"numeric"})}`:"",Q=`Ny bokning: ${R.name} - ${ee} kl ${h}`,ce=`
NY BOKNING VIA HEMSIDAN

TERAPEUT: ${Y}
DATUM: ${ee}
TID: ${h}
MTESFORM: ${R.meetingForm}

KONTAKTUPPGIFTER:
Namn: ${R.name}
E-post: ${R.email}
Telefon: ${R.phone}

SYFTE / MEDDELANDE:
${R.reason||"Ingen beskrivning angiven."}

---
Detta r ett automatiskt genererat utkast frn hemsidan.
    `.trim(),oe=`mailto:${B}?subject=${encodeURIComponent(Q)}&body=${encodeURIComponent(ce)}`;v(3),setTimeout(()=>{window.location.href=oe},500)},F=z=>{z.preventDefault(),E(!0)};return d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-10 animate-fade-in space-y-16",children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between px-4 gap-6",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-amber-500 text-[10px] font-bold uppercase tracking-[0.3em] mb-2 block",children:"Tidsbokning"}),d.jsx("h1",{className:"text-4xl md:text-5xl font-black text-white italic tracking-tight",children:"Vlj en tid i kalendern"})]}),d.jsx("div",{className:"inline-flex bg-white/5 p-1.5 rounded-2xl border border-white/10 backdrop-blur-xl",children:gu.map(z=>d.jsx("button",{onClick:()=>{e(z.id),v(1),p(null),c(null)},className:`px-6 md:px-8 py-3 rounded-xl text-sm font-bold transition-all duration-300 ${n===z.id?"bg-white/10 border border-white/20 text-white scale-105":"text-white/50 hover:text-white hover:bg-white/5"}`,children:z.name},z.id))})]}),d.jsxs("div",{className:"flex flex-col lg:flex-row items-start gap-12 lg:gap-20",children:[d.jsx("div",{className:"lg:w-1/2 w-full flex justify-center",children:d.jsxs("div",{ref:y,onMouseMove:A,onMouseEnter:()=>r(!0),onMouseLeave:()=>{r(!1),i({x:0,y:0})},style:{perspective:"1000px"},className:"relative cursor-pointer group",children:[d.jsxs("div",{className:"relative w-[300px] md:w-[380px] aspect-[3/4] rounded-[2.5rem] overflow-hidden shadow-2xl transition-all duration-500 ease-out border border-white/10",style:{transform:`rotateX(${t.x}deg) rotateY(${t.y}deg) scale(${s?1.05:1})`,transformStyle:"preserve-3d"},children:[d.jsxs("div",{className:"absolute inset-0 bg-slate-900",children:[d.jsx("img",{src:gu[n].image,className:"w-full h-full object-cover object-top opacity-60 grayscale group-hover:grayscale-0 transition-all duration-1000",alt:"Therapist"}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-90"})]}),d.jsxs("div",{className:"absolute inset-0 p-10 flex flex-col justify-end",style:{transform:"translateZ(60px)"},children:[d.jsxs("div",{className:"mb-4",children:[d.jsxs("span",{className:"text-amber-500 text-[10px] font-bold tracking-[0.3em] uppercase block mb-1",children:[gu[n].age," r  ",gu[n].subRole]}),d.jsx("h2",{className:"text-4xl font-black text-white leading-none",children:gu[n].name})]}),d.jsxs("p",{className:"text-white/70 text-sm leading-relaxed mb-6 border-l-2 border-amber-500/50 pl-4 italic",children:['"',gu[n].desc,'"']}),d.jsxs("div",{className:"flex items-center gap-2 text-amber-500/80 text-[11px] font-bold uppercase tracking-widest",children:[d.jsx(Sl,{size:14})," Certifierad Behandlare"]})]})]}),d.jsx("div",{className:"absolute -inset-4 bg-amber-500/10 blur-3xl -z-10 rounded-full opacity-50 group-hover:opacity-100 transition-opacity"})]})}),d.jsx("div",{className:"lg:w-1/2 w-full",children:d.jsx("div",{className:"glass bg-white/5 border border-white/10 rounded-[2.5rem] p-8 md:p-12 shadow-2xl min-h-[550px] flex flex-col",children:g===1?d.jsxs("div",{className:"animate-fade-in flex-1 flex flex-col",children:[d.jsx("h3",{className:"text-3xl font-black mb-2 text-white italic",children:"Boka session"}),d.jsxs("p",{className:"text-zinc-500 text-sm mb-10",children:["Vlj ett datum och en tid fr ditt mte med ",gu[n].name,"."]}),d.jsxs("div",{className:"space-y-10 flex-1",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-amber-500 mb-4 block",children:new Date().toLocaleDateString("sv-SE",{month:"long",year:"numeric"})}),d.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 no-scrollbar",children:D.map(z=>d.jsxs("button",{onClick:()=>{c(z.num),p(null)},className:`flex flex-col items-center min-w-[75px] py-5 rounded-2xl border transition-all ${o===z.num?"bg-amber-500 border-amber-500 text-black shadow-xl scale-105":"bg-white/5 border-white/10 text-zinc-400 hover:border-white/30"}`,children:[d.jsx("span",{className:"text-[10px] uppercase font-bold mb-1",children:z.day}),d.jsx("span",{className:"text-xl font-black",children:z.num})]},z.num))})]}),d.jsxs("div",{children:[d.jsx("label",{className:`text-[10px] font-bold uppercase tracking-widest mb-4 block transition-colors ${o?"text-amber-500":"text-zinc-700"}`,children:"Tillgngliga tider"}),d.jsx("div",{className:"grid grid-cols-3 gap-3",children:U.map(z=>d.jsx("button",{disabled:!o,onClick:()=>p(z),className:`py-4 rounded-xl text-sm font-black border transition-all ${o?h===z?"bg-white text-black border-white shadow-lg":"bg-transparent border-white/10 text-white/80 hover:bg-white/5":"bg-white/5 border-white/5 text-zinc-700 cursor-not-allowed"}`,children:z},z))})]})]}),d.jsx("div",{className:"mt-8",children:d.jsxs("button",{disabled:!h,onClick:()=>v(2),className:`w-full py-5 rounded-xl font-bold text-xl transition-all flex items-center justify-center gap-3 group border border-white/20 ${h?"bg-white/10 hover:bg-white/20 text-white shadow-xl hover:scale-105":"bg-white/5 text-white/30 border-white/5 cursor-not-allowed"}`,children:["Fortstt med bokning",d.jsx(Fs,{size:24,className:h?"group-hover:translate-x-1 transition-transform":""})]})})]}):g===2?d.jsxs("div",{className:"animate-in fade-in zoom-in-95 duration-300 flex-1",children:[d.jsxs("button",{onClick:()=>v(1),className:"text-zinc-500 hover:text-white mb-8 text-sm flex items-center gap-2 font-bold",children:[d.jsx(lR,{size:18})," G tillbaka till tider"]}),d.jsx("h3",{className:"text-3xl font-black mb-2 text-white italic",children:"Ngra frgor..."}),d.jsx("p",{className:"text-zinc-500 text-sm mb-8 italic",children:"Vi behver veta lite mer om dig fr att frbereda vrt mte."}),d.jsxs("form",{className:"space-y-6",onSubmit:j,children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase text-amber-500 ml-1",children:"Vad heter du?"}),d.jsx("input",{type:"text",required:!0,placeholder:"Fr- och efternamn",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-4 text-white outline-none focus:border-amber-500 transition-all",value:R.name,onChange:z=>N({...R,name:z.target.value})})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase text-amber-500 ml-1",children:"Din e-post"}),d.jsx("input",{type:"email",required:!0,placeholder:"namn@epost.se",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-4 text-white outline-none focus:border-amber-500 transition-all",value:R.email,onChange:z=>N({...R,email:z.target.value})})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase text-amber-500 ml-1",children:"Telefonnummer"}),d.jsx("input",{type:"tel",required:!0,placeholder:"07x-xxx xx xx",className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-4 text-white outline-none focus:border-amber-500 transition-all",value:R.phone,onChange:z=>N({...R,phone:z.target.value})})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase text-amber-500 ml-1",children:"Hur vill du ses?"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:["Fysiskt p mottagning","Digitalt via Zoom"].map(z=>d.jsx("button",{type:"button",onClick:()=>N({...R,meetingForm:z}),className:`px-3 py-3 rounded-xl text-[11px] font-bold transition-all border ${R.meetingForm===z?"bg-amber-500/20 border-amber-500 text-amber-400":"bg-black/20 border-white/10 text-white/40 hover:border-white/30"}`,children:z},z))})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-bold uppercase text-amber-500 ml-1",children:"Vad nskar du hjlp med? (Valfritt)"}),d.jsx("textarea",{placeholder:"Kort beskrivning av ditt rende...",rows:3,className:"w-full bg-black/40 border border-white/10 rounded-xl px-4 py-4 text-white outline-none focus:border-amber-500 transition-all resize-none",value:R.reason,onChange:z=>N({...R,reason:z.target.value})})]})]}),d.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5 flex items-center gap-4",children:[d.jsx($a,{size:20,className:"text-amber-500"}),d.jsxs("span",{className:"text-sm font-bold text-white/90",children:["Vald tid: ",o," ",new Date().toLocaleDateString("sv-SE",{month:"short"})," kl ",h]})]}),d.jsx("button",{className:"w-full bg-white/10 hover:bg-white/20 border border-white/20 text-white py-5 rounded-xl font-bold text-xl transition-all hover:scale-[1.01] active:scale-95 mt-4",children:"Slutfr bokning"})]})]}):d.jsxs("div",{className:"text-center py-20 animate-in zoom-in-90 duration-500 flex-1 flex flex-col items-center justify-center",children:[d.jsx("div",{className:"w-24 h-24 bg-emerald-500/20 text-emerald-400 rounded-full flex items-center justify-center mb-8 shadow-2xl",children:d.jsx(OS,{size:48})}),d.jsx("h3",{className:"text-3xl md:text-4xl font-black mb-4 text-white italic",children:"Vlkommen till vr bokningspanel"}),d.jsxs("p",{className:"text-zinc-300 text-lg mb-6 max-w-sm mx-auto leading-relaxed",children:["Tack ",R.name.split(" ")[0],"! Vad bra att du hrde av dig till oss och vi terkommer till dig snarast efter att vi mottagit mailet!"]}),d.jsx("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 mb-8 text-xs text-zinc-500 max-w-xs italic",children:'Notera: Ditt e-postprogram har ppnats. Vnligen klicka p "Skicka" fr att slutfra bokningen.'}),d.jsx("button",{onClick:()=>{v(1),c(null),p(null),N({name:"",email:"",phone:"",meetingForm:"Fysiskt p mottagning",reason:""})},className:"text-white hover:text-amber-400 font-bold hover:underline tracking-widest text-sm uppercase",children:"Gr en ny bokning"})]})})})]}),d.jsxs("div",{className:"grid lg:grid-cols-5 gap-10",children:[d.jsx("div",{className:"lg:col-span-2 space-y-6",children:d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-10 space-y-10",children:[d.jsx("h2",{className:"text-3xl font-black text-white italic",children:"Kontakt"}),d.jsxs("div",{className:"space-y-8",children:[d.jsxs("div",{className:"flex items-start gap-5",children:[d.jsx("div",{className:"p-4 bg-white/5 border border-white/10 rounded-2xl text-amber-500 shrink-0",children:d.jsx(Bb,{size:24})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] text-zinc-500 uppercase tracking-widest mb-1 font-bold",children:"Mottagning"}),d.jsx("p",{className:"text-white font-medium text-lg",children:"Gullregnsgatan 9A, Gvle"})]})]}),d.jsxs("div",{className:"flex items-start gap-5",children:[d.jsx("div",{className:"p-4 bg-white/5 border border-white/10 rounded-2xl text-amber-500 shrink-0",children:d.jsx(w0,{size:24})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-[10px] text-zinc-500 uppercase tracking-widest mb-1 font-bold",children:"E-post"}),d.jsx("p",{className:"text-white font-medium text-lg",children:"billy@klattertradet.se"})]})]})]})]})}),d.jsx("div",{className:"lg:col-span-3",children:w?d.jsxs("div",{className:"glass bg-white/5 border border-white/10 p-12 rounded-[40px] text-center flex flex-col items-center justify-center min-h-[400px]",children:[d.jsx(OS,{size:64,className:"text-emerald-500 mb-6"}),d.jsx("h2",{className:"text-3xl font-black text-white mb-4 italic",children:"Tack!"}),d.jsx("p",{className:"text-zinc-400",children:"Vi terkommer till dig s snart vi kan."})]}):d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-10 md:p-12",children:[d.jsxs("div",{className:"flex items-center gap-4 mb-10",children:[d.jsx("div",{className:"w-12 h-12 bg-amber-500/10 rounded-xl flex items-center justify-center",children:d.jsx(KD,{className:"text-amber-500",size:28})}),d.jsx("h2",{className:"text-3xl font-black text-white italic",children:"vriga frgor"})]}),d.jsxs("form",{onSubmit:F,className:"space-y-8",children:[d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsx("input",{required:!0,placeholder:"Ditt namn",type:"text",className:"w-full p-4 bg-black/40 border border-white/10 rounded-2xl text-white outline-none focus:border-amber-500 transition-all"}),d.jsx("input",{required:!0,placeholder:"Din e-post",type:"email",className:"w-full p-4 bg-black/40 border border-white/10 rounded-2xl text-white outline-none focus:border-amber-500 transition-all"})]}),d.jsx("textarea",{rows:5,placeholder:"Ditt meddelande...",className:"w-full p-4 bg-black/40 border border-white/10 rounded-2xl text-white outline-none focus:border-amber-500 transition-all resize-none"}),d.jsxs("button",{type:"submit",className:"w-full py-6 bg-white/10 hover:bg-white/20 border border-white/20 text-white font-bold rounded-xl shadow-xl transition-all hover:scale-[1.01] active:scale-95 flex items-center justify-center gap-3 text-lg",children:["Skicka meddelande ",d.jsx(Ml,{size:20})]})]})]})})]}),d.jsx(V1,{})]})},m4=()=>{const[n,e]=ue.useState(!1),[t,i]=ue.useState(!1),s=new Date().getFullYear(),r=Array.from({length:s-1990+1},(c,h)=>s-h),o=c=>{c.preventDefault();const h=new FormData(c.currentTarget),p=Object.fromEntries(h.entries());console.log("Survey Data:",p),i(!0),window.scrollTo(0,0)};return t?d.jsx("div",{className:"container mx-auto px-4 py-20 flex items-center justify-center animate-fade-in min-h-[70vh]",children:d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-xl border border-white/20 p-12 rounded-[40px] max-w-2xl w-full text-center shadow-2xl",children:[d.jsx("div",{className:"mb-6 flex justify-center text-green-400",children:d.jsx(bc,{size:64})}),d.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Tack fr din medverkan!"}),d.jsx("p",{className:"text-lg text-white/80 mb-6 leading-relaxed",children:"Genom att dela din erfarenhet har du gett oss ett viktigt bidrag i arbetet med att synliggra de mnskliga konsekvenserna av myndigheters agerande."}),d.jsxs("div",{className:"bg-white/5 p-6 rounded-2xl border border-white/10 text-left space-y-4 mb-8",children:[d.jsx("h3",{className:"font-bold text-white",children:"Behver du std?"}),d.jsx("p",{className:"text-white/70 text-sm",children:"Besk grna vra sjlvhjlpsmten i Horizonten app, det r gratis och tillgngligt fr alla."})]}),d.jsxs("div",{className:"text-white/60 text-sm",children:[d.jsx("p",{children:"Med vrme och styrka,"}),d.jsx("p",{children:"Styrelsen p Horizonten Social-kraft & Klttertrdet AB"})]}),d.jsx("button",{onClick:()=>i(!1),className:"mt-8 text-white hover:text-amber-400 font-medium underline transition-colors",children:"G tillbaka till formulret"})]})}):d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-10 animate-fade-in max-w-4xl",children:[d.jsxs("div",{className:"text-center mb-12 space-y-4",children:[d.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-200 to-indigo-400",children:"Kraftsamling fr Barnens Bsta"}),d.jsx("h2",{className:"text-xl text-white/80 font-light italic",children:"Upplevelser av rttsskerhet i den Svenska barnavrden"})]}),d.jsxs("div",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8 md:p-12 shadow-2xl",children:[d.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/30 p-6 rounded-2xl mb-10 text-white/90 leading-relaxed space-y-4",children:[d.jsxs("div",{className:"flex items-start gap-3",children:[d.jsx(_0,{className:"text-blue-400 shrink-0 mt-1",size:20}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("p",{children:"Vi p Horizonten och Klttertrdet genomfr i samarbete med Socialkraft genomfr denna kartlggning fr att frst och synliggra de upplevelser och konsekvenser som familjer erfar i samband med ett rende om omhndertagande av barn."}),d.jsx("p",{children:"Syftet r att samla in ett brett underlag fr att kunna belysa hur dessa processer kan pverka familjer (frldrar och framfrallte barnen)- och fr att kunna beskriva det vi kallar Myndighetsinducerat trauma."}),d.jsxs("p",{className:"text-sm opacity-90",children:["Det du skriver kommer hanteras enligt vr integritets & sekretesspolicy som du hittar p lnken hr: ",d.jsx("a",{href:"https://klattertradet.se/integritet-sekretess-policy",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:underline underline-offset-2 font-medium",children:"https://klattertradet.se/integritet-sekretess-policy"})]})]})]}),d.jsx("p",{className:"ml-8 text-xs font-bold text-blue-300",children:"Underskningen tar mellan 3-8 minuter. Alla frgor frutom den frsta r frivilliga."})]}),d.jsxs("form",{onSubmit:o,className:"space-y-12",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-xl font-bold text-blue-300 border-l-4 border-blue-500 pl-4",children:"Dataskydd och Samtycke"}),d.jsxs("label",{className:"flex items-start gap-3 cursor-pointer p-4 bg-white/5 rounded-xl hover:bg-white/10 transition-colors",children:[d.jsx("input",{type:"checkbox",name:"consent",required:!0,className:"mt-1 w-5 h-5 rounded text-blue-500 bg-black/30 border-white/20"}),d.jsxs("span",{className:"text-white/80 text-sm",children:["Jag har lst informationen ovan, tagit del av ",d.jsx("a",{href:"https://klattertradet.se/integritet-sekretess-policy",target:"_blank",className:"text-blue-400 hover:underline",children:"integritetspolicyn"})," och samtycker till att Social-kraft behandlar mina svar i enlighet med beskrivningen. ",d.jsx("span",{className:"text-red-400",children:"*"})]})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-xl font-bold text-blue-300 border-l-4 border-blue-500 pl-4",children:"1. Din grundlggande upplevelse"}),d.jsxs("p",{className:"text-white/90 font-medium",children:["Upplever du att du eller din familj har blivit felaktigt eller illa behandlad av socialtjnsten i samband med ett rende om omhndertagande av barn? ",d.jsx("span",{className:"text-red-400",children:"*"})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[d.jsx("input",{type:"radio",name:"experience",value:"Ja",required:!0,className:"w-5 h-5 text-blue-500 bg-black/30 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white",children:"Ja"})]}),d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[d.jsx("input",{type:"radio",name:"experience",value:"Nej",className:"w-5 h-5 text-blue-500 bg-black/30 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white",children:"Nej"})]})]}),d.jsx("p",{className:"text-sm text-white/50 italic",children:"Stort tack! Bara genom att svara p fregende frga har du bidragit med ovrderlig information. Varje extra steg du orkar ta ger oss djupare kunskap."})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-xl font-bold text-blue-300 border-l-4 border-blue-500 pl-4",children:"2. Hur vill du delta?"}),d.jsx("p",{className:"text-white/90",children:"Vlj det alternativ som passar dig bst."}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[d.jsx("input",{type:"radio",name:"participation_type",value:"Anonym",onClick:()=>e(!1),className:"w-5 h-5 text-blue-500 bg-black/30 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white",children:"Jag vill delta helt anonymt."})]}),d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[d.jsx("input",{type:"radio",name:"participation_type",value:"Kontakt",onClick:()=>e(!0),className:"w-5 h-5 text-blue-500 bg-black/30 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white",children:"Jag kan tnka mig att bli kontaktad fr eventuella fljdfrgor eller djupintervjuer."})]})]}),n&&d.jsxs("div",{className:"mt-6 p-6 bg-black/30 border border-white/10 rounded-xl space-y-4 animate-fade-in",children:[d.jsx("p",{className:"font-bold text-white/90 mb-2",children:"Fyll i de kontaktuppgifter du r bekvm med att dela:"}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"Namn"}),d.jsx("input",{type:"text",name:"name",className:"w-full p-3 bg-white/5 border border-white/10 rounded-lg text-white outline-none focus:border-blue-500 transition-colors"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"E-post"}),d.jsx("input",{type:"email",name:"email",className:"w-full p-3 bg-white/5 border border-white/10 rounded-lg text-white outline-none focus:border-blue-500 transition-colors"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm text-white/60 mb-1",children:"Telefonnummer"}),d.jsx("input",{type:"tel",name:"phone",className:"w-full p-3 bg-white/5 border border-white/10 rounded-lg text-white outline-none focus:border-blue-500 transition-colors"})]})]})]}),d.jsxs("div",{className:"space-y-8",children:[d.jsx("h3",{className:"text-xl font-bold text-blue-300 border-l-4 border-blue-500 pl-4",children:"3. P vilket eller vilka stt upplevde du dig felbehandlad?"}),d.jsx("p",{className:"text-sm text-white/60",children:"Vlj alla alternativ som stmmer in. Detta hjlper oss frst de processer som kan leda till myndighetsinducerat trauma."}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h4",{className:"font-bold text-white/90 border-b border-white/10 pb-2",children:"Maktlshet och Inflytande"}),d.jsxs("div",{className:"space-y-2",children:[[{val:"maktls",label:"Jag knde mig maktls och helt utlmnad till systemet."},{val:"omyndigfrklarad",label:"Jag upplevde att jag blev 'omyndigfrklarad' och/eller inte lyssnad p."},{val:"inflytande_frsvann",label:"Mitt inflytande ver mitt barns situation frsvann helt."}].map(c=>d.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[d.jsx("input",{type:"checkbox",name:"mistreatment",value:c.val,className:"mt-1 w-4 h-4 rounded text-blue-500 bg-black/30 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white text-sm",children:c.label})]},c.val)),d.jsx("input",{type:"text",name:"mistreatment_other_1",placeholder:"Annat...",className:"w-full mt-2 p-2 bg-black/30 border border-white/10 rounded text-sm text-white placeholder-white/30 outline-none focus:border-blue-500"})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h4",{className:"font-bold text-white/90 border-b border-white/10 pb-2",children:"Beslutsunderlag och Rttsskerhet"}),d.jsx("div",{className:"space-y-2",children:[{val:"saknad_grund",label:"Jag/andra anser att det saknades objektiv grund eller tillrckliga bevis fr ingripandet."},{val:"vinklad_dok",label:"Jag upplevde att dokumentationen (journaler, utredningar) var vinklad eller innehll direkta felaktigheter."},{val:"ignorerad_bild",label:"Min bild av situationen och min kunskap om mitt barn ignorerades (jag frlorade tolkningsfretrdet)."}].map(c=>d.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[d.jsx("input",{type:"checkbox",name:"legal",value:c.val,className:"mt-1 w-4 h-4 rounded text-blue-500 bg-black/30 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white text-sm",children:c.label})]},c.val))})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h4",{className:"font-bold text-white/90 border-b border-white/10 pb-2",children:"Kommunikation och Bemtande"}),d.jsx("div",{className:"space-y-2",children:[{val:"bristfllig",label:"Kommunikationen med socialtjnsten var bristfllig, otydlig eller obefintlig."},{val:"respektlst",label:"Jag upplevde bemtandet som respektlst, dmande eller hotfullt."},{val:"brist_info",label:"Jag fick inte tillrcklig eller korrekt information om processen eller mina rttigheter."}].map(c=>d.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[d.jsx("input",{type:"checkbox",name:"comm",value:c.val,className:"mt-1 w-4 h-4 rounded text-blue-500 bg-black/30 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white text-sm",children:c.label})]},c.val))})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h4",{className:"font-bold text-white/90 border-b border-white/10 pb-2",children:"Lngsiktiga Konsekvenser"}),d.jsxs("div",{className:"space-y-2",children:[[{val:"skadad_tillit",label:"Min tillit till myndigheter och samhllet har skadats allvarligt."},{val:"psykisk_ohlsa",label:"Processen har direkt orsakat mig eller min familj psykisk ohlsa (t.ex. ngest, depression, PTSD-symptom)."}].map(c=>d.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[d.jsx("input",{type:"checkbox",name:"cons",value:c.val,className:"mt-1 w-4 h-4 rounded text-blue-500 bg-black/30 border-white/20"}),d.jsx("span",{className:"text-white/80 group-hover:text-white text-sm",children:c.label})]},c.val)),d.jsx("textarea",{name:"cons_other",placeholder:"Annat: Sammanfatta i korthet med egna ord",rows:2,className:"w-full mt-2 p-3 bg-black/30 border border-white/10 rounded text-sm text-white placeholder-white/30 outline-none focus:border-blue-500"})]})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-xl font-bold text-blue-300 border-l-4 border-blue-500 pl-4",children:"4. Din redogrelse"}),d.jsx("p",{className:"text-sm text-white/60",children:"Detta avsnitt r helt frivilligt, men din berttelse hjlper oss att frst helheten."}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("label",{className:"block text-white/90 font-medium",children:"A) Vad var det som utlste socialtjnstens utredning?"}),d.jsxs("label",{className:"flex items-center gap-2 text-sm text-white/70 mb-2",children:[d.jsx("input",{type:"checkbox",name:"no_redogorelse",className:"rounded text-blue-500 bg-black/30 border-white/20"})," Kan inte redogra pga bristande utredning"]}),d.jsx("textarea",{name:"redogorelse_start",placeholder:"Min redogrelse...",rows:4,className:"w-full p-4 bg-black/30 border border-white/10 rounded-xl text-white outline-none focus:border-blue-500"})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("label",{className:"block text-white/90 font-medium",children:"B) Vilken pverkan hade processen p dig och din familj?"}),d.jsx("p",{className:"text-xs text-white/50",children:"Tnk grna p hlsa, ekonomi, sociala relationer, stress, sjlvbild. Upplever du att dina ord tappade sitt vrde?"}),d.jsx("textarea",{name:"paverkan",placeholder:"Beskriv pverkan hr...",rows:4,className:"w-full p-4 bg-black/30 border border-white/10 rounded-xl text-white outline-none focus:border-blue-500"})]})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-xl font-bold text-blue-300 border-l-4 border-blue-500 pl-4",children:"5. Bakgrundsinformation"}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm text-white/70",children:"Vilken kommun gllde rendet?"}),d.jsx("input",{type:"text",name:"kommun",className:"w-full p-3 bg-black/30 border border-white/10 rounded-xl text-white outline-none focus:border-blue-500"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-sm text-white/70",children:"Vilket r inleddes rendet ungefr?"}),d.jsxs("select",{name:"start_year",className:"w-full p-3 bg-black/30 border border-white/10 rounded-xl text-white outline-none focus:border-blue-500",children:[d.jsx("option",{value:"",className:"bg-gray-900",children:"Vlj rtal..."}),r.map(c=>d.jsx("option",{value:c,className:"bg-gray-900",children:c},c))]})]})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-xl font-bold text-blue-300 border-l-4 border-blue-500 pl-4",children:"6. vriga kommentarer"}),d.jsx("p",{className:"text-sm text-white/60",children:"Hr kan du frklara varfr du hoppat ver vissa frgor eller lmna andra tillgg."}),d.jsx("textarea",{name:"extra_comments",rows:3,className:"w-full p-4 bg-black/30 border border-white/10 rounded-xl text-white outline-none focus:border-blue-500"})]}),d.jsxs("button",{type:"submit",className:"w-full py-5 bg-white/10 hover:bg-white/20 border border-white/20 text-white font-bold rounded-xl shadow-xl transition-all hover:scale-[1.01] active:scale-95 flex items-center justify-center gap-3",children:["Skicka in mitt svar ",d.jsx(Ml,{size:20})]})]})]})]})},g4=()=>{const n=[{category:"E-bcker",items:[{title:"Myndighetsinducerat trauma - En introduktion",desc:"En sammanfattning av grunderna i MiT-modellen och hur du brjar din lkningsresa.",icon:Sw,color:"text-amber-400",size:"2.4 MB"},{title:"Gestaltterapi i vardagen",desc:"Praktiska verktyg fr att anvnda gestaltmetodik i dina nra relationer.",icon:Sw,color:"text-blue-400",size:"1.8 MB"},{title:"Narcissism, en problematisering av etiketter",desc:"En djupdykning i hur diagnoser och etiketter pverkar individens sjlvbild och den terapeutiska processen.",icon:Sw,color:"text-purple-400",size:"2.1 MB"}]},{category:"Arbetsmaterial & Mallar",items:[{title:"Sjlvreglerings-schema (Veckoplanering)",desc:"Ett verktyg fr att kartlgga ditt nervsystems reaktioner under veckan.",icon:tP,color:"text-emerald-400",size:"0.5 MB"},{title:"Checklista infr myndighetsmten",desc:"Gr din rst hrd. En guide fr att frbereda dig mentalt och praktiskt.",icon:jb,color:"text-orange-400",size:"0.3 MB"}]},{category:"vningar & Verktyg",items:[{title:"Grounding-vningar fr hemmabruk",desc:"Fem enkla vningar fr att komma tillbaka till nuet nr stressen tar ver.",icon:Ka,color:"text-red-400",size:"1.2 MB"},{title:"Self-care modellen: Arbetsblad",desc:"Frdjupat arbetsblad fr att arbeta med dina grundsr p egen hand.",icon:va,color:"text-purple-400",size:"0.9 MB"}]}];return d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-10 animate-fade-in space-y-12",children:[d.jsxs("div",{className:"text-center max-w-3xl mx-auto space-y-4",children:[d.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-emerald-300 to-teal-500",children:"Nedladdningar"}),d.jsx("p",{className:"text-lg text-white/70",children:"Hr har vi samlat resurser, e-bcker och arbetsmaterial som hjlper dig i din personliga eller professionella utveckling."})]}),d.jsx("div",{className:"space-y-16",children:n.map((e,t)=>d.jsxs("div",{className:"space-y-6",children:[d.jsx("h2",{className:"text-2xl font-bold border-l-4 border-emerald-500 pl-4 text-white/90",children:e.category}),d.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:e.items.map((i,s)=>d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-6 hover:bg-white/10 transition-all duration-300 group flex flex-col h-full",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsx("div",{className:`p-3 bg-white/5 rounded-2xl ${i.color} group-hover:scale-110 transition-transform`,children:d.jsx(i.icon,{size:28})}),d.jsxs("span",{className:"text-[10px] font-bold text-white/30 uppercase tracking-widest bg-black/20 px-3 py-1 rounded-full border border-white/5",children:["PDF | ",i.size]})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"text-xl font-bold mb-2 group-hover:text-white transition-colors",children:i.title}),d.jsx("p",{className:"text-white/60 text-sm leading-relaxed mb-6",children:i.desc})]}),d.jsxs("button",{onClick:()=>alert(`Startar nedladdning av: ${i.title}`),className:"w-full py-3 bg-white/10 hover:bg-white/20 border border-white/20 text-white rounded-xl font-bold text-sm transition-all hover:scale-[1.02] active:scale-95 flex items-center justify-center gap-2",children:[d.jsx(dR,{size:18})," Ladda ner material"]})]},s))})]},t))}),d.jsxs("div",{className:"glass bg-emerald-900/10 border border-emerald-500/20 rounded-3xl p-8 text-center max-w-2xl mx-auto mt-12",children:[d.jsx(va,{className:"mx-auto text-emerald-400 mb-4"}),d.jsx("p",{className:"text-sm text-white/70 italic",children:"Vi fyller p med nytt material kontinuerligt. Saknar du ngot specifikt? Kontakta oss grna med nskeml."})]})]})},x4=({setPage:n})=>d.jsx("div",{className:"container mx-auto px-4 md:px-6 py-10 md:py-20 animate-fade-in flex flex-col items-center",children:d.jsxs("div",{className:"w-full max-w-6xl",children:[d.jsxs("button",{onClick:()=>n(De.HOME),className:"flex items-center gap-2 text-white/40 hover:text-white transition-colors mb-8 group",children:[d.jsx(yc,{size:18,className:"group-hover:-translate-x-1 transition-transform"}),"Tillbaka till hem"]}),d.jsxs("div",{className:"text-center space-y-4 mb-16 animate-in fade-in slide-in-from-top-4 duration-700",children:[d.jsxs("h1",{className:"text-4xl md:text-6xl font-black tracking-tighter text-white leading-tight",children:["Medlemsinloggning ",d.jsx("br",{}),d.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-amber-200 to-white",children:"Horizonten Gemenskap"})]}),d.jsx("p",{className:"text-lg md:text-2xl font-medium text-orange-200/80 tracking-tight italic",children:"Din digitala gemenskap fr lkning och vxande"})]}),d.jsxs("div",{className:"glass bg-white/[0.03] border border-white/10 p-6 md:p-10 rounded-3xl max-w-5xl mx-auto text-center space-y-6 backdrop-blur-md mb-20 animate-in fade-in zoom-in-95 duration-700",children:[d.jsxs("div",{className:"space-y-4 text-slate-300 text-base md:text-lg leading-relaxed font-light",children:[d.jsx("p",{children:"Att vara mnniska r att behva andra. Vrt nervsystem sker stndigt efter trygghet i kontakt med flocken. Hr p Horizonten har vi skapat en digital plats dr du kan va p att ta plats, dela erfarenheter och hitta styrka i igenknning  allt utifrn din egen takt och dina behov."}),d.jsx("p",{className:"text-white font-medium",children:'Oavsett om du vill smyga igng och "knna in rummet" eller om du r redo att dyka djupt och leda dig sjlv och andra, s finns det en plats fr dig hr.'})]}),d.jsx("div",{className:"pt-2",children:d.jsx("p",{className:"text-orange-400 font-black uppercase tracking-[0.2em] text-xs",children:"Vlj den niv av gemenskap som passar ditt liv just nu:"})})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 w-full mb-12",children:[d.jsxs("div",{className:"group relative glass bg-white/[0.02] border border-white/10 hover:border-white/20 p-8 md:p-10 rounded-[2.5rem] transition-all duration-500 flex flex-col justify-between overflow-hidden shadow-2xl",children:[d.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 group-hover:opacity-10 transition-opacity",children:d.jsx(aP,{size:100,className:"text-green-500 rotate-12"})}),d.jsxs("div",{className:"space-y-6 relative z-10",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsx("h3",{className:"text-2xl md:text-3xl font-black text-white flex items-center gap-2",children:"GRATIS MEDLEMSKAP"}),d.jsx("p",{className:"text-slate-400 font-bold tracking-wide uppercase text-[10px]",children:"En trygg plats att landa p"})]}),d.jsx("p",{className:"text-slate-400 leading-relaxed text-sm md:text-base",children:"Detta r fr dig som vill ta del av gemenskapen, lsa och inspireras, men kanske inte har behov av de djupare funktionerna just nu. Det r ett frsta steg i din Self-care fr att bryta isolering."}),d.jsx("ul",{className:"space-y-4 pt-4 border-t border-white/5",children:[{title:"Lsrttigheter",desc:"Ta del av ppna diskussioner och insikter."},{title:"Begrnsad chat",desc:"Mjlighet att skriva i vr allmnna vlkomst-trd."},{title:"Gemenskap",desc:"Du r en del av flocken  du r inte ensam."}].map((e,t)=>d.jsxs("li",{className:"flex gap-3 items-start",children:[d.jsx(ch,{size:14,className:"text-slate-500 mt-1 shrink-0"}),d.jsxs("div",{className:"text-sm",children:[d.jsxs("span",{className:"font-bold text-white mr-1",children:[e.title,":"]}),d.jsx("span",{className:"text-slate-400 font-light",children:e.desc})]})]},t))})]}),d.jsxs("div",{className:"flex flex-col gap-3 mt-8",children:[d.jsxs("button",{onClick:()=>{window.location.hash="#login",n(De.GEMENSKAP_APP)},className:"w-full py-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-2xl font-black text-white transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-xs",children:["Logga in ",d.jsx(Fs,{size:18})]}),d.jsx("button",{onClick:()=>{window.location.hash="#signup",n(De.GEMENSKAP_APP)},className:"w-full py-4 bg-amber-500 hover:bg-amber-400 text-black rounded-2xl font-black transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-xs shadow-lg shadow-amber-500/20",children:"Registrera dig gratis idag"})]})]}),d.jsxs("div",{className:"group relative overflow-hidden bg-gradient-to-br from-orange-600/10 to-transparent border border-orange-500/30 hover:border-orange-500 p-8 md:p-10 rounded-[2.5rem] transition-all duration-500 flex flex-col justify-between shadow-[0_20px_60px_rgba(249,115,22,0.1)]",children:[d.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity",children:d.jsx(vP,{size:120,className:"text-orange-500 -rotate-6"})}),d.jsxs("div",{className:"space-y-6 relative z-10",children:[d.jsxs("div",{className:"space-y-1",children:[d.jsxs("div",{className:"flex flex-wrap justify-between items-start gap-2",children:[d.jsx("h3",{className:"text-2xl md:text-3xl font-black text-white flex items-center gap-2",children:"PREMIUM"}),d.jsx("div",{className:"bg-orange-500 text-[10px] font-black px-3 py-1 rounded-full text-white uppercase tracking-widest shadow-lg shadow-orange-500/40",children:"250 kr/mn"})]}),d.jsx("p",{className:"text-orange-300 font-bold tracking-wide uppercase text-[10px]",children:"Fr dig som vill vxa, pverka och frdjupa din process"})]}),d.jsx("p",{className:"text-slate-300 leading-relaxed text-sm md:text-base font-light",children:"Hr fr du tillgng till hela verktygsldan. Premium r utformat fr att ge dig handlingsutrymme. Det handlar inte bara om att f std, utan om mjligheten att sjlv vara en aktiv skapare av din trygghet och din utveckling."}),d.jsx("ul",{className:"space-y-4 pt-4 border-t border-orange-500/10",children:[{title:"Obegrnsad Chat & Trdar",desc:"Skriv fritt i den offentliga trden och f tillgng till privata trdar."},{title:"Bli din egen mtesledare",desc:"Mjlighet att (till rabatterat pris) hyra vra skra videorum fr egna grupper."},{title:"Kunskapsbanken",desc:"Fri nedladdning av arbetsblad, mallar och filer som stttar din resa."},{title:"Frtur & Rabatter",desc:"F frtur till workshops och event som Klttertrdet anordnar."}].map((e,t)=>d.jsxs("li",{className:"flex gap-3 items-start",children:[d.jsx(ch,{size:14,className:"text-orange-400 mt-1 shrink-0"}),d.jsxs("div",{className:"text-sm",children:[d.jsxs("span",{className:"font-bold text-white mr-1",children:[e.title,":"]}),d.jsx("span",{className:"text-slate-400 font-light leading-relaxed",children:e.desc})]})]},t))}),d.jsx("div",{className:"bg-orange-500/5 p-3 rounded-xl border border-orange-500/10",children:d.jsx("p",{className:"text-orange-200/90 text-xs font-medium italic text-center",children:"Ingen bindningstid. Investera i din egen och andras hllbarhet."})})]}),d.jsxs("div",{className:"flex flex-col gap-3 mt-8",children:[d.jsxs("button",{onClick:()=>{window.location.hash="#premium-login",n(De.GEMENSKAP_APP)},className:"w-full py-4 bg-white/10 hover:bg-white/20 border border-white/10 rounded-2xl font-black text-white transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-xs",children:["Logga in ",d.jsx(Fs,{size:18})]}),d.jsx("button",{onClick:()=>n(De.PREMIUM_APPLICATION),className:"w-full py-4 bg-orange-500 hover:bg-orange-400 text-white rounded-2xl font-black transition-all flex items-center justify-center gap-2 uppercase tracking-widest text-xs shadow-2xl shadow-orange-500/20",children:"Ansk om medlemskap"})]})]})]}),d.jsx("div",{className:"text-center",children:d.jsxs("button",{onClick:()=>{window.location.hash="#login",n(De.GEMENSKAP_APP)},className:"text-white/40 hover:text-orange-400 transition-colors text-sm font-bold flex items-center gap-2 mx-auto",children:["Redan medlem? ",d.jsx("span",{className:"underline underline-offset-4",children:"Logga in hr"})]})})]})}),v4=({setPage:n})=>d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-12 md:py-24 animate-fade-in space-y-24",children:[d.jsxs("section",{className:"glass bg-white/10 backdrop-blur-md border border-white/20 rounded-[3rem] p-8 md:p-20 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-2/3 h-full bg-gradient-to-l from-amber-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 grid lg:grid-cols-2 gap-12 items-center",children:[d.jsxs("div",{className:"space-y-8",children:[d.jsx("div",{className:"inline-block px-4 py-1 bg-amber-500/20 rounded-full border border-amber-500/30 text-amber-500 text-xs font-black uppercase tracking-widest",children:"Nyutgiven Bok"}),d.jsxs("h1",{className:"text-4xl md:text-7xl font-bold leading-tight text-white",children:["Myndighetsinducerat trauma ",d.jsx("br",{}),d.jsx("span",{className:"text-2xl md:text-4xl font-light text-amber-200/80 block mt-4",children:" frn subjekt till objekt"})]}),d.jsx("p",{className:"text-lg md:text-xl text-white/80 leading-relaxed font-light",children:"Vr nyutgivna bok r en djupdykning i hur systemet kan skada och hur vi kan lka. Men boken r mer n bara text  den r en guide till din terhmtning."}),d.jsx("div",{className:"flex flex-wrap gap-4 pt-4",children:d.jsxs("button",{onClick:()=>n(De.CHECKOUT),className:"px-8 py-4 bg-amber-500 hover:bg-amber-400 text-slate-950 rounded-2xl font-black transition-all hover:scale-105 shadow-2xl shadow-amber-500/20 flex items-center gap-2",children:["Bestll boken hr ",d.jsx(Fs,{size:20})]})})]}),d.jsx("div",{className:"hidden lg:flex justify-end",children:d.jsxs("div",{className:"relative w-80 h-96",children:[d.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-amber-500/20 to-transparent rounded-[2rem] blur-3xl animate-pulse"}),d.jsx("div",{className:"relative glass bg-white/5 border border-white/10 rounded-[2rem] shadow-2xl overflow-hidden transform rotate-3 hover:rotate-0 transition-all duration-500",children:d.jsx("img",{src:"/booklet.jpeg",alt:"Bokomslag",className:"w-full h-full object-contain p-4"})})]})})]})]}),d.jsx("section",{className:"glass bg-gradient-to-br from-blue-500/10 to-transparent border border-blue-500/20 rounded-[2.5rem] p-8 md:p-12",children:d.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-8",children:[d.jsx("div",{className:"w-16 h-16 bg-blue-500/20 rounded-2xl flex items-center justify-center text-blue-400 shrink-0",children:d.jsx(xR,{size:32})}),d.jsx("blockquote",{className:"text-xl md:text-2xl font-medium text-blue-100/90 italic leading-relaxed",children:'"Tillhrande boken finns en stor mngd sjlvhjlpsmaterial och praktiska vningar i appen, skapade fr att ge dig verktygen att navigera i din egen lkningsprocess."'})]})}),d.jsxs("section",{className:"grid md:grid-cols-2 gap-12 items-start",children:[d.jsxs("div",{className:"space-y-8",children:[d.jsx("h2",{className:"text-3xl md:text-5xl font-bold text-white",children:"Vad innehller boken?"}),d.jsx("div",{className:"grid gap-6",children:[{title:"Neurobiologisk frstelse",text:"Hur kroppen och nervsystemet reagerar p strukturellt svek."},{title:"Self-care modellen",text:"Praktiska verktyg fr sjlvreglering och lkning."},{title:"Fallstudier",text:"Verkliga berttelser frn mnniskor som navigerat systemet."},{title:"Praktiska vningar",text:"Steg-fr-steg-guider fr bearbetning och terhmtning."},{title:"Frn subjekt till objekt",text:"Vad r systemdriven objektifiering och vad sger forskningen?"}].map((e,t)=>d.jsxs("div",{className:"flex items-start gap-4 group",children:[d.jsx("div",{className:"p-1 mt-1",children:d.jsx(bc,{className:"text-amber-500 w-6 h-6"})}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("h3",{className:"text-lg font-bold text-white group-hover:text-amber-400 transition-colors uppercase tracking-tight",children:e.title}),d.jsx("p",{className:"text-zinc-400 text-sm leading-relaxed",children:e.text})]})]},t))})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-[2.5rem] p-8 md:p-12 space-y-8",children:[d.jsx("h2",{className:"text-3xl md:text-5xl font-bold text-white",children:"Fr vem r boken?"}),d.jsxs("div",{className:"space-y-6 text-zinc-300 leading-relaxed text-lg",children:[d.jsx("p",{children:"Denna bok vnder sig till dig som har upplevt att mtet med myndigheter blivit mer skadligt n hjlpsamt."}),d.jsx("div",{className:"p-6 bg-white/5 rounded-2xl border border-white/5",children:d.jsxs("p",{className:"text-white/90 font-medium",children:["Men den r ocks ovrderlig fr professionella  ",d.jsx("span",{className:"text-amber-400",children:"socialsekreterare, terapeuter, behandlingspedagoger"}),"  som vill frst och bemta myndighetsinducerat trauma med strre medvetenhet och empati."]})})]}),d.jsx("div",{className:"pt-8 border-t border-white/10",children:d.jsxs("div",{className:"flex items-center gap-4 text-zinc-400",children:[d.jsx(Fu,{className:"text-amber-500/50"}),d.jsx("p",{className:"text-sm italic",children:"Baserad p mngrig forskning och praktisk erfarenhet inom TMO."})]})})]})]}),d.jsx("section",{className:"text-center py-12",children:d.jsx("div",{className:"max-w-3xl mx-auto space-y-8",children:d.jsxs("div",{className:"p-8 glass bg-white/5 border border-white/10 rounded-[2.5rem]",children:[d.jsx("p",{className:"text-xl text-amber-200 font-bold mb-6",children:"Slpps inom en snar framtid  skra ditt exemplar nu."}),d.jsx("button",{onClick:()=>n(De.CHECKOUT),className:"inline-block bg-amber-500 hover:bg-amber-400 text-slate-950 px-12 py-5 rounded-2xl text-xl font-black transition-all hover:scale-105 shadow-2xl shadow-amber-500/20",children:"Frhandsbestll boken hr"})]})})})]}),y4=({setPage:n})=>d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-12 animate-fade-in max-w-4xl space-y-16",children:[d.jsxs("button",{onClick:()=>n(De.HOME),className:"flex items-center gap-2 text-white/60 hover:text-white transition-colors group",children:[d.jsx(yc,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),"Tillbaka"]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-[3rem] p-8 md:p-16 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-green-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 space-y-4",children:[d.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white tracking-tight",children:"Integritetspolicy"}),d.jsx("p",{className:"text-slate-400 text-sm font-medium uppercase tracking-widest",children:"Senast uppdaterad: 22/1-2026"}),d.jsx("div",{className:"pt-6 border-t border-white/10",children:d.jsx("p",{className:"text-slate-300 font-bold",children:"Personuppgiftsansvarig: Klttertrdet AB (Org. nr: 559267-4732)"})})]})]}),d.jsxs("div",{className:"space-y-12",children:[d.jsxs("section",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-3 text-orange-400",children:[d.jsx(Sl,{size:28}),d.jsx("h3",{className:"text-2xl font-bold text-white uppercase tracking-tight",children:"1. Vrt lfte till dig"})]}),d.jsx("p",{className:"text-slate-300 text-lg leading-relaxed font-light italic",children:'"Fr att du ska vga vara srbar och dela dina erfarenheter krvs det att du vet exakt var dina ord tar vgen. Vi ser dina personuppgifter som en frlngning av din personliga integritet."'}),d.jsx("p",{className:"text-slate-400 leading-relaxed",children:'Vi sljer aldrig dina uppgifter. Vi delar dem inte med tredje part fr marknadsfring. Din data stannar i vr "trygga hamn".'})]}),d.jsxs("section",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 md:p-12 space-y-8",children:[d.jsxs("div",{className:"flex items-center gap-3 text-blue-400",children:[d.jsx(QD,{size:24}),d.jsx("h3",{className:"text-xl font-bold text-white uppercase tracking-tight",children:"2. Vilka uppgifter samlar vi in och varfr?"})]}),d.jsxs("div",{className:"grid gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("h4",{className:"text-white font-bold",children:"Identifikation (BankID)"}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"Vi lagrar inte ditt personnummer synligt fr andra, men vi anvnder BankID vid registrering fr att verifiera att du r en verklig person. Detta skyddar communityt frn troll och falska profiler."})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("h4",{className:"text-white font-bold",children:"Anvndargenererat innehll"}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"Det du skriver i chatten och forumet sparas p skra servrar fr att tjnsten ska fungera."})]})]})]}),d.jsxs("section",{className:"space-y-8",children:[d.jsxs("div",{className:"flex items-center gap-3 text-green-400",children:[d.jsx(Fb,{size:24}),d.jsx("h3",{className:"text-xl font-bold text-white uppercase tracking-tight",children:"3. Hur skyddas din information?"})]}),d.jsx("p",{className:"text-slate-300 leading-relaxed font-light",children:"All trafik mellan din telefon/dator och vra servrar r krypterad (SSL/TLS). Vi anvnder moderna databaser med hg skerhetsklassning (AES-256 kryptering vid vila)."})]}),d.jsxs("section",{className:"glass bg-gradient-to-br from-orange-500/10 to-transparent border border-orange-500/20 rounded-[2.5rem] p-8 md:p-12 space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-3 text-orange-400",children:[d.jsx(gP,{size:24}),d.jsx("h3",{className:"text-xl font-bold text-white uppercase tracking-tight",children:"4. Skillnad p Chat och Journal"})]}),d.jsxs("div",{className:"space-y-4 text-slate-300",children:[d.jsx("div",{className:"p-4 bg-white/5 rounded-xl border border-white/5",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Chatten/Appen:"})," Det du skriver i Horizonten-appen rknas inte som hlso- och sjukvrdsjournal. Det r ett medlemsforum."]})}),d.jsx("div",{className:"p-4 bg-white/5 rounded-xl border border-white/5",children:d.jsxs("p",{children:[d.jsx("strong",{children:"Terapi hos Klttertrdet:"})," Om du gr i enskild terapi frs lagstadgad patientjournal i ett helt separat, skert system (enligt Patientdatalagen). Dessa tv system r tskilda."]})})]})]}),d.jsxs("section",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("h4",{className:"text-white font-bold flex items-center gap-2 tracking-tight uppercase text-sm",children:[d.jsx(yP,{size:18,className:"text-blue-400"})," 6. Dina rttigheter (GDPR)"]}),d.jsxs("ul",{className:"text-slate-400 text-xs space-y-2 leading-relaxed",children:[d.jsx("li",{children:" F ett utdrag p all data vi har om dig."}),d.jsx("li",{children:" Begra rttelse av felaktiga uppgifter."}),d.jsx("li",{children:' Begra att bli helt raderad ("Rtten att bli bortglmd").'})]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("h4",{className:"text-white font-bold flex items-center gap-2 tracking-tight uppercase text-sm",children:[d.jsx(w0,{size:18,className:"text-orange-400"})," 7. Kontakt"]}),d.jsxs("p",{className:"text-slate-400 text-xs leading-relaxed",children:["Klttertrdet AB",d.jsx("br",{}),"Gullregnsgatan 9A, Gvle",d.jsx("br",{}),"E-post: billy@klattertradet.se"]})]})]})]})]}),b4=({setPage:n})=>d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-12 animate-fade-in max-w-4xl",children:[d.jsxs("button",{onClick:()=>n(De.HOME),className:"flex items-center gap-2 text-white/60 hover:text-white transition-colors mb-8 group",children:[d.jsx(yc,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),"Tillbaka"]}),d.jsxs("div",{className:"space-y-12",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-[2.5rem] p-8 md:p-16 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-orange-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 space-y-6",children:[d.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white leading-tight",children:"Din data, ditt val"}),d.jsx("h2",{className:"text-2xl md:text-3xl font-light text-amber-200/80 italic",children:" Vr Cookiepolicy"}),d.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-white/10",children:[d.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-500/10 flex items-center justify-center text-orange-400",children:d.jsx(Sl,{size:24})}),d.jsx("p",{className:"text-slate-300 font-medium",children:"Transparens och samtycke r vra grundstenar."})]})]})]}),d.jsx("div",{className:"space-y-6 text-lg text-slate-300 leading-relaxed font-light",children:d.jsx("p",{children:"Precis som i vra utbildningar och i terapirummet r transparens och samtycke grundstenar i vr verksamhet. Vi vill att du ska knna dig trygg med hur vi hanterar information om dig nr du besker oss digitalt."})}),d.jsxs("div",{className:"space-y-16",children:[d.jsxs("section",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(_0,{className:"text-amber-500"}),d.jsx("h3",{className:"text-2xl font-bold text-white uppercase tracking-tight",children:"Vad r en Cookie?"})]}),d.jsx("p",{className:"text-slate-400",children:'En cookie r en liten textfil som sparas p din enhet (dator eller mobil). Man kan se det som ett litet digitalt minne som hjlper hemsidan att komma ihg dina val. Det finns dock olika typer av "minnen", och vi skiljer noga p dem:'})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 hover:bg-white/10 transition-colors",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-2xl flex items-center justify-center text-blue-400 mb-6",children:d.jsx(Fu,{size:24})}),d.jsx("h4",{className:"text-xl font-bold text-white mb-4",children:"1. Ndvndiga Cookies"}),d.jsxs("p",{className:"text-slate-400 text-sm leading-relaxed",children:["Dessa r hemsidans ",d.jsx("strong",{children:'"autonoma nervsystem"'}),". Utan dessa fungerar inte sidan. De hller koll p grundlggande funktioner, som skerhet eller vad du lagt i varukorgen om du bokar en utbildning."]})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 hover:bg-white/10 transition-colors",children:[d.jsx("div",{className:"w-12 h-12 bg-orange-500/10 rounded-2xl flex items-center justify-center text-orange-400 mb-6",children:d.jsx(hR,{size:24})}),d.jsx("h4",{className:"text-xl font-bold text-white mb-4",children:"2. Funktions- & Analyscookies"}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"Dessa anvnder vi fr att se hur beskare rr sig p sidan, s att vi kan frbttra vrt innehll och vra tjnster. Det handlar om att frst mnster  lite som vi kartlgger mnster i Self-care modellen."})]})]}),d.jsxs("section",{className:"glass bg-gradient-to-br from-white/5 to-transparent border border-white/10 rounded-[2.5rem] p-8 md:p-12 space-y-8",children:[d.jsx("h3",{className:"text-2xl font-bold text-white uppercase tracking-tight",children:'Ditt samtycke r "Frivilligt, Specifikt och Otvetydigt"'}),d.jsxs("div",{className:"grid gap-6 text-slate-300 text-sm",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx(Fb,{className:"text-amber-500 shrink-0",size:20}),d.jsxs("p",{children:[d.jsx("strong",{children:"Inget antagande:"}),' Vi sprar inget (frutom de strikt ndvndiga) frrn du aktivt klickat "OK".']})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsx(uR,{className:"text-amber-500 shrink-0",size:20}),d.jsxs("p",{children:[d.jsx("strong",{children:"Du kan ndra dig:"})," Du kan nr som helst dra tillbaka ditt samtycke via instllningarna. Det r en del av din Self-care att stta grnser."]})]})]})]}),d.jsxs("section",{className:"text-center space-y-4",children:[d.jsx("p",{className:"text-slate-400 text-sm",children:"Frgor? Maila Billy Ljungberg direkt p:"}),d.jsx("a",{href:"mailto:billy@klattertradet.se",className:"text-orange-400 font-bold hover:underline",children:"billy@klattertradet.se"})]})]})]})]}),_4=({setPage:n})=>d.jsxs("div",{className:"container mx-auto px-4 md:px-6 py-12 animate-fade-in max-w-4xl space-y-16",children:[d.jsxs("button",{onClick:()=>n(De.HOME),className:"flex items-center gap-2 text-white/60 hover:text-white transition-colors group",children:[d.jsx(yc,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),"Tillbaka"]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-[3rem] p-8 md:p-16 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-blue-500/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 space-y-6",children:[d.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-white leading-tight",children:"Medlemsvillkor"}),d.jsx("h2",{className:"text-2xl md:text-3xl font-light text-blue-200/80 italic",children:"Horizonten Gemenskap"})]})]}),d.jsxs("div",{className:"space-y-12",children:[d.jsxs("section",{className:"space-y-8",children:[d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:"w-12 h-12 rounded-2xl bg-blue-500/10 flex items-center justify-center text-blue-400 shrink-0",children:d.jsx(rR,{size:24})}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-2xl font-bold text-white uppercase tracking-tight",children:"1. Din digitala trygga hamn"}),d.jsx("p",{className:"text-slate-300 leading-relaxed",children:"Genom att klicka p Jag godknner kliver du in i en gemenskap som drivs av Klttertrdet AB och Horizonten. Vi r glada att du r hr. Dessa villkor finns till fr att skydda din och gruppens integritet  en frutsttning fr verklig terhmtning."})]})]}),d.jsxs("div",{className:"flex items-start gap-4",children:[d.jsx("div",{className:"w-12 h-12 rounded-2xl bg-orange-500/10 flex items-center justify-center text-orange-400 shrink-0",children:d.jsx(Ka,{size:24})}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-2xl font-bold text-white uppercase tracking-tight",children:"2. Syftet: En plats fr lkning och std"}),d.jsx("p",{className:"text-slate-300 leading-relaxed",children:"Denna chatt r en mtesplats fr vrdnadshavare och individer som sker std och gemenskap. Vi vet att ensamhet r ett av vra strsta grundsr. Hr motverkar vi det genom kta kontakt och igenknning."})]})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-3 text-amber-400",children:[d.jsx(Sl,{size:24}),d.jsx("h3",{className:"text-xl font-bold",children:"3. Identitet & Skerhet"})]}),d.jsxs("ul",{className:"space-y-4 text-sm text-slate-400 leading-relaxed",children:[d.jsxs("li",{children:[d.jsx("strong",{className:"text-white",children:"kthet:"})," Du registrerar dig med BankID fr att skapa en sker milj fri frn troll. Trygghet brjar med transparens."]}),d.jsxs("li",{children:[d.jsx("strong",{className:"text-white",children:"En vuxen, ett konto:"})," Delade konton tillts inte. Detta r din plats fr terhmtning."]})]})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 rounded-3xl p-8 space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-3 text-green-400",children:[d.jsx(Vs,{size:24}),d.jsx("h3",{className:"text-xl font-bold",children:"4. Vr gemensamma trygghet"})]}),d.jsxs("ul",{className:"space-y-4 text-sm text-slate-400 leading-relaxed",children:[d.jsxs("li",{children:[d.jsx("strong",{className:"text-white",children:"Respekt:"})," Krnkningar eller hot aktiverar hot-systemet hos andra och leder till omedelbar uteslutning."]}),d.jsxs("li",{children:[d.jsx("strong",{className:"text-white",children:"Integritet:"})," Dela aldrig bilder p andras barn eller skrmdumpa. Det som sgs i rummet stannar dr."]}),d.jsxs("li",{children:[d.jsx("strong",{className:"text-white",children:"Reklamfritt:"})," Vi r hr fr mnsklig kontakt, inte frsljning."]})]})]})]}),d.jsxs("section",{className:"space-y-12",children:[d.jsxs("div",{className:"glass bg-gradient-to-br from-white/5 to-transparent border border-white/10 rounded-[2.5rem] p-8 md:p-12 space-y-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(aR,{className:"text-blue-400"}),d.jsx("h3",{className:"text-2xl font-bold text-white",children:"5. Reglering av gruppen (Moderering)"})]}),d.jsxs("p",{className:"text-slate-300 leading-relaxed",children:["Vra moderatorer fungerar som gruppens ",d.jsx("strong",{children:'"prefrontala cortex"'}),". De hjlper till att hlla ordning och snka stressnivn. Om ngon agerar p ett stt som skadar gruppens trygghet kan vi behva pausa kontot. Detta r en ndvndig grnsdragning fr kollektivets bsta."]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[d.jsxs("div",{className:"space-y-4",children:[d.jsxs("h4",{className:"text-xl font-bold text-white flex items-center gap-2",children:[d.jsx(Fb,{size:20,className:"text-orange-400"})," 6. Sekretess & Data"]}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"Vi skyddar dina uppgifter stenhrt (GDPR). Mnga hr har erfarenhet av myndighetsinducerat trauma  drfr r din datahelgd vr hgsta prioritet."})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("h4",{className:"text-xl font-bold text-white flex items-center gap-2",children:[d.jsx(_0,{size:20,className:"text-blue-400"})," 7. Ansvarsfriskrivning"]}),d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"Horizonten r en stdjande gemenskap, inte klinisk terapi. Vid behov av professionell traumabehandling hnvisar vi till vr mottagning."})]})]})]}),d.jsx("div",{className:"pt-16 border-t border-white/10",children:d.jsxs("div",{className:"glass bg-gradient-to-tr from-amber-500/10 to-orange-500/5 border border-amber-500/20 rounded-[3rem] p-8 md:p-16 relative overflow-hidden",children:[d.jsx("div",{className:"absolute -right-20 -bottom-20 w-64 h-64 bg-amber-500/10 rounded-full blur-3xl"}),d.jsxs("div",{className:"relative z-10 space-y-8",children:[d.jsx("div",{className:"inline-block px-4 py-1 bg-amber-500/20 rounded-full border border-amber-500/30 text-amber-500 text-xs font-black uppercase tracking-widest",children:"Uppgradera din upplevelse"}),d.jsx("h2",{className:"text-3xl md:text-5xl font-bold text-white",children:"HORIZONTEN PREMIUM"}),d.jsx("p",{className:"text-xl text-amber-200/90 font-light italic",children:" Investera i din hllbarhet"}),d.jsx("div",{className:"space-y-6 text-slate-300 leading-relaxed",children:d.jsx("p",{children:"Varfr bli betalande medlem? Den fria chatten ger dig gemenskapen. Premium-medlemskapet ger dig verktygen fr frndring. Min vision med Horizonten r att demokratisera kunskapen om hur vi fungerar."})}),d.jsxs("div",{className:"grid sm:grid-cols-2 gap-6 pt-6",children:[d.jsxs("div",{className:"bg-white/5 p-6 rounded-2xl border border-white/5 space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2 font-bold text-white",children:[d.jsx(wP,{size:18,className:"text-amber-400"})," Frdjupning"]}),d.jsx("p",{className:"text-xs text-slate-400",children:"Exklusivt material om traumateori och bottom-up-metoder."})]}),d.jsxs("div",{className:"bg-white/5 p-6 rounded-2xl border border-white/5 space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-2 font-bold text-white",children:[d.jsx(nP,{size:18,className:"text-amber-400"})," Frmner"]}),d.jsx("p",{className:"text-xs text-slate-400",children:"Rabatter p utbildningar och frtur till nya funktioner."})]})]})]})]})})]})]});var Mu=(n=>(n.IDLE="IDLE",n.LOADING="LOADING",n.AUTHENTICATED="AUTHENTICATED",n.UNAUTHENTICATED="UNAUTHENTICATED",n.ERROR="ERROR",n))(Mu||{});const w4=({onLoginSuccess:n,initialView:e="login"})=>{const[t,i]=ue.useState(e==="login"),[s,r]=ue.useState(""),[o,c]=ue.useState(""),[h,p]=ue.useState(""),[g,v]=ue.useState(!1),[y,w]=ue.useState(null),[E,R]=ue.useState(null),[N,A]=ue.useState(!1),I=async D=>{D.preventDefault(),v(!0),w(null),R(null);try{if(t){const{data:U,error:j}=await Ji.auth.signInWithPassword({email:s,password:o});j?(w(j.message),v(!1)):U.user&&(console.log("Login successful:",U.user),await Ji.from("login_events").insert({user_id:U.user.id,logged_in_at:new Date().toISOString()}))}else{const{data:U,error:j}=await Ji.auth.signUp({email:s,password:o,options:{emailRedirectTo:window.location.origin,data:{full_name:h,avatar_url:""}}});j?(w(j.message),v(!1)):U.user&&(await Ji.from("profiles").upsert({id:U.user.id,email:s,full_name:h,membership_level:2,membership_active:!0,updated_at:new Date().toISOString()}),U.session?console.log("Signup successful, session created"):(R("Ett bekrftelsemail har skickats. Kolla din inkorg!"),i(!0)),v(!1))}}catch{w("Ett ovntat fel uppstod."),v(!1)}};return d.jsxs("div",{className:"w-full max-w-md",children:[d.jsxs("div",{className:"text-center mb-10 selection:bg-orange-500/30",children:[d.jsx("div",{className:"inline-flex items-center justify-center mb-6",children:d.jsx("img",{src:"/assets/logo2.png",alt:"Klttertrdet & Horizonten",className:"h-24 md:h-28 w-auto object-contain drop-shadow-2xl"})}),d.jsx("p",{className:"text-slate-400 font-medium tracking-wide",children:"Exklusiv Gemenskap  Niv 2"})]}),d.jsxs("div",{className:"bg-slate-900/80 backdrop-blur-xl p-8 rounded-3xl shadow-2xl border border-slate-800",children:[d.jsxs("form",{onSubmit:I,className:"space-y-6",children:[y&&d.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 p-4 rounded-xl flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[d.jsx(JD,{className:"text-red-400 shrink-0 mt-0.5",size:18}),d.jsx("p",{className:"text-sm text-red-200",children:y})]}),E&&d.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 p-4 rounded-xl flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[d.jsx(Sl,{className:"text-green-400 shrink-0 mt-0.5",size:18}),d.jsx("p",{className:"text-sm text-green-200",children:E})]}),!t&&d.jsxs("div",{className:"animate-in fade-in slide-in-from-top-4",children:[d.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-slate-500 mb-2 ml-1",children:"Namn (Visas fr andra)"}),d.jsx("input",{type:"text",value:h,onChange:D=>p(D.target.value),placeholder:"Frnamn Efternamn",required:!t,className:"w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-orange-500/50 focus:border-orange-500 transition-all"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-slate-500 mb-2 ml-1",children:"E-post"}),d.jsx("input",{type:"email",value:s,onChange:D=>r(D.target.value),placeholder:"namn@exempel.se",required:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-orange-500/50 focus:border-orange-500 transition-all"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-bold uppercase tracking-widest text-slate-500 mb-2 ml-1",children:"Lsenord"}),d.jsx("input",{type:"password",value:o,onChange:D=>c(D.target.value),placeholder:"",required:!0,minLength:6,className:"w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-orange-500/50 focus:border-orange-500 transition-all"})]}),!t&&d.jsxs("div",{className:"flex items-start gap-3 mt-4 animate-in fade-in slide-in-from-top-2",children:[d.jsx("input",{type:"checkbox",id:"terms",checked:N,onChange:D=>A(D.target.checked),className:"mt-1 w-4 h-4 bg-slate-800 border-slate-700 rounded text-orange-500 focus:ring-orange-500/50"}),d.jsxs("label",{htmlFor:"terms",className:"text-sm text-slate-400 leading-tight",children:["Jag godknner"," ",d.jsx("button",{type:"button",className:"text-orange-400 hover:text-orange-300 underline font-medium",children:"medlemsvillkoren"})," ","och att mina uppgifter hanteras enligt integritetspolicyn."]})]}),d.jsx("button",{type:"submit",disabled:g||!t&&!N,className:"w-full bg-orange-500 hover:bg-orange-400 disabled:bg-orange-500/30 disabled:text-slate-800 disabled:cursor-not-allowed text-slate-950 font-bold py-4 rounded-xl shadow-lg shadow-orange-500/20 flex items-center justify-center gap-2 group transition-all",children:g?d.jsx(fR,{className:"animate-spin",size:20}):d.jsxs(d.Fragment,{children:[t?"Logga in":"Skapa konto",d.jsx(Fs,{className:"group-hover:translate-x-1 transition-transform",size:20})]})})]}),d.jsx("div",{className:"mt-8 pt-6 border-t border-slate-800 text-center",children:d.jsxs("p",{className:"text-slate-500 text-sm",children:[t?"Ingen tillgng?":"Har du redan ett konto?"," ",d.jsx("button",{onClick:()=>i(!t),className:"text-orange-400 hover:text-orange-300 font-semibold underline underline-offset-4 focus:outline-none",children:t?"Skapa ett konto":"Logga in hr"})]})})]}),d.jsxs("div",{className:"mt-12 text-center",children:[d.jsx("p",{className:"text-slate-600 text-xs mb-4",children:" 2024 Horizonten Network. Alla rttigheter frbehllna."}),d.jsxs("div",{className:"flex flex-wrap justify-center gap-4 text-[10px] text-slate-500 uppercase tracking-wider font-medium",children:[d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Kontoinstllningar"}),d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Medlemsvillkor"}),d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Integritets- & Sekretesspolicy"}),d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Cookie-instllningar"}),d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Kontakt"})]})]})]})},S4=({onLoginSuccess:n,onBack:e})=>{const[t,i]=ue.useState(""),[s,r]=ue.useState(""),[o,c]=ue.useState(!1),[h,p]=ue.useState(null),g=async v=>{v.preventDefault(),c(!0),p(null);try{const{data:y,error:w}=await Ji.auth.signInWithPassword({email:t,password:s});w?(p(w.message),c(!1)):y.user&&(console.log("Premium Login successful:",y.user),await Ji.from("login_events").insert({user_id:y.user.id,logged_in_at:new Date().toISOString()}))}catch{p("Ett ovntat fel uppstod."),c(!1)}};return d.jsxs("div",{className:"w-full max-w-md animate-in fade-in zoom-in-95 duration-700",children:[d.jsxs("div",{className:"text-center mb-10",children:[d.jsxs("div",{className:"inline-flex items-center justify-center gap-3 mb-6",children:[d.jsx("img",{src:"/assets/logo2.png",alt:"Horizonten gemenskap",className:"w-14 h-14 object-contain"}),d.jsx("span",{className:"text-white text-xl font-medium",children:"Horizonten gemenskap"})]}),d.jsx("h1",{className:"text-2xl sm:text-3xl text-white font-light tracking-wide",children:"Logga in p ditt konto"}),d.jsx("p",{className:"text-slate-400 mt-3 text-sm",children:"Vlkommen tillbaka till vr community fr betalmedlemmar"})]}),d.jsxs("form",{onSubmit:g,className:"space-y-6",children:[h&&d.jsx("div",{className:"bg-red-500/10 border border-red-500/20 p-4 rounded-xl text-sm text-red-200 animate-bounce-subtle",children:h}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-300 mb-2",children:"E-postadress"}),d.jsx("input",{id:"email",type:"email",value:t,onChange:v=>i(v.target.value),required:!0,placeholder:"din@email.se",className:"w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white placeholder:text-white/20 focus:outline-none focus:border-[#b35c2a] focus:ring-1 focus:ring-[#b35c2a] transition-colors"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-300 mb-2",children:"Lsenord"}),d.jsx("input",{id:"password",type:"password",value:s,onChange:v=>r(v.target.value),required:!0,placeholder:"Ange ditt lsenord",className:"w-full px-4 py-3 bg-white/5 border border-white/20 rounded-lg text-white placeholder:text-white/20 focus:outline-none focus:border-[#b35c2a] focus:ring-1 focus:ring-[#b35c2a] transition-colors"})]}),d.jsxs("div",{className:"flex items-center justify-between text-sm",children:[d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[d.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-white/20 bg-white/5 text-[#b35c2a] focus:ring-[#b35c2a] focus:ring-offset-0"}),d.jsx("span",{className:"text-slate-400 group-hover:text-slate-200 transition-colors",children:"Kom ihg mig"})]}),d.jsx("button",{type:"button",className:"text-[#b35c2a] hover:text-[#9a4f24] transition-colors",children:"Glmt lsenord?"})]}),d.jsx("button",{type:"submit",disabled:o,className:"w-full px-8 py-3 bg-[#b35c2a] hover:bg-[#9a4f24] disabled:bg-[#b35c2a]/50 text-white font-medium rounded-lg transition-all duration-200 shadow-lg shadow-[#b35c2a]/20 flex items-center justify-center gap-2",children:o?d.jsx(fR,{className:"animate-spin",size:20}):"Logga in"})]}),d.jsx("div",{className:"mt-8 text-center",children:d.jsxs("p",{className:"text-slate-500 text-sm",children:["Inte medlem n?"," ",d.jsx("button",{onClick:e,className:"text-[#b35c2a] hover:text-[#9a4f24] transition-colors font-medium",children:"Bli medlem idag"})]})}),d.jsx("div",{className:"mt-8 text-center pt-6 border-t border-white/5",children:d.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-slate-500 hover:text-white transition-colors mx-auto text-sm group",children:[d.jsx(yc,{size:16,className:"group-hover:-translate-x-1 transition-transform"}),"Tillbaka till startsidan"]})})]})};const Wb="182",T4={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},E4={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},LR=0,KS=1,OR=2,M4=3,zR=0,mp=1,zg=2,nh=3,_c=0,Ar=1,yl=2,wl=0,ah=1,ZS=2,QS=3,e1=4,jR=5,Ru=100,FR=101,BR=102,VR=103,HR=104,GR=200,qR=201,WR=202,$R=203,Iy=204,Dy=205,XR=206,YR=207,JR=208,KR=209,ZR=210,QR=211,ek=212,tk=213,nk=214,Py=0,Uy=1,Ly=2,uh=3,Oy=4,zy=5,jy=6,Fy=7,T0=0,ik=1,sk=2,Xa=0,G1=1,q1=2,W1=3,$b=4,$1=5,X1=6,Y1=7,t1="attached",rk="detached",Xb=300,Tl=301,Lu=302,t0=303,n0=304,Rp=306,i0=1e3,Qr=1001,s0=1002,Ii=1003,J1=1004,A4=1004,cp=1005,N4=1005,si=1006,jg=1007,C4=1007,bl=1008,R4=1008,Er=1009,K1=1010,Z1=1011,bp=1012,Yb=1013,Za=1014,Ts=1015,Po=1016,Jb=1017,Kb=1018,_p=1020,Q1=35902,eT=35899,tT=1021,nT=1022,Es=1023,El=1026,Iu=1027,Zb=1028,E0=1029,dh=1030,Qb=1031,k4=1032,e_=1033,Fg=33776,Bg=33777,Vg=33778,Hg=33779,By=35840,Vy=35841,Hy=35842,Gy=35843,qy=36196,Wy=37492,$y=37496,Xy=37488,Yy=37489,Jy=37490,Ky=37491,Zy=37808,Qy=37809,eb=37810,tb=37811,nb=37812,ib=37813,sb=37814,rb=37815,ab=37816,ob=37817,lb=37818,cb=37819,ub=37820,db=37821,hb=36492,fb=36494,pb=36495,mb=36283,gb=36284,xb=36285,vb=36286,ak=2200,ok=2201,lk=2202,r0=2300,yb=2301,yy=2302,ih=2400,sh=2401,a0=2402,t_=2500,iT=2501,I4=0,D4=1,P4=2,ck=3200,U4=3201,L4=3202,O4=3203,Vu=0,uk=1,gc="",sr="srgb",Ou="srgb-linear",o0="linear",$n="srgb",z4="",j4="rg",F4="ga",B4=0,Yd=7680,V4=7681,H4=7682,G4=7683,q4=34055,W4=34056,$4=5386,X4=512,Y4=513,J4=514,K4=515,Z4=516,Q4=517,e5=518,n1=519,dk=512,hk=513,fk=514,n_=515,pk=516,mk=517,i_=518,gk=519,l0=35044,t5=35048,n5=35040,i5=35045,s5=35049,r5=35041,a5=35046,o5=35050,l5=35042,c5="100",i1="300 es",ga=2e3,wp=2001,u5={COMPUTE:"compute",RENDER:"render"},d5={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},h5={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function xk(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const f5={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function up(n,e){return new f5[n](e)}function vk(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function c0(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function yk(){const n=c0("canvas");return n.style.display="block",n}const EM={};let zu=null;function p5(n){zu=n}function m5(){return zu}function u0(...n){const e="THREE."+n.shift();zu?zu("log",e,...n):console.log(e,...n)}function ht(...n){const e="THREE."+n.shift();zu?zu("warn",e,...n):console.warn(e,...n)}function Dt(...n){const e="THREE."+n.shift();zu?zu("error",e,...n):console.error(e,...n)}function Sp(...n){const e=n.join(" ");e in EM||(EM[e]=!0,ht(...n))}function g5(n,e,t){return new Promise(function(i,s){function r(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:s();break;case n.TIMEOUT_EXPIRED:setTimeout(r,t);break;default:i()}}setTimeout(r,t)})}class Al{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners;if(i===void 0)return;const s=i[e];if(s!==void 0){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const i=t[e.type];if(i!==void 0){e.target=this;const s=i.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,e);e.target=null}}}const tr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let MM=1234567;const oh=Math.PI/180,Tp=180/Math.PI;function xa(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(tr[n&255]+tr[n>>8&255]+tr[n>>16&255]+tr[n>>24&255]+"-"+tr[e&255]+tr[e>>8&255]+"-"+tr[e>>16&15|64]+tr[e>>24&255]+"-"+tr[t&63|128]+tr[t>>8&255]+"-"+tr[t>>16&255]+tr[t>>24&255]+tr[i&255]+tr[i>>8&255]+tr[i>>16&255]+tr[i>>24&255]).toLowerCase()}function Xt(n,e,t){return Math.max(e,Math.min(t,n))}function sT(n,e){return(n%e+e)%e}function x5(n,e,t,i,s){return i+(n-e)*(s-i)/(t-e)}function v5(n,e,t){return n!==e?(t-n)/(e-n):0}function Gg(n,e,t){return(1-t)*n+t*e}function y5(n,e,t,i){return Gg(n,e,1-Math.exp(-t*i))}function b5(n,e=1){return e-Math.abs(sT(n,e*2)-e)}function _5(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function w5(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function S5(n,e){return n+Math.floor(Math.random()*(e-n+1))}function T5(n,e){return n+Math.random()*(e-n)}function E5(n){return n*(.5-Math.random())}function M5(n){n!==void 0&&(MM=n);let e=MM+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function A5(n){return n*oh}function N5(n){return n*Tp}function C5(n){return(n&n-1)===0&&n!==0}function R5(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function k5(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function I5(n,e,t,i,s){const r=Math.cos,o=Math.sin,c=r(t/2),h=o(t/2),p=r((e+i)/2),g=o((e+i)/2),v=r((e-i)/2),y=o((e-i)/2),w=r((i-e)/2),E=o((i-e)/2);switch(s){case"XYX":n.set(c*g,h*v,h*y,c*p);break;case"YZY":n.set(h*y,c*g,h*v,c*p);break;case"ZXZ":n.set(h*v,h*y,c*g,c*p);break;case"XZX":n.set(c*g,h*E,h*w,c*p);break;case"YXY":n.set(h*w,c*g,h*E,c*p);break;case"ZYZ":n.set(h*E,h*w,c*g,c*p);break;default:ht("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function Mr(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function hn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const D5={DEG2RAD:oh,RAD2DEG:Tp,generateUUID:xa,clamp:Xt,euclideanModulo:sT,mapLinear:x5,inverseLerp:v5,lerp:Gg,damp:y5,pingpong:b5,smoothstep:_5,smootherstep:w5,randInt:S5,randFloat:T5,randFloatSpread:E5,seededRandom:M5,degToRad:A5,radToDeg:N5,isPowerOfTwo:C5,ceilPowerOfTwo:R5,floorPowerOfTwo:k5,setQuaternionFromProperEuler:I5,normalize:hn,denormalize:Mr};class Be{constructor(e=0,t=0){Be.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6],this.y=s[1]*t+s[4]*i+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Xt(this.x,e.x,t.x),this.y=Xt(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Xt(this.x,e,t),this.y=Xt(this.y,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Xt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),s=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*i-o*s+e.x,this.y=r*s+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ea{constructor(e=0,t=0,i=0,s=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=s}static slerpFlat(e,t,i,s,r,o,c){let h=i[s+0],p=i[s+1],g=i[s+2],v=i[s+3],y=r[o+0],w=r[o+1],E=r[o+2],R=r[o+3];if(c<=0){e[t+0]=h,e[t+1]=p,e[t+2]=g,e[t+3]=v;return}if(c>=1){e[t+0]=y,e[t+1]=w,e[t+2]=E,e[t+3]=R;return}if(v!==R||h!==y||p!==w||g!==E){let N=h*y+p*w+g*E+v*R;N<0&&(y=-y,w=-w,E=-E,R=-R,N=-N);let A=1-c;if(N<.9995){const I=Math.acos(N),D=Math.sin(I);A=Math.sin(A*I)/D,c=Math.sin(c*I)/D,h=h*A+y*c,p=p*A+w*c,g=g*A+E*c,v=v*A+R*c}else{h=h*A+y*c,p=p*A+w*c,g=g*A+E*c,v=v*A+R*c;const I=1/Math.sqrt(h*h+p*p+g*g+v*v);h*=I,p*=I,g*=I,v*=I}}e[t]=h,e[t+1]=p,e[t+2]=g,e[t+3]=v}static multiplyQuaternionsFlat(e,t,i,s,r,o){const c=i[s],h=i[s+1],p=i[s+2],g=i[s+3],v=r[o],y=r[o+1],w=r[o+2],E=r[o+3];return e[t]=c*E+g*v+h*w-p*y,e[t+1]=h*E+g*y+p*v-c*w,e[t+2]=p*E+g*w+c*y-h*v,e[t+3]=g*E-c*v-h*y-p*w,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,s){return this._x=e,this._y=t,this._z=i,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,s=e._y,r=e._z,o=e._order,c=Math.cos,h=Math.sin,p=c(i/2),g=c(s/2),v=c(r/2),y=h(i/2),w=h(s/2),E=h(r/2);switch(o){case"XYZ":this._x=y*g*v+p*w*E,this._y=p*w*v-y*g*E,this._z=p*g*E+y*w*v,this._w=p*g*v-y*w*E;break;case"YXZ":this._x=y*g*v+p*w*E,this._y=p*w*v-y*g*E,this._z=p*g*E-y*w*v,this._w=p*g*v+y*w*E;break;case"ZXY":this._x=y*g*v-p*w*E,this._y=p*w*v+y*g*E,this._z=p*g*E+y*w*v,this._w=p*g*v-y*w*E;break;case"ZYX":this._x=y*g*v-p*w*E,this._y=p*w*v+y*g*E,this._z=p*g*E-y*w*v,this._w=p*g*v+y*w*E;break;case"YZX":this._x=y*g*v+p*w*E,this._y=p*w*v+y*g*E,this._z=p*g*E-y*w*v,this._w=p*g*v-y*w*E;break;case"XZY":this._x=y*g*v-p*w*E,this._y=p*w*v-y*g*E,this._z=p*g*E+y*w*v,this._w=p*g*v+y*w*E;break;default:ht("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,s=Math.sin(i);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],s=t[4],r=t[8],o=t[1],c=t[5],h=t[9],p=t[2],g=t[6],v=t[10],y=i+c+v;if(y>0){const w=.5/Math.sqrt(y+1);this._w=.25/w,this._x=(g-h)*w,this._y=(r-p)*w,this._z=(o-s)*w}else if(i>c&&i>v){const w=2*Math.sqrt(1+i-c-v);this._w=(g-h)/w,this._x=.25*w,this._y=(s+o)/w,this._z=(r+p)/w}else if(c>v){const w=2*Math.sqrt(1+c-i-v);this._w=(r-p)/w,this._x=(s+o)/w,this._y=.25*w,this._z=(h+g)/w}else{const w=2*Math.sqrt(1+v-i-c);this._w=(o-s)/w,this._x=(r+p)/w,this._y=(h+g)/w,this._z=.25*w}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<1e-8?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xt(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const s=Math.min(1,t/i);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,s=e._y,r=e._z,o=e._w,c=t._x,h=t._y,p=t._z,g=t._w;return this._x=i*g+o*c+s*p-r*h,this._y=s*g+o*h+r*c-i*p,this._z=r*g+o*p+i*h-s*c,this._w=o*g-i*c-s*h-r*p,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let i=e._x,s=e._y,r=e._z,o=e._w,c=this.dot(e);c<0&&(i=-i,s=-s,r=-r,o=-o,c=-c);let h=1-t;if(c<.9995){const p=Math.acos(c),g=Math.sin(p);h=Math.sin(h*p)/g,t=Math.sin(t*p)/g,this._x=this._x*h+i*t,this._y=this._y*h+s*t,this._z=this._z*h+r*t,this._w=this._w*h+o*t,this._onChangeCallback()}else this._x=this._x*h+i*t,this._y=this._y*h+s*t,this._z=this._z*h+r*t,this._w=this._w*h+o*t,this.normalize();return this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),s=Math.sqrt(1-i),r=Math.sqrt(i);return this.set(s*Math.sin(e),s*Math.cos(e),r*Math.sin(t),r*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class K{constructor(e=0,t=0,i=0){K.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(AM.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(AM.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*s,this.y=r[1]*t+r[4]*i+r[7]*s,this.z=r[2]*t+r[5]*i+r[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,r=e.elements,o=1/(r[3]*t+r[7]*i+r[11]*s+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*s+r[12])*o,this.y=(r[1]*t+r[5]*i+r[9]*s+r[13])*o,this.z=(r[2]*t+r[6]*i+r[10]*s+r[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,s=this.z,r=e.x,o=e.y,c=e.z,h=e.w,p=2*(o*s-c*i),g=2*(c*t-r*s),v=2*(r*i-o*t);return this.x=t+h*p+o*v-c*g,this.y=i+h*g+c*p-r*v,this.z=s+h*v+r*g-o*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,s=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*s,this.y=r[1]*t+r[5]*i+r[9]*s,this.z=r[2]*t+r[6]*i+r[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Xt(this.x,e.x,t.x),this.y=Xt(this.y,e.y,t.y),this.z=Xt(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Xt(this.x,e,t),this.y=Xt(this.y,e,t),this.z=Xt(this.z,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,s=e.y,r=e.z,o=t.x,c=t.y,h=t.z;return this.x=s*h-r*c,this.y=r*o-i*h,this.z=i*c-s*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return Pw.copy(this).projectOnVector(e),this.sub(Pw)}reflect(e){return this.sub(Pw.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Xt(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,s=this.z-e.z;return t*t+i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const s=Math.sin(t)*e;return this.x=s*Math.sin(i),this.y=Math.cos(t)*e,this.z=s*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=s,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Pw=new K,AM=new ea;class on{constructor(e,t,i,s,r,o,c,h,p){on.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,s,r,o,c,h,p)}set(e,t,i,s,r,o,c,h,p){const g=this.elements;return g[0]=e,g[1]=s,g[2]=c,g[3]=t,g[4]=r,g[5]=h,g[6]=i,g[7]=o,g[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,r=this.elements,o=i[0],c=i[3],h=i[6],p=i[1],g=i[4],v=i[7],y=i[2],w=i[5],E=i[8],R=s[0],N=s[3],A=s[6],I=s[1],D=s[4],U=s[7],j=s[2],F=s[5],z=s[8];return r[0]=o*R+c*I+h*j,r[3]=o*N+c*D+h*F,r[6]=o*A+c*U+h*z,r[1]=p*R+g*I+v*j,r[4]=p*N+g*D+v*F,r[7]=p*A+g*U+v*z,r[2]=y*R+w*I+E*j,r[5]=y*N+w*D+E*F,r[8]=y*A+w*U+E*z,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],s=e[2],r=e[3],o=e[4],c=e[5],h=e[6],p=e[7],g=e[8];return t*o*g-t*c*p-i*r*g+i*c*h+s*r*p-s*o*h}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],r=e[3],o=e[4],c=e[5],h=e[6],p=e[7],g=e[8],v=g*o-c*p,y=c*h-g*r,w=p*r-o*h,E=t*v+i*y+s*w;if(E===0)return this.set(0,0,0,0,0,0,0,0,0);const R=1/E;return e[0]=v*R,e[1]=(s*p-g*i)*R,e[2]=(c*i-s*o)*R,e[3]=y*R,e[4]=(g*t-s*h)*R,e[5]=(s*r-c*t)*R,e[6]=w*R,e[7]=(i*h-p*t)*R,e[8]=(o*t-i*r)*R,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,s,r,o,c){const h=Math.cos(r),p=Math.sin(r);return this.set(i*h,i*p,-i*(h*o+p*c)+o+e,-s*p,s*h,-s*(-p*o+h*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(Uw.makeScale(e,t)),this}rotate(e){return this.premultiply(Uw.makeRotation(-e)),this}translate(e,t){return this.premultiply(Uw.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<9;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Uw=new on,NM=new on().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),CM=new on().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function P5(){const n={enabled:!0,workingColorSpace:Ou,spaces:{},convert:function(s,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===$n&&(s.r=vc(s.r),s.g=vc(s.g),s.b=vc(s.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(s.applyMatrix3(this.spaces[r].toXYZ),s.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===$n&&(s.r=gp(s.r),s.g=gp(s.g),s.b=gp(s.b))),s},workingToColorSpace:function(s,r){return this.convert(s,this.workingColorSpace,r)},colorSpaceToWorking:function(s,r){return this.convert(s,r,this.workingColorSpace)},getPrimaries:function(s){return this.spaces[s].primaries},getTransfer:function(s){return s===gc?o0:this.spaces[s].transfer},getToneMappingMode:function(s){return this.spaces[s].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(s,r=this.workingColorSpace){return s.fromArray(this.spaces[r].luminanceCoefficients)},define:function(s){Object.assign(this.spaces,s)},_getMatrix:function(s,r,o){return s.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(s){return this.spaces[s].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(s=this.workingColorSpace){return this.spaces[s].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(s,r){return Sp("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(s,r)},toWorkingColorSpace:function(s,r){return Sp("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(s,r)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[Ou]:{primaries:e,whitePoint:i,transfer:o0,toXYZ:NM,fromXYZ:CM,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:sr},outputColorSpaceConfig:{drawingBufferColorSpace:sr}},[sr]:{primaries:e,whitePoint:i,transfer:$n,toXYZ:NM,fromXYZ:CM,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:sr}}}),n}const kn=P5();function vc(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function gp(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Pf;class bk{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Pf===void 0&&(Pf=c0("canvas")),Pf.width=e.width,Pf.height=e.height;const s=Pf.getContext("2d");e instanceof ImageData?s.putImageData(e,0,0):s.drawImage(e,0,0,e.width,e.height),i=Pf}return i.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=c0("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const s=i.getImageData(0,0,e.width,e.height),r=s.data;for(let o=0;o<r.length;o++)r[o]=vc(r[o]/255)*255;return i.putImageData(s,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(vc(t[i]/255)*255):t[i]=vc(t[i]);return{data:t,width:e.width,height:e.height}}else return ht("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let U5=0;class Du{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:U5++}),this.uuid=xa(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let o=0,c=s.length;o<c;o++)s[o].isDataTexture?r.push(Lw(s[o].image)):r.push(Lw(s[o]))}else r=Lw(s);i.url=r}return t||(e.images[this.uuid]=i),i}}function Lw(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?bk.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(ht("Texture: Unable to serialize Texture."),{})}let L5=0;const Ow=new K;class Bi extends Al{constructor(e=Bi.DEFAULT_IMAGE,t=Bi.DEFAULT_MAPPING,i=Qr,s=Qr,r=si,o=bl,c=Es,h=Er,p=Bi.DEFAULT_ANISOTROPY,g=gc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:L5++}),this.uuid=xa(),this.name="",this.source=new Du(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=s,this.magFilter=r,this.minFilter=o,this.anisotropy=p,this.format=c,this.internalFormat=null,this.type=h,this.offset=new Be(0,0),this.repeat=new Be(1,1),this.center=new Be(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new on,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=g,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Ow).x}get height(){return this.source.getSize(Ow).y}get depth(){return this.source.getSize(Ow).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const i=e[t];if(i===void 0){ht(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){ht(`Texture.setValues(): property '${t}' does not exist.`);continue}s&&i&&s.isVector2&&i.isVector2||s&&i&&s.isVector3&&i.isVector3||s&&i&&s.isMatrix3&&i.isMatrix3?s.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Xb)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case i0:e.x=e.x-Math.floor(e.x);break;case Qr:e.x=e.x<0?0:1;break;case s0:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case i0:e.y=e.y-Math.floor(e.y);break;case Qr:e.y=e.y<0?0:1;break;case s0:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Bi.DEFAULT_IMAGE=null;Bi.DEFAULT_MAPPING=Xb;Bi.DEFAULT_ANISOTROPY=1;class ii{constructor(e=0,t=0,i=0,s=1){ii.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,s){return this.x=e,this.y=t,this.z=i,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,s=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*s+o[12]*r,this.y=o[1]*t+o[5]*i+o[9]*s+o[13]*r,this.z=o[2]*t+o[6]*i+o[10]*s+o[14]*r,this.w=o[3]*t+o[7]*i+o[11]*s+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,s,r;const h=e.elements,p=h[0],g=h[4],v=h[8],y=h[1],w=h[5],E=h[9],R=h[2],N=h[6],A=h[10];if(Math.abs(g-y)<.01&&Math.abs(v-R)<.01&&Math.abs(E-N)<.01){if(Math.abs(g+y)<.1&&Math.abs(v+R)<.1&&Math.abs(E+N)<.1&&Math.abs(p+w+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const D=(p+1)/2,U=(w+1)/2,j=(A+1)/2,F=(g+y)/4,z=(v+R)/4,W=(E+N)/4;return D>U&&D>j?D<.01?(i=0,s=.707106781,r=.707106781):(i=Math.sqrt(D),s=F/i,r=z/i):U>j?U<.01?(i=.707106781,s=0,r=.707106781):(s=Math.sqrt(U),i=F/s,r=W/s):j<.01?(i=.707106781,s=.707106781,r=0):(r=Math.sqrt(j),i=z/r,s=W/r),this.set(i,s,r,t),this}let I=Math.sqrt((N-E)*(N-E)+(v-R)*(v-R)+(y-g)*(y-g));return Math.abs(I)<.001&&(I=1),this.x=(N-E)/I,this.y=(v-R)/I,this.z=(y-g)/I,this.w=Math.acos((p+w+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Xt(this.x,e.x,t.x),this.y=Xt(this.y,e.y,t.y),this.z=Xt(this.z,e.z,t.z),this.w=Xt(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Xt(this.x,e,t),this.y=Xt(this.y,e,t),this.z=Xt(this.z,e,t),this.w=Xt(this.w,e,t),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xt(i,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rT extends Al{constructor(e=1,t=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:si,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=i.depth,this.scissor=new ii(0,0,e,t),this.scissorTest=!1,this.viewport=new ii(0,0,e,t);const s={width:e,height:t,depth:i.depth},r=new Bi(s);this.textures=[];const o=i.count;for(let c=0;c<o;c++)this.textures[c]=r.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(e={}){const t={minFilter:si,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let s=0,r=this.textures.length;s<r;s++)this.textures[s].image.width=e,this.textures[s].image.height=t,this.textures[s].image.depth=i,this.textures[s].isData3DTexture!==!0&&(this.textures[s].isArrayTexture=this.textures[s].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,i=e.textures.length;t<i;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const s=Object.assign({},e.textures[t].image);this.textures[t].source=new Du(s)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class ta extends rT{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class s_ extends Bi{constructor(e=null,t=1,i=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Ii,this.minFilter=Ii,this.wrapR=Qr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class O5 extends ta{constructor(e=1,t=1,i=1,s={}){super(e,t,s),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new s_(null,e,t,i),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class r_ extends Bi{constructor(e=null,t=1,i=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:s},this.magFilter=Ii,this.minFilter=Ii,this.wrapR=Qr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class z5 extends ta{constructor(e=1,t=1,i=1,s={}){super(e,t,s),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new r_(null,e,t,i),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class ar{constructor(e=new K(1/0,1/0,1/0),t=new K(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(To.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(To.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=To.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const r=i.getAttribute("position");if(t===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,c=r.count;o<c;o++)e.isMesh===!0?e.getVertexPosition(o,To):To.fromBufferAttribute(r,o),To.applyMatrix4(e.matrixWorld),this.expandByPoint(To);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),_v.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),_v.copy(i.boundingBox)),_v.applyMatrix4(e.matrixWorld),this.union(_v)}const s=e.children;for(let r=0,o=s.length;r<o;r++)this.expandByObject(s[r],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,To),To.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(hg),wv.subVectors(this.max,hg),Uf.subVectors(e.a,hg),Lf.subVectors(e.b,hg),Of.subVectors(e.c,hg),xu.subVectors(Lf,Uf),vu.subVectors(Of,Lf),Pd.subVectors(Uf,Of);let t=[0,-xu.z,xu.y,0,-vu.z,vu.y,0,-Pd.z,Pd.y,xu.z,0,-xu.x,vu.z,0,-vu.x,Pd.z,0,-Pd.x,-xu.y,xu.x,0,-vu.y,vu.x,0,-Pd.y,Pd.x,0];return!zw(t,Uf,Lf,Of,wv)||(t=[1,0,0,0,1,0,0,0,1],!zw(t,Uf,Lf,Of,wv))?!1:(Sv.crossVectors(xu,vu),t=[Sv.x,Sv.y,Sv.z],zw(t,Uf,Lf,Of,wv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,To).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(To).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(lc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),lc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),lc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),lc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),lc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),lc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),lc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),lc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(lc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const lc=[new K,new K,new K,new K,new K,new K,new K,new K],To=new K,_v=new ar,Uf=new K,Lf=new K,Of=new K,xu=new K,vu=new K,Pd=new K,hg=new K,wv=new K,Sv=new K,Ud=new K;function zw(n,e,t,i,s){for(let r=0,o=n.length-3;r<=o;r+=3){Ud.fromArray(n,r);const c=s.x*Math.abs(Ud.x)+s.y*Math.abs(Ud.y)+s.z*Math.abs(Ud.z),h=e.dot(Ud),p=t.dot(Ud),g=i.dot(Ud);if(Math.max(-Math.max(h,p,g),Math.min(h,p,g))>c)return!1}return!0}const j5=new ar,fg=new K,jw=new K;class Bs{constructor(e=new K,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):j5.setFromPoints(e).getCenter(i);let s=0;for(let r=0,o=e.length;r<o;r++)s=Math.max(s,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;fg.subVectors(e,this.center);const t=fg.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),s=(i-this.radius)*.5;this.center.addScaledVector(fg,s/i),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(jw.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(fg.copy(e.center).add(jw)),this.expandByPoint(fg.copy(e.center).sub(jw))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const cc=new K,Fw=new K,Tv=new K,yu=new K,Bw=new K,Ev=new K,Vw=new K;class kp{constructor(e=new K,t=new K(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,cc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=cc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(cc.copy(this.origin).addScaledVector(this.direction,t),cc.distanceToSquared(e))}distanceSqToSegment(e,t,i,s){Fw.copy(e).add(t).multiplyScalar(.5),Tv.copy(t).sub(e).normalize(),yu.copy(this.origin).sub(Fw);const r=e.distanceTo(t)*.5,o=-this.direction.dot(Tv),c=yu.dot(this.direction),h=-yu.dot(Tv),p=yu.lengthSq(),g=Math.abs(1-o*o);let v,y,w,E;if(g>0)if(v=o*h-c,y=o*c-h,E=r*g,v>=0)if(y>=-E)if(y<=E){const R=1/g;v*=R,y*=R,w=v*(v+o*y+2*c)+y*(o*v+y+2*h)+p}else y=r,v=Math.max(0,-(o*y+c)),w=-v*v+y*(y+2*h)+p;else y=-r,v=Math.max(0,-(o*y+c)),w=-v*v+y*(y+2*h)+p;else y<=-E?(v=Math.max(0,-(-o*r+c)),y=v>0?-r:Math.min(Math.max(-r,-h),r),w=-v*v+y*(y+2*h)+p):y<=E?(v=0,y=Math.min(Math.max(-r,-h),r),w=y*(y+2*h)+p):(v=Math.max(0,-(o*r+c)),y=v>0?r:Math.min(Math.max(-r,-h),r),w=-v*v+y*(y+2*h)+p);else y=o>0?-r:r,v=Math.max(0,-(o*y+c)),w=-v*v+y*(y+2*h)+p;return i&&i.copy(this.origin).addScaledVector(this.direction,v),s&&s.copy(Fw).addScaledVector(Tv,y),w}intersectSphere(e,t){cc.subVectors(e.center,this.origin);const i=cc.dot(this.direction),s=cc.dot(cc)-i*i,r=e.radius*e.radius;if(s>r)return null;const o=Math.sqrt(r-s),c=i-o,h=i+o;return h<0?null:c<0?this.at(h,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,s,r,o,c,h;const p=1/this.direction.x,g=1/this.direction.y,v=1/this.direction.z,y=this.origin;return p>=0?(i=(e.min.x-y.x)*p,s=(e.max.x-y.x)*p):(i=(e.max.x-y.x)*p,s=(e.min.x-y.x)*p),g>=0?(r=(e.min.y-y.y)*g,o=(e.max.y-y.y)*g):(r=(e.max.y-y.y)*g,o=(e.min.y-y.y)*g),i>o||r>s||((r>i||isNaN(i))&&(i=r),(o<s||isNaN(s))&&(s=o),v>=0?(c=(e.min.z-y.z)*v,h=(e.max.z-y.z)*v):(c=(e.max.z-y.z)*v,h=(e.min.z-y.z)*v),i>h||c>s)||((c>i||i!==i)&&(i=c),(h<s||s!==s)&&(s=h),s<0)?null:this.at(i>=0?i:s,t)}intersectsBox(e){return this.intersectBox(e,cc)!==null}intersectTriangle(e,t,i,s,r){Bw.subVectors(t,e),Ev.subVectors(i,e),Vw.crossVectors(Bw,Ev);let o=this.direction.dot(Vw),c;if(o>0){if(s)return null;c=1}else if(o<0)c=-1,o=-o;else return null;yu.subVectors(this.origin,e);const h=c*this.direction.dot(Ev.crossVectors(yu,Ev));if(h<0)return null;const p=c*this.direction.dot(Bw.cross(yu));if(p<0||h+p>o)return null;const g=-c*yu.dot(Vw);return g<0?null:this.at(g/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Jt{constructor(e,t,i,s,r,o,c,h,p,g,v,y,w,E,R,N){Jt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,s,r,o,c,h,p,g,v,y,w,E,R,N)}set(e,t,i,s,r,o,c,h,p,g,v,y,w,E,R,N){const A=this.elements;return A[0]=e,A[4]=t,A[8]=i,A[12]=s,A[1]=r,A[5]=o,A[9]=c,A[13]=h,A[2]=p,A[6]=g,A[10]=v,A[14]=y,A[3]=w,A[7]=E,A[11]=R,A[15]=N,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Jt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),i.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this)}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,i=e.elements,s=1/zf.setFromMatrixColumn(e,0).length(),r=1/zf.setFromMatrixColumn(e,1).length(),o=1/zf.setFromMatrixColumn(e,2).length();return t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,s=e.y,r=e.z,o=Math.cos(i),c=Math.sin(i),h=Math.cos(s),p=Math.sin(s),g=Math.cos(r),v=Math.sin(r);if(e.order==="XYZ"){const y=o*g,w=o*v,E=c*g,R=c*v;t[0]=h*g,t[4]=-h*v,t[8]=p,t[1]=w+E*p,t[5]=y-R*p,t[9]=-c*h,t[2]=R-y*p,t[6]=E+w*p,t[10]=o*h}else if(e.order==="YXZ"){const y=h*g,w=h*v,E=p*g,R=p*v;t[0]=y+R*c,t[4]=E*c-w,t[8]=o*p,t[1]=o*v,t[5]=o*g,t[9]=-c,t[2]=w*c-E,t[6]=R+y*c,t[10]=o*h}else if(e.order==="ZXY"){const y=h*g,w=h*v,E=p*g,R=p*v;t[0]=y-R*c,t[4]=-o*v,t[8]=E+w*c,t[1]=w+E*c,t[5]=o*g,t[9]=R-y*c,t[2]=-o*p,t[6]=c,t[10]=o*h}else if(e.order==="ZYX"){const y=o*g,w=o*v,E=c*g,R=c*v;t[0]=h*g,t[4]=E*p-w,t[8]=y*p+R,t[1]=h*v,t[5]=R*p+y,t[9]=w*p-E,t[2]=-p,t[6]=c*h,t[10]=o*h}else if(e.order==="YZX"){const y=o*h,w=o*p,E=c*h,R=c*p;t[0]=h*g,t[4]=R-y*v,t[8]=E*v+w,t[1]=v,t[5]=o*g,t[9]=-c*g,t[2]=-p*g,t[6]=w*v+E,t[10]=y-R*v}else if(e.order==="XZY"){const y=o*h,w=o*p,E=c*h,R=c*p;t[0]=h*g,t[4]=-v,t[8]=p*g,t[1]=y*v+R,t[5]=o*g,t[9]=w*v-E,t[2]=E*v-w,t[6]=c*g,t[10]=R*v+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(F5,e,B5)}lookAt(e,t,i){const s=this.elements;return da.subVectors(e,t),da.lengthSq()===0&&(da.z=1),da.normalize(),bu.crossVectors(i,da),bu.lengthSq()===0&&(Math.abs(i.z)===1?da.x+=1e-4:da.z+=1e-4,da.normalize(),bu.crossVectors(i,da)),bu.normalize(),Mv.crossVectors(da,bu),s[0]=bu.x,s[4]=Mv.x,s[8]=da.x,s[1]=bu.y,s[5]=Mv.y,s[9]=da.y,s[2]=bu.z,s[6]=Mv.z,s[10]=da.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,s=t.elements,r=this.elements,o=i[0],c=i[4],h=i[8],p=i[12],g=i[1],v=i[5],y=i[9],w=i[13],E=i[2],R=i[6],N=i[10],A=i[14],I=i[3],D=i[7],U=i[11],j=i[15],F=s[0],z=s[4],W=s[8],L=s[12],B=s[1],Y=s[5],ee=s[9],Q=s[13],ce=s[2],oe=s[6],J=s[10],te=s[14],me=s[3],Re=s[7],Ie=s[11],$=s[15];return r[0]=o*F+c*B+h*ce+p*me,r[4]=o*z+c*Y+h*oe+p*Re,r[8]=o*W+c*ee+h*J+p*Ie,r[12]=o*L+c*Q+h*te+p*$,r[1]=g*F+v*B+y*ce+w*me,r[5]=g*z+v*Y+y*oe+w*Re,r[9]=g*W+v*ee+y*J+w*Ie,r[13]=g*L+v*Q+y*te+w*$,r[2]=E*F+R*B+N*ce+A*me,r[6]=E*z+R*Y+N*oe+A*Re,r[10]=E*W+R*ee+N*J+A*Ie,r[14]=E*L+R*Q+N*te+A*$,r[3]=I*F+D*B+U*ce+j*me,r[7]=I*z+D*Y+U*oe+j*Re,r[11]=I*W+D*ee+U*J+j*Ie,r[15]=I*L+D*Q+U*te+j*$,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],s=e[8],r=e[12],o=e[1],c=e[5],h=e[9],p=e[13],g=e[2],v=e[6],y=e[10],w=e[14],E=e[3],R=e[7],N=e[11],A=e[15],I=h*w-p*y,D=c*w-p*v,U=c*y-h*v,j=o*w-p*g,F=o*y-h*g,z=o*v-c*g;return t*(R*I-N*D+A*U)-i*(E*I-N*j+A*F)+s*(E*D-R*j+A*z)-r*(E*U-R*F+N*z)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=t,s[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],s=e[2],r=e[3],o=e[4],c=e[5],h=e[6],p=e[7],g=e[8],v=e[9],y=e[10],w=e[11],E=e[12],R=e[13],N=e[14],A=e[15],I=v*N*p-R*y*p+R*h*w-c*N*w-v*h*A+c*y*A,D=E*y*p-g*N*p-E*h*w+o*N*w+g*h*A-o*y*A,U=g*R*p-E*v*p+E*c*w-o*R*w-g*c*A+o*v*A,j=E*v*h-g*R*h-E*c*y+o*R*y+g*c*N-o*v*N,F=t*I+i*D+s*U+r*j;if(F===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const z=1/F;return e[0]=I*z,e[1]=(R*y*r-v*N*r-R*s*w+i*N*w+v*s*A-i*y*A)*z,e[2]=(c*N*r-R*h*r+R*s*p-i*N*p-c*s*A+i*h*A)*z,e[3]=(v*h*r-c*y*r-v*s*p+i*y*p+c*s*w-i*h*w)*z,e[4]=D*z,e[5]=(g*N*r-E*y*r+E*s*w-t*N*w-g*s*A+t*y*A)*z,e[6]=(E*h*r-o*N*r-E*s*p+t*N*p+o*s*A-t*h*A)*z,e[7]=(o*y*r-g*h*r+g*s*p-t*y*p-o*s*w+t*h*w)*z,e[8]=U*z,e[9]=(E*v*r-g*R*r-E*i*w+t*R*w+g*i*A-t*v*A)*z,e[10]=(o*R*r-E*c*r+E*i*p-t*R*p-o*i*A+t*c*A)*z,e[11]=(g*c*r-o*v*r-g*i*p+t*v*p+o*i*w-t*c*w)*z,e[12]=j*z,e[13]=(g*R*s-E*v*s+E*i*y-t*R*y-g*i*N+t*v*N)*z,e[14]=(E*c*s-o*R*s-E*i*h+t*R*h+o*i*N-t*c*N)*z,e[15]=(o*v*s-g*c*s+g*i*h-t*v*h-o*i*y+t*c*y)*z,this}scale(e){const t=this.elements,i=e.x,s=e.y,r=e.z;return t[0]*=i,t[4]*=s,t[8]*=r,t[1]*=i,t[5]*=s,t[9]*=r,t[2]*=i,t[6]*=s,t[10]*=r,t[3]*=i,t[7]*=s,t[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,s))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),s=Math.sin(t),r=1-i,o=e.x,c=e.y,h=e.z,p=r*o,g=r*c;return this.set(p*o+i,p*c-s*h,p*h+s*c,0,p*c+s*h,g*c+i,g*h-s*o,0,p*h-s*c,g*h+s*o,r*h*h+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,s,r,o){return this.set(1,i,r,0,e,1,o,0,t,s,1,0,0,0,0,1),this}compose(e,t,i){const s=this.elements,r=t._x,o=t._y,c=t._z,h=t._w,p=r+r,g=o+o,v=c+c,y=r*p,w=r*g,E=r*v,R=o*g,N=o*v,A=c*v,I=h*p,D=h*g,U=h*v,j=i.x,F=i.y,z=i.z;return s[0]=(1-(R+A))*j,s[1]=(w+U)*j,s[2]=(E-D)*j,s[3]=0,s[4]=(w-U)*F,s[5]=(1-(y+A))*F,s[6]=(N+I)*F,s[7]=0,s[8]=(E+D)*z,s[9]=(N-I)*z,s[10]=(1-(y+R))*z,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,t,i){const s=this.elements;if(e.x=s[12],e.y=s[13],e.z=s[14],this.determinant()===0)return i.set(1,1,1),t.identity(),this;let r=zf.set(s[0],s[1],s[2]).length();const o=zf.set(s[4],s[5],s[6]).length(),c=zf.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),Eo.copy(this);const p=1/r,g=1/o,v=1/c;return Eo.elements[0]*=p,Eo.elements[1]*=p,Eo.elements[2]*=p,Eo.elements[4]*=g,Eo.elements[5]*=g,Eo.elements[6]*=g,Eo.elements[8]*=v,Eo.elements[9]*=v,Eo.elements[10]*=v,t.setFromRotationMatrix(Eo),i.x=r,i.y=o,i.z=c,this}makePerspective(e,t,i,s,r,o,c=ga,h=!1){const p=this.elements,g=2*r/(t-e),v=2*r/(i-s),y=(t+e)/(t-e),w=(i+s)/(i-s);let E,R;if(h)E=r/(o-r),R=o*r/(o-r);else if(c===ga)E=-(o+r)/(o-r),R=-2*o*r/(o-r);else if(c===wp)E=-o/(o-r),R=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return p[0]=g,p[4]=0,p[8]=y,p[12]=0,p[1]=0,p[5]=v,p[9]=w,p[13]=0,p[2]=0,p[6]=0,p[10]=E,p[14]=R,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,i,s,r,o,c=ga,h=!1){const p=this.elements,g=2/(t-e),v=2/(i-s),y=-(t+e)/(t-e),w=-(i+s)/(i-s);let E,R;if(h)E=1/(o-r),R=o/(o-r);else if(c===ga)E=-2/(o-r),R=-(o+r)/(o-r);else if(c===wp)E=-1/(o-r),R=-r/(o-r);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return p[0]=g,p[4]=0,p[8]=0,p[12]=y,p[1]=0,p[5]=v,p[9]=0,p[13]=w,p[2]=0,p[6]=0,p[10]=E,p[14]=R,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let s=0;s<16;s++)if(t[s]!==i[s])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const zf=new K,Eo=new Jt,F5=new K(0,0,0),B5=new K(1,1,1),bu=new K,Mv=new K,da=new K,RM=new Jt,kM=new ea;class ya{constructor(e=0,t=0,i=0,s=ya.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,s=this._order){return this._x=e,this._y=t,this._z=i,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const s=e.elements,r=s[0],o=s[4],c=s[8],h=s[1],p=s[5],g=s[9],v=s[2],y=s[6],w=s[10];switch(t){case"XYZ":this._y=Math.asin(Xt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-g,w),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(y,p),this._z=0);break;case"YXZ":this._x=Math.asin(-Xt(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(c,w),this._z=Math.atan2(h,p)):(this._y=Math.atan2(-v,r),this._z=0);break;case"ZXY":this._x=Math.asin(Xt(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-v,w),this._z=Math.atan2(-o,p)):(this._y=0,this._z=Math.atan2(h,r));break;case"ZYX":this._y=Math.asin(-Xt(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(y,w),this._z=Math.atan2(h,r)):(this._x=0,this._z=Math.atan2(-o,p));break;case"YZX":this._z=Math.asin(Xt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-g,p),this._y=Math.atan2(-v,r)):(this._x=0,this._y=Math.atan2(c,w));break;case"XZY":this._z=Math.asin(-Xt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(y,p),this._y=Math.atan2(c,r)):(this._x=Math.atan2(-g,w),this._y=0);break;default:ht("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return RM.makeRotationFromQuaternion(e),this.setFromRotationMatrix(RM,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return kM.setFromEuler(this),this.setFromQuaternion(kM,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ya.DEFAULT_ORDER="XYZ";class Ep{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let V5=0;const IM=new K,jf=new ea,uc=new Jt,Av=new K,pg=new K,H5=new K,G5=new ea,DM=new K(1,0,0),PM=new K(0,1,0),UM=new K(0,0,1),LM={type:"added"},q5={type:"removed"},Ff={type:"childadded",child:null},Hw={type:"childremoved",child:null};class On extends Al{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:V5++}),this.uuid=xa(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=On.DEFAULT_UP.clone();const e=new K,t=new ya,i=new ea,s=new K(1,1,1);function r(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(r),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Jt},normalMatrix:{value:new on}}),this.matrix=new Jt,this.matrixWorld=new Jt,this.matrixAutoUpdate=On.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=On.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Ep,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return jf.setFromAxisAngle(e,t),this.quaternion.multiply(jf),this}rotateOnWorldAxis(e,t){return jf.setFromAxisAngle(e,t),this.quaternion.premultiply(jf),this}rotateX(e){return this.rotateOnAxis(DM,e)}rotateY(e){return this.rotateOnAxis(PM,e)}rotateZ(e){return this.rotateOnAxis(UM,e)}translateOnAxis(e,t){return IM.copy(e).applyQuaternion(this.quaternion),this.position.add(IM.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(DM,e)}translateY(e){return this.translateOnAxis(PM,e)}translateZ(e){return this.translateOnAxis(UM,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(uc.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Av.copy(e):Av.set(e,t,i);const s=this.parent;this.updateWorldMatrix(!0,!1),pg.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?uc.lookAt(pg,Av,this.up):uc.lookAt(Av,pg,this.up),this.quaternion.setFromRotationMatrix(uc),s&&(uc.extractRotation(s.matrixWorld),jf.setFromRotationMatrix(uc),this.quaternion.premultiply(jf.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Dt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(LM),Ff.child=e,this.dispatchEvent(Ff),Ff.child=null):Dt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(q5),Hw.child=e,this.dispatchEvent(Hw),Hw.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),uc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),uc.multiply(e.parent.matrixWorld)),e.applyMatrix4(uc),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(LM),Ff.child=e,this.dispatchEvent(Ff),Ff.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,s=this.children.length;i<s;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(pg,e,H5),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(pg,G5,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,s=t.length;i<s;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),s.instanceInfo=this._instanceInfo.map(c=>({...c})),s.availableInstanceIds=this._availableInstanceIds.slice(),s.availableGeometryIds=this._availableGeometryIds.slice(),s.nextIndexStart=this._nextIndexStart,s.nextVertexStart=this._nextVertexStart,s.geometryCount=this._geometryCount,s.maxInstanceCount=this._maxInstanceCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.matricesTexture=this._matricesTexture.toJSON(e),s.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(s.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(s.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(s.boundingBox=this.boundingBox.toJSON()));function r(c,h){return c[h.uuid]===void 0&&(c[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const h=c.shapes;if(Array.isArray(h))for(let p=0,g=h.length;p<g;p++){const v=h[p];r(e.shapes,v)}else r(e.shapes,h)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let h=0,p=this.material.length;h<p;h++)c.push(r(e.materials,this.material[h]));s.material=c}else s.material=r(e.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){const h=this.animations[c];s.animations.push(r(e.animations,h))}}if(t){const c=o(e.geometries),h=o(e.materials),p=o(e.textures),g=o(e.images),v=o(e.shapes),y=o(e.skeletons),w=o(e.animations),E=o(e.nodes);c.length>0&&(i.geometries=c),h.length>0&&(i.materials=h),p.length>0&&(i.textures=p),g.length>0&&(i.images=g),v.length>0&&(i.shapes=v),y.length>0&&(i.skeletons=y),w.length>0&&(i.animations=w),E.length>0&&(i.nodes=E)}return i.object=s,i;function o(c){const h=[];for(const p in c){const g=c[p];delete g.metadata,h.push(g)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const s=e.children[i];this.add(s.clone())}return this}}On.DEFAULT_UP=new K(0,1,0);On.DEFAULT_MATRIX_AUTO_UPDATE=!0;On.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Mo=new K,dc=new K,Gw=new K,hc=new K,Bf=new K,Vf=new K,OM=new K,qw=new K,Ww=new K,$w=new K,Xw=new ii,Yw=new ii,Jw=new ii;class Zr{constructor(e=new K,t=new K,i=new K){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,s){s.subVectors(i,t),Mo.subVectors(e,t),s.cross(Mo);const r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(e,t,i,s,r){Mo.subVectors(s,t),dc.subVectors(i,t),Gw.subVectors(e,t);const o=Mo.dot(Mo),c=Mo.dot(dc),h=Mo.dot(Gw),p=dc.dot(dc),g=dc.dot(Gw),v=o*p-c*c;if(v===0)return r.set(0,0,0),null;const y=1/v,w=(p*h-c*g)*y,E=(o*g-c*h)*y;return r.set(1-w-E,E,w)}static containsPoint(e,t,i,s){return this.getBarycoord(e,t,i,s,hc)===null?!1:hc.x>=0&&hc.y>=0&&hc.x+hc.y<=1}static getInterpolation(e,t,i,s,r,o,c,h){return this.getBarycoord(e,t,i,s,hc)===null?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(r,hc.x),h.addScaledVector(o,hc.y),h.addScaledVector(c,hc.z),h)}static getInterpolatedAttribute(e,t,i,s,r,o){return Xw.setScalar(0),Yw.setScalar(0),Jw.setScalar(0),Xw.fromBufferAttribute(e,t),Yw.fromBufferAttribute(e,i),Jw.fromBufferAttribute(e,s),o.setScalar(0),o.addScaledVector(Xw,r.x),o.addScaledVector(Yw,r.y),o.addScaledVector(Jw,r.z),o}static isFrontFacing(e,t,i,s){return Mo.subVectors(i,t),dc.subVectors(e,t),Mo.cross(dc).dot(s)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,s){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,t,i,s){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Mo.subVectors(this.c,this.b),dc.subVectors(this.a,this.b),Mo.cross(dc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Zr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Zr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,s,r){return Zr.getInterpolation(e,this.a,this.b,this.c,t,i,s,r)}containsPoint(e){return Zr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Zr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,s=this.b,r=this.c;let o,c;Bf.subVectors(s,i),Vf.subVectors(r,i),qw.subVectors(e,i);const h=Bf.dot(qw),p=Vf.dot(qw);if(h<=0&&p<=0)return t.copy(i);Ww.subVectors(e,s);const g=Bf.dot(Ww),v=Vf.dot(Ww);if(g>=0&&v<=g)return t.copy(s);const y=h*v-g*p;if(y<=0&&h>=0&&g<=0)return o=h/(h-g),t.copy(i).addScaledVector(Bf,o);$w.subVectors(e,r);const w=Bf.dot($w),E=Vf.dot($w);if(E>=0&&w<=E)return t.copy(r);const R=w*p-h*E;if(R<=0&&p>=0&&E<=0)return c=p/(p-E),t.copy(i).addScaledVector(Vf,c);const N=g*E-w*v;if(N<=0&&v-g>=0&&w-E>=0)return OM.subVectors(r,s),c=(v-g)/(v-g+(w-E)),t.copy(s).addScaledVector(OM,c);const A=1/(N+R+y);return o=R*A,c=y*A,t.copy(i).addScaledVector(Bf,o).addScaledVector(Vf,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const _k={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_u={h:0,s:0,l:0},Nv={h:0,s:0,l:0};function Kw(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class _t{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=sr){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,kn.colorSpaceToWorking(this,t),this}setRGB(e,t,i,s=kn.workingColorSpace){return this.r=e,this.g=t,this.b=i,kn.colorSpaceToWorking(this,s),this}setHSL(e,t,i,s=kn.workingColorSpace){if(e=sT(e,1),t=Xt(t,0,1),i=Xt(i,0,1),t===0)this.r=this.g=this.b=i;else{const r=i<=.5?i*(1+t):i+t-i*t,o=2*i-r;this.r=Kw(o,r,e+1/3),this.g=Kw(o,r,e),this.b=Kw(o,r,e-1/3)}return kn.colorSpaceToWorking(this,s),this}setStyle(e,t=sr){function i(r){r!==void 0&&parseFloat(r)<1&&ht("Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=s[1],c=s[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return i(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,t);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return i(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,t);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return i(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,t);break;default:ht("Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=s[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(r,16),t);ht("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=sr){const i=_k[e.toLowerCase()];return i!==void 0?this.setHex(i,t):ht("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=vc(e.r),this.g=vc(e.g),this.b=vc(e.b),this}copyLinearToSRGB(e){return this.r=gp(e.r),this.g=gp(e.g),this.b=gp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=sr){return kn.workingToColorSpace(nr.copy(this),e),Math.round(Xt(nr.r*255,0,255))*65536+Math.round(Xt(nr.g*255,0,255))*256+Math.round(Xt(nr.b*255,0,255))}getHexString(e=sr){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=kn.workingColorSpace){kn.workingToColorSpace(nr.copy(this),t);const i=nr.r,s=nr.g,r=nr.b,o=Math.max(i,s,r),c=Math.min(i,s,r);let h,p;const g=(c+o)/2;if(c===o)h=0,p=0;else{const v=o-c;switch(p=g<=.5?v/(o+c):v/(2-o-c),o){case i:h=(s-r)/v+(s<r?6:0);break;case s:h=(r-i)/v+2;break;case r:h=(i-s)/v+4;break}h/=6}return e.h=h,e.s=p,e.l=g,e}getRGB(e,t=kn.workingColorSpace){return kn.workingToColorSpace(nr.copy(this),t),e.r=nr.r,e.g=nr.g,e.b=nr.b,e}getStyle(e=sr){kn.workingToColorSpace(nr.copy(this),e);const t=nr.r,i=nr.g,s=nr.b;return e!==sr?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(s*255)})`}offsetHSL(e,t,i){return this.getHSL(_u),this.setHSL(_u.h+e,_u.s+t,_u.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(_u),e.getHSL(Nv);const i=Gg(_u.h,Nv.h,t),s=Gg(_u.s,Nv.s,t),r=Gg(_u.l,Nv.l,t);return this.setHSL(i,s,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,s=this.b,r=e.elements;return this.r=r[0]*t+r[3]*i+r[6]*s,this.g=r[1]*t+r[4]*i+r[7]*s,this.b=r[2]*t+r[5]*i+r[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const nr=new _t;_t.NAMES=_k;let W5=0;class or extends Al{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:W5++}),this.uuid=xa(),this.name="",this.type="Material",this.blending=ah,this.side=_c,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Iy,this.blendDst=Dy,this.blendEquation=Ru,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new _t(0,0,0),this.blendAlpha=0,this.depthFunc=uh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=n1,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Yd,this.stencilZFail=Yd,this.stencilZPass=Yd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){ht(`Material: parameter '${t}' has value of undefined.`);continue}const s=this[t];if(s===void 0){ht(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==ah&&(i.blending=this.blending),this.side!==_c&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Iy&&(i.blendSrc=this.blendSrc),this.blendDst!==Dy&&(i.blendDst=this.blendDst),this.blendEquation!==Ru&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==uh&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==n1&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Yd&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Yd&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Yd&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.allowOverride===!1&&(i.allowOverride=!1),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function s(r){const o=[];for(const c in r){const h=r[c];delete h.metadata,o.push(h)}return o}if(t){const r=s(e.textures),o=s(e.images);r.length>0&&(i.textures=r),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const s=t.length;i=new Array(s);for(let r=0;r!==s;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Hu extends or{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new _t(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ya,this.combine=T0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const xc=$5();function $5(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),s=new Uint32Array(512);for(let h=0;h<256;++h){const p=h-127;p<-27?(i[h]=0,i[h|256]=32768,s[h]=24,s[h|256]=24):p<-14?(i[h]=1024>>-p-14,i[h|256]=1024>>-p-14|32768,s[h]=-p-1,s[h|256]=-p-1):p<=15?(i[h]=p+15<<10,i[h|256]=p+15<<10|32768,s[h]=13,s[h|256]=13):p<128?(i[h]=31744,i[h|256]=64512,s[h]=24,s[h|256]=24):(i[h]=31744,i[h|256]=64512,s[h]=13,s[h|256]=13)}const r=new Uint32Array(2048),o=new Uint32Array(64),c=new Uint32Array(64);for(let h=1;h<1024;++h){let p=h<<13,g=0;for(;(p&8388608)===0;)p<<=1,g-=8388608;p&=-8388609,g+=947912704,r[h]=p|g}for(let h=1024;h<2048;++h)r[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)o[h]=h<<23;o[31]=1199570944,o[32]=2147483648;for(let h=33;h<63;++h)o[h]=2147483648+(h-32<<23);o[63]=3347054592;for(let h=1;h<64;++h)h!==32&&(c[h]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:s,mantissaTable:r,exponentTable:o,offsetTable:c}}function Jr(n){Math.abs(n)>65504&&ht("DataUtils.toHalfFloat(): Value out of range."),n=Xt(n,-65504,65504),xc.floatView[0]=n;const e=xc.uint32View[0],t=e>>23&511;return xc.baseTable[t]+((e&8388607)>>xc.shiftTable[t])}function kg(n){const e=n>>10;return xc.uint32View[0]=xc.mantissaTable[xc.offsetTable[e]+(n&1023)]+xc.exponentTable[e],xc.floatView[0]}class X5{static toHalfFloat(e){return Jr(e)}static fromHalfFloat(e){return kg(e)}}const rs=new K,Cv=new Be;let Y5=0;class ei{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Y5++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=l0,this.updateRanges=[],this.gpuType=Ts,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[e+s]=t.array[i+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Cv.fromBufferAttribute(this,t),Cv.applyMatrix3(e),this.setXY(t,Cv.x,Cv.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)rs.fromBufferAttribute(this,t),rs.applyMatrix3(e),this.setXYZ(t,rs.x,rs.y,rs.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)rs.fromBufferAttribute(this,t),rs.applyMatrix4(e),this.setXYZ(t,rs.x,rs.y,rs.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)rs.fromBufferAttribute(this,t),rs.applyNormalMatrix(e),this.setXYZ(t,rs.x,rs.y,rs.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)rs.fromBufferAttribute(this,t),rs.transformDirection(e),this.setXYZ(t,rs.x,rs.y,rs.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Mr(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=hn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Mr(t,this.array)),t}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Mr(t,this.array)),t}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Mr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Mr(t,this.array)),t}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),s=hn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this}setXYZW(e,t,i,s,r){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),s=hn(s,this.array),r=hn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=s,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==l0&&(e.usage=this.usage),e}}class J5 extends ei{constructor(e,t,i){super(new Int8Array(e),t,i)}}class K5 extends ei{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class Z5 extends ei{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class Q5 extends ei{constructor(e,t,i){super(new Int16Array(e),t,i)}}class aT extends ei{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class eO extends ei{constructor(e,t,i){super(new Int32Array(e),t,i)}}class oT extends ei{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class tO extends ei{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=kg(this.array[e*this.itemSize]);return this.normalized&&(t=Mr(t,this.array)),t}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize]=Jr(t),this}getY(e){let t=kg(this.array[e*this.itemSize+1]);return this.normalized&&(t=Mr(t,this.array)),t}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+1]=Jr(t),this}getZ(e){let t=kg(this.array[e*this.itemSize+2]);return this.normalized&&(t=Mr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+2]=Jr(t),this}getW(e){let t=kg(this.array[e*this.itemSize+3]);return this.normalized&&(t=Mr(t,this.array)),t}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.array[e*this.itemSize+3]=Jr(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array)),this.array[e+0]=Jr(t),this.array[e+1]=Jr(i),this}setXYZ(e,t,i,s){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),s=hn(s,this.array)),this.array[e+0]=Jr(t),this.array[e+1]=Jr(i),this.array[e+2]=Jr(s),this}setXYZW(e,t,i,s,r){return e*=this.itemSize,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),s=hn(s,this.array),r=hn(r,this.array)),this.array[e+0]=Jr(t),this.array[e+1]=Jr(i),this.array[e+2]=Jr(s),this.array[e+3]=Jr(r),this}}class Et extends ei{constructor(e,t,i){super(new Float32Array(e),t,i)}}let nO=0;const qa=new Jt,Zw=new On,Hf=new K,ha=new ar,mg=new ar,ws=new K;class sn extends Al{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:nO++}),this.uuid=xa(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(xk(e)?oT:aT)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const r=new on().getNormalMatrix(e);i.applyNormalMatrix(r),i.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return qa.makeRotationFromQuaternion(e),this.applyMatrix4(qa),this}rotateX(e){return qa.makeRotationX(e),this.applyMatrix4(qa),this}rotateY(e){return qa.makeRotationY(e),this.applyMatrix4(qa),this}rotateZ(e){return qa.makeRotationZ(e),this.applyMatrix4(qa),this}translate(e,t,i){return qa.makeTranslation(e,t,i),this.applyMatrix4(qa),this}scale(e,t,i){return qa.makeScale(e,t,i),this.applyMatrix4(qa),this}lookAt(e){return Zw.lookAt(e),Zw.updateMatrix(),this.applyMatrix4(Zw.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hf).negate(),this.translate(Hf.x,Hf.y,Hf.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Et(i,3))}else{const i=Math.min(e.length,t.count);for(let s=0;s<i;s++){const r=e[s];t.setXYZ(s,r.x,r.y,r.z||0)}e.length>t.count&&ht("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ar);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Dt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new K(-1/0,-1/0,-1/0),new K(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,s=t.length;i<s;i++){const r=t[i];ha.setFromBufferAttribute(r),this.morphTargetsRelative?(ws.addVectors(this.boundingBox.min,ha.min),this.boundingBox.expandByPoint(ws),ws.addVectors(this.boundingBox.max,ha.max),this.boundingBox.expandByPoint(ws)):(this.boundingBox.expandByPoint(ha.min),this.boundingBox.expandByPoint(ha.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Dt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Bs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Dt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new K,1/0);return}if(e){const i=this.boundingSphere.center;if(ha.setFromBufferAttribute(e),t)for(let r=0,o=t.length;r<o;r++){const c=t[r];mg.setFromBufferAttribute(c),this.morphTargetsRelative?(ws.addVectors(ha.min,mg.min),ha.expandByPoint(ws),ws.addVectors(ha.max,mg.max),ha.expandByPoint(ws)):(ha.expandByPoint(mg.min),ha.expandByPoint(mg.max))}ha.getCenter(i);let s=0;for(let r=0,o=e.count;r<o;r++)ws.fromBufferAttribute(e,r),s=Math.max(s,i.distanceToSquared(ws));if(t)for(let r=0,o=t.length;r<o;r++){const c=t[r],h=this.morphTargetsRelative;for(let p=0,g=c.count;p<g;p++)ws.fromBufferAttribute(c,p),h&&(Hf.fromBufferAttribute(e,p),ws.add(Hf)),s=Math.max(s,i.distanceToSquared(ws))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&Dt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Dt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,s=t.normal,r=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ei(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),c=[],h=[];for(let W=0;W<i.count;W++)c[W]=new K,h[W]=new K;const p=new K,g=new K,v=new K,y=new Be,w=new Be,E=new Be,R=new K,N=new K;function A(W,L,B){p.fromBufferAttribute(i,W),g.fromBufferAttribute(i,L),v.fromBufferAttribute(i,B),y.fromBufferAttribute(r,W),w.fromBufferAttribute(r,L),E.fromBufferAttribute(r,B),g.sub(p),v.sub(p),w.sub(y),E.sub(y);const Y=1/(w.x*E.y-E.x*w.y);isFinite(Y)&&(R.copy(g).multiplyScalar(E.y).addScaledVector(v,-w.y).multiplyScalar(Y),N.copy(v).multiplyScalar(w.x).addScaledVector(g,-E.x).multiplyScalar(Y),c[W].add(R),c[L].add(R),c[B].add(R),h[W].add(N),h[L].add(N),h[B].add(N))}let I=this.groups;I.length===0&&(I=[{start:0,count:e.count}]);for(let W=0,L=I.length;W<L;++W){const B=I[W],Y=B.start,ee=B.count;for(let Q=Y,ce=Y+ee;Q<ce;Q+=3)A(e.getX(Q+0),e.getX(Q+1),e.getX(Q+2))}const D=new K,U=new K,j=new K,F=new K;function z(W){j.fromBufferAttribute(s,W),F.copy(j);const L=c[W];D.copy(L),D.sub(j.multiplyScalar(j.dot(L))).normalize(),U.crossVectors(F,L);const Y=U.dot(h[W])<0?-1:1;o.setXYZW(W,D.x,D.y,D.z,Y)}for(let W=0,L=I.length;W<L;++W){const B=I[W],Y=B.start,ee=B.count;for(let Q=Y,ce=Y+ee;Q<ce;Q+=3)z(e.getX(Q+0)),z(e.getX(Q+1)),z(e.getX(Q+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new ei(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let y=0,w=i.count;y<w;y++)i.setXYZ(y,0,0,0);const s=new K,r=new K,o=new K,c=new K,h=new K,p=new K,g=new K,v=new K;if(e)for(let y=0,w=e.count;y<w;y+=3){const E=e.getX(y+0),R=e.getX(y+1),N=e.getX(y+2);s.fromBufferAttribute(t,E),r.fromBufferAttribute(t,R),o.fromBufferAttribute(t,N),g.subVectors(o,r),v.subVectors(s,r),g.cross(v),c.fromBufferAttribute(i,E),h.fromBufferAttribute(i,R),p.fromBufferAttribute(i,N),c.add(g),h.add(g),p.add(g),i.setXYZ(E,c.x,c.y,c.z),i.setXYZ(R,h.x,h.y,h.z),i.setXYZ(N,p.x,p.y,p.z)}else for(let y=0,w=t.count;y<w;y+=3)s.fromBufferAttribute(t,y+0),r.fromBufferAttribute(t,y+1),o.fromBufferAttribute(t,y+2),g.subVectors(o,r),v.subVectors(s,r),g.cross(v),i.setXYZ(y+0,g.x,g.y,g.z),i.setXYZ(y+1,g.x,g.y,g.z),i.setXYZ(y+2,g.x,g.y,g.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)ws.fromBufferAttribute(e,t),ws.normalize(),e.setXYZ(t,ws.x,ws.y,ws.z)}toNonIndexed(){function e(c,h){const p=c.array,g=c.itemSize,v=c.normalized,y=new p.constructor(h.length*g);let w=0,E=0;for(let R=0,N=h.length;R<N;R++){c.isInterleavedBufferAttribute?w=h[R]*c.data.stride+c.offset:w=h[R]*g;for(let A=0;A<g;A++)y[E++]=p[w++]}return new ei(y,g,v)}if(this.index===null)return ht("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new sn,i=this.index.array,s=this.attributes;for(const c in s){const h=s[c],p=e(h,i);t.setAttribute(c,p)}const r=this.morphAttributes;for(const c in r){const h=[],p=r[c];for(let g=0,v=p.length;g<v;g++){const y=p[g],w=e(y,i);h.push(w)}t.morphAttributes[c]=h}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let c=0,h=o.length;c<h;c++){const p=o[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const p in h)h[p]!==void 0&&(e[p]=h[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const h in i){const p=i[h];e.data.attributes[h]=p.toJSON(e.data)}const s={};let r=!1;for(const h in this.morphAttributes){const p=this.morphAttributes[h],g=[];for(let v=0,y=p.length;v<y;v++){const w=p[v];g.push(w.toJSON(e.data))}g.length>0&&(s[h]=g,r=!0)}r&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const s=e.attributes;for(const p in s){const g=s[p];this.setAttribute(p,g.clone(t))}const r=e.morphAttributes;for(const p in r){const g=[],v=r[p];for(let y=0,w=v.length;y<w;y++)g.push(v[y].clone(t));this.morphAttributes[p]=g}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let p=0,g=o.length;p<g;p++){const v=o[p];this.addGroup(v.start,v.count,v.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const h=e.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const zM=new Jt,Ld=new kp,Rv=new Bs,jM=new K,kv=new K,Iv=new K,Dv=new K,Qw=new K,Pv=new K,FM=new K,Uv=new K;class os extends On{constructor(e=new sn,t=new Hu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}getVertexPosition(e,t){const i=this.geometry,s=i.attributes.position,r=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(s,e);const c=this.morphTargetInfluences;if(r&&c){Pv.set(0,0,0);for(let h=0,p=r.length;h<p;h++){const g=c[h],v=r[h];g!==0&&(Qw.fromBufferAttribute(v,e),o?Pv.addScaledVector(Qw,g):Pv.addScaledVector(Qw.sub(t),g))}t.add(Pv)}return t}raycast(e,t){const i=this.geometry,s=this.material,r=this.matrixWorld;s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Rv.copy(i.boundingSphere),Rv.applyMatrix4(r),Ld.copy(e.ray).recast(e.near),!(Rv.containsPoint(Ld.origin)===!1&&(Ld.intersectSphere(Rv,jM)===null||Ld.origin.distanceToSquared(jM)>(e.far-e.near)**2))&&(zM.copy(r).invert(),Ld.copy(e.ray).applyMatrix4(zM),!(i.boundingBox!==null&&Ld.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Ld)))}_computeIntersections(e,t,i){let s;const r=this.geometry,o=this.material,c=r.index,h=r.attributes.position,p=r.attributes.uv,g=r.attributes.uv1,v=r.attributes.normal,y=r.groups,w=r.drawRange;if(c!==null)if(Array.isArray(o))for(let E=0,R=y.length;E<R;E++){const N=y[E],A=o[N.materialIndex],I=Math.max(N.start,w.start),D=Math.min(c.count,Math.min(N.start+N.count,w.start+w.count));for(let U=I,j=D;U<j;U+=3){const F=c.getX(U),z=c.getX(U+1),W=c.getX(U+2);s=Lv(this,A,e,i,p,g,v,F,z,W),s&&(s.faceIndex=Math.floor(U/3),s.face.materialIndex=N.materialIndex,t.push(s))}}else{const E=Math.max(0,w.start),R=Math.min(c.count,w.start+w.count);for(let N=E,A=R;N<A;N+=3){const I=c.getX(N),D=c.getX(N+1),U=c.getX(N+2);s=Lv(this,o,e,i,p,g,v,I,D,U),s&&(s.faceIndex=Math.floor(N/3),t.push(s))}}else if(h!==void 0)if(Array.isArray(o))for(let E=0,R=y.length;E<R;E++){const N=y[E],A=o[N.materialIndex],I=Math.max(N.start,w.start),D=Math.min(h.count,Math.min(N.start+N.count,w.start+w.count));for(let U=I,j=D;U<j;U+=3){const F=U,z=U+1,W=U+2;s=Lv(this,A,e,i,p,g,v,F,z,W),s&&(s.faceIndex=Math.floor(U/3),s.face.materialIndex=N.materialIndex,t.push(s))}}else{const E=Math.max(0,w.start),R=Math.min(h.count,w.start+w.count);for(let N=E,A=R;N<A;N+=3){const I=N,D=N+1,U=N+2;s=Lv(this,o,e,i,p,g,v,I,D,U),s&&(s.faceIndex=Math.floor(N/3),t.push(s))}}}}function iO(n,e,t,i,s,r,o,c){let h;if(e.side===Ar?h=i.intersectTriangle(o,r,s,!0,c):h=i.intersectTriangle(s,r,o,e.side===_c,c),h===null)return null;Uv.copy(c),Uv.applyMatrix4(n.matrixWorld);const p=t.ray.origin.distanceTo(Uv);return p<t.near||p>t.far?null:{distance:p,point:Uv.clone(),object:n}}function Lv(n,e,t,i,s,r,o,c,h,p){n.getVertexPosition(c,kv),n.getVertexPosition(h,Iv),n.getVertexPosition(p,Dv);const g=iO(n,e,t,i,kv,Iv,Dv,FM);if(g){const v=new K;Zr.getBarycoord(FM,kv,Iv,Dv,v),s&&(g.uv=Zr.getInterpolatedAttribute(s,c,h,p,v,new Be)),r&&(g.uv1=Zr.getInterpolatedAttribute(r,c,h,p,v,new Be)),o&&(g.normal=Zr.getInterpolatedAttribute(o,c,h,p,v,new K),g.normal.dot(i.direction)>0&&g.normal.multiplyScalar(-1));const y={a:c,b:h,c:p,normal:new K,materialIndex:0};Zr.getNormal(kv,Iv,Dv,y.normal),g.face=y,g.barycoord=v}return g}class gh extends sn{constructor(e=1,t=1,i=1,s=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:s,heightSegments:r,depthSegments:o};const c=this;s=Math.floor(s),r=Math.floor(r),o=Math.floor(o);const h=[],p=[],g=[],v=[];let y=0,w=0;E("z","y","x",-1,-1,i,t,e,o,r,0),E("z","y","x",1,-1,i,t,-e,o,r,1),E("x","z","y",1,1,e,i,t,s,o,2),E("x","z","y",1,-1,e,i,-t,s,o,3),E("x","y","z",1,-1,e,t,i,s,r,4),E("x","y","z",-1,-1,e,t,-i,s,r,5),this.setIndex(h),this.setAttribute("position",new Et(p,3)),this.setAttribute("normal",new Et(g,3)),this.setAttribute("uv",new Et(v,2));function E(R,N,A,I,D,U,j,F,z,W,L){const B=U/z,Y=j/W,ee=U/2,Q=j/2,ce=F/2,oe=z+1,J=W+1;let te=0,me=0;const Re=new K;for(let Ie=0;Ie<J;Ie++){const $=Ie*Y-Q;for(let de=0;de<oe;de++){const Ne=de*B-ee;Re[R]=Ne*I,Re[N]=$*D,Re[A]=ce,p.push(Re.x,Re.y,Re.z),Re[R]=0,Re[N]=0,Re[A]=F>0?1:-1,g.push(Re.x,Re.y,Re.z),v.push(de/z),v.push(1-Ie/W),te+=1}}for(let Ie=0;Ie<W;Ie++)for(let $=0;$<z;$++){const de=y+$+oe*Ie,Ne=y+$+oe*(Ie+1),Fe=y+($+1)+oe*(Ie+1),lt=y+($+1)+oe*Ie;h.push(de,Ne,lt),h.push(Ne,Fe,lt),me+=6}c.addGroup(w,me,L),w+=me,y+=te}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Mp(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const s=n[t][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(ht("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=s.clone():Array.isArray(s)?e[t][i]=s.slice():e[t][i]=s}}return e}function Sr(n){const e={};for(let t=0;t<n.length;t++){const i=Mp(n[t]);for(const s in i)e[s]=i[s]}return e}function sO(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function wk(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:kn.workingColorSpace}const Sk={clone:Mp,merge:Sr};var rO=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,aO=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class na extends or{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=rO,this.fragmentShader=aO,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Mp(e.uniforms),this.uniformsGroups=sO(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const s in this.uniforms){const o=this.uniforms[s].value;o&&o.isTexture?t.uniforms[s]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[s]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[s]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[s]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[s]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[s]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[s]={type:"m4",value:o.toArray()}:t.uniforms[s]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const s in this.extensions)this.extensions[s]===!0&&(i[s]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class a_ extends On{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Jt,this.projectionMatrix=new Jt,this.projectionMatrixInverse=new Jt,this.coordinateSystem=ga,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const wu=new K,BM=new Be,VM=new Be;class Ss extends a_{constructor(e=50,t=1,i=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=s,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Tp*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(oh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Tp*2*Math.atan(Math.tan(oh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){wu.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(wu.x,wu.y).multiplyScalar(-e/wu.z),wu.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(wu.x,wu.y).multiplyScalar(-e/wu.z)}getViewSize(e,t){return this.getViewBounds(e,BM,VM),t.subVectors(VM,BM)}setViewOffset(e,t,i,s,r,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(oh*.5*this.fov)/this.zoom,i=2*t,s=this.aspect*i,r=-.5*s;const o=this.view;if(this.view!==null&&this.view.enabled){const h=o.fullWidth,p=o.fullHeight;r+=o.offsetX*s/h,t-=o.offsetY*i/p,s*=o.width/h,i*=o.height/p}const c=this.filmOffset;c!==0&&(r+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,t,t-i,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Gf=-90,qf=1;class Tk extends On{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Ss(Gf,qf,e,t);s.layers=this.layers,this.add(s);const r=new Ss(Gf,qf,e,t);r.layers=this.layers,this.add(r);const o=new Ss(Gf,qf,e,t);o.layers=this.layers,this.add(o);const c=new Ss(Gf,qf,e,t);c.layers=this.layers,this.add(c);const h=new Ss(Gf,qf,e,t);h.layers=this.layers,this.add(h);const p=new Ss(Gf,qf,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,s,r,o,c,h]=t;for(const p of t)this.remove(p);if(e===ga)i.up.set(0,1,0),i.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),h.up.set(0,1,0),h.lookAt(0,0,-1);else if(e===wp)i.up.set(0,-1,0),i.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),h.up.set(0,-1,0),h.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,c,h,p,g]=this.children,v=e.getRenderTarget(),y=e.getActiveCubeFace(),w=e.getActiveMipmapLevel(),E=e.xr.enabled;e.xr.enabled=!1;const R=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,s),e.render(t,r),e.setRenderTarget(i,1,s),e.render(t,o),e.setRenderTarget(i,2,s),e.render(t,c),e.setRenderTarget(i,3,s),e.render(t,h),e.setRenderTarget(i,4,s),e.render(t,p),i.texture.generateMipmaps=R,e.setRenderTarget(i,5,s),e.render(t,g),e.setRenderTarget(v,y,w),e.xr.enabled=E,i.texture.needsPMREMUpdate=!0}}class M0 extends Bi{constructor(e=[],t=Tl,i,s,r,o,c,h,p,g){super(e,t,i,s,r,o,c,h,p,g),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class lT extends ta{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},s=[i,i,i,i,i,i];this.texture=new M0(s),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new gh(5,5,5),r=new na({name:"CubemapFromEquirect",uniforms:Mp(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Ar,blending:wl});r.uniforms.tEquirect.value=t;const o=new os(s,r),c=t.minFilter;return t.minFilter===bl&&(t.minFilter=si),new Tk(1,10,this).update(e,o),t.minFilter=c,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,i=!0,s=!0){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,s);e.setRenderTarget(r)}}class dp extends On{constructor(){super(),this.isGroup=!0,this.type="Group"}}const oO={type:"move"};class by{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new dp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new dp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new K,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new K),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new dp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new K,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new K),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let s=null,r=null,o=null;const c=this._targetRay,h=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){o=!0;for(const R of e.hand.values()){const N=t.getJointPose(R,i),A=this._getHandJoint(p,R);N!==null&&(A.matrix.fromArray(N.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=N.radius),A.visible=N!==null}const g=p.joints["index-finger-tip"],v=p.joints["thumb-tip"],y=g.position.distanceTo(v.position),w=.02,E=.005;p.inputState.pinching&&y>w+E?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&y<=w-E&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else h!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,i),r!==null&&(h.matrix.fromArray(r.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),h.matrixWorldNeedsUpdate=!0,r.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(r.linearVelocity)):h.hasLinearVelocity=!1,r.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(r.angularVelocity)):h.hasAngularVelocity=!1));c!==null&&(s=t.getPose(e.targetRaySpace,i),s===null&&r!==null&&(s=r),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(oO)))}return c!==null&&(c.visible=s!==null),h!==null&&(h.visible=r!==null),p!==null&&(p.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new dp;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class o_{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new _t(e),this.density=t}clone(){return new o_(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class l_{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new _t(e),this.near=t,this.far=i}clone(){return new l_(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class c_ extends On{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ya,this.environmentIntensity=1,this.environmentRotation=new ya,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class u_{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=l0,this.updateRanges=[],this.version=0,this.uuid=xa()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let s=0,r=this.stride;s<r;s++)this.array[e+s]=t.array[i+s];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xa()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xa()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const wr=new K;class hh{constructor(e,t,i,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)wr.fromBufferAttribute(this,t),wr.applyMatrix4(e),this.setXYZ(t,wr.x,wr.y,wr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)wr.fromBufferAttribute(this,t),wr.applyNormalMatrix(e),this.setXYZ(t,wr.x,wr.y,wr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)wr.fromBufferAttribute(this,t),wr.transformDirection(e),this.setXYZ(t,wr.x,wr.y,wr.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Mr(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=hn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=hn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Mr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Mr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Mr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Mr(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),s=hn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this}setXYZW(e,t,i,s,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=hn(t,this.array),i=hn(i,this.array),s=hn(s,this.array),r=hn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=s,this.data.array[e+3]=r,this}clone(e){if(e===void 0){u0("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return new ei(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new hh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){u0("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const s=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class cT extends or{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new _t(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Wf;const gg=new K,$f=new K,Xf=new K,Yf=new Be,xg=new Be,Ek=new Jt,Ov=new K,vg=new K,zv=new K,HM=new Be,eS=new Be,GM=new Be;class Mk extends On{constructor(e=new cT){if(super(),this.isSprite=!0,this.type="Sprite",Wf===void 0){Wf=new sn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new u_(t,5);Wf.setIndex([0,1,2,0,2,3]),Wf.setAttribute("position",new hh(i,3,0,!1)),Wf.setAttribute("uv",new hh(i,2,3,!1))}this.geometry=Wf,this.material=e,this.center=new Be(.5,.5),this.count=1}raycast(e,t){e.camera===null&&Dt('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),$f.setFromMatrixScale(this.matrixWorld),Ek.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Xf.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&$f.multiplyScalar(-Xf.z);const i=this.material.rotation;let s,r;i!==0&&(r=Math.cos(i),s=Math.sin(i));const o=this.center;jv(Ov.set(-.5,-.5,0),Xf,o,$f,s,r),jv(vg.set(.5,-.5,0),Xf,o,$f,s,r),jv(zv.set(.5,.5,0),Xf,o,$f,s,r),HM.set(0,0),eS.set(1,0),GM.set(1,1);let c=e.ray.intersectTriangle(Ov,vg,zv,!1,gg);if(c===null&&(jv(vg.set(-.5,.5,0),Xf,o,$f,s,r),eS.set(0,1),c=e.ray.intersectTriangle(Ov,zv,vg,!1,gg),c===null))return;const h=e.ray.origin.distanceTo(gg);h<e.near||h>e.far||t.push({distance:h,point:gg.clone(),uv:Zr.getInterpolation(gg,Ov,vg,zv,HM,eS,GM,new Be),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function jv(n,e,t,i,s,r){Yf.subVectors(n,t).addScalar(.5).multiply(i),s!==void 0?(xg.x=r*Yf.x-s*Yf.y,xg.y=s*Yf.x+r*Yf.y):xg.copy(Yf),n.copy(e),n.x+=xg.x,n.y+=xg.y,n.applyMatrix4(Ek)}const Fv=new K,qM=new K;class Ak extends On{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,s=t.length;i<s;i++){const r=t[i];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const s=this.levels;let r;for(r=0;r<s.length&&!(t<s[r].distance);r++);return s.splice(r,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let i=0;i<t.length;i++)if(t[i].distance===e){const s=t.splice(i,1);return this.remove(s[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,s;for(i=1,s=t.length;i<s;i++){let r=t[i].distance;if(t[i].object.visible&&(r-=r*t[i].hysteresis),e<r)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Fv.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(Fv);this.getObjectForDistance(s).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Fv.setFromMatrixPosition(e.matrixWorld),qM.setFromMatrixPosition(this.matrixWorld);const i=Fv.distanceTo(qM)/e.zoom;t[0].object.visible=!0;let s,r;for(s=1,r=t.length;s<r;s++){let o=t[s].distance;if(t[s].object.visible&&(o-=o*t[s].hysteresis),i>=o)t[s-1].object.visible=!1,t[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<r;s++)t[s].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let s=0,r=i.length;s<r;s++){const o=i[s];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const WM=new K,$M=new ii,XM=new ii,lO=new K,YM=new Jt,Bv=new K,tS=new Bs,JM=new Jt,nS=new kp;class Nk extends os{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=t1,this.bindMatrix=new Jt,this.bindMatrixInverse=new Jt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new ar),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Bv),this.boundingBox.expandByPoint(Bv)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Bs),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Bv),this.boundingSphere.expandByPoint(Bv)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,s=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),tS.copy(this.boundingSphere),tS.applyMatrix4(s),e.ray.intersectsSphere(tS)!==!1&&(JM.copy(s).invert(),nS.copy(e.ray).applyMatrix4(JM),!(this.boundingBox!==null&&nS.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,nS)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ii,t=this.geometry.attributes.skinWeight;for(let i=0,s=t.count;i<s;i++){e.fromBufferAttribute(t,i);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===t1?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===rk?this.bindMatrixInverse.copy(this.bindMatrix).invert():ht("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,s=this.geometry;$M.fromBufferAttribute(s.attributes.skinIndex,e),XM.fromBufferAttribute(s.attributes.skinWeight,e),WM.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){const o=XM.getComponent(r);if(o!==0){const c=$M.getComponent(r);YM.multiplyMatrices(i.bones[c].matrixWorld,i.boneInverses[c]),t.addScaledVector(lO.copy(WM).applyMatrix4(YM),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class uT extends On{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ya extends Bi{constructor(e=null,t=1,i=1,s,r,o,c,h,p=Ii,g=Ii,v,y){super(null,o,c,h,p,g,s,r,v,y),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const KM=new Jt,cO=new Jt;class d_{constructor(e=[],t=[]){this.uuid=xa(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){ht("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,s=this.bones.length;i<s;i++)this.boneInverses.push(new Jt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Jt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,s=this.boneTexture;for(let r=0,o=e.length;r<o;r++){const c=e[r]?e[r].matrixWorld:cO;KM.multiplyMatrices(c,t[r]),KM.toArray(i,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new d_(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Ya(t,e,e,Es,Ts);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const s=this.bones[t];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,s=e.bones.length;i<s;i++){const r=e.bones[i];let o=t[r];o===void 0&&(ht("Skeleton: No bone found with UUID:",r),o=new uT),this.bones.push(o),this.boneInverses.push(new Jt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let s=0,r=t.length;s<r;s++){const o=t[s];e.bones.push(o.uuid);const c=i[s];e.boneInverses.push(c.toArray())}return e}}class Ap extends ei{constructor(e,t,i,s=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Jf=new Jt,ZM=new Jt,Vv=[],QM=new ar,uO=new Jt,yg=new os,bg=new Bs;class Ck extends os{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ap(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<i;s++)this.setMatrixAt(s,uO)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new ar),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Jf),QM.copy(e.boundingBox).applyMatrix4(Jf),this.boundingBox.union(QM)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Bs),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,Jf),bg.copy(e.boundingSphere).applyMatrix4(Jf),this.boundingSphere.union(bg)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const i=t.morphTargetInfluences,s=this.morphTexture.source.data.data,r=i.length+1,o=e*r+1;for(let c=0;c<i.length;c++)i[c]=s[o+c]}raycast(e,t){const i=this.matrixWorld,s=this.count;if(yg.geometry=this.geometry,yg.material=this.material,yg.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),bg.copy(this.boundingSphere),bg.applyMatrix4(i),e.ray.intersectsSphere(bg)!==!1))for(let r=0;r<s;r++){this.getMatrixAt(r,Jf),ZM.multiplyMatrices(i,Jf),yg.matrixWorld=ZM,yg.raycast(e,Vv);for(let o=0,c=Vv.length;o<c;o++){const h=Vv[o];h.instanceId=r,h.object=this,t.push(h)}Vv.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Ap(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const i=t.morphTargetInfluences,s=i.length+1;this.morphTexture===null&&(this.morphTexture=new Ya(new Float32Array(s*this.count),s,this.count,Zb,Ts));const r=this.morphTexture.source.data.data;let o=0;for(let p=0;p<i.length;p++)o+=i[p];const c=this.geometry.morphTargetsRelative?1:1-o,h=s*e;r[h]=c,r.set(i,h+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const iS=new K,dO=new K,hO=new on;class Nu{constructor(e=new K(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,s){return this.normal.set(e,t,i),this.constant=s,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const s=iS.subVectors(i,t).cross(dO.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(iS),s=this.normal.dot(i);if(s===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:t.copy(e.start).addScaledVector(i,r)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||hO.getNormalMatrix(e),s=this.coplanarPoint(iS).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-s.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Od=new Bs,fO=new Be(.5,.5),Hv=new K;class Ip{constructor(e=new Nu,t=new Nu,i=new Nu,s=new Nu,r=new Nu,o=new Nu){this.planes=[e,t,i,s,r,o]}set(e,t,i,s,r,o){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(i),c[3].copy(s),c[4].copy(r),c[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ga,i=!1){const s=this.planes,r=e.elements,o=r[0],c=r[1],h=r[2],p=r[3],g=r[4],v=r[5],y=r[6],w=r[7],E=r[8],R=r[9],N=r[10],A=r[11],I=r[12],D=r[13],U=r[14],j=r[15];if(s[0].setComponents(p-o,w-g,A-E,j-I).normalize(),s[1].setComponents(p+o,w+g,A+E,j+I).normalize(),s[2].setComponents(p+c,w+v,A+R,j+D).normalize(),s[3].setComponents(p-c,w-v,A-R,j-D).normalize(),i)s[4].setComponents(h,y,N,U).normalize(),s[5].setComponents(p-h,w-y,A-N,j-U).normalize();else if(s[4].setComponents(p-h,w-y,A-N,j-U).normalize(),t===ga)s[5].setComponents(p+h,w+y,A+N,j+U).normalize();else if(t===wp)s[5].setComponents(h,y,N,U).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Od.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Od.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Od)}intersectsSprite(e){Od.center.set(0,0,0);const t=fO.distanceTo(e.center);return Od.radius=.7071067811865476+t,Od.applyMatrix4(e.matrixWorld),this.intersectsSphere(Od)}intersectsSphere(e){const t=this.planes,i=e.center,s=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(i)<s)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const s=t[i];if(Hv.x=s.normal.x>0?e.max.x:e.min.x,Hv.y=s.normal.y>0?e.max.y:e.min.y,Hv.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Hv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const gl=new Jt,xl=new Ip;class h_{constructor(){this.coordinateSystem=ga}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const s=t.cameras[i];if(gl.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),xl.setFromProjectionMatrix(gl,s.coordinateSystem,s.reversedDepth),xl.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const s=t.cameras[i];if(gl.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),xl.setFromProjectionMatrix(gl,s.coordinateSystem,s.reversedDepth),xl.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const s=t.cameras[i];if(gl.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),xl.setFromProjectionMatrix(gl,s.coordinateSystem,s.reversedDepth),xl.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const s=t.cameras[i];if(gl.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),xl.setFromProjectionMatrix(gl,s.coordinateSystem,s.reversedDepth),xl.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let i=0;i<t.cameras.length;i++){const s=t.cameras[i];if(gl.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),xl.setFromProjectionMatrix(gl,s.coordinateSystem,s.reversedDepth),xl.containsPoint(e))return!0}return!1}clone(){return new h_}}function sS(n,e){return n-e}function pO(n,e){return n.z-e.z}function mO(n,e){return e.z-n.z}class gO{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,i,s){const r=this.pool,o=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const c=r[this.index];o.push(c),this.index++,c.start=e,c.count=t,c.z=i,c.index=s}reset(){this.list.length=0,this.index=0}}const Yr=new Jt,xO=new _t(1,1,1),eA=new Ip,vO=new h_,Gv=new ar,zd=new Bs,_g=new K,tA=new K,yO=new K,rS=new gO,ir=new os,qv=[];function bO(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const s=n.count;for(let r=0;r<s;r++)for(let o=0;o<i;o++)e.setComponent(r+t,o,n.getComponent(r,o))}else e.array.set(n.array,t*i);e.needsUpdate=!0}function jd(n,e){if(n.constructor!==e.constructor){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++)e[i]=n[i]}else{const t=Math.min(n.length,e.length);e.set(new n.constructor(n.buffer,0,t))}}class Rk extends os{constructor(e,t,i=t*2,s){super(new sn,s),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new Ya(t,e,e,Es,Ts);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),i=new Ya(t,e,e,E0,Za);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),i=new Ya(t,e,e,Es,Ts);i.colorSpace=kn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const r in e.attributes){const o=e.getAttribute(r),{array:c,itemSize:h,normalized:p}=o,g=new c.constructor(i*h),v=new ei(g,h,p);t.setAttribute(r,v)}if(e.getIndex()!==null){const r=i>65535?new Uint32Array(s):new Uint16Array(s);t.setIndex(new ei(r,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const s=e.getAttribute(i),r=t.getAttribute(i);if(s.itemSize!==r.itemSize||s.normalized!==r.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ar);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let i=0,s=t.length;i<s;i++){if(t[i].active===!1)continue;const r=t[i].geometryIndex;this.getMatrixAt(i,Yr),this.getBoundingBoxAt(r,Gv).applyMatrix4(Yr),e.union(Gv)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Bs);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let i=0,s=t.length;i<s;i++){if(t[i].active===!1)continue;const r=t[i].geometryIndex;this.getMatrixAt(i,Yr),this.getBoundingSphereAt(r,zd).applyMatrix4(Yr),e.union(zd)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let s=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(sS),s=this._availableInstanceIds.shift(),this._instanceInfo[s]=i):(s=this._instanceInfo.length,this._instanceInfo.push(i));const r=this._matricesTexture;Yr.identity().toArray(r.image.data,s*16),r.needsUpdate=!0;const o=this._colorsTexture;return o&&(xO.toArray(o.image.data,s*4),o.needsUpdate=!0),this._visibilityChanged=!0,s}addGeometry(e,t=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const s={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},r=this._geometryInfo;s.vertexStart=this._nextVertexStart,s.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(s.indexStart=this._nextIndexStart,s.reservedIndexCount=i===-1?o.count:i),s.indexStart!==-1&&s.indexStart+s.reservedIndexCount>this._maxIndexCount||s.vertexStart+s.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let h;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(sS),h=this._availableGeometryIds.shift(),r[h]=s):(h=this._geometryCount,this._geometryCount++,r.push(s)),this.setGeometryAt(h,e),this._nextIndexStart=s.indexStart+s.reservedIndexCount,this._nextVertexStart=s.vertexStart+s.reservedVertexCount,h}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,s=i.getIndex()!==null,r=i.getIndex(),o=t.getIndex(),c=this._geometryInfo[e];if(s&&o.count>c.reservedIndexCount||t.attributes.position.count>c.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const h=c.vertexStart,p=c.reservedVertexCount;c.vertexCount=t.getAttribute("position").count;for(const g in i.attributes){const v=t.getAttribute(g),y=i.getAttribute(g);bO(v,y,h);const w=v.itemSize;for(let E=v.count,R=p;E<R;E++){const N=h+E;for(let A=0;A<w;A++)y.setComponent(N,A,0)}y.needsUpdate=!0,y.addUpdateRange(h*w,p*w)}if(s){const g=c.indexStart,v=c.reservedIndexCount;c.indexCount=t.getIndex().count;for(let y=0;y<o.count;y++)r.setX(g+y,h+o.getX(y));for(let y=o.count,w=v;y<w;y++)r.setX(g+y,h);r.needsUpdate=!0,r.addUpdateRange(g,c.reservedIndexCount)}return c.start=s?c.indexStart:c.vertexStart,c.count=s?c.indexCount:c.vertexCount,c.boundingBox=null,t.boundingBox!==null&&(c.boundingBox=t.boundingBox.clone()),c.boundingSphere=null,t.boundingSphere!==null&&(c.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const i=this._instanceInfo;for(let s=0,r=i.length;s<r;s++)i[s].active&&i[s].geometryIndex===e&&this.deleteInstance(s);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const i=this._geometryInfo,s=i.map((o,c)=>c).sort((o,c)=>i[o].vertexStart-i[c].vertexStart),r=this.geometry;for(let o=0,c=i.length;o<c;o++){const h=s[o],p=i[h];if(p.active!==!1){if(r.index!==null){if(p.indexStart!==t){const{indexStart:g,vertexStart:v,reservedIndexCount:y}=p,w=r.index,E=w.array,R=e-v;for(let N=g;N<g+y;N++)E[N]=E[N]+R;w.array.copyWithin(t,g,g+y),w.addUpdateRange(t,y),w.needsUpdate=!0,p.indexStart=t}t+=p.reservedIndexCount}if(p.vertexStart!==e){const{vertexStart:g,reservedVertexCount:v}=p,y=r.attributes;for(const w in y){const E=y[w],{array:R,itemSize:N}=E;R.copyWithin(e*N,g*N,(g+v)*N),E.addUpdateRange(e*N,v*N),E.needsUpdate=!0}p.vertexStart=e}e+=p.reservedVertexCount,p.start=r.index?p.indexStart:p.vertexStart,this._nextIndexStart=r.index?p.indexStart+p.reservedIndexCount:0,this._nextVertexStart=p.vertexStart+p.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const i=this.geometry,s=this._geometryInfo[e];if(s.boundingBox===null){const r=new ar,o=i.index,c=i.attributes.position;for(let h=s.start,p=s.start+s.count;h<p;h++){let g=h;o&&(g=o.getX(g)),r.expandByPoint(_g.fromBufferAttribute(c,g))}s.boundingBox=r}return t.copy(s.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const i=this.geometry,s=this._geometryInfo[e];if(s.boundingSphere===null){const r=new Bs;this.getBoundingBoxAt(e,Gv),Gv.getCenter(r.center);const o=i.index,c=i.attributes.position;let h=0;for(let p=s.start,g=s.start+s.count;p<g;p++){let v=p;o&&(v=o.getX(v)),_g.fromBufferAttribute(c,v),h=Math.max(h,r.center.distanceToSquared(_g))}r.radius=Math.sqrt(h),s.boundingSphere=r}return t.copy(s.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const i=this._matricesTexture,s=this._matricesTexture.image.data;return t.toArray(s,e*16),i.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return t.vertexStart=i.vertexStart,t.vertexCount=i.vertexCount,t.reservedVertexCount=i.reservedVertexCount,t.indexStart=i.indexStart,t.indexCount=i.indexCount,t.reservedIndexCount=i.reservedIndexCount,t.start=i.start,t.count=i.count,t}setInstanceCount(e){const t=this._availableInstanceIds,i=this._instanceInfo;for(t.sort(sS);t[t.length-1]===i.length-1;)i.pop(),t.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const s=new Int32Array(e),r=new Int32Array(e);jd(this._multiDrawCounts,s),jd(this._multiDrawStarts,r),this._multiDrawCounts=s,this._multiDrawStarts=r,this._maxInstanceCount=e;const o=this._indirectTexture,c=this._matricesTexture,h=this._colorsTexture;o.dispose(),this._initIndirectTexture(),jd(o.image.data,this._indirectTexture.image.data),c.dispose(),this._initMatricesTexture(),jd(c.image.data,this._matricesTexture.image.data),h&&(h.dispose(),this._initColorsTexture(),jd(h.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const i=[...this._geometryInfo].filter(c=>c.active);if(Math.max(...i.map(c=>c.vertexStart+c.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(h=>h.indexStart+h.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new sn,this._initializeGeometry(r));const o=this.geometry;r.index&&jd(r.index.array,o.index.array);for(const c in r.attributes)jd(r.attributes[c].array,o.attributes[c].array)}raycast(e,t){const i=this._instanceInfo,s=this._geometryInfo,r=this.matrixWorld,o=this.geometry;ir.material=this.material,ir.geometry.index=o.index,ir.geometry.attributes=o.attributes,ir.geometry.boundingBox===null&&(ir.geometry.boundingBox=new ar),ir.geometry.boundingSphere===null&&(ir.geometry.boundingSphere=new Bs);for(let c=0,h=i.length;c<h;c++){if(!i[c].visible||!i[c].active)continue;const p=i[c].geometryIndex,g=s[p];ir.geometry.setDrawRange(g.start,g.count),this.getMatrixAt(c,ir.matrixWorld).premultiply(r),this.getBoundingBoxAt(p,ir.geometry.boundingBox),this.getBoundingSphereAt(p,ir.geometry.boundingSphere),ir.raycast(e,qv);for(let v=0,y=qv.length;v<y;v++){const w=qv[v];w.object=this,w.batchId=c,t.push(w)}qv.length=0}ir.material=null,ir.geometry.index=null,ir.geometry.attributes={},ir.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,i,s,r){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=s.getIndex(),c=o===null?1:o.array.BYTES_PER_ELEMENT,h=this._instanceInfo,p=this._multiDrawStarts,g=this._multiDrawCounts,v=this._geometryInfo,y=this.perObjectFrustumCulled,w=this._indirectTexture,E=w.image.data,R=i.isArrayCamera?vO:eA;y&&!i.isArrayCamera&&(Yr.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),eA.setFromProjectionMatrix(Yr,i.coordinateSystem,i.reversedDepth));let N=0;if(this.sortObjects){Yr.copy(this.matrixWorld).invert(),_g.setFromMatrixPosition(i.matrixWorld).applyMatrix4(Yr),tA.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(Yr);for(let D=0,U=h.length;D<U;D++)if(h[D].visible&&h[D].active){const j=h[D].geometryIndex;this.getMatrixAt(D,Yr),this.getBoundingSphereAt(j,zd).applyMatrix4(Yr);let F=!1;if(y&&(F=!R.intersectsSphere(zd,i)),!F){const z=v[j],W=yO.subVectors(zd.center,_g).dot(tA);rS.push(z.start,z.count,W,D)}}const A=rS.list,I=this.customSort;I===null?A.sort(r.transparent?mO:pO):I.call(this,A,i);for(let D=0,U=A.length;D<U;D++){const j=A[D];p[N]=j.start*c,g[N]=j.count,E[N]=j.index,N++}rS.reset()}else for(let A=0,I=h.length;A<I;A++)if(h[A].visible&&h[A].active){const D=h[A].geometryIndex;let U=!1;if(y&&(this.getMatrixAt(A,Yr),this.getBoundingSphereAt(D,zd).applyMatrix4(Yr),U=!R.intersectsSphere(zd,i)),!U){const j=v[D];p[N]=j.start*c,g[N]=j.count,E[N]=A,N++}}w.needsUpdate=!0,this._multiDrawCount=N,this._visibilityChanged=!1}onBeforeShadow(e,t,i,s,r,o){this.onBeforeRender(e,null,s,r,o)}}class Cr extends or{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new _t(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const bb=new K,_b=new K,nA=new Jt,wg=new kp,Wv=new Bs,aS=new K,iA=new K;class ju extends On{constructor(e=new sn,t=new Cr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let s=1,r=t.count;s<r;s++)bb.fromBufferAttribute(t,s-1),_b.fromBufferAttribute(t,s),i[s]=i[s-1],i[s]+=bb.distanceTo(_b);e.setAttribute("lineDistance",new Et(i,1))}else ht("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,s=this.matrixWorld,r=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Wv.copy(i.boundingSphere),Wv.applyMatrix4(s),Wv.radius+=r,e.ray.intersectsSphere(Wv)===!1)return;nA.copy(s).invert(),wg.copy(e.ray).applyMatrix4(nA);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,p=this.isLineSegments?2:1,g=i.index,y=i.attributes.position;if(g!==null){const w=Math.max(0,o.start),E=Math.min(g.count,o.start+o.count);for(let R=w,N=E-1;R<N;R+=p){const A=g.getX(R),I=g.getX(R+1),D=$v(this,e,wg,h,A,I,R);D&&t.push(D)}if(this.isLineLoop){const R=g.getX(E-1),N=g.getX(w),A=$v(this,e,wg,h,R,N,E-1);A&&t.push(A)}}else{const w=Math.max(0,o.start),E=Math.min(y.count,o.start+o.count);for(let R=w,N=E-1;R<N;R+=p){const A=$v(this,e,wg,h,R,R+1,R);A&&t.push(A)}if(this.isLineLoop){const R=$v(this,e,wg,h,E-1,w,E-1);R&&t.push(R)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function $v(n,e,t,i,s,r,o){const c=n.geometry.attributes.position;if(bb.fromBufferAttribute(c,s),_b.fromBufferAttribute(c,r),t.distanceSqToSegment(bb,_b,aS,iA)>i)return;aS.applyMatrix4(n.matrixWorld);const p=e.ray.origin.distanceTo(aS);if(!(p<e.near||p>e.far))return{distance:p,point:iA.clone().applyMatrix4(n.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:n}}const sA=new K,rA=new K;class Nl extends ju{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let s=0,r=t.count;s<r;s+=2)sA.fromBufferAttribute(t,s),rA.fromBufferAttribute(t,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+sA.distanceTo(rA);e.setAttribute("lineDistance",new Et(i,1))}else ht("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kk extends ju{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class dT extends or{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new _t(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const aA=new Jt,s1=new kp,Xv=new Bs,Yv=new K;class Ik extends On{constructor(e=new sn,t=new dT){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,s=this.matrixWorld,r=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Xv.copy(i.boundingSphere),Xv.applyMatrix4(s),Xv.radius+=r,e.ray.intersectsSphere(Xv)===!1)return;aA.copy(s).invert(),s1.copy(e.ray).applyMatrix4(aA);const c=r/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,p=i.index,v=i.attributes.position;if(p!==null){const y=Math.max(0,o.start),w=Math.min(p.count,o.start+o.count);for(let E=y,R=w;E<R;E++){const N=p.getX(E);Yv.fromBufferAttribute(v,N),oA(Yv,N,h,s,e,t,this)}}else{const y=Math.max(0,o.start),w=Math.min(v.count,o.start+o.count);for(let E=y,R=w;E<R;E++)Yv.fromBufferAttribute(v,E),oA(Yv,E,h,s,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const s=t[i[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=s.length;r<o;r++){const c=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=r}}}}}function oA(n,e,t,i,s,r,o){const c=s1.distanceSqToPoint(n);if(c<t){const h=new K;s1.closestPointToPoint(n,h),h.applyMatrix4(i);const p=s.ray.origin.distanceTo(h);if(p<s.near||p>s.far)return;r.push({distance:p,distanceToRay:Math.sqrt(c),point:h,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class Dk extends Bi{constructor(e,t,i,s,r=si,o=si,c,h,p){super(e,t,i,s,r,o,c,h,p),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const g=this;function v(){g.needsUpdate=!0,g._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class _O extends Dk{constructor(e,t,i,s,r,o,c,h){super({},e,t,i,s,r,o,c,h),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class wO extends Bi{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ii,this.minFilter=Ii,this.generateMipmaps=!1,this.needsUpdate=!0}}class f_ extends Bi{constructor(e,t,i,s,r,o,c,h,p,g,v,y){super(null,o,c,h,p,g,s,r,v,y),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class SO extends f_{constructor(e,t,i,s,r,o){super(e,t,i,r,o),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Qr,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class TO extends f_{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,Tl),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class EO extends Bi{constructor(e,t,i,s,r,o,c,h,p){super(e,t,i,s,r,o,c,h,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class fh extends Bi{constructor(e,t,i=Za,s,r,o,c=Ii,h=Ii,p,g=El,v=1){if(g!==El&&g!==Iu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const y={width:e,height:t,depth:v};super(y,s,r,o,c,h,g,i,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Du(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class Pk extends fh{constructor(e,t=Za,i=Tl,s,r,o=Ii,c=Ii,h,p=El){const g={width:e,height:e,depth:1},v=[g,g,g,g,g,g];super(e,e,t,i,s,r,o,c,h,p),this.image=v,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class hT extends Bi{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class p_ extends sn{constructor(e=1,t=1,i=4,s=8,r=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:i,radialSegments:s,heightSegments:r},t=Math.max(0,t),i=Math.max(1,Math.floor(i)),s=Math.max(3,Math.floor(s)),r=Math.max(1,Math.floor(r));const o=[],c=[],h=[],p=[],g=t/2,v=Math.PI/2*e,y=t,w=2*v+y,E=i*2+r,R=s+1,N=new K,A=new K;for(let I=0;I<=E;I++){let D=0,U=0,j=0,F=0;if(I<=i){const L=I/i,B=L*Math.PI/2;U=-g-e*Math.cos(B),j=e*Math.sin(B),F=-e*Math.cos(B),D=L*v}else if(I<=i+r){const L=(I-i)/r;U=-g+L*t,j=e,F=0,D=v+L*y}else{const L=(I-i-r)/i,B=L*Math.PI/2;U=g+e*Math.sin(B),j=e*Math.cos(B),F=e*Math.sin(B),D=v+y+L*v}const z=Math.max(0,Math.min(1,D/w));let W=0;I===0?W=.5/s:I===E&&(W=-.5/s);for(let L=0;L<=s;L++){const B=L/s,Y=B*Math.PI*2,ee=Math.sin(Y),Q=Math.cos(Y);A.x=-j*Q,A.y=U,A.z=j*ee,c.push(A.x,A.y,A.z),N.set(-j*Q,F,j*ee),N.normalize(),h.push(N.x,N.y,N.z),p.push(B+W,z)}if(I>0){const L=(I-1)*R;for(let B=0;B<s;B++){const Y=L+B,ee=L+B+1,Q=I*R+B,ce=I*R+B+1;o.push(Y,ee,Q),o.push(ee,ce,Q)}}}this.setIndex(o),this.setAttribute("position",new Et(c,3)),this.setAttribute("normal",new Et(h,3)),this.setAttribute("uv",new Et(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new p_(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class m_ extends sn{constructor(e=1,t=32,i=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:s},t=Math.max(3,t);const r=[],o=[],c=[],h=[],p=new K,g=new Be;o.push(0,0,0),c.push(0,0,1),h.push(.5,.5);for(let v=0,y=3;v<=t;v++,y+=3){const w=i+v/t*s;p.x=e*Math.cos(w),p.y=e*Math.sin(w),o.push(p.x,p.y,p.z),c.push(0,0,1),g.x=(o[y]/e+1)/2,g.y=(o[y+1]/e+1)/2,h.push(g.x,g.y)}for(let v=1;v<=t;v++)r.push(v,v+1,0);this.setIndex(r),this.setAttribute("position",new Et(o,3)),this.setAttribute("normal",new Et(c,3)),this.setAttribute("uv",new Et(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new m_(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class A0 extends sn{constructor(e=1,t=1,i=1,s=32,r=1,o=!1,c=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:s,heightSegments:r,openEnded:o,thetaStart:c,thetaLength:h};const p=this;s=Math.floor(s),r=Math.floor(r);const g=[],v=[],y=[],w=[];let E=0;const R=[],N=i/2;let A=0;I(),o===!1&&(e>0&&D(!0),t>0&&D(!1)),this.setIndex(g),this.setAttribute("position",new Et(v,3)),this.setAttribute("normal",new Et(y,3)),this.setAttribute("uv",new Et(w,2));function I(){const U=new K,j=new K;let F=0;const z=(t-e)/i;for(let W=0;W<=r;W++){const L=[],B=W/r,Y=B*(t-e)+e;for(let ee=0;ee<=s;ee++){const Q=ee/s,ce=Q*h+c,oe=Math.sin(ce),J=Math.cos(ce);j.x=Y*oe,j.y=-B*i+N,j.z=Y*J,v.push(j.x,j.y,j.z),U.set(oe,z,J).normalize(),y.push(U.x,U.y,U.z),w.push(Q,1-B),L.push(E++)}R.push(L)}for(let W=0;W<s;W++)for(let L=0;L<r;L++){const B=R[L][W],Y=R[L+1][W],ee=R[L+1][W+1],Q=R[L][W+1];(e>0||L!==0)&&(g.push(B,Y,Q),F+=3),(t>0||L!==r-1)&&(g.push(Y,ee,Q),F+=3)}p.addGroup(A,F,0),A+=F}function D(U){const j=E,F=new Be,z=new K;let W=0;const L=U===!0?e:t,B=U===!0?1:-1;for(let ee=1;ee<=s;ee++)v.push(0,N*B,0),y.push(0,B,0),w.push(.5,.5),E++;const Y=E;for(let ee=0;ee<=s;ee++){const ce=ee/s*h+c,oe=Math.cos(ce),J=Math.sin(ce);z.x=L*J,z.y=N*B,z.z=L*oe,v.push(z.x,z.y,z.z),y.push(0,B,0),F.x=oe*.5+.5,F.y=J*.5*B+.5,w.push(F.x,F.y),E++}for(let ee=0;ee<s;ee++){const Q=j+ee,ce=Y+ee;U===!0?g.push(ce,ce+1,Q):g.push(ce+1,ce,Q),W+=3}p.addGroup(A,W,U===!0?1:2),A+=W}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new A0(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class N0 extends A0{constructor(e=1,t=1,i=32,s=1,r=!1,o=0,c=Math.PI*2){super(0,e,t,i,s,r,o,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:c}}static fromJSON(e){return new N0(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Gu extends sn{constructor(e=[],t=[],i=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:s};const r=[],o=[];c(s),p(i),g(),this.setAttribute("position",new Et(r,3)),this.setAttribute("normal",new Et(r.slice(),3)),this.setAttribute("uv",new Et(o,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function c(I){const D=new K,U=new K,j=new K;for(let F=0;F<t.length;F+=3)w(t[F+0],D),w(t[F+1],U),w(t[F+2],j),h(D,U,j,I)}function h(I,D,U,j){const F=j+1,z=[];for(let W=0;W<=F;W++){z[W]=[];const L=I.clone().lerp(U,W/F),B=D.clone().lerp(U,W/F),Y=F-W;for(let ee=0;ee<=Y;ee++)ee===0&&W===F?z[W][ee]=L:z[W][ee]=L.clone().lerp(B,ee/Y)}for(let W=0;W<F;W++)for(let L=0;L<2*(F-W)-1;L++){const B=Math.floor(L/2);L%2===0?(y(z[W][B+1]),y(z[W+1][B]),y(z[W][B])):(y(z[W][B+1]),y(z[W+1][B+1]),y(z[W+1][B]))}}function p(I){const D=new K;for(let U=0;U<r.length;U+=3)D.x=r[U+0],D.y=r[U+1],D.z=r[U+2],D.normalize().multiplyScalar(I),r[U+0]=D.x,r[U+1]=D.y,r[U+2]=D.z}function g(){const I=new K;for(let D=0;D<r.length;D+=3){I.x=r[D+0],I.y=r[D+1],I.z=r[D+2];const U=N(I)/2/Math.PI+.5,j=A(I)/Math.PI+.5;o.push(U,1-j)}E(),v()}function v(){for(let I=0;I<o.length;I+=6){const D=o[I+0],U=o[I+2],j=o[I+4],F=Math.max(D,U,j),z=Math.min(D,U,j);F>.9&&z<.1&&(D<.2&&(o[I+0]+=1),U<.2&&(o[I+2]+=1),j<.2&&(o[I+4]+=1))}}function y(I){r.push(I.x,I.y,I.z)}function w(I,D){const U=I*3;D.x=e[U+0],D.y=e[U+1],D.z=e[U+2]}function E(){const I=new K,D=new K,U=new K,j=new K,F=new Be,z=new Be,W=new Be;for(let L=0,B=0;L<r.length;L+=9,B+=6){I.set(r[L+0],r[L+1],r[L+2]),D.set(r[L+3],r[L+4],r[L+5]),U.set(r[L+6],r[L+7],r[L+8]),F.set(o[B+0],o[B+1]),z.set(o[B+2],o[B+3]),W.set(o[B+4],o[B+5]),j.copy(I).add(D).add(U).divideScalar(3);const Y=N(j);R(F,B+0,I,Y),R(z,B+2,D,Y),R(W,B+4,U,Y)}}function R(I,D,U,j){j<0&&I.x===1&&(o[D]=I.x-1),U.x===0&&U.z===0&&(o[D]=j/2/Math.PI+.5)}function N(I){return Math.atan2(I.z,-I.x)}function A(I){return Math.atan2(-I.y,Math.sqrt(I.x*I.x+I.z*I.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gu(e.vertices,e.indices,e.radius,e.detail)}}class g_ extends Gu{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,s=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-i,0,-s,i,0,s,-i,0,s,i,-s,-i,0,-s,i,0,s,-i,0,s,i,0,-i,0,-s,i,0,-s,-i,0,s,i,0,s],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new g_(e.radius,e.detail)}}const Jv=new K,Kv=new K,oS=new K,Zv=new Zr;class Uk extends sn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const s=Math.pow(10,4),r=Math.cos(oh*t),o=e.getIndex(),c=e.getAttribute("position"),h=o?o.count:c.count,p=[0,0,0],g=["a","b","c"],v=new Array(3),y={},w=[];for(let E=0;E<h;E+=3){o?(p[0]=o.getX(E),p[1]=o.getX(E+1),p[2]=o.getX(E+2)):(p[0]=E,p[1]=E+1,p[2]=E+2);const{a:R,b:N,c:A}=Zv;if(R.fromBufferAttribute(c,p[0]),N.fromBufferAttribute(c,p[1]),A.fromBufferAttribute(c,p[2]),Zv.getNormal(oS),v[0]=`${Math.round(R.x*s)},${Math.round(R.y*s)},${Math.round(R.z*s)}`,v[1]=`${Math.round(N.x*s)},${Math.round(N.y*s)},${Math.round(N.z*s)}`,v[2]=`${Math.round(A.x*s)},${Math.round(A.y*s)},${Math.round(A.z*s)}`,!(v[0]===v[1]||v[1]===v[2]||v[2]===v[0]))for(let I=0;I<3;I++){const D=(I+1)%3,U=v[I],j=v[D],F=Zv[g[I]],z=Zv[g[D]],W=`${U}_${j}`,L=`${j}_${U}`;L in y&&y[L]?(oS.dot(y[L].normal)<=r&&(w.push(F.x,F.y,F.z),w.push(z.x,z.y,z.z)),y[L]=null):W in y||(y[W]={index0:p[I],index1:p[D],normal:oS.clone()})}}for(const E in y)if(y[E]){const{index0:R,index1:N}=y[E];Jv.fromBufferAttribute(c,R),Kv.fromBufferAttribute(c,N),w.push(Jv.x,Jv.y,Jv.z),w.push(Kv.x,Kv.y,Kv.z)}this.setAttribute("position",new Et(w,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Uo{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){ht("Curve: .getPoint() not implemented.")}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,s=this.getPoint(0),r=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),r+=i.distanceTo(s),t.push(r),s=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const i=this.getLengths();let s=0;const r=i.length;let o;t?o=t:o=e*i[r-1];let c=0,h=r-1,p;for(;c<=h;)if(s=Math.floor(c+(h-c)/2),p=i[s]-o,p<0)c=s+1;else if(p>0)h=s-1;else{h=s;break}if(s=h,i[s]===o)return s/(r-1);const g=i[s],y=i[s+1]-g,w=(o-g)/y;return(s+w)/(r-1)}getTangent(e,t){let s=e-1e-4,r=e+1e-4;s<0&&(s=0),r>1&&(r=1);const o=this.getPoint(s),c=this.getPoint(r),h=t||(o.isVector2?new Be:new K);return h.copy(c).sub(o).normalize(),h}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t=!1){const i=new K,s=[],r=[],o=[],c=new K,h=new Jt;for(let w=0;w<=e;w++){const E=w/e;s[w]=this.getTangentAt(E,new K)}r[0]=new K,o[0]=new K;let p=Number.MAX_VALUE;const g=Math.abs(s[0].x),v=Math.abs(s[0].y),y=Math.abs(s[0].z);g<=p&&(p=g,i.set(1,0,0)),v<=p&&(p=v,i.set(0,1,0)),y<=p&&i.set(0,0,1),c.crossVectors(s[0],i).normalize(),r[0].crossVectors(s[0],c),o[0].crossVectors(s[0],r[0]);for(let w=1;w<=e;w++){if(r[w]=r[w-1].clone(),o[w]=o[w-1].clone(),c.crossVectors(s[w-1],s[w]),c.length()>Number.EPSILON){c.normalize();const E=Math.acos(Xt(s[w-1].dot(s[w]),-1,1));r[w].applyMatrix4(h.makeRotationAxis(c,E))}o[w].crossVectors(s[w],r[w])}if(t===!0){let w=Math.acos(Xt(r[0].dot(r[e]),-1,1));w/=e,s[0].dot(c.crossVectors(r[0],r[e]))>0&&(w=-w);for(let E=1;E<=e;E++)r[E].applyMatrix4(h.makeRotationAxis(s[E],w*E)),o[E].crossVectors(s[E],r[E])}return{tangents:s,normals:r,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class x_ extends Uo{constructor(e=0,t=0,i=1,s=1,r=0,o=Math.PI*2,c=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=s,this.aStartAngle=r,this.aEndAngle=o,this.aClockwise=c,this.aRotation=h}getPoint(e,t=new Be){const i=t,s=Math.PI*2;let r=this.aEndAngle-this.aStartAngle;const o=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=s;for(;r>s;)r-=s;r<Number.EPSILON&&(o?r=0:r=s),this.aClockwise===!0&&!o&&(r===s?r=-s:r=r-s);const c=this.aStartAngle+e*r;let h=this.aX+this.xRadius*Math.cos(c),p=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const g=Math.cos(this.aRotation),v=Math.sin(this.aRotation),y=h-this.aX,w=p-this.aY;h=y*g-w*v+this.aX,p=y*v+w*g+this.aY}return i.set(h,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Lk extends x_{constructor(e,t,i,s,r,o){super(e,t,i,i,s,r,o),this.isArcCurve=!0,this.type="ArcCurve"}}function fT(){let n=0,e=0,t=0,i=0;function s(r,o,c,h){n=r,e=c,t=-3*r+3*o-2*c-h,i=2*r-2*o+c+h}return{initCatmullRom:function(r,o,c,h,p){s(o,c,p*(c-r),p*(h-o))},initNonuniformCatmullRom:function(r,o,c,h,p,g,v){let y=(o-r)/p-(c-r)/(p+g)+(c-o)/g,w=(c-o)/g-(h-o)/(g+v)+(h-c)/v;y*=g,w*=g,s(o,c,y,w)},calc:function(r){const o=r*r,c=o*r;return n+e*r+t*o+i*c}}}const Qv=new K,lS=new fT,cS=new fT,uS=new fT;class Ok extends Uo{constructor(e=[],t=!1,i="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=s}getPoint(e,t=new K){const i=t,s=this.points,r=s.length,o=(r-(this.closed?0:1))*e;let c=Math.floor(o),h=o-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/r)+1)*r:h===0&&c===r-1&&(c=r-2,h=1);let p,g;this.closed||c>0?p=s[(c-1)%r]:(Qv.subVectors(s[0],s[1]).add(s[0]),p=Qv);const v=s[c%r],y=s[(c+1)%r];if(this.closed||c+2<r?g=s[(c+2)%r]:(Qv.subVectors(s[r-1],s[r-2]).add(s[r-1]),g=Qv),this.curveType==="centripetal"||this.curveType==="chordal"){const w=this.curveType==="chordal"?.5:.25;let E=Math.pow(p.distanceToSquared(v),w),R=Math.pow(v.distanceToSquared(y),w),N=Math.pow(y.distanceToSquared(g),w);R<1e-4&&(R=1),E<1e-4&&(E=R),N<1e-4&&(N=R),lS.initNonuniformCatmullRom(p.x,v.x,y.x,g.x,E,R,N),cS.initNonuniformCatmullRom(p.y,v.y,y.y,g.y,E,R,N),uS.initNonuniformCatmullRom(p.z,v.z,y.z,g.z,E,R,N)}else this.curveType==="catmullrom"&&(lS.initCatmullRom(p.x,v.x,y.x,g.x,this.tension),cS.initCatmullRom(p.y,v.y,y.y,g.y,this.tension),uS.initCatmullRom(p.z,v.z,y.z,g.z,this.tension));return i.set(lS.calc(h),cS.calc(h),uS.calc(h)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const s=e.points[t];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const s=this.points[t];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const s=e.points[t];this.points.push(new K().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function lA(n,e,t,i,s){const r=(i-e)*.5,o=(s-t)*.5,c=n*n,h=n*c;return(2*t-2*i+r+o)*h+(-3*t+3*i-2*r-o)*c+r*n+t}function MO(n,e){const t=1-n;return t*t*e}function AO(n,e){return 2*(1-n)*n*e}function NO(n,e){return n*n*e}function qg(n,e,t,i){return MO(n,e)+AO(n,t)+NO(n,i)}function CO(n,e){const t=1-n;return t*t*t*e}function RO(n,e){const t=1-n;return 3*t*t*n*e}function kO(n,e){return 3*(1-n)*n*n*e}function IO(n,e){return n*n*n*e}function Wg(n,e,t,i,s){return CO(n,e)+RO(n,t)+kO(n,i)+IO(n,s)}class pT extends Uo{constructor(e=new Be,t=new Be,i=new Be,s=new Be){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=s}getPoint(e,t=new Be){const i=t,s=this.v0,r=this.v1,o=this.v2,c=this.v3;return i.set(Wg(e,s.x,r.x,o.x,c.x),Wg(e,s.y,r.y,o.y,c.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class zk extends Uo{constructor(e=new K,t=new K,i=new K,s=new K){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=s}getPoint(e,t=new K){const i=t,s=this.v0,r=this.v1,o=this.v2,c=this.v3;return i.set(Wg(e,s.x,r.x,o.x,c.x),Wg(e,s.y,r.y,o.y,c.y),Wg(e,s.z,r.z,o.z,c.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class mT extends Uo{constructor(e=new Be,t=new Be){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Be){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Be){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class jk extends Uo{constructor(e=new K,t=new K){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new K){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new K){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gT extends Uo{constructor(e=new Be,t=new Be,i=new Be){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Be){const i=t,s=this.v0,r=this.v1,o=this.v2;return i.set(qg(e,s.x,r.x,o.x),qg(e,s.y,r.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class xT extends Uo{constructor(e=new K,t=new K,i=new K){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new K){const i=t,s=this.v0,r=this.v1,o=this.v2;return i.set(qg(e,s.x,r.x,o.x),qg(e,s.y,r.y,o.y),qg(e,s.z,r.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class vT extends Uo{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Be){const i=t,s=this.points,r=(s.length-1)*e,o=Math.floor(r),c=r-o,h=s[o===0?o:o-1],p=s[o],g=s[o>s.length-2?s.length-1:o+1],v=s[o>s.length-3?s.length-1:o+2];return i.set(lA(c,h.x,p.x,g.x,v.x),lA(c,h.y,p.y,g.y,v.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const s=e.points[t];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const s=this.points[t];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const s=e.points[t];this.points.push(new Be().fromArray(s))}return this}}var wb=Object.freeze({__proto__:null,ArcCurve:Lk,CatmullRomCurve3:Ok,CubicBezierCurve:pT,CubicBezierCurve3:zk,EllipseCurve:x_,LineCurve:mT,LineCurve3:jk,QuadraticBezierCurve:gT,QuadraticBezierCurve3:xT,SplineCurve:vT});class Fk extends Uo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new wb[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),s=this.getCurveLengths();let r=0;for(;r<s.length;){if(s[r]>=i){const o=s[r]-i,c=this.curves[r],h=c.getLength(),p=h===0?0:1-o/h;return c.getPointAt(p,t)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,s=this.curves.length;i<s;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let s=0,r=this.curves;s<r.length;s++){const o=r[s],c=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,h=o.getPoints(c);for(let p=0;p<h.length;p++){const g=h[p];i&&i.equals(g)||(t.push(g),i=g)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const s=e.curves[t];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const s=this.curves[t];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const s=e.curves[t];this.curves.push(new wb[s.type]().fromJSON(s))}return this}}class Sb extends Fk{constructor(e){super(),this.type="Path",this.currentPoint=new Be,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new mT(this.currentPoint.clone(),new Be(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,s){const r=new gT(this.currentPoint.clone(),new Be(e,t),new Be(i,s));return this.curves.push(r),this.currentPoint.set(i,s),this}bezierCurveTo(e,t,i,s,r,o){const c=new pT(this.currentPoint.clone(),new Be(e,t),new Be(i,s),new Be(r,o));return this.curves.push(c),this.currentPoint.set(r,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new vT(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,s,r,o){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(e+c,t+h,i,s,r,o),this}absarc(e,t,i,s,r,o){return this.absellipse(e,t,i,i,s,r,o),this}ellipse(e,t,i,s,r,o,c,h){const p=this.currentPoint.x,g=this.currentPoint.y;return this.absellipse(e+p,t+g,i,s,r,o,c,h),this}absellipse(e,t,i,s,r,o,c,h){const p=new x_(e,t,i,s,r,o,c,h);if(this.curves.length>0){const v=p.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(p);const g=p.getPoint(1);return this.currentPoint.copy(g),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class lh extends Sb{constructor(e){super(e),this.uuid=xa(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,s=this.holes.length;i<s;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const s=e.holes[t];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const s=this.holes[t];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const s=e.holes[t];this.holes.push(new Sb().fromJSON(s))}return this}}function DO(n,e,t=2){const i=e&&e.length,s=i?e[0]*t:n.length;let r=Bk(n,0,s,t,!0);const o=[];if(!r||r.next===r.prev)return o;let c,h,p;if(i&&(r=zO(n,e,r,t)),n.length>80*t){c=n[0],h=n[1];let g=c,v=h;for(let y=t;y<s;y+=t){const w=n[y],E=n[y+1];w<c&&(c=w),E<h&&(h=E),w>g&&(g=w),E>v&&(v=E)}p=Math.max(g-c,v-h),p=p!==0?32767/p:0}return d0(r,o,t,c,h,p,0),o}function Bk(n,e,t,i,s){let r;if(s===YO(n,e,t,i)>0)for(let o=e;o<t;o+=i)r=cA(o/i|0,n[o],n[o+1],r);else for(let o=t-i;o>=e;o-=i)r=cA(o/i|0,n[o],n[o+1],r);return r&&Np(r,r.next)&&(f0(r),r=r.next),r}function ph(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(Np(t,t.next)||ki(t.prev,t,t.next)===0)){if(f0(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function d0(n,e,t,i,s,r,o){if(!n)return;!o&&r&&HO(n,i,s,r);let c=n;for(;n.prev!==n.next;){const h=n.prev,p=n.next;if(r?UO(n,i,s,r):PO(n)){e.push(h.i,n.i,p.i),f0(n),n=p.next,c=p.next;continue}if(n=p,n===c){o?o===1?(n=LO(ph(n),e),d0(n,e,t,i,s,r,2)):o===2&&OO(n,e,t,i,s,r):d0(ph(n),e,t,i,s,r,1);break}}}function PO(n){const e=n.prev,t=n,i=n.next;if(ki(e,t,i)>=0)return!1;const s=e.x,r=t.x,o=i.x,c=e.y,h=t.y,p=i.y,g=Math.min(s,r,o),v=Math.min(c,h,p),y=Math.max(s,r,o),w=Math.max(c,h,p);let E=i.next;for(;E!==e;){if(E.x>=g&&E.x<=y&&E.y>=v&&E.y<=w&&Ig(s,c,r,h,o,p,E.x,E.y)&&ki(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function UO(n,e,t,i){const s=n.prev,r=n,o=n.next;if(ki(s,r,o)>=0)return!1;const c=s.x,h=r.x,p=o.x,g=s.y,v=r.y,y=o.y,w=Math.min(c,h,p),E=Math.min(g,v,y),R=Math.max(c,h,p),N=Math.max(g,v,y),A=r1(w,E,e,t,i),I=r1(R,N,e,t,i);let D=n.prevZ,U=n.nextZ;for(;D&&D.z>=A&&U&&U.z<=I;){if(D.x>=w&&D.x<=R&&D.y>=E&&D.y<=N&&D!==s&&D!==o&&Ig(c,g,h,v,p,y,D.x,D.y)&&ki(D.prev,D,D.next)>=0||(D=D.prevZ,U.x>=w&&U.x<=R&&U.y>=E&&U.y<=N&&U!==s&&U!==o&&Ig(c,g,h,v,p,y,U.x,U.y)&&ki(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;D&&D.z>=A;){if(D.x>=w&&D.x<=R&&D.y>=E&&D.y<=N&&D!==s&&D!==o&&Ig(c,g,h,v,p,y,D.x,D.y)&&ki(D.prev,D,D.next)>=0)return!1;D=D.prevZ}for(;U&&U.z<=I;){if(U.x>=w&&U.x<=R&&U.y>=E&&U.y<=N&&U!==s&&U!==o&&Ig(c,g,h,v,p,y,U.x,U.y)&&ki(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function LO(n,e){let t=n;do{const i=t.prev,s=t.next.next;!Np(i,s)&&Hk(i,t,t.next,s)&&h0(i,s)&&h0(s,i)&&(e.push(i.i,t.i,s.i),f0(t),f0(t.next),t=n=s),t=t.next}while(t!==n);return ph(t)}function OO(n,e,t,i,s,r){let o=n;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&WO(o,c)){let h=Gk(o,c);o=ph(o,o.next),h=ph(h,h.next),d0(o,e,t,i,s,r,0),d0(h,e,t,i,s,r,0);return}c=c.next}o=o.next}while(o!==n)}function zO(n,e,t,i){const s=[];for(let r=0,o=e.length;r<o;r++){const c=e[r]*i,h=r<o-1?e[r+1]*i:n.length,p=Bk(n,c,h,i,!1);p===p.next&&(p.steiner=!0),s.push(qO(p))}s.sort(jO);for(let r=0;r<s.length;r++)t=FO(s[r],t);return t}function jO(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const i=(n.next.y-n.y)/(n.next.x-n.x),s=(e.next.y-e.y)/(e.next.x-e.x);t=i-s}return t}function FO(n,e){const t=BO(n,e);if(!t)return e;const i=Gk(t,n);return ph(i,i.next),ph(t,t.next)}function BO(n,e){let t=e;const i=n.x,s=n.y;let r=-1/0,o;if(Np(n,t))return t;do{if(Np(n,t.next))return t.next;if(s<=t.y&&s>=t.next.y&&t.next.y!==t.y){const v=t.x+(s-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(v<=i&&v>r&&(r=v,o=t.x<t.next.x?t:t.next,v===i))return o}t=t.next}while(t!==e);if(!o)return null;const c=o,h=o.x,p=o.y;let g=1/0;t=o;do{if(i>=t.x&&t.x>=h&&i!==t.x&&Vk(s<p?i:r,s,h,p,s<p?r:i,s,t.x,t.y)){const v=Math.abs(s-t.y)/(i-t.x);h0(t,n)&&(v<g||v===g&&(t.x>o.x||t.x===o.x&&VO(o,t)))&&(o=t,g=v)}t=t.next}while(t!==c);return o}function VO(n,e){return ki(n.prev,n,e.prev)<0&&ki(e.next,n,n.next)<0}function HO(n,e,t,i){let s=n;do s.z===0&&(s.z=r1(s.x,s.y,e,t,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==n);s.prevZ.nextZ=null,s.prevZ=null,GO(s)}function GO(n){let e,t=1;do{let i=n,s;n=null;let r=null;for(e=0;i;){e++;let o=i,c=0;for(let p=0;p<t&&(c++,o=o.nextZ,!!o);p++);let h=t;for(;c>0||h>0&&o;)c!==0&&(h===0||!o||i.z<=o.z)?(s=i,i=i.nextZ,c--):(s=o,o=o.nextZ,h--),r?r.nextZ=s:n=s,s.prevZ=r,r=s;i=o}r.nextZ=null,t*=2}while(e>1);return n}function r1(n,e,t,i,s){return n=(n-t)*s|0,e=(e-i)*s|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function qO(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Vk(n,e,t,i,s,r,o,c){return(s-o)*(e-c)>=(n-o)*(r-c)&&(n-o)*(i-c)>=(t-o)*(e-c)&&(t-o)*(r-c)>=(s-o)*(i-c)}function Ig(n,e,t,i,s,r,o,c){return!(n===o&&e===c)&&Vk(n,e,t,i,s,r,o,c)}function WO(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!$O(n,e)&&(h0(n,e)&&h0(e,n)&&XO(n,e)&&(ki(n.prev,n,e.prev)||ki(n,e.prev,e))||Np(n,e)&&ki(n.prev,n,n.next)>0&&ki(e.prev,e,e.next)>0)}function ki(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function Np(n,e){return n.x===e.x&&n.y===e.y}function Hk(n,e,t,i){const s=ty(ki(n,e,t)),r=ty(ki(n,e,i)),o=ty(ki(t,i,n)),c=ty(ki(t,i,e));return!!(s!==r&&o!==c||s===0&&ey(n,t,e)||r===0&&ey(n,i,e)||o===0&&ey(t,n,i)||c===0&&ey(t,e,i))}function ey(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function ty(n){return n>0?1:n<0?-1:0}function $O(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&Hk(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function h0(n,e){return ki(n.prev,n,n.next)<0?ki(n,e,n.next)>=0&&ki(n,n.prev,e)>=0:ki(n,e,n.prev)<0||ki(n,n.next,e)<0}function XO(n,e){let t=n,i=!1;const s=(n.x+e.x)/2,r=(n.y+e.y)/2;do t.y>r!=t.next.y>r&&t.next.y!==t.y&&s<(t.next.x-t.x)*(r-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function Gk(n,e){const t=a1(n.i,n.x,n.y),i=a1(e.i,e.x,e.y),s=n.next,r=e.prev;return n.next=e,e.prev=n,t.next=s,s.prev=t,i.next=t,t.prev=i,r.next=i,i.prev=r,i}function cA(n,e,t,i){const s=a1(n,e,t);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function f0(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function a1(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function YO(n,e,t,i){let s=0;for(let r=e,o=t-i;r<t;r+=i)s+=(n[o]-n[r])*(n[r+1]+n[o+1]),o=r;return s}class JO{static triangulate(e,t,i=2){return DO(e,t,i)}}class ko{static area(e){const t=e.length;let i=0;for(let s=t-1,r=0;r<t;s=r++)i+=e[s].x*e[r].y-e[r].x*e[s].y;return i*.5}static isClockWise(e){return ko.area(e)<0}static triangulateShape(e,t){const i=[],s=[],r=[];uA(e),dA(i,e);let o=e.length;t.forEach(uA);for(let h=0;h<t.length;h++)s.push(o),o+=t[h].length,dA(i,t[h]);const c=JO.triangulate(i,s);for(let h=0;h<c.length;h+=3)r.push(c.slice(h,h+3));return r}}function uA(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function dA(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class v_ extends sn{constructor(e=new lh([new Be(.5,.5),new Be(-.5,.5),new Be(-.5,-.5),new Be(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,s=[],r=[];for(let c=0,h=e.length;c<h;c++){const p=e[c];o(p)}this.setAttribute("position",new Et(s,3)),this.setAttribute("uv",new Et(r,2)),this.computeVertexNormals();function o(c){const h=[],p=t.curveSegments!==void 0?t.curveSegments:12,g=t.steps!==void 0?t.steps:1,v=t.depth!==void 0?t.depth:1;let y=t.bevelEnabled!==void 0?t.bevelEnabled:!0,w=t.bevelThickness!==void 0?t.bevelThickness:.2,E=t.bevelSize!==void 0?t.bevelSize:w-.1,R=t.bevelOffset!==void 0?t.bevelOffset:0,N=t.bevelSegments!==void 0?t.bevelSegments:3;const A=t.extrudePath,I=t.UVGenerator!==void 0?t.UVGenerator:KO;let D,U=!1,j,F,z,W;if(A){D=A.getSpacedPoints(g),U=!0,y=!1;const Pe=A.isCatmullRomCurve3?A.closed:!1;j=A.computeFrenetFrames(g,Pe),F=new K,z=new K,W=new K}y||(N=0,w=0,E=0,R=0);const L=c.extractPoints(p);let B=L.shape;const Y=L.holes;if(!ko.isClockWise(B)){B=B.reverse();for(let Pe=0,qe=Y.length;Pe<qe;Pe++){const Oe=Y[Pe];ko.isClockWise(Oe)&&(Y[Pe]=Oe.reverse())}}function Q(Pe){const Oe=10000000000000001e-36;let it=Pe[0];for(let Z=1;Z<=Pe.length;Z++){const Nt=Z%Pe.length,ot=Pe[Nt],Rt=ot.x-it.x,Je=ot.y-it.y,X=Rt*Rt+Je*Je,V=Math.max(Math.abs(ot.x),Math.abs(ot.y),Math.abs(it.x),Math.abs(it.y)),ae=Oe*V*V;if(X<=ae){Pe.splice(Nt,1),Z--;continue}it=ot}}Q(B),Y.forEach(Q);const ce=Y.length,oe=B;for(let Pe=0;Pe<ce;Pe++){const qe=Y[Pe];B=B.concat(qe)}function J(Pe,qe,Oe){return qe||Dt("ExtrudeGeometry: vec does not exist"),Pe.clone().addScaledVector(qe,Oe)}const te=B.length;function me(Pe,qe,Oe){let it,Z,Nt;const ot=Pe.x-qe.x,Rt=Pe.y-qe.y,Je=Oe.x-Pe.x,X=Oe.y-Pe.y,V=ot*ot+Rt*Rt,ae=ot*X-Rt*Je;if(Math.abs(ae)>Number.EPSILON){const Ee=Math.sqrt(V),ze=Math.sqrt(Je*Je+X*X),Me=qe.x-Rt/Ee,gt=qe.y+ot/Ee,Qe=Oe.x-X/ze,St=Oe.y+Je/ze,Ut=((Qe-Me)*X-(St-gt)*Je)/(ot*X-Rt*Je);it=Me+ot*Ut-Pe.x,Z=gt+Rt*Ut-Pe.y;const He=it*it+Z*Z;if(He<=2)return new Be(it,Z);Nt=Math.sqrt(He/2)}else{let Ee=!1;ot>Number.EPSILON?Je>Number.EPSILON&&(Ee=!0):ot<-Number.EPSILON?Je<-Number.EPSILON&&(Ee=!0):Math.sign(Rt)===Math.sign(X)&&(Ee=!0),Ee?(it=-Rt,Z=ot,Nt=Math.sqrt(V)):(it=ot,Z=Rt,Nt=Math.sqrt(V/2))}return new Be(it/Nt,Z/Nt)}const Re=[];for(let Pe=0,qe=oe.length,Oe=qe-1,it=Pe+1;Pe<qe;Pe++,Oe++,it++)Oe===qe&&(Oe=0),it===qe&&(it=0),Re[Pe]=me(oe[Pe],oe[Oe],oe[it]);const Ie=[];let $,de=Re.concat();for(let Pe=0,qe=ce;Pe<qe;Pe++){const Oe=Y[Pe];$=[];for(let it=0,Z=Oe.length,Nt=Z-1,ot=it+1;it<Z;it++,Nt++,ot++)Nt===Z&&(Nt=0),ot===Z&&(ot=0),$[it]=me(Oe[it],Oe[Nt],Oe[ot]);Ie.push($),de=de.concat($)}let Ne;if(N===0)Ne=ko.triangulateShape(oe,Y);else{const Pe=[],qe=[];for(let Oe=0;Oe<N;Oe++){const it=Oe/N,Z=w*Math.cos(it*Math.PI/2),Nt=E*Math.sin(it*Math.PI/2)+R;for(let ot=0,Rt=oe.length;ot<Rt;ot++){const Je=J(oe[ot],Re[ot],Nt);rt(Je.x,Je.y,-Z),it===0&&Pe.push(Je)}for(let ot=0,Rt=ce;ot<Rt;ot++){const Je=Y[ot];$=Ie[ot];const X=[];for(let V=0,ae=Je.length;V<ae;V++){const Ee=J(Je[V],$[V],Nt);rt(Ee.x,Ee.y,-Z),it===0&&X.push(Ee)}it===0&&qe.push(X)}}Ne=ko.triangulateShape(Pe,qe)}const Fe=Ne.length,lt=E+R;for(let Pe=0;Pe<te;Pe++){const qe=y?J(B[Pe],de[Pe],lt):B[Pe];U?(z.copy(j.normals[0]).multiplyScalar(qe.x),F.copy(j.binormals[0]).multiplyScalar(qe.y),W.copy(D[0]).add(z).add(F),rt(W.x,W.y,W.z)):rt(qe.x,qe.y,0)}for(let Pe=1;Pe<=g;Pe++)for(let qe=0;qe<te;qe++){const Oe=y?J(B[qe],de[qe],lt):B[qe];U?(z.copy(j.normals[Pe]).multiplyScalar(Oe.x),F.copy(j.binormals[Pe]).multiplyScalar(Oe.y),W.copy(D[Pe]).add(z).add(F),rt(W.x,W.y,W.z)):rt(Oe.x,Oe.y,v/g*Pe)}for(let Pe=N-1;Pe>=0;Pe--){const qe=Pe/N,Oe=w*Math.cos(qe*Math.PI/2),it=E*Math.sin(qe*Math.PI/2)+R;for(let Z=0,Nt=oe.length;Z<Nt;Z++){const ot=J(oe[Z],Re[Z],it);rt(ot.x,ot.y,v+Oe)}for(let Z=0,Nt=Y.length;Z<Nt;Z++){const ot=Y[Z];$=Ie[Z];for(let Rt=0,Je=ot.length;Rt<Je;Rt++){const X=J(ot[Rt],$[Rt],it);U?rt(X.x,X.y+D[g-1].y,D[g-1].x+Oe):rt(X.x,X.y,v+Oe)}}}ge(),Ce();function ge(){const Pe=s.length/3;if(y){let qe=0,Oe=te*qe;for(let it=0;it<Fe;it++){const Z=Ne[it];mt(Z[2]+Oe,Z[1]+Oe,Z[0]+Oe)}qe=g+N*2,Oe=te*qe;for(let it=0;it<Fe;it++){const Z=Ne[it];mt(Z[0]+Oe,Z[1]+Oe,Z[2]+Oe)}}else{for(let qe=0;qe<Fe;qe++){const Oe=Ne[qe];mt(Oe[2],Oe[1],Oe[0])}for(let qe=0;qe<Fe;qe++){const Oe=Ne[qe];mt(Oe[0]+te*g,Oe[1]+te*g,Oe[2]+te*g)}}i.addGroup(Pe,s.length/3-Pe,0)}function Ce(){const Pe=s.length/3;let qe=0;nt(oe,qe),qe+=oe.length;for(let Oe=0,it=Y.length;Oe<it;Oe++){const Z=Y[Oe];nt(Z,qe),qe+=Z.length}i.addGroup(Pe,s.length/3-Pe,1)}function nt(Pe,qe){let Oe=Pe.length;for(;--Oe>=0;){const it=Oe;let Z=Oe-1;Z<0&&(Z=Pe.length-1);for(let Nt=0,ot=g+N*2;Nt<ot;Nt++){const Rt=te*Nt,Je=te*(Nt+1),X=qe+it+Rt,V=qe+Z+Rt,ae=qe+Z+Je,Ee=qe+it+Je;ln(X,V,ae,Ee)}}}function rt(Pe,qe,Oe){h.push(Pe),h.push(qe),h.push(Oe)}function mt(Pe,qe,Oe){vn(Pe),vn(qe),vn(Oe);const it=s.length/3,Z=I.generateTopUV(i,s,it-3,it-2,it-1);zt(Z[0]),zt(Z[1]),zt(Z[2])}function ln(Pe,qe,Oe,it){vn(Pe),vn(qe),vn(it),vn(qe),vn(Oe),vn(it);const Z=s.length/3,Nt=I.generateSideWallUV(i,s,Z-6,Z-3,Z-2,Z-1);zt(Nt[0]),zt(Nt[1]),zt(Nt[3]),zt(Nt[1]),zt(Nt[2]),zt(Nt[3])}function vn(Pe){s.push(h[Pe*3+0]),s.push(h[Pe*3+1]),s.push(h[Pe*3+2])}function zt(Pe){r.push(Pe.x),r.push(Pe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return ZO(t,i,e)}static fromJSON(e,t){const i=[];for(let r=0,o=e.shapes.length;r<o;r++){const c=t[e.shapes[r]];i.push(c)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new wb[s.type]().fromJSON(s)),new v_(i,e.options)}}const KO={generateTopUV:function(n,e,t,i,s){const r=e[t*3],o=e[t*3+1],c=e[i*3],h=e[i*3+1],p=e[s*3],g=e[s*3+1];return[new Be(r,o),new Be(c,h),new Be(p,g)]},generateSideWallUV:function(n,e,t,i,s,r){const o=e[t*3],c=e[t*3+1],h=e[t*3+2],p=e[i*3],g=e[i*3+1],v=e[i*3+2],y=e[s*3],w=e[s*3+1],E=e[s*3+2],R=e[r*3],N=e[r*3+1],A=e[r*3+2];return Math.abs(c-g)<Math.abs(o-p)?[new Be(o,1-h),new Be(p,1-v),new Be(y,1-E),new Be(R,1-A)]:[new Be(c,1-h),new Be(g,1-v),new Be(w,1-E),new Be(N,1-A)]}};function ZO(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,s=n.length;i<s;i++){const r=n[i];t.shapes.push(r.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class y_ extends Gu{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,s=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new y_(e.radius,e.detail)}}class b_ extends sn{constructor(e=[new Be(0,-.5),new Be(.5,0),new Be(0,.5)],t=12,i=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:s},t=Math.floor(t),s=Xt(s,0,Math.PI*2);const r=[],o=[],c=[],h=[],p=[],g=1/t,v=new K,y=new Be,w=new K,E=new K,R=new K;let N=0,A=0;for(let I=0;I<=e.length-1;I++)switch(I){case 0:N=e[I+1].x-e[I].x,A=e[I+1].y-e[I].y,w.x=A*1,w.y=-N,w.z=A*0,R.copy(w),w.normalize(),h.push(w.x,w.y,w.z);break;case e.length-1:h.push(R.x,R.y,R.z);break;default:N=e[I+1].x-e[I].x,A=e[I+1].y-e[I].y,w.x=A*1,w.y=-N,w.z=A*0,E.copy(w),w.x+=R.x,w.y+=R.y,w.z+=R.z,w.normalize(),h.push(w.x,w.y,w.z),R.copy(E)}for(let I=0;I<=t;I++){const D=i+I*g*s,U=Math.sin(D),j=Math.cos(D);for(let F=0;F<=e.length-1;F++){v.x=e[F].x*U,v.y=e[F].y,v.z=e[F].x*j,o.push(v.x,v.y,v.z),y.x=I/t,y.y=F/(e.length-1),c.push(y.x,y.y);const z=h[3*F+0]*U,W=h[3*F+1],L=h[3*F+0]*j;p.push(z,W,L)}}for(let I=0;I<t;I++)for(let D=0;D<e.length-1;D++){const U=D+I*e.length,j=U,F=U+e.length,z=U+e.length+1,W=U+1;r.push(j,F,W),r.push(z,W,F)}this.setIndex(r),this.setAttribute("position",new Et(o,3)),this.setAttribute("uv",new Et(c,2)),this.setAttribute("normal",new Et(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new b_(e.points,e.segments,e.phiStart,e.phiLength)}}class C0 extends Gu{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,s,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new C0(e.radius,e.detail)}}class Dp extends sn{constructor(e=1,t=1,i=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:s};const r=e/2,o=t/2,c=Math.floor(i),h=Math.floor(s),p=c+1,g=h+1,v=e/c,y=t/h,w=[],E=[],R=[],N=[];for(let A=0;A<g;A++){const I=A*y-o;for(let D=0;D<p;D++){const U=D*v-r;E.push(U,-I,0),R.push(0,0,1),N.push(D/c),N.push(1-A/h)}}for(let A=0;A<h;A++)for(let I=0;I<c;I++){const D=I+p*A,U=I+p*(A+1),j=I+1+p*(A+1),F=I+1+p*A;w.push(D,U,F),w.push(U,j,F)}this.setIndex(w),this.setAttribute("position",new Et(E,3)),this.setAttribute("normal",new Et(R,3)),this.setAttribute("uv",new Et(N,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Dp(e.width,e.height,e.widthSegments,e.heightSegments)}}class __ extends sn{constructor(e=.5,t=1,i=32,s=1,r=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:s,thetaStart:r,thetaLength:o},i=Math.max(3,i),s=Math.max(1,s);const c=[],h=[],p=[],g=[];let v=e;const y=(t-e)/s,w=new K,E=new Be;for(let R=0;R<=s;R++){for(let N=0;N<=i;N++){const A=r+N/i*o;w.x=v*Math.cos(A),w.y=v*Math.sin(A),h.push(w.x,w.y,w.z),p.push(0,0,1),E.x=(w.x/t+1)/2,E.y=(w.y/t+1)/2,g.push(E.x,E.y)}v+=y}for(let R=0;R<s;R++){const N=R*(i+1);for(let A=0;A<i;A++){const I=A+N,D=I,U=I+i+1,j=I+i+2,F=I+1;c.push(D,U,F),c.push(U,j,F)}}this.setIndex(c),this.setAttribute("position",new Et(h,3)),this.setAttribute("normal",new Et(p,3)),this.setAttribute("uv",new Et(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new __(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class w_ extends sn{constructor(e=new lh([new Be(0,.5),new Be(-.5,-.5),new Be(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],s=[],r=[],o=[];let c=0,h=0;if(Array.isArray(e)===!1)p(e);else for(let g=0;g<e.length;g++)p(e[g]),this.addGroup(c,h,g),c+=h,h=0;this.setIndex(i),this.setAttribute("position",new Et(s,3)),this.setAttribute("normal",new Et(r,3)),this.setAttribute("uv",new Et(o,2));function p(g){const v=s.length/3,y=g.extractPoints(t);let w=y.shape;const E=y.holes;ko.isClockWise(w)===!1&&(w=w.reverse());for(let N=0,A=E.length;N<A;N++){const I=E[N];ko.isClockWise(I)===!0&&(E[N]=I.reverse())}const R=ko.triangulateShape(w,E);for(let N=0,A=E.length;N<A;N++){const I=E[N];w=w.concat(I)}for(let N=0,A=w.length;N<A;N++){const I=w[N];s.push(I.x,I.y,0),r.push(0,0,1),o.push(I.x,I.y)}for(let N=0,A=R.length;N<A;N++){const I=R[N],D=I[0]+v,U=I[1]+v,j=I[2]+v;i.push(D,U,j),h+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return QO(t,e)}static fromJSON(e,t){const i=[];for(let s=0,r=e.shapes.length;s<r;s++){const o=t[e.shapes[s]];i.push(o)}return new w_(i,e.curveSegments)}}function QO(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const s=n[t];e.shapes.push(s.uuid)}else e.shapes.push(n.uuid);return e}class R0 extends sn{constructor(e=1,t=32,i=16,s=0,r=Math.PI*2,o=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:s,phiLength:r,thetaStart:o,thetaLength:c},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const h=Math.min(o+c,Math.PI);let p=0;const g=[],v=new K,y=new K,w=[],E=[],R=[],N=[];for(let A=0;A<=i;A++){const I=[],D=A/i;let U=0;A===0&&o===0?U=.5/t:A===i&&h===Math.PI&&(U=-.5/t);for(let j=0;j<=t;j++){const F=j/t;v.x=-e*Math.cos(s+F*r)*Math.sin(o+D*c),v.y=e*Math.cos(o+D*c),v.z=e*Math.sin(s+F*r)*Math.sin(o+D*c),E.push(v.x,v.y,v.z),y.copy(v).normalize(),R.push(y.x,y.y,y.z),N.push(F+U,1-D),I.push(p++)}g.push(I)}for(let A=0;A<i;A++)for(let I=0;I<t;I++){const D=g[A][I+1],U=g[A][I],j=g[A+1][I],F=g[A+1][I+1];(A!==0||o>0)&&w.push(D,U,F),(A!==i-1||h<Math.PI)&&w.push(U,j,F)}this.setIndex(w),this.setAttribute("position",new Et(E,3)),this.setAttribute("normal",new Et(R,3)),this.setAttribute("uv",new Et(N,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new R0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class S_ extends Gu{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,s,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new S_(e.radius,e.detail)}}class T_ extends sn{constructor(e=1,t=.4,i=12,s=48,r=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:s,arc:r},i=Math.floor(i),s=Math.floor(s);const o=[],c=[],h=[],p=[],g=new K,v=new K,y=new K;for(let w=0;w<=i;w++)for(let E=0;E<=s;E++){const R=E/s*r,N=w/i*Math.PI*2;v.x=(e+t*Math.cos(N))*Math.cos(R),v.y=(e+t*Math.cos(N))*Math.sin(R),v.z=t*Math.sin(N),c.push(v.x,v.y,v.z),g.x=e*Math.cos(R),g.y=e*Math.sin(R),y.subVectors(v,g).normalize(),h.push(y.x,y.y,y.z),p.push(E/s),p.push(w/i)}for(let w=1;w<=i;w++)for(let E=1;E<=s;E++){const R=(s+1)*w+E-1,N=(s+1)*(w-1)+E-1,A=(s+1)*(w-1)+E,I=(s+1)*w+E;o.push(R,N,I),o.push(N,A,I)}this.setIndex(o),this.setAttribute("position",new Et(c,3)),this.setAttribute("normal",new Et(h,3)),this.setAttribute("uv",new Et(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new T_(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class E_ extends sn{constructor(e=1,t=.4,i=64,s=8,r=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:s,p:r,q:o},i=Math.floor(i),s=Math.floor(s);const c=[],h=[],p=[],g=[],v=new K,y=new K,w=new K,E=new K,R=new K,N=new K,A=new K;for(let D=0;D<=i;++D){const U=D/i*r*Math.PI*2;I(U,r,o,e,w),I(U+.01,r,o,e,E),N.subVectors(E,w),A.addVectors(E,w),R.crossVectors(N,A),A.crossVectors(R,N),R.normalize(),A.normalize();for(let j=0;j<=s;++j){const F=j/s*Math.PI*2,z=-t*Math.cos(F),W=t*Math.sin(F);v.x=w.x+(z*A.x+W*R.x),v.y=w.y+(z*A.y+W*R.y),v.z=w.z+(z*A.z+W*R.z),h.push(v.x,v.y,v.z),y.subVectors(v,w).normalize(),p.push(y.x,y.y,y.z),g.push(D/i),g.push(j/s)}}for(let D=1;D<=i;D++)for(let U=1;U<=s;U++){const j=(s+1)*(D-1)+(U-1),F=(s+1)*D+(U-1),z=(s+1)*D+U,W=(s+1)*(D-1)+U;c.push(j,F,W),c.push(F,z,W)}this.setIndex(c),this.setAttribute("position",new Et(h,3)),this.setAttribute("normal",new Et(p,3)),this.setAttribute("uv",new Et(g,2));function I(D,U,j,F,z){const W=Math.cos(D),L=Math.sin(D),B=j/U*D,Y=Math.cos(B);z.x=F*(2+Y)*.5*W,z.y=F*(2+Y)*L*.5,z.z=F*Math.sin(B)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new E_(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class M_ extends sn{constructor(e=new xT(new K(-1,-1,0),new K(-1,1,0),new K(1,1,0)),t=64,i=1,s=8,r=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:s,closed:r};const o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const c=new K,h=new K,p=new Be;let g=new K;const v=[],y=[],w=[],E=[];R(),this.setIndex(E),this.setAttribute("position",new Et(v,3)),this.setAttribute("normal",new Et(y,3)),this.setAttribute("uv",new Et(w,2));function R(){for(let D=0;D<t;D++)N(D);N(r===!1?t:0),I(),A()}function N(D){g=e.getPointAt(D/t,g);const U=o.normals[D],j=o.binormals[D];for(let F=0;F<=s;F++){const z=F/s*Math.PI*2,W=Math.sin(z),L=-Math.cos(z);h.x=L*U.x+W*j.x,h.y=L*U.y+W*j.y,h.z=L*U.z+W*j.z,h.normalize(),y.push(h.x,h.y,h.z),c.x=g.x+i*h.x,c.y=g.y+i*h.y,c.z=g.z+i*h.z,v.push(c.x,c.y,c.z)}}function A(){for(let D=1;D<=t;D++)for(let U=1;U<=s;U++){const j=(s+1)*(D-1)+(U-1),F=(s+1)*D+(U-1),z=(s+1)*D+U,W=(s+1)*(D-1)+U;E.push(j,F,W),E.push(F,z,W)}}function I(){for(let D=0;D<=t;D++)for(let U=0;U<=s;U++)p.x=D/t,p.y=U/s,w.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new M_(new wb[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class qk extends sn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,s=new K,r=new K;if(e.index!==null){const o=e.attributes.position,c=e.index;let h=e.groups;h.length===0&&(h=[{start:0,count:c.count,materialIndex:0}]);for(let p=0,g=h.length;p<g;++p){const v=h[p],y=v.start,w=v.count;for(let E=y,R=y+w;E<R;E+=3)for(let N=0;N<3;N++){const A=c.getX(E+N),I=c.getX(E+(N+1)%3);s.fromBufferAttribute(o,A),r.fromBufferAttribute(o,I),hA(s,r,i)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}}else{const o=e.attributes.position;for(let c=0,h=o.count/3;c<h;c++)for(let p=0;p<3;p++){const g=3*c+p,v=3*c+(p+1)%3;s.fromBufferAttribute(o,g),r.fromBufferAttribute(o,v),hA(s,r,i)===!0&&(t.push(s.x,s.y,s.z),t.push(r.x,r.y,r.z))}}this.setAttribute("position",new Et(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function hA(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(s)===!0?!1:(t.add(i),t.add(s),!0)}var fA=Object.freeze({__proto__:null,BoxGeometry:gh,CapsuleGeometry:p_,CircleGeometry:m_,ConeGeometry:N0,CylinderGeometry:A0,DodecahedronGeometry:g_,EdgesGeometry:Uk,ExtrudeGeometry:v_,IcosahedronGeometry:y_,LatheGeometry:b_,OctahedronGeometry:C0,PlaneGeometry:Dp,PolyhedronGeometry:Gu,RingGeometry:__,ShapeGeometry:w_,SphereGeometry:R0,TetrahedronGeometry:S_,TorusGeometry:T_,TorusKnotGeometry:E_,TubeGeometry:M_,WireframeGeometry:qk});class Wk extends or{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new _t(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class yT extends na{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class bT extends or{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new _t(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _t(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vu,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ya,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $k extends bT{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Be(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Xt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new _t(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new _t(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new _t(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Xk extends or{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new _t(16777215),this.specular=new _t(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _t(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vu,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ya,this.combine=T0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Yk extends or{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new _t(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _t(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vu,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Jk extends or{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vu,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Kk extends or{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new _t(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _t(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vu,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ya,this.combine=T0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class _T extends or{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ck,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class wT extends or{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Zk extends or{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new _t(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Vu,this.normalScale=new Be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Qk extends Cr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function rh(n,e){return!n||n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function eI(n){function e(s,r){return n[s]-n[r]}const t=n.length,i=new Array(t);for(let s=0;s!==t;++s)i[s]=s;return i.sort(e),i}function o1(n,e,t){const i=n.length,s=new n.constructor(i);for(let r=0,o=0;o!==i;++r){const c=t[r]*e;for(let h=0;h!==e;++h)s[o++]=n[c+h]}return s}function ST(n,e,t,i){let s=1,r=n[0];for(;r!==void 0&&r[i]===void 0;)r=n[s++];if(r===void 0)return;let o=r[i];if(o!==void 0)if(Array.isArray(o))do o=r[i],o!==void 0&&(e.push(r.time),t.push(...o)),r=n[s++];while(r!==void 0);else if(o.toArray!==void 0)do o=r[i],o!==void 0&&(e.push(r.time),o.toArray(t,t.length)),r=n[s++];while(r!==void 0);else do o=r[i],o!==void 0&&(e.push(r.time),t.push(o)),r=n[s++];while(r!==void 0)}function e2(n,e,t,i,s=30){const r=n.clone();r.name=e;const o=[];for(let h=0;h<r.tracks.length;++h){const p=r.tracks[h],g=p.getValueSize(),v=[],y=[];for(let w=0;w<p.times.length;++w){const E=p.times[w]*s;if(!(E<t||E>=i)){v.push(p.times[w]);for(let R=0;R<g;++R)y.push(p.values[w*g+R])}}v.length!==0&&(p.times=rh(v,p.times.constructor),p.values=rh(y,p.values.constructor),o.push(p))}r.tracks=o;let c=1/0;for(let h=0;h<r.tracks.length;++h)c>r.tracks[h].times[0]&&(c=r.tracks[h].times[0]);for(let h=0;h<r.tracks.length;++h)r.tracks[h].shift(-1*c);return r.resetDuration(),r}function t2(n,e=0,t=n,i=30){i<=0&&(i=30);const s=t.tracks.length,r=e/i;for(let o=0;o<s;++o){const c=t.tracks[o],h=c.ValueTypeName;if(h==="bool"||h==="string")continue;const p=n.tracks.find(function(A){return A.name===c.name&&A.ValueTypeName===h});if(p===void 0)continue;let g=0;const v=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=v/3);let y=0;const w=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=w/3);const E=c.times.length-1;let R;if(r<=c.times[0]){const A=g,I=v-g;R=c.values.slice(A,I)}else if(r>=c.times[E]){const A=E*v+g,I=A+v-g;R=c.values.slice(A,I)}else{const A=c.createInterpolant(),I=g,D=v-g;A.evaluate(r),R=A.resultBuffer.slice(I,D)}h==="quaternion"&&new ea().fromArray(R).normalize().conjugate().toArray(R);const N=p.times.length;for(let A=0;A<N;++A){const I=A*w+y;if(h==="quaternion")ea.multiplyQuaternionsFlat(p.values,I,R,0,p.values,I);else{const D=w-y*2;for(let U=0;U<D;++U)p.values[I+U]-=R[U]}}}return n.blendMode=iT,n}class n2{static convertArray(e,t){return rh(e,t)}static isTypedArray(e){return vk(e)}static getKeyframeOrder(e){return eI(e)}static sortedArray(e,t,i){return o1(e,t,i)}static flattenJSON(e,t,i,s){ST(e,t,i,s)}static subclip(e,t,i,s,r=30){return e2(e,t,i,s,r)}static makeClipAdditive(e,t=0,i=e,s=30){return t2(e,t,i,s)}}class k0{constructor(e,t,i,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,s=t[i],r=t[i-1];e:{t:{let o;n:{i:if(!(e<s)){for(let c=i+2;;){if(s===void 0){if(e<r)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===c)break;if(r=s,s=t[++i],e<s)break t}o=t.length;break n}if(!(e>=r)){const c=t[1];e<c&&(i=2,r=c);for(let h=i-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===h)break;if(s=r,r=t[--i-1],e>=r)break t}o=i,i=0;break n}break e}for(;i<o;){const c=i+o>>>1;e<t[c]?o=c:i=c+1}if(s=t[i],r=t[i-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,s)}return this.interpolate_(i,r,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,r=e*s;for(let o=0;o!==s;++o)t[o]=i[r+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class tI extends k0{constructor(e,t,i,s){super(e,t,i,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ih,endingEnd:ih}}intervalChanged_(e,t,i){const s=this.parameterPositions;let r=e-2,o=e+1,c=s[r],h=s[o];if(c===void 0)switch(this.getSettings_().endingStart){case sh:r=e,c=2*t-i;break;case a0:r=s.length-2,c=t+s[r]-s[r+1];break;default:r=e,c=i}if(h===void 0)switch(this.getSettings_().endingEnd){case sh:o=e,h=2*i-t;break;case a0:o=1,h=i+s[1]-s[0];break;default:o=e-1,h=t}const p=(i-t)*.5,g=this.valueSize;this._weightPrev=p/(t-c),this._weightNext=p/(h-i),this._offsetPrev=r*g,this._offsetNext=o*g}interpolate_(e,t,i,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,h=e*c,p=h-c,g=this._offsetPrev,v=this._offsetNext,y=this._weightPrev,w=this._weightNext,E=(i-t)/(s-t),R=E*E,N=R*E,A=-y*N+2*y*R-y*E,I=(1+y)*N+(-1.5-2*y)*R+(-.5+y)*E+1,D=(-1-w)*N+(1.5+w)*R+.5*E,U=w*N-w*R;for(let j=0;j!==c;++j)r[j]=A*o[g+j]+I*o[p+j]+D*o[h+j]+U*o[v+j];return r}}class TT extends k0{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,h=e*c,p=h-c,g=(i-t)/(s-t),v=1-g;for(let y=0;y!==c;++y)r[y]=o[p+y]*v+o[h+y]*g;return r}}class nI extends k0{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class eo{constructor(e,t,i,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=rh(t,this.TimeBufferType),this.values=rh(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:rh(e.times,Array),values:rh(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(i.interpolation=s)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new nI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new TT(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new tI(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case r0:t=this.InterpolantFactoryMethodDiscrete;break;case yb:t=this.InterpolantFactoryMethodLinear;break;case yy:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return ht("KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return r0;case this.InterpolantFactoryMethodLinear:return yb;case this.InterpolantFactoryMethodSmooth:return yy}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,s=t.length;i!==s;++i)t[i]*=e}return this}trim(e,t){const i=this.times,s=i.length;let r=0,o=s-1;for(;r!==s&&i[r]<e;)++r;for(;o!==-1&&i[o]>t;)--o;if(++o,r!==0||o!==s){r>=o&&(o=Math.max(o,1),r=o-1);const c=this.getValueSize();this.times=i.slice(r,o),this.values=this.values.slice(r*c,o*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(Dt("KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,s=this.values,r=i.length;r===0&&(Dt("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let c=0;c!==r;c++){const h=i[c];if(typeof h=="number"&&isNaN(h)){Dt("KeyframeTrack: Time is not a valid number.",this,c,h),e=!1;break}if(o!==null&&o>h){Dt("KeyframeTrack: Out of order keys.",this,c,h,o),e=!1;break}o=h}if(s!==void 0&&vk(s))for(let c=0,h=s.length;c!==h;++c){const p=s[c];if(isNaN(p)){Dt("KeyframeTrack: Value is not a valid number.",this,c,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),s=this.getInterpolation()===yy,r=e.length-1;let o=1;for(let c=1;c<r;++c){let h=!1;const p=e[c],g=e[c+1];if(p!==g&&(c!==1||p!==e[0]))if(s)h=!0;else{const v=c*i,y=v-i,w=v+i;for(let E=0;E!==i;++E){const R=t[v+E];if(R!==t[y+E]||R!==t[w+E]){h=!0;break}}}if(h){if(c!==o){e[o]=e[c];const v=c*i,y=o*i;for(let w=0;w!==i;++w)t[y+w]=t[v+w]}++o}}if(r>0){e[o]=e[r];for(let c=r*i,h=o*i,p=0;p!==i;++p)t[h+p]=t[c+p];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,s=new i(this.name,e,t);return s.createInterpolant=this.createInterpolant,s}}eo.prototype.ValueTypeName="";eo.prototype.TimeBufferType=Float32Array;eo.prototype.ValueBufferType=Float32Array;eo.prototype.DefaultInterpolation=yb;class xh extends eo{constructor(e,t,i){super(e,t,i)}}xh.prototype.ValueTypeName="bool";xh.prototype.ValueBufferType=Array;xh.prototype.DefaultInterpolation=r0;xh.prototype.InterpolantFactoryMethodLinear=void 0;xh.prototype.InterpolantFactoryMethodSmooth=void 0;class ET extends eo{constructor(e,t,i,s){super(e,t,i,s)}}ET.prototype.ValueTypeName="color";class p0 extends eo{constructor(e,t,i,s){super(e,t,i,s)}}p0.prototype.ValueTypeName="number";class iI extends k0{constructor(e,t,i,s){super(e,t,i,s)}interpolate_(e,t,i,s){const r=this.resultBuffer,o=this.sampleValues,c=this.valueSize,h=(i-t)/(s-t);let p=e*c;for(let g=p+c;p!==g;p+=4)ea.slerpFlat(r,0,o,p-c,o,p,h);return r}}class I0 extends eo{constructor(e,t,i,s){super(e,t,i,s)}InterpolantFactoryMethodLinear(e){return new iI(this.times,this.values,this.getValueSize(),e)}}I0.prototype.ValueTypeName="quaternion";I0.prototype.InterpolantFactoryMethodSmooth=void 0;class vh extends eo{constructor(e,t,i){super(e,t,i)}}vh.prototype.ValueTypeName="string";vh.prototype.ValueBufferType=Array;vh.prototype.DefaultInterpolation=r0;vh.prototype.InterpolantFactoryMethodLinear=void 0;vh.prototype.InterpolantFactoryMethodSmooth=void 0;class m0 extends eo{constructor(e,t,i,s){super(e,t,i,s)}}m0.prototype.ValueTypeName="vector";class g0{constructor(e="",t=-1,i=[],s=t_){this.name=e,this.tracks=i,this.duration=t,this.blendMode=s,this.uuid=xa(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,s=1/(e.fps||1);for(let o=0,c=i.length;o!==c;++o)t.push(s2(i[o]).scale(s));const r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r.userData=JSON.parse(e.userData||"{}"),r}static toJSON(e){const t=[],i=e.tracks,s={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let r=0,o=i.length;r!==o;++r)t.push(eo.toJSON(i[r]));return s}static CreateFromMorphTargetSequence(e,t,i,s){const r=t.length,o=[];for(let c=0;c<r;c++){let h=[],p=[];h.push((c+r-1)%r,c,(c+1)%r),p.push(0,1,0);const g=eI(h);h=o1(h,1,g),p=o1(p,1,g),!s&&h[0]===0&&(h.push(r),p.push(p[0])),o.push(new p0(".morphTargetInfluences["+t[c].name+"]",h,p).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const s=e;i=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<i.length;s++)if(i[s].name===t)return i[s];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const s={},r=/^([\w-]*?)([\d]+)$/;for(let c=0,h=e.length;c<h;c++){const p=e[c],g=p.name.match(r);if(g&&g.length>1){const v=g[1];let y=s[v];y||(s[v]=y=[]),y.push(p)}}const o=[];for(const c in s)o.push(this.CreateFromMorphTargetSequence(c,s[c],t,i));return o}static parseAnimation(e,t){if(ht("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Dt("AnimationClip: No animation in JSONLoader data."),null;const i=function(v,y,w,E,R){if(w.length!==0){const N=[],A=[];ST(w,N,A,E),N.length!==0&&R.push(new v(y,N,A))}},s=[],r=e.name||"default",o=e.fps||30,c=e.blendMode;let h=e.length||-1;const p=e.hierarchy||[];for(let v=0;v<p.length;v++){const y=p[v].keys;if(!(!y||y.length===0))if(y[0].morphTargets){const w={};let E;for(E=0;E<y.length;E++)if(y[E].morphTargets)for(let R=0;R<y[E].morphTargets.length;R++)w[y[E].morphTargets[R]]=-1;for(const R in w){const N=[],A=[];for(let I=0;I!==y[E].morphTargets.length;++I){const D=y[E];N.push(D.time),A.push(D.morphTarget===R?1:0)}s.push(new p0(".morphTargetInfluence["+R+"]",N,A))}h=w.length*o}else{const w=".bones["+t[v].name+"]";i(m0,w+".position",y,"pos",s),i(I0,w+".quaternion",y,"rot",s),i(m0,w+".scale",y,"scl",s)}}return s.length===0?null:new this(r,h,s,c)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,s=e.length;i!==s;++i){const r=this.tracks[i];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function i2(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return p0;case"vector":case"vector2":case"vector3":case"vector4":return m0;case"color":return ET;case"quaternion":return I0;case"bool":case"boolean":return xh;case"string":return vh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function s2(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=i2(n.type);if(n.times===void 0){const t=[],i=[];ST(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const _l={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class MT{constructor(e,t,i){const s=this;let r=!1,o=0,c=0,h;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this._abortController=null,this.itemStart=function(g){c++,r===!1&&s.onStart!==void 0&&s.onStart(g,o,c),r=!0},this.itemEnd=function(g){o++,s.onProgress!==void 0&&s.onProgress(g,o,c),o===c&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(g){s.onError!==void 0&&s.onError(g)},this.resolveURL=function(g){return h?h(g):g},this.setURLModifier=function(g){return h=g,this},this.addHandler=function(g,v){return p.push(g,v),this},this.removeHandler=function(g){const v=p.indexOf(g);return v!==-1&&p.splice(v,2),this},this.getHandler=function(g){for(let v=0,y=p.length;v<y;v+=2){const w=p[v],E=p[v+1];if(w.global&&(w.lastIndex=0),w.test(g))return E}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const sI=new MT;class ia{constructor(e){this.manager=e!==void 0?e:sI,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(s,r){i.load(e,s,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}ia.DEFAULT_MATERIAL_NAME="__DEFAULT";const fc={};class r2 extends Error{constructor(e,t){super(e),this.response=t}}class wc extends ia{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=_l.get(`file:${e}`);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(fc[e]!==void 0){fc[e].push({onLoad:t,onProgress:i,onError:s});return}fc[e]=[],fc[e].push({onLoad:t,onProgress:i,onError:s});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),c=this.mimeType,h=this.responseType;fetch(o).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&ht("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const g=fc[e],v=p.body.getReader(),y=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),w=y?parseInt(y):0,E=w!==0;let R=0;const N=new ReadableStream({start(A){I();function I(){v.read().then(({done:D,value:U})=>{if(D)A.close();else{R+=U.byteLength;const j=new ProgressEvent("progress",{lengthComputable:E,loaded:R,total:w});for(let F=0,z=g.length;F<z;F++){const W=g[F];W.onProgress&&W.onProgress(j)}A.enqueue(U),I()}},D=>{A.error(D)})}}});return new Response(N)}else throw new r2(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(h){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(g=>new DOMParser().parseFromString(g,c));case"json":return p.json();default:if(c==="")return p.text();{const v=/charset="?([^;"\s]*)"?/i.exec(c),y=v&&v[1]?v[1].toLowerCase():void 0,w=new TextDecoder(y);return p.arrayBuffer().then(E=>w.decode(E))}}}).then(p=>{_l.add(`file:${e}`,p);const g=fc[e];delete fc[e];for(let v=0,y=g.length;v<y;v++){const w=g[v];w.onLoad&&w.onLoad(p)}}).catch(p=>{const g=fc[e];if(g===void 0)throw this.manager.itemError(e),p;delete fc[e];for(let v=0,y=g.length;v<y;v++){const w=g[v];w.onError&&w.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class a2 extends ia{constructor(e){super(e)}load(e,t,i,s){const r=this,o=new wc(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(h){s?s(h):Dt(h),r.manager.itemError(e)}},i,s)}parse(e){const t=[];for(let i=0;i<e.length;i++){const s=g0.parse(e[i]);t.push(s)}return t}}class o2 extends ia{constructor(e){super(e)}load(e,t,i,s){const r=this,o=[],c=new f_,h=new wc(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(r.withCredentials);let p=0;function g(v){h.load(e[v],function(y){const w=r.parse(y,!0);o[v]={width:w.width,height:w.height,format:w.format,mipmaps:w.mipmaps},p+=1,p===6&&(w.mipmapCount===1&&(c.minFilter=si),c.image=o,c.format=w.format,c.needsUpdate=!0,t&&t(c))},i,s)}if(Array.isArray(e))for(let v=0,y=e.length;v<y;++v)g(v);else h.load(e,function(v){const y=r.parse(v,!0);if(y.isCubemap){const w=y.mipmaps.length/y.mipmapCount;for(let E=0;E<w;E++){o[E]={mipmaps:[]};for(let R=0;R<y.mipmapCount;R++)o[E].mipmaps.push(y.mipmaps[E*y.mipmapCount+R]),o[E].format=y.format,o[E].width=y.width,o[E].height=y.height}c.image=o}else c.image.width=y.width,c.image.height=y.height,c.mipmaps=y.mipmaps;y.mipmapCount===1&&(c.minFilter=si),c.format=y.format,c.needsUpdate=!0,t&&t(c)},i,s);return c}}const Kf=new WeakMap;class x0 extends ia{constructor(e){super(e)}load(e,t,i,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=_l.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)r.manager.itemStart(e),setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0);else{let v=Kf.get(o);v===void 0&&(v=[],Kf.set(o,v)),v.push({onLoad:t,onError:s})}return o}const c=c0("img");function h(){g(),t&&t(this);const v=Kf.get(this)||[];for(let y=0;y<v.length;y++){const w=v[y];w.onLoad&&w.onLoad(this)}Kf.delete(this),r.manager.itemEnd(e)}function p(v){g(),s&&s(v),_l.remove(`image:${e}`);const y=Kf.get(this)||[];for(let w=0;w<y.length;w++){const E=y[w];E.onError&&E.onError(v)}Kf.delete(this),r.manager.itemError(e),r.manager.itemEnd(e)}function g(){c.removeEventListener("load",h,!1),c.removeEventListener("error",p,!1)}return c.addEventListener("load",h,!1),c.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),_l.add(`image:${e}`,c),r.manager.itemStart(e),c.src=e,c}}class l2 extends ia{constructor(e){super(e)}load(e,t,i,s){const r=new M0;r.colorSpace=sr;const o=new x0(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let c=0;function h(p){o.load(e[p],function(g){r.images[p]=g,c++,c===6&&(r.needsUpdate=!0,t&&t(r))},void 0,s)}for(let p=0;p<e.length;++p)h(p);return r}}class c2 extends ia{constructor(e){super(e)}load(e,t,i,s){const r=this,o=new Ya,c=new wc(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(r.withCredentials),c.load(e,function(h){let p;try{p=r.parse(h)}catch(g){if(s!==void 0)s(g);else{g(g);return}}p.image!==void 0?o.image=p.image:p.data!==void 0&&(o.image.width=p.width,o.image.height=p.height,o.image.data=p.data),o.wrapS=p.wrapS!==void 0?p.wrapS:Qr,o.wrapT=p.wrapT!==void 0?p.wrapT:Qr,o.magFilter=p.magFilter!==void 0?p.magFilter:si,o.minFilter=p.minFilter!==void 0?p.minFilter:si,o.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.colorSpace!==void 0&&(o.colorSpace=p.colorSpace),p.flipY!==void 0&&(o.flipY=p.flipY),p.format!==void 0&&(o.format=p.format),p.type!==void 0&&(o.type=p.type),p.mipmaps!==void 0&&(o.mipmaps=p.mipmaps,o.minFilter=bl),p.mipmapCount===1&&(o.minFilter=si),p.generateMipmaps!==void 0&&(o.generateMipmaps=p.generateMipmaps),o.needsUpdate=!0,t&&t(o,p)},i,s),o}}class u2 extends ia{constructor(e){super(e)}load(e,t,i,s){const r=new Bi,o=new x0(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(c){r.image=c,r.needsUpdate=!0,t!==void 0&&t(r)},i,s),r}}class qu extends On{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new _t(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class rI extends qu{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(On.DEFAULT_UP),this.updateMatrix(),this.groundColor=new _t(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const dS=new Jt,pA=new K,mA=new K;class AT{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Be(512,512),this.mapType=Er,this.map=null,this.mapPass=null,this.matrix=new Jt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ip,this._frameExtents=new Be(1,1),this._viewportCount=1,this._viewports=[new ii(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;pA.setFromMatrixPosition(e.matrixWorld),t.position.copy(pA),mA.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(mA),t.updateMatrixWorld(),dS.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(dS,t.coordinateSystem,t.reversedDepth),t.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(dS)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class d2 extends AT{constructor(){super(new Ss(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,i=Tp*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height*this.aspect,r=e.distance||t.far;(i!==t.fov||s!==t.aspect||r!==t.far)&&(t.fov=i,t.aspect=s,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class aI extends qu{constructor(e,t,i=0,s=Math.PI/3,r=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(On.DEFAULT_UP),this.updateMatrix(),this.target=new On,this.distance=i,this.angle=s,this.penumbra=r,this.decay=o,this.map=null,this.shadow=new d2}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class h2 extends AT{constructor(){super(new Ss(90,1,.5,500)),this.isPointLightShadow=!0}}class oI extends qu{constructor(e,t,i=0,s=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=s,this.shadow=new h2}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class yh extends a_{constructor(e=-1,t=1,i=1,s=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=s,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,s,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=s,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let r=i-e,o=i+e,c=s+t,h=s-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=p*this.view.offsetX,o=r+p*this.view.width,c-=g*this.view.offsetY,h=c-g*this.view.height}this.projectionMatrix.makeOrthographic(r,o,c,h,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class f2 extends AT{constructor(){super(new yh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class lI extends qu{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(On.DEFAULT_UP),this.updateMatrix(),this.target=new On,this.shadow=new f2}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class cI extends qu{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class uI extends qu{constructor(e,t,i=10,s=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class NT{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new K)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*s),t.addScaledVector(o[2],.488603*r),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*s)),t.addScaledVector(o[5],1.092548*(s*r)),t.addScaledVector(o[6],.315392*(3*r*r-1)),t.addScaledVector(o[7],1.092548*(i*r)),t.addScaledVector(o[8],.546274*(i*i-s*s)),t}getIrradianceAt(e,t){const i=e.x,s=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*s),t.addScaledVector(o[2],2*.511664*r),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*s),t.addScaledVector(o[5],2*.429043*s*r),t.addScaledVector(o[6],.743125*r*r-.247708),t.addScaledVector(o[7],2*.429043*i*r),t.addScaledVector(o[8],.429043*(i*i-s*s)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].fromArray(e,t+s*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let s=0;s<9;s++)i[s].toArray(e,t+s*3);return e}static getBasisAt(e,t){const i=e.x,s=e.y,r=e.z;t[0]=.282095,t[1]=.488603*s,t[2]=.488603*r,t[3]=.488603*i,t[4]=1.092548*i*s,t[5]=1.092548*s*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*i*r,t[8]=.546274*(i*i-s*s)}}class dI extends qu{constructor(e=new NT,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class A_ extends ia{constructor(e){super(e),this.textures={}}load(e,t,i,s){const r=this,o=new wc(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(h){s?s(h):Dt(h),r.manager.itemError(e)}},i,s)}parse(e){const t=this.textures;function i(r){return t[r]===void 0&&ht("MaterialLoader: Undefined texture",r),t[r]}const s=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new _t().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(s.dispersion=e.dispersion),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(s.allowOverride=e.allowOverride),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const r in e.uniforms){const o=e.uniforms[r];switch(s.uniforms[r]={},o.type){case"t":s.uniforms[r].value=i(o.value);break;case"c":s.uniforms[r].value=new _t().setHex(o.value);break;case"v2":s.uniforms[r].value=new Be().fromArray(o.value);break;case"v3":s.uniforms[r].value=new K().fromArray(o.value);break;case"v4":s.uniforms[r].value=new ii().fromArray(o.value);break;case"m3":s.uniforms[r].value=new on().fromArray(o.value);break;case"m4":s.uniforms[r].value=new Jt().fromArray(o.value);break;default:s.uniforms[r].value=o.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const r in e.extensions)s.extensions[r]=e.extensions[r];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=i(e.map)),e.matcap!==void 0&&(s.matcap=i(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let r=e.normalScale;Array.isArray(r)===!1&&(r=[r,r]),s.normalScale=new Be().fromArray(r)}return e.displacementMap!==void 0&&(s.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=i(e.envMap)),e.envMapRotation!==void 0&&s.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Be().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=i(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return A_.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:Wk,SpriteMaterial:cT,RawShaderMaterial:yT,ShaderMaterial:na,PointsMaterial:dT,MeshPhysicalMaterial:$k,MeshStandardMaterial:bT,MeshPhongMaterial:Xk,MeshToonMaterial:Yk,MeshNormalMaterial:Jk,MeshLambertMaterial:Kk,MeshDepthMaterial:_T,MeshDistanceMaterial:wT,MeshBasicMaterial:Hu,MeshMatcapMaterial:Zk,LineDashedMaterial:Qk,LineBasicMaterial:Cr,Material:or};return new t[e]}}class l1{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class hI extends sn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class fI extends ia{constructor(e){super(e)}load(e,t,i,s){const r=this,o=new wc(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(c){try{t(r.parse(JSON.parse(c)))}catch(h){s?s(h):Dt(h),r.manager.itemError(e)}},i,s)}parse(e){const t={},i={};function s(w,E){if(t[E]!==void 0)return t[E];const N=w.interleavedBuffers[E],A=r(w,N.buffer),I=up(N.type,A),D=new u_(I,N.stride);return D.uuid=N.uuid,t[E]=D,D}function r(w,E){if(i[E]!==void 0)return i[E];const N=w.arrayBuffers[E],A=new Uint32Array(N).buffer;return i[E]=A,A}const o=e.isInstancedBufferGeometry?new hI:new sn,c=e.data.index;if(c!==void 0){const w=up(c.type,c.array);o.setIndex(new ei(w,1))}const h=e.data.attributes;for(const w in h){const E=h[w];let R;if(E.isInterleavedBufferAttribute){const N=s(e.data,E.data);R=new hh(N,E.itemSize,E.offset,E.normalized)}else{const N=up(E.type,E.array),A=E.isInstancedBufferAttribute?Ap:ei;R=new A(N,E.itemSize,E.normalized)}E.name!==void 0&&(R.name=E.name),E.usage!==void 0&&R.setUsage(E.usage),o.setAttribute(w,R)}const p=e.data.morphAttributes;if(p)for(const w in p){const E=p[w],R=[];for(let N=0,A=E.length;N<A;N++){const I=E[N];let D;if(I.isInterleavedBufferAttribute){const U=s(e.data,I.data);D=new hh(U,I.itemSize,I.offset,I.normalized)}else{const U=up(I.type,I.array);D=new ei(U,I.itemSize,I.normalized)}I.name!==void 0&&(D.name=I.name),R.push(D)}o.morphAttributes[w]=R}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const v=e.data.groups||e.data.drawcalls||e.data.offsets;if(v!==void 0)for(let w=0,E=v.length;w!==E;++w){const R=v[w];o.addGroup(R.start,R.count,R.materialIndex)}const y=e.data.boundingSphere;return y!==void 0&&(o.boundingSphere=new Bs().fromJSON(y)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class p2 extends ia{constructor(e){super(e)}load(e,t,i,s){const r=this,o=this.path===""?l1.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const c=new wc(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(h){let p=null;try{p=JSON.parse(h)}catch(v){s!==void 0&&s(v),v("ObjectLoader: Can't parse "+e+".",v.message);return}const g=p.metadata;if(g===void 0||g.type===void 0||g.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),Dt("ObjectLoader: Can't load "+e);return}r.parse(p,t)},i,s)}async loadAsync(e,t){const i=this,s=this.path===""?l1.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const r=new wc(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const o=await r.loadAsync(e,t),c=JSON.parse(o),h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(c)}parse(e,t){const i=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,s),o=this.parseImages(e.images,function(){t!==void 0&&t(p)}),c=this.parseTextures(e.textures,o),h=this.parseMaterials(e.materials,c),p=this.parseObject(e.object,r,h,c,i),g=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,g),this.bindLightTargets(p),t!==void 0){let v=!1;for(const y in o)if(o[y].data instanceof HTMLImageElement){v=!0;break}v===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),r=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,r),c=this.parseMaterials(e.materials,o),h=this.parseObject(e.object,s,c,o,t),p=this.parseSkeletons(e.skeletons,h);return this.bindSkeletons(h,p),this.bindLightTargets(h),h}parseShapes(e){const t={};if(e!==void 0)for(let i=0,s=e.length;i<s;i++){const r=new lh().fromJSON(e[i]);t[r.uuid]=r}return t}parseSkeletons(e,t){const i={},s={};if(t.traverse(function(r){r.isBone&&(s[r.uuid]=r)}),e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=new d_().fromJSON(e[r],s);i[c.uuid]=c}return i}parseGeometries(e,t){const i={};if(e!==void 0){const s=new fI;for(let r=0,o=e.length;r<o;r++){let c;const h=e[r];switch(h.type){case"BufferGeometry":case"InstancedBufferGeometry":c=s.parse(h);break;default:h.type in fA?c=fA[h.type].fromJSON(h,t):ht(`ObjectLoader: Unsupported geometry type "${h.type}"`)}c.uuid=h.uuid,h.name!==void 0&&(c.name=h.name),h.userData!==void 0&&(c.userData=h.userData),i[h.uuid]=c}}return i}parseMaterials(e,t){const i={},s={};if(e!==void 0){const r=new A_;r.setTextures(t);for(let o=0,c=e.length;o<c;o++){const h=e[o];i[h.uuid]===void 0&&(i[h.uuid]=r.parse(h)),s[h.uuid]=i[h.uuid]}}return s}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const s=e[i],r=g0.parse(s);t[r.uuid]=r}return t}parseImages(e,t){const i=this,s={};let r;function o(h){return i.manager.itemStart(h),r.load(h,function(){i.manager.itemEnd(h)},void 0,function(){i.manager.itemError(h),i.manager.itemEnd(h)})}function c(h){if(typeof h=="string"){const p=h,g=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:i.resourcePath+p;return o(g)}else return h.data?{data:up(h.type,h.data),width:h.width,height:h.height}:null}if(e!==void 0&&e.length>0){const h=new MT(t);r=new x0(h),r.setCrossOrigin(this.crossOrigin);for(let p=0,g=e.length;p<g;p++){const v=e[p],y=v.url;if(Array.isArray(y)){const w=[];for(let E=0,R=y.length;E<R;E++){const N=y[E],A=c(N);A!==null&&(A instanceof HTMLImageElement?w.push(A):w.push(new Ya(A.data,A.width,A.height)))}s[v.uuid]=new Du(w)}else{const w=c(v.url);s[v.uuid]=new Du(w)}}}return s}async parseImagesAsync(e){const t=this,i={};let s;async function r(o){if(typeof o=="string"){const c=o,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await s.loadAsync(h)}else return o.data?{data:up(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){s=new x0(this.manager),s.setCrossOrigin(this.crossOrigin);for(let o=0,c=e.length;o<c;o++){const h=e[o],p=h.url;if(Array.isArray(p)){const g=[];for(let v=0,y=p.length;v<y;v++){const w=p[v],E=await r(w);E!==null&&(E instanceof HTMLImageElement?g.push(E):g.push(new Ya(E.data,E.width,E.height)))}i[h.uuid]=new Du(g)}else{const g=await r(h.url);i[h.uuid]=new Du(g)}}}return i}parseTextures(e,t){function i(r,o){return typeof r=="number"?r:(ht("ObjectLoader.parseTexture: Constant should be in numeric form.",r),o[r])}const s={};if(e!==void 0)for(let r=0,o=e.length;r<o;r++){const c=e[r];c.image===void 0&&ht('ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&ht("ObjectLoader: Undefined image",c.image);const h=t[c.image],p=h.data;let g;Array.isArray(p)?(g=new M0,p.length===6&&(g.needsUpdate=!0)):(p&&p.data?g=new Ya:g=new Bi,p&&(g.needsUpdate=!0)),g.source=h,g.uuid=c.uuid,c.name!==void 0&&(g.name=c.name),c.mapping!==void 0&&(g.mapping=i(c.mapping,m2)),c.channel!==void 0&&(g.channel=c.channel),c.offset!==void 0&&g.offset.fromArray(c.offset),c.repeat!==void 0&&g.repeat.fromArray(c.repeat),c.center!==void 0&&g.center.fromArray(c.center),c.rotation!==void 0&&(g.rotation=c.rotation),c.wrap!==void 0&&(g.wrapS=i(c.wrap[0],gA),g.wrapT=i(c.wrap[1],gA)),c.format!==void 0&&(g.format=c.format),c.internalFormat!==void 0&&(g.internalFormat=c.internalFormat),c.type!==void 0&&(g.type=c.type),c.colorSpace!==void 0&&(g.colorSpace=c.colorSpace),c.minFilter!==void 0&&(g.minFilter=i(c.minFilter,xA)),c.magFilter!==void 0&&(g.magFilter=i(c.magFilter,xA)),c.anisotropy!==void 0&&(g.anisotropy=c.anisotropy),c.flipY!==void 0&&(g.flipY=c.flipY),c.generateMipmaps!==void 0&&(g.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(g.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(g.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(g.compareFunction=c.compareFunction),c.userData!==void 0&&(g.userData=c.userData),s[c.uuid]=g}return s}parseObject(e,t,i,s,r){let o;function c(y){return t[y]===void 0&&ht("ObjectLoader: Undefined geometry",y),t[y]}function h(y){if(y!==void 0){if(Array.isArray(y)){const w=[];for(let E=0,R=y.length;E<R;E++){const N=y[E];i[N]===void 0&&ht("ObjectLoader: Undefined material",N),w.push(i[N])}return w}return i[y]===void 0&&ht("ObjectLoader: Undefined material",y),i[y]}}function p(y){return s[y]===void 0&&ht("ObjectLoader: Undefined texture",y),s[y]}let g,v;switch(e.type){case"Scene":o=new c_,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new _t(e.background):o.background=p(e.background)),e.environment!==void 0&&(o.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new l_(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new o_(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Ss(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new yh(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new cI(e.color,e.intensity);break;case"DirectionalLight":o=new lI(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new oI(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new uI(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new aI(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new rI(e.color,e.groundColor,e.intensity);break;case"LightProbe":const y=new NT().fromArray(e.sh);o=new dI(y,e.intensity);break;case"SkinnedMesh":g=c(e.geometry),v=h(e.material),o=new Nk(g,v),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":g=c(e.geometry),v=h(e.material),o=new os(g,v);break;case"InstancedMesh":g=c(e.geometry),v=h(e.material);const w=e.count,E=e.instanceMatrix,R=e.instanceColor;o=new Ck(g,v,w),o.instanceMatrix=new Ap(new Float32Array(E.array),16),R!==void 0&&(o.instanceColor=new Ap(new Float32Array(R.array),R.itemSize));break;case"BatchedMesh":g=c(e.geometry),v=h(e.material),o=new Rk(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,v),o.geometry=g,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(N=>{let A=null,I=null;return N.boundingBox!==void 0&&(A=new ar().fromJSON(N.boundingBox)),N.boundingSphere!==void 0&&(I=new Bs().fromJSON(N.boundingSphere)),{...N,boundingBox:A,boundingSphere:I}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=p(e.matricesTexture.uuid),o._indirectTexture=p(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=p(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new Bs().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new ar().fromJSON(e.boundingBox));break;case"LOD":o=new Ak;break;case"Line":o=new ju(c(e.geometry),h(e.material));break;case"LineLoop":o=new kk(c(e.geometry),h(e.material));break;case"LineSegments":o=new Nl(c(e.geometry),h(e.material));break;case"PointCloud":case"Points":o=new Ik(c(e.geometry),h(e.material));break;case"Sprite":o=new Mk(h(e.material));break;case"Group":o=new dp;break;case"Bone":o=new uT;break;default:o=new On}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const y=e.children;for(let w=0;w<y.length;w++)o.add(this.parseObject(y[w],t,i,s,r))}if(e.animations!==void 0){const y=e.animations;for(let w=0;w<y.length;w++){const E=y[w];o.animations.push(r[E])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const y=e.levels;for(let w=0;w<y.length;w++){const E=y[w],R=o.getObjectByProperty("uuid",E.object);R!==void 0&&o.addLevel(R,E.distance,E.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const s=t[i.skeleton];s===void 0?ht("ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(s,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const i=t.target,s=e.getObjectByProperty("uuid",i);s!==void 0?t.target=s:t.target=new On}})}}const m2={UVMapping:Xb,CubeReflectionMapping:Tl,CubeRefractionMapping:Lu,EquirectangularReflectionMapping:t0,EquirectangularRefractionMapping:n0,CubeUVReflectionMapping:Rp},gA={RepeatWrapping:i0,ClampToEdgeWrapping:Qr,MirroredRepeatWrapping:s0},xA={NearestFilter:Ii,NearestMipmapNearestFilter:J1,NearestMipmapLinearFilter:cp,LinearFilter:si,LinearMipmapNearestFilter:jg,LinearMipmapLinearFilter:bl},hS=new WeakMap;class g2 extends ia{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&ht("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&ht("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,i,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=_l.get(`image-bitmap:${e}`);if(o!==void 0){if(r.manager.itemStart(e),o.then){o.then(p=>{if(hS.has(o)===!0)s&&s(hS.get(o)),r.manager.itemError(e),r.manager.itemEnd(e);else return t&&t(p),r.manager.itemEnd(e),p});return}return setTimeout(function(){t&&t(o),r.manager.itemEnd(e)},0),o}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,c.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const h=fetch(e,c).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(p){return _l.add(`image-bitmap:${e}`,p),t&&t(p),r.manager.itemEnd(e),p}).catch(function(p){s&&s(p),hS.set(h,p),_l.remove(`image-bitmap:${e}`),r.manager.itemError(e),r.manager.itemEnd(e)});_l.add(`image-bitmap:${e}`,h),r.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let ny;class CT{static getContext(){return ny===void 0&&(ny=new(window.AudioContext||window.webkitAudioContext)),ny}static setContext(e){ny=e}}class x2 extends ia{constructor(e){super(e)}load(e,t,i,s){const r=this,o=new wc(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(h){try{const p=h.slice(0);CT.getContext().decodeAudioData(p,function(v){t(v)}).catch(c)}catch(p){c(p)}},i,s);function c(h){s?s(h):Dt(h),r.manager.itemError(e)}}}const vA=new Jt,yA=new Jt,Fd=new Jt;class v2{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ss,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ss,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Fd.copy(e.projectionMatrix);const s=t.eyeSep/2,r=s*t.near/t.focus,o=t.near*Math.tan(oh*t.fov*.5)/t.zoom;let c,h;yA.elements[12]=-s,vA.elements[12]=s,c=-o*t.aspect+r,h=o*t.aspect+r,Fd.elements[0]=2*t.near/(h-c),Fd.elements[8]=(h+c)/(h-c),this.cameraL.projectionMatrix.copy(Fd),c=-o*t.aspect-r,h=o*t.aspect-r,Fd.elements[0]=2*t.near/(h-c),Fd.elements[8]=(h+c)/(h-c),this.cameraR.projectionMatrix.copy(Fd)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(yA),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(vA)}}class pI extends Ss{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class RT{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const Bd=new K,fS=new ea,y2=new K,Vd=new K,Hd=new K;class b2 extends On{constructor(){super(),this.type="AudioListener",this.context=CT.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new RT}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Bd,fS,y2),Vd.set(0,0,-1).applyQuaternion(fS),Hd.set(0,1,0).applyQuaternion(fS),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Bd.x,i),t.positionY.linearRampToValueAtTime(Bd.y,i),t.positionZ.linearRampToValueAtTime(Bd.z,i),t.forwardX.linearRampToValueAtTime(Vd.x,i),t.forwardY.linearRampToValueAtTime(Vd.y,i),t.forwardZ.linearRampToValueAtTime(Vd.z,i),t.upX.linearRampToValueAtTime(Hd.x,i),t.upY.linearRampToValueAtTime(Hd.y,i),t.upZ.linearRampToValueAtTime(Hd.z,i)}else t.setPosition(Bd.x,Bd.y,Bd.z),t.setOrientation(Vd.x,Vd.y,Vd.z,Hd.x,Hd.y,Hd.z)}}let mI=class extends On{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){ht("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){ht("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){ht("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){ht("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){ht("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(ht("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){ht("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(ht("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}};const Gd=new K,bA=new ea,_2=new K,qd=new K;class w2 extends mI{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Gd,bA,_2),qd.set(0,0,1).applyQuaternion(bA);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Gd.x,i),t.positionY.linearRampToValueAtTime(Gd.y,i),t.positionZ.linearRampToValueAtTime(Gd.z,i),t.orientationX.linearRampToValueAtTime(qd.x,i),t.orientationY.linearRampToValueAtTime(qd.y,i),t.orientationZ.linearRampToValueAtTime(qd.z,i)}else t.setPosition(Gd.x,Gd.y,Gd.z),t.setOrientation(qd.x,qd.y,qd.z)}}class S2{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class gI{constructor(e,t,i){this.binding=e,this.valueSize=i;let s,r,o;switch(t){case"quaternion":s=this._slerp,r=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":s=this._select,r=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:s=this._lerp,r=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=r,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,s=this.valueSize,r=e*s+s;let o=this.cumulativeWeight;if(o===0){for(let c=0;c!==s;++c)i[r+c]=i[c];o=t}else{o+=t;const c=t/o;this._mixBufferRegion(i,r,0,c,s)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,s=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,s,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,s=e*t+t,r=this.cumulativeWeight,o=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){const h=t*this._origIndex;this._mixBufferRegion(i,s,h,1-r,t)}o>0&&this._mixBufferRegionAdditive(i,s,this._addIndex*t,1,t);for(let h=t,p=t+t;h!==p;++h)if(i[h]!==i[h+t]){c.setValue(i,s);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,s=i*this._origIndex;e.getValue(t,s);for(let r=i,o=s;r!==o;++r)t[r]=t[s+r%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,s,r){if(s>=.5)for(let o=0;o!==r;++o)e[t+o]=e[i+o]}_slerp(e,t,i,s){ea.slerpFlat(e,t,e,t,e,i,s)}_slerpAdditive(e,t,i,s,r){const o=this._workIndex*r;ea.multiplyQuaternionsFlat(e,o,e,t,e,i),ea.slerpFlat(e,t,e,t,e,o,s)}_lerp(e,t,i,s,r){const o=1-s;for(let c=0;c!==r;++c){const h=t+c;e[h]=e[h]*o+e[i+c]*s}}_lerpAdditive(e,t,i,s,r){for(let o=0;o!==r;++o){const c=t+o;e[c]=e[c]+e[i+o]*s}}}const kT="\\[\\]\\.:\\/",T2=new RegExp("["+kT+"]","g"),IT="[^"+kT+"]",E2="[^"+kT.replace("\\.","")+"]",M2=/((?:WC+[\/:])*)/.source.replace("WC",IT),A2=/(WCOD+)?/.source.replace("WCOD",E2),N2=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",IT),C2=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",IT),R2=new RegExp("^"+M2+A2+N2+C2+"$"),k2=["material","materials","bones","map"];class I2{constructor(e,t,i){const s=i||Ln.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,s)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,s=this._bindings[i];s!==void 0&&s.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let s=this._targetGroup.nCachedObjects_,r=i.length;s!==r;++s)i[s].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Ln{constructor(e,t,i){this.path=t,this.parsedPath=i||Ln.parseTrackName(t),this.node=Ln.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Ln.Composite(e,t,i):new Ln(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(T2,"")}static parseTrackName(e){const t=R2.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},s=i.nodeName&&i.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const r=i.nodeName.substring(s+1);k2.indexOf(r)!==-1&&(i.nodeName=i.nodeName.substring(0,s),i.objectName=r)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(r){for(let o=0;o<r.length;o++){const c=r[o];if(c.name===t||c.uuid===t)return c;const h=i(c.children);if(h)return h}return null},s=i(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)e[t++]=i[s]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let s=0,r=i.length;s!==r;++s)i[s]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,s=t.propertyName;let r=t.propertyIndex;if(e||(e=Ln.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){ht("PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let p=t.objectIndex;switch(i){case"materials":if(!e.material){Dt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Dt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Dt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let g=0;g<e.length;g++)if(e[g].name===p){p=g;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Dt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Dt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){Dt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(p!==void 0){if(e[p]===void 0){Dt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const o=e[s];if(o===void 0){const p=t.nodeName;Dt("PropertyBinding: Trying to update property for track: "+p+"."+s+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(r!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){Dt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Dt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}h=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=r}else o.fromArray!==void 0&&o.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(h=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ln.Composite=I2;Ln.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ln.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ln.prototype.GetterByBindingType=[Ln.prototype._getValue_direct,Ln.prototype._getValue_array,Ln.prototype._getValue_arrayElement,Ln.prototype._getValue_toArray];Ln.prototype.SetterByBindingTypeAndVersioning=[[Ln.prototype._setValue_direct,Ln.prototype._setValue_direct_setNeedsUpdate,Ln.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ln.prototype._setValue_array,Ln.prototype._setValue_array_setNeedsUpdate,Ln.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ln.prototype._setValue_arrayElement,Ln.prototype._setValue_arrayElement_setNeedsUpdate,Ln.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ln.prototype._setValue_fromArray,Ln.prototype._setValue_fromArray_setNeedsUpdate,Ln.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class D2{constructor(){this.isAnimationObjectGroup=!0,this.uuid=xa(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,s=arguments.length;i!==s;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length;let c,h=e.length,p=this.nCachedObjects_;for(let g=0,v=arguments.length;g!==v;++g){const y=arguments[g],w=y.uuid;let E=t[w];if(E===void 0){E=h++,t[w]=E,e.push(y);for(let R=0,N=o;R!==N;++R)r[R].push(new Ln(y,i[R],s[R]))}else if(E<p){c=e[E];const R=--p,N=e[R];t[N.uuid]=E,e[E]=N,t[w]=R,e[R]=y;for(let A=0,I=o;A!==I;++A){const D=r[A],U=D[R];let j=D[E];D[E]=U,j===void 0&&(j=new Ln(y,i[A],s[A])),D[R]=j}}else e[E]!==c&&Dt("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,s=i.length;let r=this.nCachedObjects_;for(let o=0,c=arguments.length;o!==c;++o){const h=arguments[o],p=h.uuid,g=t[p];if(g!==void 0&&g>=r){const v=r++,y=e[v];t[y.uuid]=g,e[g]=y,t[p]=v,e[v]=h;for(let w=0,E=s;w!==E;++w){const R=i[w],N=R[v],A=R[g];R[g]=N,R[v]=A}}}this.nCachedObjects_=r}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,s=i.length;let r=this.nCachedObjects_,o=e.length;for(let c=0,h=arguments.length;c!==h;++c){const p=arguments[c],g=p.uuid,v=t[g];if(v!==void 0)if(delete t[g],v<r){const y=--r,w=e[y],E=--o,R=e[E];t[w.uuid]=v,e[v]=w,t[R.uuid]=y,e[y]=R,e.pop();for(let N=0,A=s;N!==A;++N){const I=i[N],D=I[y],U=I[E];I[v]=D,I[y]=U,I.pop()}}else{const y=--o,w=e[y];y>0&&(t[w.uuid]=v),e[v]=w,e.pop();for(let E=0,R=s;E!==R;++E){const N=i[E];N[v]=N[y],N.pop()}}}this.nCachedObjects_=r}subscribe_(e,t){const i=this._bindingsIndicesByPath;let s=i[e];const r=this._bindings;if(s!==void 0)return r[s];const o=this._paths,c=this._parsedPaths,h=this._objects,p=h.length,g=this.nCachedObjects_,v=new Array(p);s=r.length,i[e]=s,o.push(e),c.push(t),r.push(v);for(let y=g,w=h.length;y!==w;++y){const E=h[y];v[y]=new Ln(E,e,t)}return v}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const s=this._paths,r=this._parsedPaths,o=this._bindings,c=o.length-1,h=o[c],p=e[c];t[p]=i,o[i]=h,o.pop(),r[i]=r[c],r.pop(),s[i]=s[c],s.pop()}}}class xI{constructor(e,t,i=null,s=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=s;const r=t.tracks,o=r.length,c=new Array(o),h={endingStart:ih,endingEnd:ih};for(let p=0;p!==o;++p){const g=r[p].createInterpolant(null);c[p]=g,g.settings=h}this._interpolantSettings=h,this._interpolants=c,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ok,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i=!1){if(e.fadeOut(t),this.fadeIn(t),i===!0){const s=this._clip.duration,r=e._clip.duration,o=r/s,c=s/r;e.warp(1,o,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,i=!1){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const s=this._mixer,r=s.time,o=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=s._lendControlInterpolant(),this._timeScaleInterpolant=c);const h=c.parameterPositions,p=c.sampleValues;return h[0]=r,h[1]=r+i,p[0]=e/o,p[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,s){if(!this.enabled){this._updateWeight(e);return}const r=this._startTime;if(r!==null){const h=(e-r)*i;h<0||i===0?t=0:(this._startTime=null,t=i*h)}t*=this._updateTimeScale(e);const o=this._updateTime(t),c=this._updateWeight(e);if(c>0){const h=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case iT:for(let g=0,v=h.length;g!==v;++g)h[g].evaluate(o),p[g].accumulateAdditive(c);break;case t_:default:for(let g=0,v=h.length;g!==v;++g)h[g].evaluate(o),p[g].accumulate(s,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const s=i.evaluate(e)[0];t*=s,e>i.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const s=i.evaluate(e)[0];t*=s,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let s=this.time+e,r=this._loopCount;const o=i===lk;if(e===0)return r===-1?s:o&&(r&1)===1?t-s:s;if(i===ak){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=t)s=t;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),s>=t||s<0){const c=Math.floor(s/t);s-=t*c,r+=Math.abs(c);const h=this.repetitions-r;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?t:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(h===1){const p=e<0;this._setEndings(p,!p,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=s;if(o&&(r&1)===1)return t-s}return s}_setEndings(e,t,i){const s=this._interpolantSettings;i?(s.endingStart=sh,s.endingEnd=sh):(e?s.endingStart=this.zeroSlopeAtStart?sh:ih:s.endingStart=a0,t?s.endingEnd=this.zeroSlopeAtEnd?sh:ih:s.endingEnd=a0)}_scheduleFading(e,t,i){const s=this._mixer,r=s.time;let o=this._weightInterpolant;o===null&&(o=s._lendControlInterpolant(),this._weightInterpolant=o);const c=o.parameterPositions,h=o.sampleValues;return c[0]=r,h[0]=t,c[1]=r+e,h[1]=i,this}}const P2=new Float32Array(1);class U2 extends Al{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,s=e._clip.tracks,r=s.length,o=e._propertyBindings,c=e._interpolants,h=i.uuid,p=this._bindingsByRootAndName;let g=p[h];g===void 0&&(g={},p[h]=g);for(let v=0;v!==r;++v){const y=s[v],w=y.name;let E=g[w];if(E!==void 0)++E.referenceCount,o[v]=E;else{if(E=o[v],E!==void 0){E._cacheIndex===null&&(++E.referenceCount,this._addInactiveBinding(E,h,w));continue}const R=t&&t._propertyBindings[v].binding.parsedPath;E=new gI(Ln.create(i,w,R),y.ValueTypeName,y.getValueSize()),++E.referenceCount,this._addInactiveBinding(E,h,w),o[v]=E}c[v].resultBuffer=E.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,s=e._clip.uuid,r=this._actionsByClip[s];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,s,i)}const t=e._propertyBindings;for(let i=0,s=t.length;i!==s;++i){const r=t[i];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,s=t.length;i!==s;++i){const r=t[i];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const s=this._actions,r=this._actionsByClip;let o=r[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{const c=o.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=s.length,s.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],s=e._cacheIndex;i._cacheIndex=s,t[s]=i,t.pop(),e._cacheIndex=null;const r=e._clip.uuid,o=this._actionsByClip,c=o[r],h=c.knownActions,p=h[h.length-1],g=e._byClipCacheIndex;p._byClipCacheIndex=g,h[g]=p,h.pop(),e._byClipCacheIndex=null;const v=c.actionByRoot,y=(e._localRoot||this._root).uuid;delete v[y],h.length===0&&delete o[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,s=t.length;i!==s;++i){const r=t[i];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,s=this._nActiveActions++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=i,t[i]=r}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,s=--this._nActiveActions,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=i,t[i]=r}_addInactiveBinding(e,t,i){const s=this._bindingsByRootAndName,r=this._bindings;let o=s[t];o===void 0&&(o={},s[t]=o),o[i]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,s=i.rootNode.uuid,r=i.path,o=this._bindingsByRootAndName,c=o[s],h=t[t.length-1],p=e._cacheIndex;h._cacheIndex=p,t[p]=h,t.pop(),delete c[r],Object.keys(c).length===0&&delete o[s]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,s=this._nActiveBindings++,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=i,t[i]=r}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,s=--this._nActiveBindings,r=t[s];e._cacheIndex=s,t[s]=e,r._cacheIndex=i,t[i]=r}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new TT(new Float32Array(2),new Float32Array(2),1,P2),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,s=--this._nActiveControlInterpolants,r=t[s];e.__cacheIndex=s,t[s]=e,r.__cacheIndex=i,t[i]=r}clipAction(e,t,i){const s=t||this._root,r=s.uuid;let o=typeof e=="string"?g0.findByName(s,e):e;const c=o!==null?o.uuid:e,h=this._actionsByClip[c];let p=null;if(i===void 0&&(o!==null?i=o.blendMode:i=t_),h!==void 0){const v=h.actionByRoot[r];if(v!==void 0&&v.blendMode===i)return v;p=h.knownActions[0],o===null&&(o=p._clip)}if(o===null)return null;const g=new xI(this,o,t,i);return this._bindAction(g,p),this._addInactiveAction(g,c,r),g}existingAction(e,t){const i=t||this._root,s=i.uuid,r=typeof e=="string"?g0.findByName(i,e):e,o=r?r.uuid:e,c=this._actionsByClip[o];return c!==void 0&&c.actionByRoot[s]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,s=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1;for(let p=0;p!==i;++p)t[p]._update(s,e,r,o);const c=this._bindings,h=this._nActiveBindings;for(let p=0;p!==h;++p)c[p].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,s=this._actionsByClip,r=s[i];if(r!==void 0){const o=r.knownActions;for(let c=0,h=o.length;c!==h;++c){const p=o[c];this._deactivateAction(p);const g=p._cacheIndex,v=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,v._cacheIndex=g,t[g]=v,t.pop(),this._removeInactiveBindingsForAction(p)}delete s[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const c=i[o].actionByRoot,h=c[t];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}const s=this._bindingsByRootAndName,r=s[t];if(r!==void 0)for(const o in r){const c=r[o];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class L2 extends rT{constructor(e=1,t=1,i=1,s={}){super(e,t,s),this.isRenderTarget3D=!0,this.depth=i,this.texture=new r_(null,e,t,i),this._setTextureOptions(s),this.texture.isRenderTargetTexture=!0}}class DT{constructor(e){this.value=e}clone(){return new DT(this.value.clone===void 0?this.value:this.value.clone())}}let O2=0;class z2 extends Al{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:O2++}),this.name="",this.usage=l0,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,s=t.length;i<s;i++){const r=Array.isArray(t[i])?t[i]:[t[i]];for(let o=0;o<r.length;o++)this.uniforms.push(r[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class j2 extends u_{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class F2{constructor(e,t,i,s,r,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=s,this.count=r,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const _A=new Jt;class PT{constructor(e,t,i=0,s=1/0){this.ray=new kp(e,t),this.near=i,this.far=s,this.camera=null,this.layers=new Ep,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Dt("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return _A.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(_A),this}intersectObject(e,t=!0,i=[]){return c1(e,this,i,t),i.sort(wA),i}intersectObjects(e,t=!0,i=[]){for(let s=0,r=e.length;s<r;s++)c1(e[s],this,i,t);return i.sort(wA),i}}function wA(n,e){return n.distance-e.distance}function c1(n,e,t,i){let s=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(s=!1),s===!0&&i===!0){const r=n.children;for(let o=0,c=r.length;o<c;o++)c1(r[o],e,t,!0)}}class B2{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=V2.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function V2(){this._document.hidden===!1&&this.reset()}class H2{constructor(e=1,t=0,i=0){this.radius=e,this.phi=t,this.theta=i}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Xt(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Xt(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class G2{constructor(e=1,t=0,i=0){this.radius=e,this.theta=t,this.y=i}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}class UT{constructor(e,t,i,s){UT.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,i,s)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let i=0;i<4;i++)this.elements[i]=e[i+t];return this}set(e,t,i,s){const r=this.elements;return r[0]=e,r[2]=t,r[1]=i,r[3]=s,this}}const SA=new Be;class q2{constructor(e=new Be(1/0,1/0),t=new Be(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=SA.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,SA).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const TA=new K,iy=new K,Zf=new K,Qf=new K,pS=new K,W2=new K,$2=new K;class X2{constructor(e=new K,t=new K){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){TA.subVectors(e,this.start),iy.subVectors(this.end,this.start);const i=iy.dot(iy);let r=iy.dot(TA)/i;return t&&(r=Xt(r,0,1)),r}closestPointToPoint(e,t,i){const s=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(s).add(this.start)}distanceSqToLine3(e,t=W2,i=$2){const s=10000000000000001e-32;let r,o;const c=this.start,h=e.start,p=this.end,g=e.end;Zf.subVectors(p,c),Qf.subVectors(g,h),pS.subVectors(c,h);const v=Zf.dot(Zf),y=Qf.dot(Qf),w=Qf.dot(pS);if(v<=s&&y<=s)return t.copy(c),i.copy(h),t.sub(i),t.dot(t);if(v<=s)r=0,o=w/y,o=Xt(o,0,1);else{const E=Zf.dot(pS);if(y<=s)o=0,r=Xt(-E/v,0,1);else{const R=Zf.dot(Qf),N=v*y-R*R;N!==0?r=Xt((R*w-E*y)/N,0,1):r=0,o=(R*r+w)/y,o<0?(o=0,r=Xt(-E/v,0,1)):o>1&&(o=1,r=Xt((R-E)/v,0,1))}}return t.copy(c).add(Zf.multiplyScalar(r)),i.copy(h).add(Qf.multiplyScalar(o)),t.sub(i),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const EA=new K;class Y2 extends On{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new sn,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,c=1,h=32;o<h;o++,c++){const p=o/h*Math.PI*2,g=c/h*Math.PI*2;s.push(Math.cos(p),Math.sin(p),1,Math.cos(g),Math.sin(g),1)}i.setAttribute("position",new Et(s,3));const r=new Cr({fog:!1,toneMapped:!1});this.cone=new Nl(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),EA.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(EA),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Su=new K,sy=new Jt,mS=new Jt;class J2 extends Nl{constructor(e){const t=vI(e),i=new sn,s=[],r=[];for(let p=0;p<t.length;p++){const g=t[p];g.parent&&g.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),r.push(0,0,0),r.push(0,0,0))}i.setAttribute("position",new Et(s,3)),i.setAttribute("color",new Et(r,3));const o=new Cr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const c=new _t(255),h=new _t(65280);this.setColors(c,h)}updateMatrixWorld(e){const t=this.bones,i=this.geometry,s=i.getAttribute("position");mS.copy(this.root.matrixWorld).invert();for(let r=0,o=0;r<t.length;r++){const c=t[r];c.parent&&c.parent.isBone&&(sy.multiplyMatrices(mS,c.matrixWorld),Su.setFromMatrixPosition(sy),s.setXYZ(o,Su.x,Su.y,Su.z),sy.multiplyMatrices(mS,c.parent.matrixWorld),Su.setFromMatrixPosition(sy),s.setXYZ(o+1,Su.x,Su.y,Su.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const s=this.geometry.getAttribute("color");for(let r=0;r<s.count;r+=2)s.setXYZ(r,e.r,e.g,e.b),s.setXYZ(r+1,t.r,t.g,t.b);return s.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function vI(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push(...vI(n.children[t]));return e}class K2 extends os{constructor(e,t,i){const s=new R0(t,4,2),r=new Hu({wireframe:!0,fog:!1,toneMapped:!1});super(s,r),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Z2=new K,MA=new _t,AA=new _t;class Q2 extends On{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const s=new C0(t);s.rotateY(Math.PI*.5),this.material=new Hu({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const r=s.getAttribute("position"),o=new Float32Array(r.count*3);s.setAttribute("color",new ei(o,3)),this.add(new os(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");MA.copy(this.light.color),AA.copy(this.light.groundColor);for(let i=0,s=t.count;i<s;i++){const r=i<s/2?MA:AA;t.setXYZ(i,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Z2.setFromMatrixPosition(this.light.matrixWorld).negate())}}class ez extends Nl{constructor(e=10,t=10,i=4473924,s=8947848){i=new _t(i),s=new _t(s);const r=t/2,o=e/t,c=e/2,h=[],p=[];for(let y=0,w=0,E=-c;y<=t;y++,E+=o){h.push(-c,0,E,c,0,E),h.push(E,0,-c,E,0,c);const R=y===r?i:s;R.toArray(p,w),w+=3,R.toArray(p,w),w+=3,R.toArray(p,w),w+=3,R.toArray(p,w),w+=3}const g=new sn;g.setAttribute("position",new Et(h,3)),g.setAttribute("color",new Et(p,3));const v=new Cr({vertexColors:!0,toneMapped:!1});super(g,v),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class tz extends Nl{constructor(e=10,t=16,i=8,s=64,r=4473924,o=8947848){r=new _t(r),o=new _t(o);const c=[],h=[];if(t>1)for(let v=0;v<t;v++){const y=v/t*(Math.PI*2),w=Math.sin(y)*e,E=Math.cos(y)*e;c.push(0,0,0),c.push(w,0,E);const R=v&1?r:o;h.push(R.r,R.g,R.b),h.push(R.r,R.g,R.b)}for(let v=0;v<i;v++){const y=v&1?r:o,w=e-e/i*v;for(let E=0;E<s;E++){let R=E/s*(Math.PI*2),N=Math.sin(R)*w,A=Math.cos(R)*w;c.push(N,0,A),h.push(y.r,y.g,y.b),R=(E+1)/s*(Math.PI*2),N=Math.sin(R)*w,A=Math.cos(R)*w,c.push(N,0,A),h.push(y.r,y.g,y.b)}}const p=new sn;p.setAttribute("position",new Et(c,3)),p.setAttribute("color",new Et(h,3));const g=new Cr({vertexColors:!0,toneMapped:!1});super(p,g),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const NA=new K,ry=new K,CA=new K;class nz extends On{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let s=new sn;s.setAttribute("position",new Et([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const r=new Cr({fog:!1,toneMapped:!1});this.lightPlane=new ju(s,r),this.add(this.lightPlane),s=new sn,s.setAttribute("position",new Et([0,0,0,0,0,1],3)),this.targetLine=new ju(s,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),NA.setFromMatrixPosition(this.light.matrixWorld),ry.setFromMatrixPosition(this.light.target.matrixWorld),CA.subVectors(ry,NA),this.lightPlane.lookAt(ry),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(ry),this.targetLine.scale.z=CA.length()}}const ay=new K,ji=new a_;class iz extends Nl{constructor(e){const t=new sn,i=new Cr({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],r=[],o={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(E,R){h(E),h(R)}function h(E){s.push(0,0,0),r.push(0,0,0),o[E]===void 0&&(o[E]=[]),o[E].push(s.length/3-1)}t.setAttribute("position",new Et(s,3)),t.setAttribute("color",new Et(r,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const p=new _t(16755200),g=new _t(16711680),v=new _t(43775),y=new _t(16777215),w=new _t(3355443);this.setColors(p,g,v,y,w)}setColors(e,t,i,s,r){const c=this.geometry.getAttribute("color");return c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,i.r,i.g,i.b),c.setXYZ(33,i.r,i.g,i.b),c.setXYZ(34,i.r,i.g,i.b),c.setXYZ(35,i.r,i.g,i.b),c.setXYZ(36,i.r,i.g,i.b),c.setXYZ(37,i.r,i.g,i.b),c.setXYZ(38,s.r,s.g,s.b),c.setXYZ(39,s.r,s.g,s.b),c.setXYZ(40,r.r,r.g,r.b),c.setXYZ(41,r.r,r.g,r.b),c.setXYZ(42,r.r,r.g,r.b),c.setXYZ(43,r.r,r.g,r.b),c.setXYZ(44,r.r,r.g,r.b),c.setXYZ(45,r.r,r.g,r.b),c.setXYZ(46,r.r,r.g,r.b),c.setXYZ(47,r.r,r.g,r.b),c.setXYZ(48,r.r,r.g,r.b),c.setXYZ(49,r.r,r.g,r.b),c.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,i=1,s=1;let r,o;if(ji.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)r=1,o=0;else if(this.camera.coordinateSystem===ga)r=-1,o=1;else if(this.camera.coordinateSystem===wp)r=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);Yi("c",t,e,ji,0,0,r),Yi("t",t,e,ji,0,0,o),Yi("n1",t,e,ji,-i,-s,r),Yi("n2",t,e,ji,i,-s,r),Yi("n3",t,e,ji,-i,s,r),Yi("n4",t,e,ji,i,s,r),Yi("f1",t,e,ji,-i,-s,o),Yi("f2",t,e,ji,i,-s,o),Yi("f3",t,e,ji,-i,s,o),Yi("f4",t,e,ji,i,s,o),Yi("u1",t,e,ji,i*.7,s*1.1,r),Yi("u2",t,e,ji,-i*.7,s*1.1,r),Yi("u3",t,e,ji,0,s*2,r),Yi("cf1",t,e,ji,-i,0,o),Yi("cf2",t,e,ji,i,0,o),Yi("cf3",t,e,ji,0,-s,o),Yi("cf4",t,e,ji,0,s,o),Yi("cn1",t,e,ji,-i,0,r),Yi("cn2",t,e,ji,i,0,r),Yi("cn3",t,e,ji,0,-s,r),Yi("cn4",t,e,ji,0,s,r),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Yi(n,e,t,i,s,r,o){ay.set(s,r,o).unproject(i);const c=e[n];if(c!==void 0){const h=t.getAttribute("position");for(let p=0,g=c.length;p<g;p++)h.setXYZ(c[p],ay.x,ay.y,ay.z)}}const oy=new ar;class sz extends Nl{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(24),r=new sn;r.setIndex(new ei(i,1)),r.setAttribute("position",new ei(s,3)),super(r,new Cr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&oy.setFromObject(this.object),oy.isEmpty())return;const e=oy.min,t=oy.max,i=this.geometry.attributes.position,s=i.array;s[0]=t.x,s[1]=t.y,s[2]=t.z,s[3]=e.x,s[4]=t.y,s[5]=t.z,s[6]=e.x,s[7]=e.y,s[8]=t.z,s[9]=t.x,s[10]=e.y,s[11]=t.z,s[12]=t.x,s[13]=t.y,s[14]=e.z,s[15]=e.x,s[16]=t.y,s[17]=e.z,s[18]=e.x,s[19]=e.y,s[20]=e.z,s[21]=t.x,s[22]=e.y,s[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class rz extends Nl{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new sn;r.setIndex(new ei(i,1)),r.setAttribute("position",new Et(s,3)),super(r,new Cr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class az extends ju{constructor(e,t=1,i=16776960){const s=i,r=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new sn;o.setAttribute("position",new Et(r,3)),o.computeBoundingSphere(),super(o,new Cr({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],h=new sn;h.setAttribute("position",new Et(c,3)),h.computeBoundingSphere(),this.add(new os(h,new Hu({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const RA=new K;let ly,gS;class oz extends On{constructor(e=new K(0,0,1),t=new K(0,0,0),i=1,s=16776960,r=i*.2,o=r*.2){super(),this.type="ArrowHelper",ly===void 0&&(ly=new sn,ly.setAttribute("position",new Et([0,0,0,0,1,0],3)),gS=new N0(.5,1,5,1),gS.translate(0,-.5,0)),this.position.copy(t),this.line=new ju(ly,new Cr({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new os(gS,new Hu({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,r,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{RA.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(RA,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class lz extends Nl{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new sn;s.setAttribute("position",new Et(t,3)),s.setAttribute("color",new Et(i,3));const r=new Cr({vertexColors:!0,toneMapped:!1});super(s,r),this.type="AxesHelper"}setColors(e,t,i){const s=new _t,r=this.geometry.attributes.color.array;return s.set(e),s.toArray(r,0),s.toArray(r,3),s.set(t),s.toArray(r,6),s.toArray(r,9),s.set(i),s.toArray(r,12),s.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class cz{constructor(){this.type="ShapePath",this.color=new _t,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Sb,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,s){return this.currentPath.quadraticCurveTo(e,t,i,s),this}bezierCurveTo(e,t,i,s,r,o){return this.currentPath.bezierCurveTo(e,t,i,s,r,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(A){const I=[];for(let D=0,U=A.length;D<U;D++){const j=A[D],F=new lh;F.curves=j.curves,I.push(F)}return I}function i(A,I){const D=I.length;let U=!1;for(let j=D-1,F=0;F<D;j=F++){let z=I[j],W=I[F],L=W.x-z.x,B=W.y-z.y;if(Math.abs(B)>Number.EPSILON){if(B<0&&(z=I[F],L=-L,W=I[j],B=-B),A.y<z.y||A.y>W.y)continue;if(A.y===z.y){if(A.x===z.x)return!0}else{const Y=B*(A.x-z.x)-L*(A.y-z.y);if(Y===0)return!0;if(Y<0)continue;U=!U}}else{if(A.y!==z.y)continue;if(W.x<=A.x&&A.x<=z.x||z.x<=A.x&&A.x<=W.x)return!0}}return U}const s=ko.isClockWise,r=this.subPaths;if(r.length===0)return[];let o,c,h;const p=[];if(r.length===1)return c=r[0],h=new lh,h.curves=c.curves,p.push(h),p;let g=!s(r[0].getPoints());g=e?!g:g;const v=[],y=[];let w=[],E=0,R;y[E]=void 0,w[E]=[];for(let A=0,I=r.length;A<I;A++)c=r[A],R=c.getPoints(),o=s(R),o=e?!o:o,o?(!g&&y[E]&&E++,y[E]={s:new lh,p:R},y[E].s.curves=c.curves,g&&E++,w[E]=[]):w[E].push({h:c,p:R[0]});if(!y[0])return t(r);if(y.length>1){let A=!1,I=0;for(let D=0,U=y.length;D<U;D++)v[D]=[];for(let D=0,U=y.length;D<U;D++){const j=w[D];for(let F=0;F<j.length;F++){const z=j[F];let W=!0;for(let L=0;L<y.length;L++)i(z.p,y[L].p)&&(D!==L&&I++,W?(W=!1,v[L].push(z)):A=!0);W&&v[D].push(z)}}I>0&&A===!1&&(w=v)}let N;for(let A=0,I=y.length;A<I;A++){h=y[A].s,p.push(h),N=w[A];for(let D=0,U=N.length;D<U;D++)h.holes.push(N[D].h)}return p}}class uz extends Al{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){ht("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function dz(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function hz(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function fz(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function u1(n,e,t,i){const s=pz(i);switch(t){case tT:return n*e;case Zb:return n*e/s.components*s.byteLength;case E0:return n*e/s.components*s.byteLength;case dh:return n*e*2/s.components*s.byteLength;case Qb:return n*e*2/s.components*s.byteLength;case nT:return n*e*3/s.components*s.byteLength;case Es:return n*e*4/s.components*s.byteLength;case e_:return n*e*4/s.components*s.byteLength;case Fg:case Bg:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Vg:case Hg:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Vy:case Gy:return Math.max(n,16)*Math.max(e,8)/4;case By:case Hy:return Math.max(n,8)*Math.max(e,8)/2;case qy:case Wy:case Xy:case Yy:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case $y:case Jy:case Ky:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Zy:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case Qy:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case eb:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case tb:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case nb:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case ib:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case sb:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case rb:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case ab:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case ob:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case lb:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case cb:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case ub:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case db:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case hb:case fb:case pb:return Math.ceil(n/4)*Math.ceil(e/4)*16;case mb:case gb:return Math.ceil(n/4)*Math.ceil(e/4)*8;case xb:case vb:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function pz(n){switch(n){case Er:case K1:return{byteLength:1,components:1};case bp:case Z1:case Po:return{byteLength:2,components:1};case Jb:case Kb:return{byteLength:2,components:4};case Za:case Yb:case Ts:return{byteLength:4,components:1};case Q1:case eT:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}class mz{static contain(e,t){return dz(e,t)}static cover(e,t){return hz(e,t)}static fill(e){return fz(e)}static getByteLength(e,t,i,s){return u1(e,t,i,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Wb}}));typeof window<"u"&&(window.__THREE__?ht("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Wb);function yI(){let n=null,e=!1,t=null,i=null;function s(r,o){t(r,o),i=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(r){t=r},setContext:function(r){n=r}}}function gz(n){const e=new WeakMap;function t(c,h){const p=c.array,g=c.usage,v=p.byteLength,y=n.createBuffer();n.bindBuffer(h,y),n.bufferData(h,p,g),c.onUploadCallback();let w;if(p instanceof Float32Array)w=n.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)w=n.HALF_FLOAT;else if(p instanceof Uint16Array)c.isFloat16BufferAttribute?w=n.HALF_FLOAT:w=n.UNSIGNED_SHORT;else if(p instanceof Int16Array)w=n.SHORT;else if(p instanceof Uint32Array)w=n.UNSIGNED_INT;else if(p instanceof Int32Array)w=n.INT;else if(p instanceof Int8Array)w=n.BYTE;else if(p instanceof Uint8Array)w=n.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)w=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:y,type:w,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version,size:v}}function i(c,h,p){const g=h.array,v=h.updateRanges;if(n.bindBuffer(p,c),v.length===0)n.bufferSubData(p,0,g);else{v.sort((w,E)=>w.start-E.start);let y=0;for(let w=1;w<v.length;w++){const E=v[y],R=v[w];R.start<=E.start+E.count+1?E.count=Math.max(E.count,R.start+R.count-E.start):(++y,v[y]=R)}v.length=y+1;for(let w=0,E=v.length;w<E;w++){const R=v[w];n.bufferSubData(p,R.start*g.BYTES_PER_ELEMENT,g,R.start,R.count)}h.clearUpdateRanges()}h.onUploadCallback()}function s(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function r(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=e.get(c);h&&(n.deleteBuffer(h.buffer),e.delete(c))}function o(c,h){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const g=e.get(c);(!g||g.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const p=e.get(c);if(p===void 0)e.set(c,t(c,h));else if(p.version<c.version){if(p.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(p.buffer,c,h),p.version=c.version}}return{get:s,remove:r,update:o}}var xz=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,vz=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,yz=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,bz=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,_z=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,wz=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Sz=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Tz=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Ez=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Mz=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Az=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Nz=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Cz=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Rz=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,kz=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Iz=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Dz=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Pz=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Uz=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Lz=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Oz=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,zz=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,jz=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Fz=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Bz=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Vz=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Hz=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Gz=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,qz=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Wz=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,$z="gl_FragColor = linearToOutputTexel( gl_FragColor );",Xz=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Yz=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Jz=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,Kz=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Zz=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Qz=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,ej=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,tj=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,nj=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,ij=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,sj=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,rj=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,aj=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,oj=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lj=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,cj=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,uj=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,dj=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,hj=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,fj=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,pj=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,mj=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,gj=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,xj=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,vj=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,yj=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,bj=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,_j=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,wj=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Sj=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Tj=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Ej=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Mj=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Aj=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Nj=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Cj=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Rj=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,kj=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Ij=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Dj=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Pj=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Uj=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Lj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Oj=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,zj=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,jj=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Fj=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Bj=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Vj=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Hj=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Gj=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,qj=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Wj=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,$j=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Xj=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Yj=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Jj=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Kj=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Zj=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,Qj=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,eF=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,tF=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,nF=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,iF=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,sF=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,rF=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,aF=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,oF=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,lF=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,cF=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,uF=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,dF=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,hF=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,fF=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,pF=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,mF=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const gF=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,xF=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vF=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,yF=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bF=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_F=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wF=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,SF=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,TF=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,EF=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,MF=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,AF=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,NF=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,CF=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,RF=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,kF=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,IF=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,DF=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,PF=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,UF=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,LF=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,OF=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,zF=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jF=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FF=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,BF=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,VF=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,HF=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GF=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,qF=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,WF=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$F=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,XF=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,YF=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,mn={alphahash_fragment:xz,alphahash_pars_fragment:vz,alphamap_fragment:yz,alphamap_pars_fragment:bz,alphatest_fragment:_z,alphatest_pars_fragment:wz,aomap_fragment:Sz,aomap_pars_fragment:Tz,batching_pars_vertex:Ez,batching_vertex:Mz,begin_vertex:Az,beginnormal_vertex:Nz,bsdfs:Cz,iridescence_fragment:Rz,bumpmap_pars_fragment:kz,clipping_planes_fragment:Iz,clipping_planes_pars_fragment:Dz,clipping_planes_pars_vertex:Pz,clipping_planes_vertex:Uz,color_fragment:Lz,color_pars_fragment:Oz,color_pars_vertex:zz,color_vertex:jz,common:Fz,cube_uv_reflection_fragment:Bz,defaultnormal_vertex:Vz,displacementmap_pars_vertex:Hz,displacementmap_vertex:Gz,emissivemap_fragment:qz,emissivemap_pars_fragment:Wz,colorspace_fragment:$z,colorspace_pars_fragment:Xz,envmap_fragment:Yz,envmap_common_pars_fragment:Jz,envmap_pars_fragment:Kz,envmap_pars_vertex:Zz,envmap_physical_pars_fragment:cj,envmap_vertex:Qz,fog_vertex:ej,fog_pars_vertex:tj,fog_fragment:nj,fog_pars_fragment:ij,gradientmap_pars_fragment:sj,lightmap_pars_fragment:rj,lights_lambert_fragment:aj,lights_lambert_pars_fragment:oj,lights_pars_begin:lj,lights_toon_fragment:uj,lights_toon_pars_fragment:dj,lights_phong_fragment:hj,lights_phong_pars_fragment:fj,lights_physical_fragment:pj,lights_physical_pars_fragment:mj,lights_fragment_begin:gj,lights_fragment_maps:xj,lights_fragment_end:vj,logdepthbuf_fragment:yj,logdepthbuf_pars_fragment:bj,logdepthbuf_pars_vertex:_j,logdepthbuf_vertex:wj,map_fragment:Sj,map_pars_fragment:Tj,map_particle_fragment:Ej,map_particle_pars_fragment:Mj,metalnessmap_fragment:Aj,metalnessmap_pars_fragment:Nj,morphinstance_vertex:Cj,morphcolor_vertex:Rj,morphnormal_vertex:kj,morphtarget_pars_vertex:Ij,morphtarget_vertex:Dj,normal_fragment_begin:Pj,normal_fragment_maps:Uj,normal_pars_fragment:Lj,normal_pars_vertex:Oj,normal_vertex:zj,normalmap_pars_fragment:jj,clearcoat_normal_fragment_begin:Fj,clearcoat_normal_fragment_maps:Bj,clearcoat_pars_fragment:Vj,iridescence_pars_fragment:Hj,opaque_fragment:Gj,packing:qj,premultiplied_alpha_fragment:Wj,project_vertex:$j,dithering_fragment:Xj,dithering_pars_fragment:Yj,roughnessmap_fragment:Jj,roughnessmap_pars_fragment:Kj,shadowmap_pars_fragment:Zj,shadowmap_pars_vertex:Qj,shadowmap_vertex:eF,shadowmask_pars_fragment:tF,skinbase_vertex:nF,skinning_pars_vertex:iF,skinning_vertex:sF,skinnormal_vertex:rF,specularmap_fragment:aF,specularmap_pars_fragment:oF,tonemapping_fragment:lF,tonemapping_pars_fragment:cF,transmission_fragment:uF,transmission_pars_fragment:dF,uv_pars_fragment:hF,uv_pars_vertex:fF,uv_vertex:pF,worldpos_vertex:mF,background_vert:gF,background_frag:xF,backgroundCube_vert:vF,backgroundCube_frag:yF,cube_vert:bF,cube_frag:_F,depth_vert:wF,depth_frag:SF,distance_vert:TF,distance_frag:EF,equirect_vert:MF,equirect_frag:AF,linedashed_vert:NF,linedashed_frag:CF,meshbasic_vert:RF,meshbasic_frag:kF,meshlambert_vert:IF,meshlambert_frag:DF,meshmatcap_vert:PF,meshmatcap_frag:UF,meshnormal_vert:LF,meshnormal_frag:OF,meshphong_vert:zF,meshphong_frag:jF,meshphysical_vert:FF,meshphysical_frag:BF,meshtoon_vert:VF,meshtoon_frag:HF,points_vert:GF,points_frag:qF,shadow_vert:WF,shadow_frag:$F,sprite_vert:XF,sprite_frag:YF},ft={common:{diffuse:{value:new _t(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new on},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new on}},envmap:{envMap:{value:null},envMapRotation:{value:new on},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new on}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new on}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new on},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new on},normalScale:{value:new Be(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new on},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new on}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new on}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new on}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _t(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new _t(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0},uvTransform:{value:new on}},sprite:{diffuse:{value:new _t(16777215)},opacity:{value:1},center:{value:new Be(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new on},alphaMap:{value:null},alphaMapTransform:{value:new on},alphaTest:{value:0}}},Ro={basic:{uniforms:Sr([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.fog]),vertexShader:mn.meshbasic_vert,fragmentShader:mn.meshbasic_frag},lambert:{uniforms:Sr([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new _t(0)}}]),vertexShader:mn.meshlambert_vert,fragmentShader:mn.meshlambert_frag},phong:{uniforms:Sr([ft.common,ft.specularmap,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,ft.lights,{emissive:{value:new _t(0)},specular:{value:new _t(1118481)},shininess:{value:30}}]),vertexShader:mn.meshphong_vert,fragmentShader:mn.meshphong_frag},standard:{uniforms:Sr([ft.common,ft.envmap,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.roughnessmap,ft.metalnessmap,ft.fog,ft.lights,{emissive:{value:new _t(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:mn.meshphysical_vert,fragmentShader:mn.meshphysical_frag},toon:{uniforms:Sr([ft.common,ft.aomap,ft.lightmap,ft.emissivemap,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.gradientmap,ft.fog,ft.lights,{emissive:{value:new _t(0)}}]),vertexShader:mn.meshtoon_vert,fragmentShader:mn.meshtoon_frag},matcap:{uniforms:Sr([ft.common,ft.bumpmap,ft.normalmap,ft.displacementmap,ft.fog,{matcap:{value:null}}]),vertexShader:mn.meshmatcap_vert,fragmentShader:mn.meshmatcap_frag},points:{uniforms:Sr([ft.points,ft.fog]),vertexShader:mn.points_vert,fragmentShader:mn.points_frag},dashed:{uniforms:Sr([ft.common,ft.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:mn.linedashed_vert,fragmentShader:mn.linedashed_frag},depth:{uniforms:Sr([ft.common,ft.displacementmap]),vertexShader:mn.depth_vert,fragmentShader:mn.depth_frag},normal:{uniforms:Sr([ft.common,ft.bumpmap,ft.normalmap,ft.displacementmap,{opacity:{value:1}}]),vertexShader:mn.meshnormal_vert,fragmentShader:mn.meshnormal_frag},sprite:{uniforms:Sr([ft.sprite,ft.fog]),vertexShader:mn.sprite_vert,fragmentShader:mn.sprite_frag},background:{uniforms:{uvTransform:{value:new on},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:mn.background_vert,fragmentShader:mn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new on}},vertexShader:mn.backgroundCube_vert,fragmentShader:mn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:mn.cube_vert,fragmentShader:mn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:mn.equirect_vert,fragmentShader:mn.equirect_frag},distance:{uniforms:Sr([ft.common,ft.displacementmap,{referencePosition:{value:new K},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:mn.distance_vert,fragmentShader:mn.distance_frag},shadow:{uniforms:Sr([ft.lights,ft.fog,{color:{value:new _t(0)},opacity:{value:1}}]),vertexShader:mn.shadow_vert,fragmentShader:mn.shadow_frag}};Ro.physical={uniforms:Sr([Ro.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new on},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new on},clearcoatNormalScale:{value:new Be(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new on},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new on},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new on},sheen:{value:0},sheenColor:{value:new _t(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new on},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new on},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new on},transmissionSamplerSize:{value:new Be},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new on},attenuationDistance:{value:0},attenuationColor:{value:new _t(0)},specularColor:{value:new _t(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new on},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new on},anisotropyVector:{value:new Be},anisotropyMap:{value:null},anisotropyMapTransform:{value:new on}}]),vertexShader:mn.meshphysical_vert,fragmentShader:mn.meshphysical_frag};const cy={r:0,b:0,g:0},Wd=new ya,JF=new Jt;function KF(n,e,t,i,s,r,o){const c=new _t(0);let h=r===!0?0:1,p,g,v=null,y=0,w=null;function E(D){let U=D.isScene===!0?D.background:null;return U&&U.isTexture&&(U=(D.backgroundBlurriness>0?t:e).get(U)),U}function R(D){let U=!1;const j=E(D);j===null?A(c,h):j&&j.isColor&&(A(j,1),U=!0);const F=n.xr.getEnvironmentBlendMode();F==="additive"?i.buffers.color.setClear(0,0,0,1,o):F==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||U)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function N(D,U){const j=E(U);j&&(j.isCubeTexture||j.mapping===Rp)?(g===void 0&&(g=new os(new gh(1,1,1),new na({name:"BackgroundCubeMaterial",uniforms:Mp(Ro.backgroundCube.uniforms),vertexShader:Ro.backgroundCube.vertexShader,fragmentShader:Ro.backgroundCube.fragmentShader,side:Ar,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),g.geometry.deleteAttribute("normal"),g.geometry.deleteAttribute("uv"),g.onBeforeRender=function(F,z,W){this.matrixWorld.copyPosition(W.matrixWorld)},Object.defineProperty(g.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(g)),Wd.copy(U.backgroundRotation),Wd.x*=-1,Wd.y*=-1,Wd.z*=-1,j.isCubeTexture&&j.isRenderTargetTexture===!1&&(Wd.y*=-1,Wd.z*=-1),g.material.uniforms.envMap.value=j,g.material.uniforms.flipEnvMap.value=j.isCubeTexture&&j.isRenderTargetTexture===!1?-1:1,g.material.uniforms.backgroundBlurriness.value=U.backgroundBlurriness,g.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,g.material.uniforms.backgroundRotation.value.setFromMatrix4(JF.makeRotationFromEuler(Wd)),g.material.toneMapped=kn.getTransfer(j.colorSpace)!==$n,(v!==j||y!==j.version||w!==n.toneMapping)&&(g.material.needsUpdate=!0,v=j,y=j.version,w=n.toneMapping),g.layers.enableAll(),D.unshift(g,g.geometry,g.material,0,0,null)):j&&j.isTexture&&(p===void 0&&(p=new os(new Dp(2,2),new na({name:"BackgroundMaterial",uniforms:Mp(Ro.background.uniforms),vertexShader:Ro.background.vertexShader,fragmentShader:Ro.background.fragmentShader,side:_c,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(p)),p.material.uniforms.t2D.value=j,p.material.uniforms.backgroundIntensity.value=U.backgroundIntensity,p.material.toneMapped=kn.getTransfer(j.colorSpace)!==$n,j.matrixAutoUpdate===!0&&j.updateMatrix(),p.material.uniforms.uvTransform.value.copy(j.matrix),(v!==j||y!==j.version||w!==n.toneMapping)&&(p.material.needsUpdate=!0,v=j,y=j.version,w=n.toneMapping),p.layers.enableAll(),D.unshift(p,p.geometry,p.material,0,0,null))}function A(D,U){D.getRGB(cy,wk(n)),i.buffers.color.setClear(cy.r,cy.g,cy.b,U,o)}function I(){g!==void 0&&(g.geometry.dispose(),g.material.dispose(),g=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return c},setClearColor:function(D,U=1){c.set(D),h=U,A(c,h)},getClearAlpha:function(){return h},setClearAlpha:function(D){h=D,A(c,h)},render:R,addToRenderList:N,dispose:I}}function ZF(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},s=y(null);let r=s,o=!1;function c(B,Y,ee,Q,ce){let oe=!1;const J=v(Q,ee,Y);r!==J&&(r=J,p(r.object)),oe=w(B,Q,ee,ce),oe&&E(B,Q,ee,ce),ce!==null&&e.update(ce,n.ELEMENT_ARRAY_BUFFER),(oe||o)&&(o=!1,U(B,Y,ee,Q),ce!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(ce).buffer))}function h(){return n.createVertexArray()}function p(B){return n.bindVertexArray(B)}function g(B){return n.deleteVertexArray(B)}function v(B,Y,ee){const Q=ee.wireframe===!0;let ce=i[B.id];ce===void 0&&(ce={},i[B.id]=ce);let oe=ce[Y.id];oe===void 0&&(oe={},ce[Y.id]=oe);let J=oe[Q];return J===void 0&&(J=y(h()),oe[Q]=J),J}function y(B){const Y=[],ee=[],Q=[];for(let ce=0;ce<t;ce++)Y[ce]=0,ee[ce]=0,Q[ce]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Y,enabledAttributes:ee,attributeDivisors:Q,object:B,attributes:{},index:null}}function w(B,Y,ee,Q){const ce=r.attributes,oe=Y.attributes;let J=0;const te=ee.getAttributes();for(const me in te)if(te[me].location>=0){const Ie=ce[me];let $=oe[me];if($===void 0&&(me==="instanceMatrix"&&B.instanceMatrix&&($=B.instanceMatrix),me==="instanceColor"&&B.instanceColor&&($=B.instanceColor)),Ie===void 0||Ie.attribute!==$||$&&Ie.data!==$.data)return!0;J++}return r.attributesNum!==J||r.index!==Q}function E(B,Y,ee,Q){const ce={},oe=Y.attributes;let J=0;const te=ee.getAttributes();for(const me in te)if(te[me].location>=0){let Ie=oe[me];Ie===void 0&&(me==="instanceMatrix"&&B.instanceMatrix&&(Ie=B.instanceMatrix),me==="instanceColor"&&B.instanceColor&&(Ie=B.instanceColor));const $={};$.attribute=Ie,Ie&&Ie.data&&($.data=Ie.data),ce[me]=$,J++}r.attributes=ce,r.attributesNum=J,r.index=Q}function R(){const B=r.newAttributes;for(let Y=0,ee=B.length;Y<ee;Y++)B[Y]=0}function N(B){A(B,0)}function A(B,Y){const ee=r.newAttributes,Q=r.enabledAttributes,ce=r.attributeDivisors;ee[B]=1,Q[B]===0&&(n.enableVertexAttribArray(B),Q[B]=1),ce[B]!==Y&&(n.vertexAttribDivisor(B,Y),ce[B]=Y)}function I(){const B=r.newAttributes,Y=r.enabledAttributes;for(let ee=0,Q=Y.length;ee<Q;ee++)Y[ee]!==B[ee]&&(n.disableVertexAttribArray(ee),Y[ee]=0)}function D(B,Y,ee,Q,ce,oe,J){J===!0?n.vertexAttribIPointer(B,Y,ee,ce,oe):n.vertexAttribPointer(B,Y,ee,Q,ce,oe)}function U(B,Y,ee,Q){R();const ce=Q.attributes,oe=ee.getAttributes(),J=Y.defaultAttributeValues;for(const te in oe){const me=oe[te];if(me.location>=0){let Re=ce[te];if(Re===void 0&&(te==="instanceMatrix"&&B.instanceMatrix&&(Re=B.instanceMatrix),te==="instanceColor"&&B.instanceColor&&(Re=B.instanceColor)),Re!==void 0){const Ie=Re.normalized,$=Re.itemSize,de=e.get(Re);if(de===void 0)continue;const Ne=de.buffer,Fe=de.type,lt=de.bytesPerElement,ge=Fe===n.INT||Fe===n.UNSIGNED_INT||Re.gpuType===Yb;if(Re.isInterleavedBufferAttribute){const Ce=Re.data,nt=Ce.stride,rt=Re.offset;if(Ce.isInstancedInterleavedBuffer){for(let mt=0;mt<me.locationSize;mt++)A(me.location+mt,Ce.meshPerAttribute);B.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let mt=0;mt<me.locationSize;mt++)N(me.location+mt);n.bindBuffer(n.ARRAY_BUFFER,Ne);for(let mt=0;mt<me.locationSize;mt++)D(me.location+mt,$/me.locationSize,Fe,Ie,nt*lt,(rt+$/me.locationSize*mt)*lt,ge)}else{if(Re.isInstancedBufferAttribute){for(let Ce=0;Ce<me.locationSize;Ce++)A(me.location+Ce,Re.meshPerAttribute);B.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=Re.meshPerAttribute*Re.count)}else for(let Ce=0;Ce<me.locationSize;Ce++)N(me.location+Ce);n.bindBuffer(n.ARRAY_BUFFER,Ne);for(let Ce=0;Ce<me.locationSize;Ce++)D(me.location+Ce,$/me.locationSize,Fe,Ie,$*lt,$/me.locationSize*Ce*lt,ge)}}else if(J!==void 0){const Ie=J[te];if(Ie!==void 0)switch(Ie.length){case 2:n.vertexAttrib2fv(me.location,Ie);break;case 3:n.vertexAttrib3fv(me.location,Ie);break;case 4:n.vertexAttrib4fv(me.location,Ie);break;default:n.vertexAttrib1fv(me.location,Ie)}}}}I()}function j(){W();for(const B in i){const Y=i[B];for(const ee in Y){const Q=Y[ee];for(const ce in Q)g(Q[ce].object),delete Q[ce];delete Y[ee]}delete i[B]}}function F(B){if(i[B.id]===void 0)return;const Y=i[B.id];for(const ee in Y){const Q=Y[ee];for(const ce in Q)g(Q[ce].object),delete Q[ce];delete Y[ee]}delete i[B.id]}function z(B){for(const Y in i){const ee=i[Y];if(ee[B.id]===void 0)continue;const Q=ee[B.id];for(const ce in Q)g(Q[ce].object),delete Q[ce];delete ee[B.id]}}function W(){L(),o=!0,r!==s&&(r=s,p(r.object))}function L(){s.geometry=null,s.program=null,s.wireframe=!1}return{setup:c,reset:W,resetDefaultState:L,dispose:j,releaseStatesOfGeometry:F,releaseStatesOfProgram:z,initAttributes:R,enableAttribute:N,disableUnusedAttributes:I}}function QF(n,e,t){let i;function s(p){i=p}function r(p,g){n.drawArrays(i,p,g),t.update(g,i,1)}function o(p,g,v){v!==0&&(n.drawArraysInstanced(i,p,g,v),t.update(g,i,v))}function c(p,g,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,p,0,g,0,v);let w=0;for(let E=0;E<v;E++)w+=g[E];t.update(w,i,1)}function h(p,g,v,y){if(v===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let E=0;E<p.length;E++)o(p[E],g[E],y[E]);else{w.multiDrawArraysInstancedWEBGL(i,p,0,g,0,y,0,v);let E=0;for(let R=0;R<v;R++)E+=g[R]*y[R];t.update(E,i,1)}}this.setMode=s,this.render=r,this.renderInstances=o,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function eB(n,e,t,i){let s;function r(){if(s!==void 0)return s;if(e.has("EXT_texture_filter_anisotropic")===!0){const z=e.get("EXT_texture_filter_anisotropic");s=n.getParameter(z.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else s=0;return s}function o(z){return!(z!==Es&&i.convert(z)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(z){const W=z===Po&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(z!==Er&&i.convert(z)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&z!==Ts&&!W)}function h(z){if(z==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";z="mediump"}return z==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const g=h(p);g!==p&&(ht("WebGLRenderer:",p,"not supported, using",g,"instead."),p=g);const v=t.logarithmicDepthBuffer===!0,y=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),w=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),E=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),R=n.getParameter(n.MAX_TEXTURE_SIZE),N=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),A=n.getParameter(n.MAX_VERTEX_ATTRIBS),I=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),D=n.getParameter(n.MAX_VARYING_VECTORS),U=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),j=n.getParameter(n.MAX_SAMPLES),F=n.getParameter(n.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:h,textureFormatReadable:o,textureTypeReadable:c,precision:p,logarithmicDepthBuffer:v,reversedDepthBuffer:y,maxTextures:w,maxVertexTextures:E,maxTextureSize:R,maxCubemapSize:N,maxAttributes:A,maxVertexUniforms:I,maxVaryings:D,maxFragmentUniforms:U,maxSamples:j,samples:F}}function tB(n){const e=this;let t=null,i=0,s=!1,r=!1;const o=new Nu,c=new on,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(v,y){const w=v.length!==0||y||i!==0||s;return s=y,i=v.length,w},this.beginShadows=function(){r=!0,g(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(v,y){t=g(v,y,0)},this.setState=function(v,y,w){const E=v.clippingPlanes,R=v.clipIntersection,N=v.clipShadows,A=n.get(v);if(!s||E===null||E.length===0||r&&!N)r?g(null):p();else{const I=r?0:i,D=I*4;let U=A.clippingState||null;h.value=U,U=g(E,y,D,w);for(let j=0;j!==D;++j)U[j]=t[j];A.clippingState=U,this.numIntersection=R?this.numPlanes:0,this.numPlanes+=I}};function p(){h.value!==t&&(h.value=t,h.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function g(v,y,w,E){const R=v!==null?v.length:0;let N=null;if(R!==0){if(N=h.value,E!==!0||N===null){const A=w+R*4,I=y.matrixWorldInverse;c.getNormalMatrix(I),(N===null||N.length<A)&&(N=new Float32Array(A));for(let D=0,U=w;D!==R;++D,U+=4)o.copy(v[D]).applyMatrix4(I,c),o.normal.toArray(N,U),N[U+3]=o.constant}h.value=N,h.needsUpdate=!0}return e.numPlanes=R,e.numIntersection=0,N}}function nB(n){let e=new WeakMap;function t(o,c){return c===t0?o.mapping=Tl:c===n0&&(o.mapping=Lu),o}function i(o){if(o&&o.isTexture){const c=o.mapping;if(c===t0||c===n0)if(e.has(o)){const h=e.get(o).texture;return t(h,o.mapping)}else{const h=o.image;if(h&&h.height>0){const p=new lT(h.height);return p.fromEquirectangularTexture(n,o),e.set(o,p),o.addEventListener("dispose",s),t(p.texture,o.mapping)}else return null}}return o}function s(o){const c=o.target;c.removeEventListener("dispose",s);const h=e.get(c);h!==void 0&&(e.delete(c),h.dispose())}function r(){e=new WeakMap}return{get:i,dispose:r}}const Pu=4,kA=[.125,.215,.35,.446,.526,.582],eh=20,iB=256,Sg=new yh,IA=new _t;let xS=null,vS=0,yS=0,bS=!1;const sB=new K;class d1{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,i=.1,s=100,r={}){const{size:o=256,position:c=sB}=r;xS=this._renderer.getRenderTarget(),vS=this._renderer.getActiveCubeFace(),yS=this._renderer.getActiveMipmapLevel(),bS=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const h=this._allocateTargets();return h.depthBuffer=!0,this._sceneToCubeUV(e,i,s,h,c),t>0&&this._blur(h,0,0,t),this._applyPMREM(h),this._cleanup(h),h}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=UA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=PA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(xS,vS,yS),this._renderer.xr.enabled=bS,e.scissorTest=!1,ep(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Tl||e.mapping===Lu?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),xS=this._renderer.getRenderTarget(),vS=this._renderer.getActiveCubeFace(),yS=this._renderer.getActiveMipmapLevel(),bS=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:si,minFilter:si,generateMipmaps:!1,type:Po,format:Es,colorSpace:Ou,depthBuffer:!1},s=DA(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=DA(e,t,i);const{_lodMax:r}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=rB(r)),this._blurMaterial=oB(r,e,t),this._ggxMaterial=aB(r,e,t)}return s}_compileMaterial(e){const t=new os(new sn,e);this._renderer.compile(t,Sg)}_sceneToCubeUV(e,t,i,s,r){const h=new Ss(90,1,t,i),p=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],v=this._renderer,y=v.autoClear,w=v.toneMapping;v.getClearColor(IA),v.toneMapping=Xa,v.autoClear=!1,v.state.buffers.depth.getReversed()&&(v.setRenderTarget(s),v.clearDepth(),v.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new os(new gh,new Hu({name:"PMREM.Background",side:Ar,depthWrite:!1,depthTest:!1})));const R=this._backgroundBox,N=R.material;let A=!1;const I=e.background;I?I.isColor&&(N.color.copy(I),e.background=null,A=!0):(N.color.copy(IA),A=!0);for(let D=0;D<6;D++){const U=D%3;U===0?(h.up.set(0,p[D],0),h.position.set(r.x,r.y,r.z),h.lookAt(r.x+g[D],r.y,r.z)):U===1?(h.up.set(0,0,p[D]),h.position.set(r.x,r.y,r.z),h.lookAt(r.x,r.y+g[D],r.z)):(h.up.set(0,p[D],0),h.position.set(r.x,r.y,r.z),h.lookAt(r.x,r.y,r.z+g[D]));const j=this._cubeSize;ep(s,U*j,D>2?j:0,j,j),v.setRenderTarget(s),A&&v.render(R,h),v.render(e,h)}v.toneMapping=w,v.autoClear=y,e.background=I}_textureToCubeUV(e,t){const i=this._renderer,s=e.mapping===Tl||e.mapping===Lu;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=UA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=PA());const r=s?this._cubemapMaterial:this._equirectMaterial,o=this._lodMeshes[0];o.material=r;const c=r.uniforms;c.envMap.value=e;const h=this._cubeSize;ep(t,0,0,3*h,2*h),i.setRenderTarget(t),i.render(o,Sg)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const s=this._lodMeshes.length;for(let r=1;r<s;r++)this._applyGGXFilter(e,r-1,r);t.autoClear=i}_applyGGXFilter(e,t,i){const s=this._renderer,r=this._pingPongRenderTarget,o=this._ggxMaterial,c=this._lodMeshes[i];c.material=o;const h=o.uniforms,p=i/(this._lodMeshes.length-1),g=t/(this._lodMeshes.length-1),v=Math.sqrt(p*p-g*g),y=0+p*1.25,w=v*y,{_lodMax:E}=this,R=this._sizeLods[i],N=3*R*(i>E-Pu?i-E+Pu:0),A=4*(this._cubeSize-R);h.envMap.value=e.texture,h.roughness.value=w,h.mipInt.value=E-t,ep(r,N,A,3*R,2*R),s.setRenderTarget(r),s.render(c,Sg),h.envMap.value=r.texture,h.roughness.value=0,h.mipInt.value=E-i,ep(e,N,A,3*R,2*R),s.setRenderTarget(e),s.render(c,Sg)}_blur(e,t,i,s,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,s,"latitudinal",r),this._halfBlur(o,e,i,i,s,"longitudinal",r)}_halfBlur(e,t,i,s,r,o,c){const h=this._renderer,p=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&Dt("blur direction must be either latitudinal or longitudinal!");const g=3,v=this._lodMeshes[s];v.material=p;const y=p.uniforms,w=this._sizeLods[i]-1,E=isFinite(r)?Math.PI/(2*w):2*Math.PI/(2*eh-1),R=r/E,N=isFinite(r)?1+Math.floor(g*R):eh;N>eh&&ht(`sigmaRadians, ${r}, is too large and will clip, as it requested ${N} samples when the maximum is set to ${eh}`);const A=[];let I=0;for(let z=0;z<eh;++z){const W=z/R,L=Math.exp(-W*W/2);A.push(L),z===0?I+=L:z<N&&(I+=2*L)}for(let z=0;z<A.length;z++)A[z]=A[z]/I;y.envMap.value=e.texture,y.samples.value=N,y.weights.value=A,y.latitudinal.value=o==="latitudinal",c&&(y.poleAxis.value=c);const{_lodMax:D}=this;y.dTheta.value=E,y.mipInt.value=D-i;const U=this._sizeLods[s],j=3*U*(s>D-Pu?s-D+Pu:0),F=4*(this._cubeSize-U);ep(t,j,F,3*U,2*U),h.setRenderTarget(t),h.render(v,Sg)}}function rB(n){const e=[],t=[],i=[];let s=n;const r=n-Pu+1+kA.length;for(let o=0;o<r;o++){const c=Math.pow(2,s);e.push(c);let h=1/c;o>n-Pu?h=kA[o-n+Pu-1]:o===0&&(h=0),t.push(h);const p=1/(c-2),g=-p,v=1+p,y=[g,g,v,g,v,v,g,g,v,v,g,v],w=6,E=6,R=3,N=2,A=1,I=new Float32Array(R*E*w),D=new Float32Array(N*E*w),U=new Float32Array(A*E*w);for(let F=0;F<w;F++){const z=F%3*2/3-1,W=F>2?0:-1,L=[z,W,0,z+2/3,W,0,z+2/3,W+1,0,z,W,0,z+2/3,W+1,0,z,W+1,0];I.set(L,R*E*F),D.set(y,N*E*F);const B=[F,F,F,F,F,F];U.set(B,A*E*F)}const j=new sn;j.setAttribute("position",new ei(I,R)),j.setAttribute("uv",new ei(D,N)),j.setAttribute("faceIndex",new ei(U,A)),i.push(new os(j,null)),s>Pu&&s--}return{lodMeshes:i,sizeLods:e,sigmas:t}}function DA(n,e,t){const i=new ta(n,e,t);return i.texture.mapping=Rp,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function ep(n,e,t,i,s){n.viewport.set(e,t,i,s),n.scissor.set(e,t,i,s)}function aB(n,e,t){return new na({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:iB,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:N_(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:wl,depthTest:!1,depthWrite:!1})}function oB(n,e,t){const i=new Float32Array(eh),s=new K(0,1,0);return new na({name:"SphericalGaussianBlur",defines:{n:eh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:N_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:wl,depthTest:!1,depthWrite:!1})}function PA(){return new na({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:N_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:wl,depthTest:!1,depthWrite:!1})}function UA(){return new na({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:N_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:wl,depthTest:!1,depthWrite:!1})}function N_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function lB(n){let e=new WeakMap,t=null;function i(c){if(c&&c.isTexture){const h=c.mapping,p=h===t0||h===n0,g=h===Tl||h===Lu;if(p||g){let v=e.get(c);const y=v!==void 0?v.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==y)return t===null&&(t=new d1(n)),v=p?t.fromEquirectangular(c,v):t.fromCubemap(c,v),v.texture.pmremVersion=c.pmremVersion,e.set(c,v),v.texture;if(v!==void 0)return v.texture;{const w=c.image;return p&&w&&w.height>0||g&&w&&s(w)?(t===null&&(t=new d1(n)),v=p?t.fromEquirectangular(c):t.fromCubemap(c),v.texture.pmremVersion=c.pmremVersion,e.set(c,v),c.addEventListener("dispose",r),v.texture):null}}}return c}function s(c){let h=0;const p=6;for(let g=0;g<p;g++)c[g]!==void 0&&h++;return h===p}function r(c){const h=c.target;h.removeEventListener("dispose",r);const p=e.get(h);p!==void 0&&(e.delete(h),p.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function cB(n){const e={};function t(i){if(e[i]!==void 0)return e[i];const s=n.getExtension(i);return e[i]=s,s}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const s=t(i);return s===null&&Sp("WebGLRenderer: "+i+" extension not supported."),s}}}function uB(n,e,t,i){const s={},r=new WeakMap;function o(v){const y=v.target;y.index!==null&&e.remove(y.index);for(const E in y.attributes)e.remove(y.attributes[E]);y.removeEventListener("dispose",o),delete s[y.id];const w=r.get(y);w&&(e.remove(w),r.delete(y)),i.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function c(v,y){return s[y.id]===!0||(y.addEventListener("dispose",o),s[y.id]=!0,t.memory.geometries++),y}function h(v){const y=v.attributes;for(const w in y)e.update(y[w],n.ARRAY_BUFFER)}function p(v){const y=[],w=v.index,E=v.attributes.position;let R=0;if(w!==null){const I=w.array;R=w.version;for(let D=0,U=I.length;D<U;D+=3){const j=I[D+0],F=I[D+1],z=I[D+2];y.push(j,F,F,z,z,j)}}else if(E!==void 0){const I=E.array;R=E.version;for(let D=0,U=I.length/3-1;D<U;D+=3){const j=D+0,F=D+1,z=D+2;y.push(j,F,F,z,z,j)}}else return;const N=new(xk(y)?oT:aT)(y,1);N.version=R;const A=r.get(v);A&&e.remove(A),r.set(v,N)}function g(v){const y=r.get(v);if(y){const w=v.index;w!==null&&y.version<w.version&&p(v)}else p(v);return r.get(v)}return{get:c,update:h,getWireframeAttribute:g}}function dB(n,e,t){let i;function s(y){i=y}let r,o;function c(y){r=y.type,o=y.bytesPerElement}function h(y,w){n.drawElements(i,w,r,y*o),t.update(w,i,1)}function p(y,w,E){E!==0&&(n.drawElementsInstanced(i,w,r,y*o,E),t.update(w,i,E))}function g(y,w,E){if(E===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,w,0,r,y,0,E);let N=0;for(let A=0;A<E;A++)N+=w[A];t.update(N,i,1)}function v(y,w,E,R){if(E===0)return;const N=e.get("WEBGL_multi_draw");if(N===null)for(let A=0;A<y.length;A++)p(y[A]/o,w[A],R[A]);else{N.multiDrawElementsInstancedWEBGL(i,w,0,r,y,0,R,0,E);let A=0;for(let I=0;I<E;I++)A+=w[I]*R[I];t.update(A,i,1)}}this.setMode=s,this.setIndex=c,this.render=h,this.renderInstances=p,this.renderMultiDraw=g,this.renderMultiDrawInstances=v}function hB(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(r,o,c){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=c*(r/3);break;case n.LINES:t.lines+=c*(r/2);break;case n.LINE_STRIP:t.lines+=c*(r-1);break;case n.LINE_LOOP:t.lines+=c*r;break;case n.POINTS:t.points+=c*r;break;default:Dt("WebGLInfo: Unknown draw mode:",o);break}}function s(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:s,update:i}}function fB(n,e,t){const i=new WeakMap,s=new ii;function r(o,c,h){const p=o.morphTargetInfluences,g=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,v=g!==void 0?g.length:0;let y=i.get(c);if(y===void 0||y.count!==v){let B=function(){W.dispose(),i.delete(c),c.removeEventListener("dispose",B)};var w=B;y!==void 0&&y.texture.dispose();const E=c.morphAttributes.position!==void 0,R=c.morphAttributes.normal!==void 0,N=c.morphAttributes.color!==void 0,A=c.morphAttributes.position||[],I=c.morphAttributes.normal||[],D=c.morphAttributes.color||[];let U=0;E===!0&&(U=1),R===!0&&(U=2),N===!0&&(U=3);let j=c.attributes.position.count*U,F=1;j>e.maxTextureSize&&(F=Math.ceil(j/e.maxTextureSize),j=e.maxTextureSize);const z=new Float32Array(j*F*4*v),W=new s_(z,j,F,v);W.type=Ts,W.needsUpdate=!0;const L=U*4;for(let Y=0;Y<v;Y++){const ee=A[Y],Q=I[Y],ce=D[Y],oe=j*F*4*Y;for(let J=0;J<ee.count;J++){const te=J*L;E===!0&&(s.fromBufferAttribute(ee,J),z[oe+te+0]=s.x,z[oe+te+1]=s.y,z[oe+te+2]=s.z,z[oe+te+3]=0),R===!0&&(s.fromBufferAttribute(Q,J),z[oe+te+4]=s.x,z[oe+te+5]=s.y,z[oe+te+6]=s.z,z[oe+te+7]=0),N===!0&&(s.fromBufferAttribute(ce,J),z[oe+te+8]=s.x,z[oe+te+9]=s.y,z[oe+te+10]=s.z,z[oe+te+11]=ce.itemSize===4?s.w:1)}}y={count:v,texture:W,size:new Be(j,F)},i.set(c,y),c.addEventListener("dispose",B)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)h.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let E=0;for(let N=0;N<p.length;N++)E+=p[N];const R=c.morphTargetsRelative?1:1-E;h.getUniforms().setValue(n,"morphTargetBaseInfluence",R),h.getUniforms().setValue(n,"morphTargetInfluences",p)}h.getUniforms().setValue(n,"morphTargetsTexture",y.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",y.size)}return{update:r}}function pB(n,e,t,i){let s=new WeakMap;function r(h){const p=i.render.frame,g=h.geometry,v=e.get(h,g);if(s.get(v)!==p&&(e.update(v),s.set(v,p)),h.isInstancedMesh&&(h.hasEventListener("dispose",c)===!1&&h.addEventListener("dispose",c),s.get(h)!==p&&(t.update(h.instanceMatrix,n.ARRAY_BUFFER),h.instanceColor!==null&&t.update(h.instanceColor,n.ARRAY_BUFFER),s.set(h,p))),h.isSkinnedMesh){const y=h.skeleton;s.get(y)!==p&&(y.update(),s.set(y,p))}return v}function o(){s=new WeakMap}function c(h){const p=h.target;p.removeEventListener("dispose",c),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:r,dispose:o}}const mB={[G1]:"LINEAR_TONE_MAPPING",[q1]:"REINHARD_TONE_MAPPING",[W1]:"CINEON_TONE_MAPPING",[$b]:"ACES_FILMIC_TONE_MAPPING",[X1]:"AGX_TONE_MAPPING",[Y1]:"NEUTRAL_TONE_MAPPING",[$1]:"CUSTOM_TONE_MAPPING"};function gB(n,e,t,i,s){const r=new ta(e,t,{type:n,depthBuffer:i,stencilBuffer:s}),o=new ta(e,t,{type:Po,depthBuffer:!1,stencilBuffer:!1}),c=new sn;c.setAttribute("position",new Et([-1,3,0,-1,-1,0,3,-1,0],3)),c.setAttribute("uv",new Et([0,2,0,0,2,0],2));const h=new yT({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),p=new os(c,h),g=new yh(-1,1,1,-1,0,1);let v=null,y=null,w=!1,E,R=null,N=[],A=!1;this.setSize=function(I,D){r.setSize(I,D),o.setSize(I,D);for(let U=0;U<N.length;U++){const j=N[U];j.setSize&&j.setSize(I,D)}},this.setEffects=function(I){N=I,A=N.length>0&&N[0].isRenderPass===!0;const D=r.width,U=r.height;for(let j=0;j<N.length;j++){const F=N[j];F.setSize&&F.setSize(D,U)}},this.begin=function(I,D){if(w||I.toneMapping===Xa&&N.length===0)return!1;if(R=D,D!==null){const U=D.width,j=D.height;(r.width!==U||r.height!==j)&&this.setSize(U,j)}return A===!1&&I.setRenderTarget(r),E=I.toneMapping,I.toneMapping=Xa,!0},this.hasRenderPass=function(){return A},this.end=function(I,D){I.toneMapping=E,w=!0;let U=r,j=o;for(let F=0;F<N.length;F++){const z=N[F];if(z.enabled!==!1&&(z.render(I,j,U,D),z.needsSwap!==!1)){const W=U;U=j,j=W}}if(v!==I.outputColorSpace||y!==I.toneMapping){v=I.outputColorSpace,y=I.toneMapping,h.defines={},kn.getTransfer(v)===$n&&(h.defines.SRGB_TRANSFER="");const F=mB[y];F&&(h.defines[F]=""),h.needsUpdate=!0}h.uniforms.tDiffuse.value=U.texture,I.setRenderTarget(R),I.render(p,g),R=null,w=!1},this.isCompositing=function(){return w},this.dispose=function(){r.dispose(),o.dispose(),c.dispose(),h.dispose()}}const bI=new Bi,h1=new fh(1,1),_I=new s_,wI=new r_,SI=new M0,LA=[],OA=[],zA=new Float32Array(16),jA=new Float32Array(9),FA=new Float32Array(4);function Pp(n,e,t){const i=n[0];if(i<=0||i>0)return n;const s=e*t;let r=LA[s];if(r===void 0&&(r=new Float32Array(s),LA[s]=r),e!==0){i.toArray(r,0);for(let o=1,c=0;o!==e;++o)c+=t,n[o].toArray(r,c)}return r}function ms(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function gs(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function C_(n,e){let t=OA[e];t===void 0&&(t=new Int32Array(e),OA[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function xB(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function vB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ms(t,e))return;n.uniform2fv(this.addr,e),gs(t,e)}}function yB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(ms(t,e))return;n.uniform3fv(this.addr,e),gs(t,e)}}function bB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ms(t,e))return;n.uniform4fv(this.addr,e),gs(t,e)}}function _B(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ms(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),gs(t,e)}else{if(ms(t,i))return;FA.set(i),n.uniformMatrix2fv(this.addr,!1,FA),gs(t,i)}}function wB(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ms(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),gs(t,e)}else{if(ms(t,i))return;jA.set(i),n.uniformMatrix3fv(this.addr,!1,jA),gs(t,i)}}function SB(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(ms(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),gs(t,e)}else{if(ms(t,i))return;zA.set(i),n.uniformMatrix4fv(this.addr,!1,zA),gs(t,i)}}function TB(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function EB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ms(t,e))return;n.uniform2iv(this.addr,e),gs(t,e)}}function MB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ms(t,e))return;n.uniform3iv(this.addr,e),gs(t,e)}}function AB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ms(t,e))return;n.uniform4iv(this.addr,e),gs(t,e)}}function NB(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function CB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(ms(t,e))return;n.uniform2uiv(this.addr,e),gs(t,e)}}function RB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(ms(t,e))return;n.uniform3uiv(this.addr,e),gs(t,e)}}function kB(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(ms(t,e))return;n.uniform4uiv(this.addr,e),gs(t,e)}}function IB(n,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s);let r;this.type===n.SAMPLER_2D_SHADOW?(h1.compareFunction=t.isReversedDepthBuffer()?i_:n_,r=h1):r=bI,t.setTexture2D(e||r,s)}function DB(n,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture3D(e||wI,s)}function PB(n,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTextureCube(e||SI,s)}function UB(n,e,t){const i=this.cache,s=t.allocateTextureUnit();i[0]!==s&&(n.uniform1i(this.addr,s),i[0]=s),t.setTexture2DArray(e||_I,s)}function LB(n){switch(n){case 5126:return xB;case 35664:return vB;case 35665:return yB;case 35666:return bB;case 35674:return _B;case 35675:return wB;case 35676:return SB;case 5124:case 35670:return TB;case 35667:case 35671:return EB;case 35668:case 35672:return MB;case 35669:case 35673:return AB;case 5125:return NB;case 36294:return CB;case 36295:return RB;case 36296:return kB;case 35678:case 36198:case 36298:case 36306:case 35682:return IB;case 35679:case 36299:case 36307:return DB;case 35680:case 36300:case 36308:case 36293:return PB;case 36289:case 36303:case 36311:case 36292:return UB}}function OB(n,e){n.uniform1fv(this.addr,e)}function zB(n,e){const t=Pp(e,this.size,2);n.uniform2fv(this.addr,t)}function jB(n,e){const t=Pp(e,this.size,3);n.uniform3fv(this.addr,t)}function FB(n,e){const t=Pp(e,this.size,4);n.uniform4fv(this.addr,t)}function BB(n,e){const t=Pp(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function VB(n,e){const t=Pp(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function HB(n,e){const t=Pp(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function GB(n,e){n.uniform1iv(this.addr,e)}function qB(n,e){n.uniform2iv(this.addr,e)}function WB(n,e){n.uniform3iv(this.addr,e)}function $B(n,e){n.uniform4iv(this.addr,e)}function XB(n,e){n.uniform1uiv(this.addr,e)}function YB(n,e){n.uniform2uiv(this.addr,e)}function JB(n,e){n.uniform3uiv(this.addr,e)}function KB(n,e){n.uniform4uiv(this.addr,e)}function ZB(n,e,t){const i=this.cache,s=e.length,r=C_(t,s);ms(i,r)||(n.uniform1iv(this.addr,r),gs(i,r));let o;this.type===n.SAMPLER_2D_SHADOW?o=h1:o=bI;for(let c=0;c!==s;++c)t.setTexture2D(e[c]||o,r[c])}function QB(n,e,t){const i=this.cache,s=e.length,r=C_(t,s);ms(i,r)||(n.uniform1iv(this.addr,r),gs(i,r));for(let o=0;o!==s;++o)t.setTexture3D(e[o]||wI,r[o])}function e6(n,e,t){const i=this.cache,s=e.length,r=C_(t,s);ms(i,r)||(n.uniform1iv(this.addr,r),gs(i,r));for(let o=0;o!==s;++o)t.setTextureCube(e[o]||SI,r[o])}function t6(n,e,t){const i=this.cache,s=e.length,r=C_(t,s);ms(i,r)||(n.uniform1iv(this.addr,r),gs(i,r));for(let o=0;o!==s;++o)t.setTexture2DArray(e[o]||_I,r[o])}function n6(n){switch(n){case 5126:return OB;case 35664:return zB;case 35665:return jB;case 35666:return FB;case 35674:return BB;case 35675:return VB;case 35676:return HB;case 5124:case 35670:return GB;case 35667:case 35671:return qB;case 35668:case 35672:return WB;case 35669:case 35673:return $B;case 5125:return XB;case 36294:return YB;case 36295:return JB;case 36296:return KB;case 35678:case 36198:case 36298:case 36306:case 35682:return ZB;case 35679:case 36299:case 36307:return QB;case 35680:case 36300:case 36308:case 36293:return e6;case 36289:case 36303:case 36311:case 36292:return t6}}class i6{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=LB(t.type)}}class s6{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=n6(t.type)}}class r6{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const s=this.seq;for(let r=0,o=s.length;r!==o;++r){const c=s[r];c.setValue(e,t[c.id],i)}}}const _S=/(\w+)(\])?(\[|\.)?/g;function BA(n,e){n.seq.push(e),n.map[e.id]=e}function a6(n,e,t){const i=n.name,s=i.length;for(_S.lastIndex=0;;){const r=_S.exec(i),o=_S.lastIndex;let c=r[1];const h=r[2]==="]",p=r[3];if(h&&(c=c|0),p===void 0||p==="["&&o+2===s){BA(t,p===void 0?new i6(c,n,e):new s6(c,n,e));break}else{let v=t.map[c];v===void 0&&(v=new r6(c),BA(t,v)),t=v}}}class _y{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let o=0;o<i;++o){const c=e.getActiveUniform(t,o),h=e.getUniformLocation(t,c.name);a6(c,h,this)}const s=[],r=[];for(const o of this.seq)o.type===e.SAMPLER_2D_SHADOW||o.type===e.SAMPLER_CUBE_SHADOW||o.type===e.SAMPLER_2D_ARRAY_SHADOW?s.push(o):r.push(o);s.length>0&&(this.seq=s.concat(r))}setValue(e,t,i,s){const r=this.map[t];r!==void 0&&r.setValue(e,i,s)}setOptional(e,t,i){const s=t[i];s!==void 0&&this.setValue(e,i,s)}static upload(e,t,i,s){for(let r=0,o=t.length;r!==o;++r){const c=t[r],h=i[c.id];h.needsUpdate!==!1&&c.setValue(e,h.value,s)}}static seqWithValue(e,t){const i=[];for(let s=0,r=e.length;s!==r;++s){const o=e[s];o.id in t&&i.push(o)}return i}}function VA(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const o6=37297;let l6=0;function c6(n,e){const t=n.split(`
`),i=[],s=Math.max(e-6,0),r=Math.min(e+6,t.length);for(let o=s;o<r;o++){const c=o+1;i.push(`${c===e?">":" "} ${c}: ${t[o]}`)}return i.join(`
`)}const HA=new on;function u6(n){kn._getMatrix(HA,kn.workingColorSpace,n);const e=`mat3( ${HA.elements.map(t=>t.toFixed(4))} )`;switch(kn.getTransfer(n)){case o0:return[e,"LinearTransferOETF"];case $n:return[e,"sRGBTransferOETF"];default:return ht("WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function GA(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=(n.getShaderInfoLog(e)||"").trim();if(i&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const c=parseInt(o[1]);return t.toUpperCase()+`

`+r+`

`+c6(n.getShaderSource(e),c)}else return r}function d6(n,e){const t=u6(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const h6={[G1]:"Linear",[q1]:"Reinhard",[W1]:"Cineon",[$b]:"ACESFilmic",[X1]:"AgX",[Y1]:"Neutral",[$1]:"Custom"};function f6(n,e){const t=h6[e];return t===void 0?(ht("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+n+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const uy=new K;function p6(){kn.getLuminanceCoefficients(uy);const n=uy.x.toFixed(4),e=uy.y.toFixed(4),t=uy.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function m6(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Dg).join(`
`)}function g6(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function x6(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const r=n.getActiveAttrib(e,s),o=r.name;let c=1;r.type===n.FLOAT_MAT2&&(c=2),r.type===n.FLOAT_MAT3&&(c=3),r.type===n.FLOAT_MAT4&&(c=4),t[o]={type:r.type,location:n.getAttribLocation(e,o),locationSize:c}}return t}function Dg(n){return n!==""}function qA(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function WA(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const v6=/^[ \t]*#include +<([\w\d./]+)>/gm;function f1(n){return n.replace(v6,b6)}const y6=new Map;function b6(n,e){let t=mn[e];if(t===void 0){const i=y6.get(e);if(i!==void 0)t=mn[i],ht('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return f1(t)}const _6=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function $A(n){return n.replace(_6,w6)}function w6(n,e,t,i){let s="";for(let r=parseInt(e);r<parseInt(t);r++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return s}function XA(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const S6={[mp]:"SHADOWMAP_TYPE_PCF",[nh]:"SHADOWMAP_TYPE_VSM"};function T6(n){return S6[n.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const E6={[Tl]:"ENVMAP_TYPE_CUBE",[Lu]:"ENVMAP_TYPE_CUBE",[Rp]:"ENVMAP_TYPE_CUBE_UV"};function M6(n){return n.envMap===!1?"ENVMAP_TYPE_CUBE":E6[n.envMapMode]||"ENVMAP_TYPE_CUBE"}const A6={[Lu]:"ENVMAP_MODE_REFRACTION"};function N6(n){return n.envMap===!1?"ENVMAP_MODE_REFLECTION":A6[n.envMapMode]||"ENVMAP_MODE_REFLECTION"}const C6={[T0]:"ENVMAP_BLENDING_MULTIPLY",[ik]:"ENVMAP_BLENDING_MIX",[sk]:"ENVMAP_BLENDING_ADD"};function R6(n){return n.envMap===!1?"ENVMAP_BLENDING_NONE":C6[n.combine]||"ENVMAP_BLENDING_NONE"}function k6(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}function I6(n,e,t,i){const s=n.getContext(),r=t.defines;let o=t.vertexShader,c=t.fragmentShader;const h=T6(t),p=M6(t),g=N6(t),v=R6(t),y=k6(t),w=m6(t),E=g6(r),R=s.createProgram();let N,A,I=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(N=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E].filter(Dg).join(`
`),N.length>0&&(N+=`
`),A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E].filter(Dg).join(`
`),A.length>0&&(A+=`
`)):(N=[XA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Dg).join(`
`),A=[XA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,E,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+g:"",t.envMap?"#define "+v:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Xa?"#define TONE_MAPPING":"",t.toneMapping!==Xa?mn.tonemapping_pars_fragment:"",t.toneMapping!==Xa?f6("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",mn.colorspace_pars_fragment,d6("linearToOutputTexel",t.outputColorSpace),p6(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Dg).join(`
`)),o=f1(o),o=qA(o,t),o=WA(o,t),c=f1(c),c=qA(c,t),c=WA(c,t),o=$A(o),c=$A(c),t.isRawShaderMaterial!==!0&&(I=`#version 300 es
`,N=[w,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+N,A=["#define varying in",t.glslVersion===i1?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===i1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+A);const D=I+N+o,U=I+A+c,j=VA(s,s.VERTEX_SHADER,D),F=VA(s,s.FRAGMENT_SHADER,U);s.attachShader(R,j),s.attachShader(R,F),t.index0AttributeName!==void 0?s.bindAttribLocation(R,0,t.index0AttributeName):t.morphTargets===!0&&s.bindAttribLocation(R,0,"position"),s.linkProgram(R);function z(Y){if(n.debug.checkShaderErrors){const ee=s.getProgramInfoLog(R)||"",Q=s.getShaderInfoLog(j)||"",ce=s.getShaderInfoLog(F)||"",oe=ee.trim(),J=Q.trim(),te=ce.trim();let me=!0,Re=!0;if(s.getProgramParameter(R,s.LINK_STATUS)===!1)if(me=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,R,j,F);else{const Ie=GA(s,j,"vertex"),$=GA(s,F,"fragment");Dt("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(R,s.VALIDATE_STATUS)+`

Material Name: `+Y.name+`
Material Type: `+Y.type+`

Program Info Log: `+oe+`
`+Ie+`
`+$)}else oe!==""?ht("WebGLProgram: Program Info Log:",oe):(J===""||te==="")&&(Re=!1);Re&&(Y.diagnostics={runnable:me,programLog:oe,vertexShader:{log:J,prefix:N},fragmentShader:{log:te,prefix:A}})}s.deleteShader(j),s.deleteShader(F),W=new _y(s,R),L=x6(s,R)}let W;this.getUniforms=function(){return W===void 0&&z(this),W};let L;this.getAttributes=function(){return L===void 0&&z(this),L};let B=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return B===!1&&(B=s.getProgramParameter(R,o6)),B},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(R),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=l6++,this.cacheKey=e,this.usedTimes=1,this.program=R,this.vertexShader=j,this.fragmentShader=F,this}let D6=0;class P6{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,s=this._getShaderStage(t),r=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(s)===!1&&(o.add(s),s.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new U6(e),t.set(e,i)),i}}class U6{constructor(e){this.id=D6++,this.code=e,this.usedTimes=0}}function L6(n,e,t,i,s,r,o){const c=new Ep,h=new P6,p=new Set,g=[],v=new Map,y=s.logarithmicDepthBuffer;let w=s.precision;const E={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function R(L){return p.add(L),L===0?"uv":`uv${L}`}function N(L,B,Y,ee,Q){const ce=ee.fog,oe=Q.geometry,J=L.isMeshStandardMaterial?ee.environment:null,te=(L.isMeshStandardMaterial?t:e).get(L.envMap||J),me=te&&te.mapping===Rp?te.image.height:null,Re=E[L.type];L.precision!==null&&(w=s.getMaxPrecision(L.precision),w!==L.precision&&ht("WebGLProgram.getParameters:",L.precision,"not supported, using",w,"instead."));const Ie=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,$=Ie!==void 0?Ie.length:0;let de=0;oe.morphAttributes.position!==void 0&&(de=1),oe.morphAttributes.normal!==void 0&&(de=2),oe.morphAttributes.color!==void 0&&(de=3);let Ne,Fe,lt,ge;if(Re){const An=Ro[Re];Ne=An.vertexShader,Fe=An.fragmentShader}else Ne=L.vertexShader,Fe=L.fragmentShader,h.update(L),lt=h.getVertexShaderID(L),ge=h.getFragmentShaderID(L);const Ce=n.getRenderTarget(),nt=n.state.buffers.depth.getReversed(),rt=Q.isInstancedMesh===!0,mt=Q.isBatchedMesh===!0,ln=!!L.map,vn=!!L.matcap,zt=!!te,Pe=!!L.aoMap,qe=!!L.lightMap,Oe=!!L.bumpMap,it=!!L.normalMap,Z=!!L.displacementMap,Nt=!!L.emissiveMap,ot=!!L.metalnessMap,Rt=!!L.roughnessMap,Je=L.anisotropy>0,X=L.clearcoat>0,V=L.dispersion>0,ae=L.iridescence>0,Ee=L.sheen>0,ze=L.transmission>0,Me=Je&&!!L.anisotropyMap,gt=X&&!!L.clearcoatMap,Qe=X&&!!L.clearcoatNormalMap,St=X&&!!L.clearcoatRoughnessMap,Ut=ae&&!!L.iridescenceMap,He=ae&&!!L.iridescenceThicknessMap,Ye=Ee&&!!L.sheenColorMap,xt=Ee&&!!L.sheenRoughnessMap,pt=!!L.specularMap,st=!!L.specularColorMap,rn=!!L.specularIntensityMap,re=ze&&!!L.transmissionMap,ct=ze&&!!L.thicknessMap,Xe=!!L.gradientMap,dt=!!L.alphaMap,Ge=L.alphaTest>0,Le=!!L.alphaHash,et=!!L.extensions;let $t=Xa;L.toneMapped&&(Ce===null||Ce.isXRRenderTarget===!0)&&($t=n.toneMapping);const Tn={shaderID:Re,shaderType:L.type,shaderName:L.name,vertexShader:Ne,fragmentShader:Fe,defines:L.defines,customVertexShaderID:lt,customFragmentShaderID:ge,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:w,batching:mt,batchingColor:mt&&Q._colorsTexture!==null,instancing:rt,instancingColor:rt&&Q.instanceColor!==null,instancingMorph:rt&&Q.morphTexture!==null,outputColorSpace:Ce===null?n.outputColorSpace:Ce.isXRRenderTarget===!0?Ce.texture.colorSpace:Ou,alphaToCoverage:!!L.alphaToCoverage,map:ln,matcap:vn,envMap:zt,envMapMode:zt&&te.mapping,envMapCubeUVHeight:me,aoMap:Pe,lightMap:qe,bumpMap:Oe,normalMap:it,displacementMap:Z,emissiveMap:Nt,normalMapObjectSpace:it&&L.normalMapType===uk,normalMapTangentSpace:it&&L.normalMapType===Vu,metalnessMap:ot,roughnessMap:Rt,anisotropy:Je,anisotropyMap:Me,clearcoat:X,clearcoatMap:gt,clearcoatNormalMap:Qe,clearcoatRoughnessMap:St,dispersion:V,iridescence:ae,iridescenceMap:Ut,iridescenceThicknessMap:He,sheen:Ee,sheenColorMap:Ye,sheenRoughnessMap:xt,specularMap:pt,specularColorMap:st,specularIntensityMap:rn,transmission:ze,transmissionMap:re,thicknessMap:ct,gradientMap:Xe,opaque:L.transparent===!1&&L.blending===ah&&L.alphaToCoverage===!1,alphaMap:dt,alphaTest:Ge,alphaHash:Le,combine:L.combine,mapUv:ln&&R(L.map.channel),aoMapUv:Pe&&R(L.aoMap.channel),lightMapUv:qe&&R(L.lightMap.channel),bumpMapUv:Oe&&R(L.bumpMap.channel),normalMapUv:it&&R(L.normalMap.channel),displacementMapUv:Z&&R(L.displacementMap.channel),emissiveMapUv:Nt&&R(L.emissiveMap.channel),metalnessMapUv:ot&&R(L.metalnessMap.channel),roughnessMapUv:Rt&&R(L.roughnessMap.channel),anisotropyMapUv:Me&&R(L.anisotropyMap.channel),clearcoatMapUv:gt&&R(L.clearcoatMap.channel),clearcoatNormalMapUv:Qe&&R(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:St&&R(L.clearcoatRoughnessMap.channel),iridescenceMapUv:Ut&&R(L.iridescenceMap.channel),iridescenceThicknessMapUv:He&&R(L.iridescenceThicknessMap.channel),sheenColorMapUv:Ye&&R(L.sheenColorMap.channel),sheenRoughnessMapUv:xt&&R(L.sheenRoughnessMap.channel),specularMapUv:pt&&R(L.specularMap.channel),specularColorMapUv:st&&R(L.specularColorMap.channel),specularIntensityMapUv:rn&&R(L.specularIntensityMap.channel),transmissionMapUv:re&&R(L.transmissionMap.channel),thicknessMapUv:ct&&R(L.thicknessMap.channel),alphaMapUv:dt&&R(L.alphaMap.channel),vertexTangents:!!oe.attributes.tangent&&(it||Je),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!oe.attributes.color&&oe.attributes.color.itemSize===4,pointsUvs:Q.isPoints===!0&&!!oe.attributes.uv&&(ln||dt),fog:!!ce,useFog:L.fog===!0,fogExp2:!!ce&&ce.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:y,reversedDepthBuffer:nt,skinning:Q.isSkinnedMesh===!0,morphTargets:oe.morphAttributes.position!==void 0,morphNormals:oe.morphAttributes.normal!==void 0,morphColors:oe.morphAttributes.color!==void 0,morphTargetsCount:$,morphTextureStride:de,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numSpotLightMaps:B.spotLightMap.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numSpotLightShadowsWithMaps:B.numSpotLightShadowsWithMaps,numLightProbes:B.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:L.dithering,shadowMapEnabled:n.shadowMap.enabled&&Y.length>0,shadowMapType:n.shadowMap.type,toneMapping:$t,decodeVideoTexture:ln&&L.map.isVideoTexture===!0&&kn.getTransfer(L.map.colorSpace)===$n,decodeVideoTextureEmissive:Nt&&L.emissiveMap.isVideoTexture===!0&&kn.getTransfer(L.emissiveMap.colorSpace)===$n,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===yl,flipSided:L.side===Ar,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:et&&L.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(et&&L.extensions.multiDraw===!0||mt)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return Tn.vertexUv1s=p.has(1),Tn.vertexUv2s=p.has(2),Tn.vertexUv3s=p.has(3),p.clear(),Tn}function A(L){const B=[];if(L.shaderID?B.push(L.shaderID):(B.push(L.customVertexShaderID),B.push(L.customFragmentShaderID)),L.defines!==void 0)for(const Y in L.defines)B.push(Y),B.push(L.defines[Y]);return L.isRawShaderMaterial===!1&&(I(B,L),D(B,L),B.push(n.outputColorSpace)),B.push(L.customProgramCacheKey),B.join()}function I(L,B){L.push(B.precision),L.push(B.outputColorSpace),L.push(B.envMapMode),L.push(B.envMapCubeUVHeight),L.push(B.mapUv),L.push(B.alphaMapUv),L.push(B.lightMapUv),L.push(B.aoMapUv),L.push(B.bumpMapUv),L.push(B.normalMapUv),L.push(B.displacementMapUv),L.push(B.emissiveMapUv),L.push(B.metalnessMapUv),L.push(B.roughnessMapUv),L.push(B.anisotropyMapUv),L.push(B.clearcoatMapUv),L.push(B.clearcoatNormalMapUv),L.push(B.clearcoatRoughnessMapUv),L.push(B.iridescenceMapUv),L.push(B.iridescenceThicknessMapUv),L.push(B.sheenColorMapUv),L.push(B.sheenRoughnessMapUv),L.push(B.specularMapUv),L.push(B.specularColorMapUv),L.push(B.specularIntensityMapUv),L.push(B.transmissionMapUv),L.push(B.thicknessMapUv),L.push(B.combine),L.push(B.fogExp2),L.push(B.sizeAttenuation),L.push(B.morphTargetsCount),L.push(B.morphAttributeCount),L.push(B.numDirLights),L.push(B.numPointLights),L.push(B.numSpotLights),L.push(B.numSpotLightMaps),L.push(B.numHemiLights),L.push(B.numRectAreaLights),L.push(B.numDirLightShadows),L.push(B.numPointLightShadows),L.push(B.numSpotLightShadows),L.push(B.numSpotLightShadowsWithMaps),L.push(B.numLightProbes),L.push(B.shadowMapType),L.push(B.toneMapping),L.push(B.numClippingPlanes),L.push(B.numClipIntersection),L.push(B.depthPacking)}function D(L,B){c.disableAll(),B.instancing&&c.enable(0),B.instancingColor&&c.enable(1),B.instancingMorph&&c.enable(2),B.matcap&&c.enable(3),B.envMap&&c.enable(4),B.normalMapObjectSpace&&c.enable(5),B.normalMapTangentSpace&&c.enable(6),B.clearcoat&&c.enable(7),B.iridescence&&c.enable(8),B.alphaTest&&c.enable(9),B.vertexColors&&c.enable(10),B.vertexAlphas&&c.enable(11),B.vertexUv1s&&c.enable(12),B.vertexUv2s&&c.enable(13),B.vertexUv3s&&c.enable(14),B.vertexTangents&&c.enable(15),B.anisotropy&&c.enable(16),B.alphaHash&&c.enable(17),B.batching&&c.enable(18),B.dispersion&&c.enable(19),B.batchingColor&&c.enable(20),B.gradientMap&&c.enable(21),L.push(c.mask),c.disableAll(),B.fog&&c.enable(0),B.useFog&&c.enable(1),B.flatShading&&c.enable(2),B.logarithmicDepthBuffer&&c.enable(3),B.reversedDepthBuffer&&c.enable(4),B.skinning&&c.enable(5),B.morphTargets&&c.enable(6),B.morphNormals&&c.enable(7),B.morphColors&&c.enable(8),B.premultipliedAlpha&&c.enable(9),B.shadowMapEnabled&&c.enable(10),B.doubleSided&&c.enable(11),B.flipSided&&c.enable(12),B.useDepthPacking&&c.enable(13),B.dithering&&c.enable(14),B.transmission&&c.enable(15),B.sheen&&c.enable(16),B.opaque&&c.enable(17),B.pointsUvs&&c.enable(18),B.decodeVideoTexture&&c.enable(19),B.decodeVideoTextureEmissive&&c.enable(20),B.alphaToCoverage&&c.enable(21),L.push(c.mask)}function U(L){const B=E[L.type];let Y;if(B){const ee=Ro[B];Y=Sk.clone(ee.uniforms)}else Y=L.uniforms;return Y}function j(L,B){let Y=v.get(B);return Y!==void 0?++Y.usedTimes:(Y=new I6(n,B,L,r),g.push(Y),v.set(B,Y)),Y}function F(L){if(--L.usedTimes===0){const B=g.indexOf(L);g[B]=g[g.length-1],g.pop(),v.delete(L.cacheKey),L.destroy()}}function z(L){h.remove(L)}function W(){h.dispose()}return{getParameters:N,getProgramCacheKey:A,getUniforms:U,acquireProgram:j,releaseProgram:F,releaseShaderCache:z,programs:g,dispose:W}}function O6(){let n=new WeakMap;function e(o){return n.has(o)}function t(o){let c=n.get(o);return c===void 0&&(c={},n.set(o,c)),c}function i(o){n.delete(o)}function s(o,c,h){n.get(o)[c]=h}function r(){n=new WeakMap}return{has:e,get:t,remove:i,update:s,dispose:r}}function z6(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function YA(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function JA(){const n=[];let e=0;const t=[],i=[],s=[];function r(){e=0,t.length=0,i.length=0,s.length=0}function o(v,y,w,E,R,N){let A=n[e];return A===void 0?(A={id:v.id,object:v,geometry:y,material:w,groupOrder:E,renderOrder:v.renderOrder,z:R,group:N},n[e]=A):(A.id=v.id,A.object=v,A.geometry=y,A.material=w,A.groupOrder=E,A.renderOrder=v.renderOrder,A.z=R,A.group=N),e++,A}function c(v,y,w,E,R,N){const A=o(v,y,w,E,R,N);w.transmission>0?i.push(A):w.transparent===!0?s.push(A):t.push(A)}function h(v,y,w,E,R,N){const A=o(v,y,w,E,R,N);w.transmission>0?i.unshift(A):w.transparent===!0?s.unshift(A):t.unshift(A)}function p(v,y){t.length>1&&t.sort(v||z6),i.length>1&&i.sort(y||YA),s.length>1&&s.sort(y||YA)}function g(){for(let v=e,y=n.length;v<y;v++){const w=n[v];if(w.id===null)break;w.id=null,w.object=null,w.geometry=null,w.material=null,w.group=null}}return{opaque:t,transmissive:i,transparent:s,init:r,push:c,unshift:h,finish:g,sort:p}}function j6(){let n=new WeakMap;function e(i,s){const r=n.get(i);let o;return r===void 0?(o=new JA,n.set(i,[o])):s>=r.length?(o=new JA,r.push(o)):o=r[s],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function F6(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new K,color:new _t};break;case"SpotLight":t={position:new K,direction:new K,color:new _t,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new K,color:new _t,distance:0,decay:0};break;case"HemisphereLight":t={direction:new K,skyColor:new _t,groundColor:new _t};break;case"RectAreaLight":t={color:new _t,position:new K,halfWidth:new K,halfHeight:new K};break}return n[e.id]=t,t}}}function B6(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Be,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let V6=0;function H6(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function G6(n){const e=new F6,t=B6(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)i.probe.push(new K);const s=new K,r=new Jt,o=new Jt;function c(p){let g=0,v=0,y=0;for(let L=0;L<9;L++)i.probe[L].set(0,0,0);let w=0,E=0,R=0,N=0,A=0,I=0,D=0,U=0,j=0,F=0,z=0;p.sort(H6);for(let L=0,B=p.length;L<B;L++){const Y=p[L],ee=Y.color,Q=Y.intensity,ce=Y.distance;let oe=null;if(Y.shadow&&Y.shadow.map&&(Y.shadow.map.texture.format===dh?oe=Y.shadow.map.texture:oe=Y.shadow.map.depthTexture||Y.shadow.map.texture),Y.isAmbientLight)g+=ee.r*Q,v+=ee.g*Q,y+=ee.b*Q;else if(Y.isLightProbe){for(let J=0;J<9;J++)i.probe[J].addScaledVector(Y.sh.coefficients[J],Q);z++}else if(Y.isDirectionalLight){const J=e.get(Y);if(J.color.copy(Y.color).multiplyScalar(Y.intensity),Y.castShadow){const te=Y.shadow,me=t.get(Y);me.shadowIntensity=te.intensity,me.shadowBias=te.bias,me.shadowNormalBias=te.normalBias,me.shadowRadius=te.radius,me.shadowMapSize=te.mapSize,i.directionalShadow[w]=me,i.directionalShadowMap[w]=oe,i.directionalShadowMatrix[w]=Y.shadow.matrix,I++}i.directional[w]=J,w++}else if(Y.isSpotLight){const J=e.get(Y);J.position.setFromMatrixPosition(Y.matrixWorld),J.color.copy(ee).multiplyScalar(Q),J.distance=ce,J.coneCos=Math.cos(Y.angle),J.penumbraCos=Math.cos(Y.angle*(1-Y.penumbra)),J.decay=Y.decay,i.spot[R]=J;const te=Y.shadow;if(Y.map&&(i.spotLightMap[j]=Y.map,j++,te.updateMatrices(Y),Y.castShadow&&F++),i.spotLightMatrix[R]=te.matrix,Y.castShadow){const me=t.get(Y);me.shadowIntensity=te.intensity,me.shadowBias=te.bias,me.shadowNormalBias=te.normalBias,me.shadowRadius=te.radius,me.shadowMapSize=te.mapSize,i.spotShadow[R]=me,i.spotShadowMap[R]=oe,U++}R++}else if(Y.isRectAreaLight){const J=e.get(Y);J.color.copy(ee).multiplyScalar(Q),J.halfWidth.set(Y.width*.5,0,0),J.halfHeight.set(0,Y.height*.5,0),i.rectArea[N]=J,N++}else if(Y.isPointLight){const J=e.get(Y);if(J.color.copy(Y.color).multiplyScalar(Y.intensity),J.distance=Y.distance,J.decay=Y.decay,Y.castShadow){const te=Y.shadow,me=t.get(Y);me.shadowIntensity=te.intensity,me.shadowBias=te.bias,me.shadowNormalBias=te.normalBias,me.shadowRadius=te.radius,me.shadowMapSize=te.mapSize,me.shadowCameraNear=te.camera.near,me.shadowCameraFar=te.camera.far,i.pointShadow[E]=me,i.pointShadowMap[E]=oe,i.pointShadowMatrix[E]=Y.shadow.matrix,D++}i.point[E]=J,E++}else if(Y.isHemisphereLight){const J=e.get(Y);J.skyColor.copy(Y.color).multiplyScalar(Q),J.groundColor.copy(Y.groundColor).multiplyScalar(Q),i.hemi[A]=J,A++}}N>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=ft.LTC_FLOAT_1,i.rectAreaLTC2=ft.LTC_FLOAT_2):(i.rectAreaLTC1=ft.LTC_HALF_1,i.rectAreaLTC2=ft.LTC_HALF_2)),i.ambient[0]=g,i.ambient[1]=v,i.ambient[2]=y;const W=i.hash;(W.directionalLength!==w||W.pointLength!==E||W.spotLength!==R||W.rectAreaLength!==N||W.hemiLength!==A||W.numDirectionalShadows!==I||W.numPointShadows!==D||W.numSpotShadows!==U||W.numSpotMaps!==j||W.numLightProbes!==z)&&(i.directional.length=w,i.spot.length=R,i.rectArea.length=N,i.point.length=E,i.hemi.length=A,i.directionalShadow.length=I,i.directionalShadowMap.length=I,i.pointShadow.length=D,i.pointShadowMap.length=D,i.spotShadow.length=U,i.spotShadowMap.length=U,i.directionalShadowMatrix.length=I,i.pointShadowMatrix.length=D,i.spotLightMatrix.length=U+j-F,i.spotLightMap.length=j,i.numSpotLightShadowsWithMaps=F,i.numLightProbes=z,W.directionalLength=w,W.pointLength=E,W.spotLength=R,W.rectAreaLength=N,W.hemiLength=A,W.numDirectionalShadows=I,W.numPointShadows=D,W.numSpotShadows=U,W.numSpotMaps=j,W.numLightProbes=z,i.version=V6++)}function h(p,g){let v=0,y=0,w=0,E=0,R=0;const N=g.matrixWorldInverse;for(let A=0,I=p.length;A<I;A++){const D=p[A];if(D.isDirectionalLight){const U=i.directional[v];U.direction.setFromMatrixPosition(D.matrixWorld),s.setFromMatrixPosition(D.target.matrixWorld),U.direction.sub(s),U.direction.transformDirection(N),v++}else if(D.isSpotLight){const U=i.spot[w];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(N),U.direction.setFromMatrixPosition(D.matrixWorld),s.setFromMatrixPosition(D.target.matrixWorld),U.direction.sub(s),U.direction.transformDirection(N),w++}else if(D.isRectAreaLight){const U=i.rectArea[E];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(N),o.identity(),r.copy(D.matrixWorld),r.premultiply(N),o.extractRotation(r),U.halfWidth.set(D.width*.5,0,0),U.halfHeight.set(0,D.height*.5,0),U.halfWidth.applyMatrix4(o),U.halfHeight.applyMatrix4(o),E++}else if(D.isPointLight){const U=i.point[y];U.position.setFromMatrixPosition(D.matrixWorld),U.position.applyMatrix4(N),y++}else if(D.isHemisphereLight){const U=i.hemi[R];U.direction.setFromMatrixPosition(D.matrixWorld),U.direction.transformDirection(N),R++}}}return{setup:c,setupView:h,state:i}}function KA(n){const e=new G6(n),t=[],i=[];function s(g){p.camera=g,t.length=0,i.length=0}function r(g){t.push(g)}function o(g){i.push(g)}function c(){e.setup(t)}function h(g){e.setupView(t,g)}const p={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:s,state:p,setupLights:c,setupLightsView:h,pushLight:r,pushShadow:o}}function q6(n){let e=new WeakMap;function t(s,r=0){const o=e.get(s);let c;return o===void 0?(c=new KA(n),e.set(s,[c])):r>=o.length?(c=new KA(n),o.push(c)):c=o[r],c}function i(){e=new WeakMap}return{get:t,dispose:i}}const W6=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,$6=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,X6=[new K(1,0,0),new K(-1,0,0),new K(0,1,0),new K(0,-1,0),new K(0,0,1),new K(0,0,-1)],Y6=[new K(0,-1,0),new K(0,-1,0),new K(0,0,1),new K(0,0,-1),new K(0,-1,0),new K(0,-1,0)],ZA=new Jt,Tg=new K,wS=new K;function J6(n,e,t){let i=new Ip;const s=new Be,r=new Be,o=new ii,c=new _T,h=new wT,p={},g=t.maxTextureSize,v={[_c]:Ar,[Ar]:_c,[yl]:yl},y=new na({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Be},radius:{value:4}},vertexShader:W6,fragmentShader:$6}),w=y.clone();w.defines.HORIZONTAL_PASS=1;const E=new sn;E.setAttribute("position",new ei(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const R=new os(E,y),N=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=mp;let A=this.type;this.render=function(F,z,W){if(N.enabled===!1||N.autoUpdate===!1&&N.needsUpdate===!1||F.length===0)return;F.type===zg&&(ht("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),F.type=mp);const L=n.getRenderTarget(),B=n.getActiveCubeFace(),Y=n.getActiveMipmapLevel(),ee=n.state;ee.setBlending(wl),ee.buffers.depth.getReversed()===!0?ee.buffers.color.setClear(0,0,0,0):ee.buffers.color.setClear(1,1,1,1),ee.buffers.depth.setTest(!0),ee.setScissorTest(!1);const Q=A!==this.type;Q&&z.traverse(function(ce){ce.material&&(Array.isArray(ce.material)?ce.material.forEach(oe=>oe.needsUpdate=!0):ce.material.needsUpdate=!0)});for(let ce=0,oe=F.length;ce<oe;ce++){const J=F[ce],te=J.shadow;if(te===void 0){ht("WebGLShadowMap:",J,"has no shadow.");continue}if(te.autoUpdate===!1&&te.needsUpdate===!1)continue;s.copy(te.mapSize);const me=te.getFrameExtents();if(s.multiply(me),r.copy(te.mapSize),(s.x>g||s.y>g)&&(s.x>g&&(r.x=Math.floor(g/me.x),s.x=r.x*me.x,te.mapSize.x=r.x),s.y>g&&(r.y=Math.floor(g/me.y),s.y=r.y*me.y,te.mapSize.y=r.y)),te.map===null||Q===!0){if(te.map!==null&&(te.map.depthTexture!==null&&(te.map.depthTexture.dispose(),te.map.depthTexture=null),te.map.dispose()),this.type===nh){if(J.isPointLight){ht("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}te.map=new ta(s.x,s.y,{format:dh,type:Po,minFilter:si,magFilter:si,generateMipmaps:!1}),te.map.texture.name=J.name+".shadowMap",te.map.depthTexture=new fh(s.x,s.y,Ts),te.map.depthTexture.name=J.name+".shadowMapDepth",te.map.depthTexture.format=El,te.map.depthTexture.compareFunction=null,te.map.depthTexture.minFilter=Ii,te.map.depthTexture.magFilter=Ii}else{J.isPointLight?(te.map=new lT(s.x),te.map.depthTexture=new Pk(s.x,Za)):(te.map=new ta(s.x,s.y),te.map.depthTexture=new fh(s.x,s.y,Za)),te.map.depthTexture.name=J.name+".shadowMap",te.map.depthTexture.format=El;const Ie=n.state.buffers.depth.getReversed();this.type===mp?(te.map.depthTexture.compareFunction=Ie?i_:n_,te.map.depthTexture.minFilter=si,te.map.depthTexture.magFilter=si):(te.map.depthTexture.compareFunction=null,te.map.depthTexture.minFilter=Ii,te.map.depthTexture.magFilter=Ii)}te.camera.updateProjectionMatrix()}const Re=te.map.isWebGLCubeRenderTarget?6:1;for(let Ie=0;Ie<Re;Ie++){if(te.map.isWebGLCubeRenderTarget)n.setRenderTarget(te.map,Ie),n.clear();else{Ie===0&&(n.setRenderTarget(te.map),n.clear());const $=te.getViewport(Ie);o.set(r.x*$.x,r.y*$.y,r.x*$.z,r.y*$.w),ee.viewport(o)}if(J.isPointLight){const $=te.camera,de=te.matrix,Ne=J.distance||$.far;Ne!==$.far&&($.far=Ne,$.updateProjectionMatrix()),Tg.setFromMatrixPosition(J.matrixWorld),$.position.copy(Tg),wS.copy($.position),wS.add(X6[Ie]),$.up.copy(Y6[Ie]),$.lookAt(wS),$.updateMatrixWorld(),de.makeTranslation(-Tg.x,-Tg.y,-Tg.z),ZA.multiplyMatrices($.projectionMatrix,$.matrixWorldInverse),te._frustum.setFromProjectionMatrix(ZA,$.coordinateSystem,$.reversedDepth)}else te.updateMatrices(J);i=te.getFrustum(),U(z,W,te.camera,J,this.type)}te.isPointLightShadow!==!0&&this.type===nh&&I(te,W),te.needsUpdate=!1}A=this.type,N.needsUpdate=!1,n.setRenderTarget(L,B,Y)};function I(F,z){const W=e.update(R);y.defines.VSM_SAMPLES!==F.blurSamples&&(y.defines.VSM_SAMPLES=F.blurSamples,w.defines.VSM_SAMPLES=F.blurSamples,y.needsUpdate=!0,w.needsUpdate=!0),F.mapPass===null&&(F.mapPass=new ta(s.x,s.y,{format:dh,type:Po})),y.uniforms.shadow_pass.value=F.map.depthTexture,y.uniforms.resolution.value=F.mapSize,y.uniforms.radius.value=F.radius,n.setRenderTarget(F.mapPass),n.clear(),n.renderBufferDirect(z,null,W,y,R,null),w.uniforms.shadow_pass.value=F.mapPass.texture,w.uniforms.resolution.value=F.mapSize,w.uniforms.radius.value=F.radius,n.setRenderTarget(F.map),n.clear(),n.renderBufferDirect(z,null,W,w,R,null)}function D(F,z,W,L){let B=null;const Y=W.isPointLight===!0?F.customDistanceMaterial:F.customDepthMaterial;if(Y!==void 0)B=Y;else if(B=W.isPointLight===!0?h:c,n.localClippingEnabled&&z.clipShadows===!0&&Array.isArray(z.clippingPlanes)&&z.clippingPlanes.length!==0||z.displacementMap&&z.displacementScale!==0||z.alphaMap&&z.alphaTest>0||z.map&&z.alphaTest>0||z.alphaToCoverage===!0){const ee=B.uuid,Q=z.uuid;let ce=p[ee];ce===void 0&&(ce={},p[ee]=ce);let oe=ce[Q];oe===void 0&&(oe=B.clone(),ce[Q]=oe,z.addEventListener("dispose",j)),B=oe}if(B.visible=z.visible,B.wireframe=z.wireframe,L===nh?B.side=z.shadowSide!==null?z.shadowSide:z.side:B.side=z.shadowSide!==null?z.shadowSide:v[z.side],B.alphaMap=z.alphaMap,B.alphaTest=z.alphaToCoverage===!0?.5:z.alphaTest,B.map=z.map,B.clipShadows=z.clipShadows,B.clippingPlanes=z.clippingPlanes,B.clipIntersection=z.clipIntersection,B.displacementMap=z.displacementMap,B.displacementScale=z.displacementScale,B.displacementBias=z.displacementBias,B.wireframeLinewidth=z.wireframeLinewidth,B.linewidth=z.linewidth,W.isPointLight===!0&&B.isMeshDistanceMaterial===!0){const ee=n.properties.get(B);ee.light=W}return B}function U(F,z,W,L,B){if(F.visible===!1)return;if(F.layers.test(z.layers)&&(F.isMesh||F.isLine||F.isPoints)&&(F.castShadow||F.receiveShadow&&B===nh)&&(!F.frustumCulled||i.intersectsObject(F))){F.modelViewMatrix.multiplyMatrices(W.matrixWorldInverse,F.matrixWorld);const Q=e.update(F),ce=F.material;if(Array.isArray(ce)){const oe=Q.groups;for(let J=0,te=oe.length;J<te;J++){const me=oe[J],Re=ce[me.materialIndex];if(Re&&Re.visible){const Ie=D(F,Re,L,B);F.onBeforeShadow(n,F,z,W,Q,Ie,me),n.renderBufferDirect(W,null,Q,Ie,F,me),F.onAfterShadow(n,F,z,W,Q,Ie,me)}}}else if(ce.visible){const oe=D(F,ce,L,B);F.onBeforeShadow(n,F,z,W,Q,oe,null),n.renderBufferDirect(W,null,Q,oe,F,null),F.onAfterShadow(n,F,z,W,Q,oe,null)}}const ee=F.children;for(let Q=0,ce=ee.length;Q<ce;Q++)U(ee[Q],z,W,L,B)}function j(F){F.target.removeEventListener("dispose",j);for(const W in p){const L=p[W],B=F.target.uuid;B in L&&(L[B].dispose(),delete L[B])}}}const K6={[Py]:Uy,[Ly]:jy,[Oy]:Fy,[uh]:zy,[Uy]:Py,[jy]:Ly,[Fy]:Oy,[zy]:uh};function Z6(n,e){function t(){let re=!1;const ct=new ii;let Xe=null;const dt=new ii(0,0,0,0);return{setMask:function(Ge){Xe!==Ge&&!re&&(n.colorMask(Ge,Ge,Ge,Ge),Xe=Ge)},setLocked:function(Ge){re=Ge},setClear:function(Ge,Le,et,$t,Tn){Tn===!0&&(Ge*=$t,Le*=$t,et*=$t),ct.set(Ge,Le,et,$t),dt.equals(ct)===!1&&(n.clearColor(Ge,Le,et,$t),dt.copy(ct))},reset:function(){re=!1,Xe=null,dt.set(-1,0,0,0)}}}function i(){let re=!1,ct=!1,Xe=null,dt=null,Ge=null;return{setReversed:function(Le){if(ct!==Le){const et=e.get("EXT_clip_control");Le?et.clipControlEXT(et.LOWER_LEFT_EXT,et.ZERO_TO_ONE_EXT):et.clipControlEXT(et.LOWER_LEFT_EXT,et.NEGATIVE_ONE_TO_ONE_EXT),ct=Le;const $t=Ge;Ge=null,this.setClear($t)}},getReversed:function(){return ct},setTest:function(Le){Le?Ce(n.DEPTH_TEST):nt(n.DEPTH_TEST)},setMask:function(Le){Xe!==Le&&!re&&(n.depthMask(Le),Xe=Le)},setFunc:function(Le){if(ct&&(Le=K6[Le]),dt!==Le){switch(Le){case Py:n.depthFunc(n.NEVER);break;case Uy:n.depthFunc(n.ALWAYS);break;case Ly:n.depthFunc(n.LESS);break;case uh:n.depthFunc(n.LEQUAL);break;case Oy:n.depthFunc(n.EQUAL);break;case zy:n.depthFunc(n.GEQUAL);break;case jy:n.depthFunc(n.GREATER);break;case Fy:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}dt=Le}},setLocked:function(Le){re=Le},setClear:function(Le){Ge!==Le&&(ct&&(Le=1-Le),n.clearDepth(Le),Ge=Le)},reset:function(){re=!1,Xe=null,dt=null,Ge=null,ct=!1}}}function s(){let re=!1,ct=null,Xe=null,dt=null,Ge=null,Le=null,et=null,$t=null,Tn=null;return{setTest:function(An){re||(An?Ce(n.STENCIL_TEST):nt(n.STENCIL_TEST))},setMask:function(An){ct!==An&&!re&&(n.stencilMask(An),ct=An)},setFunc:function(An,ls,Hs){(Xe!==An||dt!==ls||Ge!==Hs)&&(n.stencilFunc(An,ls,Hs),Xe=An,dt=ls,Ge=Hs)},setOp:function(An,ls,Hs){(Le!==An||et!==ls||$t!==Hs)&&(n.stencilOp(An,ls,Hs),Le=An,et=ls,$t=Hs)},setLocked:function(An){re=An},setClear:function(An){Tn!==An&&(n.clearStencil(An),Tn=An)},reset:function(){re=!1,ct=null,Xe=null,dt=null,Ge=null,Le=null,et=null,$t=null,Tn=null}}}const r=new t,o=new i,c=new s,h=new WeakMap,p=new WeakMap;let g={},v={},y=new WeakMap,w=[],E=null,R=!1,N=null,A=null,I=null,D=null,U=null,j=null,F=null,z=new _t(0,0,0),W=0,L=!1,B=null,Y=null,ee=null,Q=null,ce=null;const oe=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let J=!1,te=0;const me=n.getParameter(n.VERSION);me.indexOf("WebGL")!==-1?(te=parseFloat(/^WebGL (\d)/.exec(me)[1]),J=te>=1):me.indexOf("OpenGL ES")!==-1&&(te=parseFloat(/^OpenGL ES (\d)/.exec(me)[1]),J=te>=2);let Re=null,Ie={};const $=n.getParameter(n.SCISSOR_BOX),de=n.getParameter(n.VIEWPORT),Ne=new ii().fromArray($),Fe=new ii().fromArray(de);function lt(re,ct,Xe,dt){const Ge=new Uint8Array(4),Le=n.createTexture();n.bindTexture(re,Le),n.texParameteri(re,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(re,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let et=0;et<Xe;et++)re===n.TEXTURE_3D||re===n.TEXTURE_2D_ARRAY?n.texImage3D(ct,0,n.RGBA,1,1,dt,0,n.RGBA,n.UNSIGNED_BYTE,Ge):n.texImage2D(ct+et,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ge);return Le}const ge={};ge[n.TEXTURE_2D]=lt(n.TEXTURE_2D,n.TEXTURE_2D,1),ge[n.TEXTURE_CUBE_MAP]=lt(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),ge[n.TEXTURE_2D_ARRAY]=lt(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),ge[n.TEXTURE_3D]=lt(n.TEXTURE_3D,n.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),c.setClear(0),Ce(n.DEPTH_TEST),o.setFunc(uh),Oe(!1),it(KS),Ce(n.CULL_FACE),Pe(wl);function Ce(re){g[re]!==!0&&(n.enable(re),g[re]=!0)}function nt(re){g[re]!==!1&&(n.disable(re),g[re]=!1)}function rt(re,ct){return v[re]!==ct?(n.bindFramebuffer(re,ct),v[re]=ct,re===n.DRAW_FRAMEBUFFER&&(v[n.FRAMEBUFFER]=ct),re===n.FRAMEBUFFER&&(v[n.DRAW_FRAMEBUFFER]=ct),!0):!1}function mt(re,ct){let Xe=w,dt=!1;if(re){Xe=y.get(ct),Xe===void 0&&(Xe=[],y.set(ct,Xe));const Ge=re.textures;if(Xe.length!==Ge.length||Xe[0]!==n.COLOR_ATTACHMENT0){for(let Le=0,et=Ge.length;Le<et;Le++)Xe[Le]=n.COLOR_ATTACHMENT0+Le;Xe.length=Ge.length,dt=!0}}else Xe[0]!==n.BACK&&(Xe[0]=n.BACK,dt=!0);dt&&n.drawBuffers(Xe)}function ln(re){return E!==re?(n.useProgram(re),E=re,!0):!1}const vn={[Ru]:n.FUNC_ADD,[FR]:n.FUNC_SUBTRACT,[BR]:n.FUNC_REVERSE_SUBTRACT};vn[VR]=n.MIN,vn[HR]=n.MAX;const zt={[GR]:n.ZERO,[qR]:n.ONE,[WR]:n.SRC_COLOR,[Iy]:n.SRC_ALPHA,[ZR]:n.SRC_ALPHA_SATURATE,[JR]:n.DST_COLOR,[XR]:n.DST_ALPHA,[$R]:n.ONE_MINUS_SRC_COLOR,[Dy]:n.ONE_MINUS_SRC_ALPHA,[KR]:n.ONE_MINUS_DST_COLOR,[YR]:n.ONE_MINUS_DST_ALPHA,[QR]:n.CONSTANT_COLOR,[ek]:n.ONE_MINUS_CONSTANT_COLOR,[tk]:n.CONSTANT_ALPHA,[nk]:n.ONE_MINUS_CONSTANT_ALPHA};function Pe(re,ct,Xe,dt,Ge,Le,et,$t,Tn,An){if(re===wl){R===!0&&(nt(n.BLEND),R=!1);return}if(R===!1&&(Ce(n.BLEND),R=!0),re!==jR){if(re!==N||An!==L){if((A!==Ru||U!==Ru)&&(n.blendEquation(n.FUNC_ADD),A=Ru,U=Ru),An)switch(re){case ah:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case ZS:n.blendFunc(n.ONE,n.ONE);break;case QS:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case e1:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:Dt("WebGLState: Invalid blending: ",re);break}else switch(re){case ah:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case ZS:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case QS:Dt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case e1:Dt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Dt("WebGLState: Invalid blending: ",re);break}I=null,D=null,j=null,F=null,z.set(0,0,0),W=0,N=re,L=An}return}Ge=Ge||ct,Le=Le||Xe,et=et||dt,(ct!==A||Ge!==U)&&(n.blendEquationSeparate(vn[ct],vn[Ge]),A=ct,U=Ge),(Xe!==I||dt!==D||Le!==j||et!==F)&&(n.blendFuncSeparate(zt[Xe],zt[dt],zt[Le],zt[et]),I=Xe,D=dt,j=Le,F=et),($t.equals(z)===!1||Tn!==W)&&(n.blendColor($t.r,$t.g,$t.b,Tn),z.copy($t),W=Tn),N=re,L=!1}function qe(re,ct){re.side===yl?nt(n.CULL_FACE):Ce(n.CULL_FACE);let Xe=re.side===Ar;ct&&(Xe=!Xe),Oe(Xe),re.blending===ah&&re.transparent===!1?Pe(wl):Pe(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.blendColor,re.blendAlpha,re.premultipliedAlpha),o.setFunc(re.depthFunc),o.setTest(re.depthTest),o.setMask(re.depthWrite),r.setMask(re.colorWrite);const dt=re.stencilWrite;c.setTest(dt),dt&&(c.setMask(re.stencilWriteMask),c.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),c.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),Nt(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits),re.alphaToCoverage===!0?Ce(n.SAMPLE_ALPHA_TO_COVERAGE):nt(n.SAMPLE_ALPHA_TO_COVERAGE)}function Oe(re){B!==re&&(re?n.frontFace(n.CW):n.frontFace(n.CCW),B=re)}function it(re){re!==LR?(Ce(n.CULL_FACE),re!==Y&&(re===KS?n.cullFace(n.BACK):re===OR?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):nt(n.CULL_FACE),Y=re}function Z(re){re!==ee&&(J&&n.lineWidth(re),ee=re)}function Nt(re,ct,Xe){re?(Ce(n.POLYGON_OFFSET_FILL),(Q!==ct||ce!==Xe)&&(n.polygonOffset(ct,Xe),Q=ct,ce=Xe)):nt(n.POLYGON_OFFSET_FILL)}function ot(re){re?Ce(n.SCISSOR_TEST):nt(n.SCISSOR_TEST)}function Rt(re){re===void 0&&(re=n.TEXTURE0+oe-1),Re!==re&&(n.activeTexture(re),Re=re)}function Je(re,ct,Xe){Xe===void 0&&(Re===null?Xe=n.TEXTURE0+oe-1:Xe=Re);let dt=Ie[Xe];dt===void 0&&(dt={type:void 0,texture:void 0},Ie[Xe]=dt),(dt.type!==re||dt.texture!==ct)&&(Re!==Xe&&(n.activeTexture(Xe),Re=Xe),n.bindTexture(re,ct||ge[re]),dt.type=re,dt.texture=ct)}function X(){const re=Ie[Re];re!==void 0&&re.type!==void 0&&(n.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)}function V(){try{n.compressedTexImage2D(...arguments)}catch(re){Dt("WebGLState:",re)}}function ae(){try{n.compressedTexImage3D(...arguments)}catch(re){Dt("WebGLState:",re)}}function Ee(){try{n.texSubImage2D(...arguments)}catch(re){Dt("WebGLState:",re)}}function ze(){try{n.texSubImage3D(...arguments)}catch(re){Dt("WebGLState:",re)}}function Me(){try{n.compressedTexSubImage2D(...arguments)}catch(re){Dt("WebGLState:",re)}}function gt(){try{n.compressedTexSubImage3D(...arguments)}catch(re){Dt("WebGLState:",re)}}function Qe(){try{n.texStorage2D(...arguments)}catch(re){Dt("WebGLState:",re)}}function St(){try{n.texStorage3D(...arguments)}catch(re){Dt("WebGLState:",re)}}function Ut(){try{n.texImage2D(...arguments)}catch(re){Dt("WebGLState:",re)}}function He(){try{n.texImage3D(...arguments)}catch(re){Dt("WebGLState:",re)}}function Ye(re){Ne.equals(re)===!1&&(n.scissor(re.x,re.y,re.z,re.w),Ne.copy(re))}function xt(re){Fe.equals(re)===!1&&(n.viewport(re.x,re.y,re.z,re.w),Fe.copy(re))}function pt(re,ct){let Xe=p.get(ct);Xe===void 0&&(Xe=new WeakMap,p.set(ct,Xe));let dt=Xe.get(re);dt===void 0&&(dt=n.getUniformBlockIndex(ct,re.name),Xe.set(re,dt))}function st(re,ct){const dt=p.get(ct).get(re);h.get(ct)!==dt&&(n.uniformBlockBinding(ct,dt,re.__bindingPointIndex),h.set(ct,dt))}function rn(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),o.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),g={},Re=null,Ie={},v={},y=new WeakMap,w=[],E=null,R=!1,N=null,A=null,I=null,D=null,U=null,j=null,F=null,z=new _t(0,0,0),W=0,L=!1,B=null,Y=null,ee=null,Q=null,ce=null,Ne.set(0,0,n.canvas.width,n.canvas.height),Fe.set(0,0,n.canvas.width,n.canvas.height),r.reset(),o.reset(),c.reset()}return{buffers:{color:r,depth:o,stencil:c},enable:Ce,disable:nt,bindFramebuffer:rt,drawBuffers:mt,useProgram:ln,setBlending:Pe,setMaterial:qe,setFlipSided:Oe,setCullFace:it,setLineWidth:Z,setPolygonOffset:Nt,setScissorTest:ot,activeTexture:Rt,bindTexture:Je,unbindTexture:X,compressedTexImage2D:V,compressedTexImage3D:ae,texImage2D:Ut,texImage3D:He,updateUBOMapping:pt,uniformBlockBinding:st,texStorage2D:Qe,texStorage3D:St,texSubImage2D:Ee,texSubImage3D:ze,compressedTexSubImage2D:Me,compressedTexSubImage3D:gt,scissor:Ye,viewport:xt,reset:rn}}function Q6(n,e,t,i,s,r,o){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new Be,g=new WeakMap;let v;const y=new WeakMap;let w=!1;try{w=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function E(X,V){return w?new OffscreenCanvas(X,V):c0("canvas")}function R(X,V,ae){let Ee=1;const ze=Je(X);if((ze.width>ae||ze.height>ae)&&(Ee=ae/Math.max(ze.width,ze.height)),Ee<1)if(typeof HTMLImageElement<"u"&&X instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&X instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&X instanceof ImageBitmap||typeof VideoFrame<"u"&&X instanceof VideoFrame){const Me=Math.floor(Ee*ze.width),gt=Math.floor(Ee*ze.height);v===void 0&&(v=E(Me,gt));const Qe=V?E(Me,gt):v;return Qe.width=Me,Qe.height=gt,Qe.getContext("2d").drawImage(X,0,0,Me,gt),ht("WebGLRenderer: Texture has been resized from ("+ze.width+"x"+ze.height+") to ("+Me+"x"+gt+")."),Qe}else return"data"in X&&ht("WebGLRenderer: Image in DataTexture is too big ("+ze.width+"x"+ze.height+")."),X;return X}function N(X){return X.generateMipmaps}function A(X){n.generateMipmap(X)}function I(X){return X.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:X.isWebGL3DRenderTarget?n.TEXTURE_3D:X.isWebGLArrayRenderTarget||X.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function D(X,V,ae,Ee,ze=!1){if(X!==null){if(n[X]!==void 0)return n[X];ht("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+X+"'")}let Me=V;if(V===n.RED&&(ae===n.FLOAT&&(Me=n.R32F),ae===n.HALF_FLOAT&&(Me=n.R16F),ae===n.UNSIGNED_BYTE&&(Me=n.R8)),V===n.RED_INTEGER&&(ae===n.UNSIGNED_BYTE&&(Me=n.R8UI),ae===n.UNSIGNED_SHORT&&(Me=n.R16UI),ae===n.UNSIGNED_INT&&(Me=n.R32UI),ae===n.BYTE&&(Me=n.R8I),ae===n.SHORT&&(Me=n.R16I),ae===n.INT&&(Me=n.R32I)),V===n.RG&&(ae===n.FLOAT&&(Me=n.RG32F),ae===n.HALF_FLOAT&&(Me=n.RG16F),ae===n.UNSIGNED_BYTE&&(Me=n.RG8)),V===n.RG_INTEGER&&(ae===n.UNSIGNED_BYTE&&(Me=n.RG8UI),ae===n.UNSIGNED_SHORT&&(Me=n.RG16UI),ae===n.UNSIGNED_INT&&(Me=n.RG32UI),ae===n.BYTE&&(Me=n.RG8I),ae===n.SHORT&&(Me=n.RG16I),ae===n.INT&&(Me=n.RG32I)),V===n.RGB_INTEGER&&(ae===n.UNSIGNED_BYTE&&(Me=n.RGB8UI),ae===n.UNSIGNED_SHORT&&(Me=n.RGB16UI),ae===n.UNSIGNED_INT&&(Me=n.RGB32UI),ae===n.BYTE&&(Me=n.RGB8I),ae===n.SHORT&&(Me=n.RGB16I),ae===n.INT&&(Me=n.RGB32I)),V===n.RGBA_INTEGER&&(ae===n.UNSIGNED_BYTE&&(Me=n.RGBA8UI),ae===n.UNSIGNED_SHORT&&(Me=n.RGBA16UI),ae===n.UNSIGNED_INT&&(Me=n.RGBA32UI),ae===n.BYTE&&(Me=n.RGBA8I),ae===n.SHORT&&(Me=n.RGBA16I),ae===n.INT&&(Me=n.RGBA32I)),V===n.RGB&&(ae===n.UNSIGNED_INT_5_9_9_9_REV&&(Me=n.RGB9_E5),ae===n.UNSIGNED_INT_10F_11F_11F_REV&&(Me=n.R11F_G11F_B10F)),V===n.RGBA){const gt=ze?o0:kn.getTransfer(Ee);ae===n.FLOAT&&(Me=n.RGBA32F),ae===n.HALF_FLOAT&&(Me=n.RGBA16F),ae===n.UNSIGNED_BYTE&&(Me=gt===$n?n.SRGB8_ALPHA8:n.RGBA8),ae===n.UNSIGNED_SHORT_4_4_4_4&&(Me=n.RGBA4),ae===n.UNSIGNED_SHORT_5_5_5_1&&(Me=n.RGB5_A1)}return(Me===n.R16F||Me===n.R32F||Me===n.RG16F||Me===n.RG32F||Me===n.RGBA16F||Me===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Me}function U(X,V){let ae;return X?V===null||V===Za||V===_p?ae=n.DEPTH24_STENCIL8:V===Ts?ae=n.DEPTH32F_STENCIL8:V===bp&&(ae=n.DEPTH24_STENCIL8,ht("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):V===null||V===Za||V===_p?ae=n.DEPTH_COMPONENT24:V===Ts?ae=n.DEPTH_COMPONENT32F:V===bp&&(ae=n.DEPTH_COMPONENT16),ae}function j(X,V){return N(X)===!0||X.isFramebufferTexture&&X.minFilter!==Ii&&X.minFilter!==si?Math.log2(Math.max(V.width,V.height))+1:X.mipmaps!==void 0&&X.mipmaps.length>0?X.mipmaps.length:X.isCompressedTexture&&Array.isArray(X.image)?V.mipmaps.length:1}function F(X){const V=X.target;V.removeEventListener("dispose",F),W(V),V.isVideoTexture&&g.delete(V)}function z(X){const V=X.target;V.removeEventListener("dispose",z),B(V)}function W(X){const V=i.get(X);if(V.__webglInit===void 0)return;const ae=X.source,Ee=y.get(ae);if(Ee){const ze=Ee[V.__cacheKey];ze.usedTimes--,ze.usedTimes===0&&L(X),Object.keys(Ee).length===0&&y.delete(ae)}i.remove(X)}function L(X){const V=i.get(X);n.deleteTexture(V.__webglTexture);const ae=X.source,Ee=y.get(ae);delete Ee[V.__cacheKey],o.memory.textures--}function B(X){const V=i.get(X);if(X.depthTexture&&(X.depthTexture.dispose(),i.remove(X.depthTexture)),X.isWebGLCubeRenderTarget)for(let Ee=0;Ee<6;Ee++){if(Array.isArray(V.__webglFramebuffer[Ee]))for(let ze=0;ze<V.__webglFramebuffer[Ee].length;ze++)n.deleteFramebuffer(V.__webglFramebuffer[Ee][ze]);else n.deleteFramebuffer(V.__webglFramebuffer[Ee]);V.__webglDepthbuffer&&n.deleteRenderbuffer(V.__webglDepthbuffer[Ee])}else{if(Array.isArray(V.__webglFramebuffer))for(let Ee=0;Ee<V.__webglFramebuffer.length;Ee++)n.deleteFramebuffer(V.__webglFramebuffer[Ee]);else n.deleteFramebuffer(V.__webglFramebuffer);if(V.__webglDepthbuffer&&n.deleteRenderbuffer(V.__webglDepthbuffer),V.__webglMultisampledFramebuffer&&n.deleteFramebuffer(V.__webglMultisampledFramebuffer),V.__webglColorRenderbuffer)for(let Ee=0;Ee<V.__webglColorRenderbuffer.length;Ee++)V.__webglColorRenderbuffer[Ee]&&n.deleteRenderbuffer(V.__webglColorRenderbuffer[Ee]);V.__webglDepthRenderbuffer&&n.deleteRenderbuffer(V.__webglDepthRenderbuffer)}const ae=X.textures;for(let Ee=0,ze=ae.length;Ee<ze;Ee++){const Me=i.get(ae[Ee]);Me.__webglTexture&&(n.deleteTexture(Me.__webglTexture),o.memory.textures--),i.remove(ae[Ee])}i.remove(X)}let Y=0;function ee(){Y=0}function Q(){const X=Y;return X>=s.maxTextures&&ht("WebGLTextures: Trying to use "+X+" texture units while this GPU supports only "+s.maxTextures),Y+=1,X}function ce(X){const V=[];return V.push(X.wrapS),V.push(X.wrapT),V.push(X.wrapR||0),V.push(X.magFilter),V.push(X.minFilter),V.push(X.anisotropy),V.push(X.internalFormat),V.push(X.format),V.push(X.type),V.push(X.generateMipmaps),V.push(X.premultiplyAlpha),V.push(X.flipY),V.push(X.unpackAlignment),V.push(X.colorSpace),V.join()}function oe(X,V){const ae=i.get(X);if(X.isVideoTexture&&ot(X),X.isRenderTargetTexture===!1&&X.isExternalTexture!==!0&&X.version>0&&ae.__version!==X.version){const Ee=X.image;if(Ee===null)ht("WebGLRenderer: Texture marked for update but no image data found.");else if(Ee.complete===!1)ht("WebGLRenderer: Texture marked for update but image is incomplete");else{ge(ae,X,V);return}}else X.isExternalTexture&&(ae.__webglTexture=X.sourceTexture?X.sourceTexture:null);t.bindTexture(n.TEXTURE_2D,ae.__webglTexture,n.TEXTURE0+V)}function J(X,V){const ae=i.get(X);if(X.isRenderTargetTexture===!1&&X.version>0&&ae.__version!==X.version){ge(ae,X,V);return}else X.isExternalTexture&&(ae.__webglTexture=X.sourceTexture?X.sourceTexture:null);t.bindTexture(n.TEXTURE_2D_ARRAY,ae.__webglTexture,n.TEXTURE0+V)}function te(X,V){const ae=i.get(X);if(X.isRenderTargetTexture===!1&&X.version>0&&ae.__version!==X.version){ge(ae,X,V);return}t.bindTexture(n.TEXTURE_3D,ae.__webglTexture,n.TEXTURE0+V)}function me(X,V){const ae=i.get(X);if(X.isCubeDepthTexture!==!0&&X.version>0&&ae.__version!==X.version){Ce(ae,X,V);return}t.bindTexture(n.TEXTURE_CUBE_MAP,ae.__webglTexture,n.TEXTURE0+V)}const Re={[i0]:n.REPEAT,[Qr]:n.CLAMP_TO_EDGE,[s0]:n.MIRRORED_REPEAT},Ie={[Ii]:n.NEAREST,[J1]:n.NEAREST_MIPMAP_NEAREST,[cp]:n.NEAREST_MIPMAP_LINEAR,[si]:n.LINEAR,[jg]:n.LINEAR_MIPMAP_NEAREST,[bl]:n.LINEAR_MIPMAP_LINEAR},$={[dk]:n.NEVER,[gk]:n.ALWAYS,[hk]:n.LESS,[n_]:n.LEQUAL,[fk]:n.EQUAL,[i_]:n.GEQUAL,[pk]:n.GREATER,[mk]:n.NOTEQUAL};function de(X,V){if(V.type===Ts&&e.has("OES_texture_float_linear")===!1&&(V.magFilter===si||V.magFilter===jg||V.magFilter===cp||V.magFilter===bl||V.minFilter===si||V.minFilter===jg||V.minFilter===cp||V.minFilter===bl)&&ht("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(X,n.TEXTURE_WRAP_S,Re[V.wrapS]),n.texParameteri(X,n.TEXTURE_WRAP_T,Re[V.wrapT]),(X===n.TEXTURE_3D||X===n.TEXTURE_2D_ARRAY)&&n.texParameteri(X,n.TEXTURE_WRAP_R,Re[V.wrapR]),n.texParameteri(X,n.TEXTURE_MAG_FILTER,Ie[V.magFilter]),n.texParameteri(X,n.TEXTURE_MIN_FILTER,Ie[V.minFilter]),V.compareFunction&&(n.texParameteri(X,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(X,n.TEXTURE_COMPARE_FUNC,$[V.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(V.magFilter===Ii||V.minFilter!==cp&&V.minFilter!==bl||V.type===Ts&&e.has("OES_texture_float_linear")===!1)return;if(V.anisotropy>1||i.get(V).__currentAnisotropy){const ae=e.get("EXT_texture_filter_anisotropic");n.texParameterf(X,ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(V.anisotropy,s.getMaxAnisotropy())),i.get(V).__currentAnisotropy=V.anisotropy}}}function Ne(X,V){let ae=!1;X.__webglInit===void 0&&(X.__webglInit=!0,V.addEventListener("dispose",F));const Ee=V.source;let ze=y.get(Ee);ze===void 0&&(ze={},y.set(Ee,ze));const Me=ce(V);if(Me!==X.__cacheKey){ze[Me]===void 0&&(ze[Me]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,ae=!0),ze[Me].usedTimes++;const gt=ze[X.__cacheKey];gt!==void 0&&(ze[X.__cacheKey].usedTimes--,gt.usedTimes===0&&L(V)),X.__cacheKey=Me,X.__webglTexture=ze[Me].texture}return ae}function Fe(X,V,ae){return Math.floor(Math.floor(X/ae)/V)}function lt(X,V,ae,Ee){const Me=X.updateRanges;if(Me.length===0)t.texSubImage2D(n.TEXTURE_2D,0,0,0,V.width,V.height,ae,Ee,V.data);else{Me.sort((He,Ye)=>He.start-Ye.start);let gt=0;for(let He=1;He<Me.length;He++){const Ye=Me[gt],xt=Me[He],pt=Ye.start+Ye.count,st=Fe(xt.start,V.width,4),rn=Fe(Ye.start,V.width,4);xt.start<=pt+1&&st===rn&&Fe(xt.start+xt.count-1,V.width,4)===st?Ye.count=Math.max(Ye.count,xt.start+xt.count-Ye.start):(++gt,Me[gt]=xt)}Me.length=gt+1;const Qe=n.getParameter(n.UNPACK_ROW_LENGTH),St=n.getParameter(n.UNPACK_SKIP_PIXELS),Ut=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,V.width);for(let He=0,Ye=Me.length;He<Ye;He++){const xt=Me[He],pt=Math.floor(xt.start/4),st=Math.ceil(xt.count/4),rn=pt%V.width,re=Math.floor(pt/V.width),ct=st,Xe=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,rn),n.pixelStorei(n.UNPACK_SKIP_ROWS,re),t.texSubImage2D(n.TEXTURE_2D,0,rn,re,ct,Xe,ae,Ee,V.data)}X.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,Qe),n.pixelStorei(n.UNPACK_SKIP_PIXELS,St),n.pixelStorei(n.UNPACK_SKIP_ROWS,Ut)}}function ge(X,V,ae){let Ee=n.TEXTURE_2D;(V.isDataArrayTexture||V.isCompressedArrayTexture)&&(Ee=n.TEXTURE_2D_ARRAY),V.isData3DTexture&&(Ee=n.TEXTURE_3D);const ze=Ne(X,V),Me=V.source;t.bindTexture(Ee,X.__webglTexture,n.TEXTURE0+ae);const gt=i.get(Me);if(Me.version!==gt.__version||ze===!0){t.activeTexture(n.TEXTURE0+ae);const Qe=kn.getPrimaries(kn.workingColorSpace),St=V.colorSpace===gc?null:kn.getPrimaries(V.colorSpace),Ut=V.colorSpace===gc||Qe===St?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,V.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,V.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ut);let He=R(V.image,!1,s.maxTextureSize);He=Rt(V,He);const Ye=r.convert(V.format,V.colorSpace),xt=r.convert(V.type);let pt=D(V.internalFormat,Ye,xt,V.colorSpace,V.isVideoTexture);de(Ee,V);let st;const rn=V.mipmaps,re=V.isVideoTexture!==!0,ct=gt.__version===void 0||ze===!0,Xe=Me.dataReady,dt=j(V,He);if(V.isDepthTexture)pt=U(V.format===Iu,V.type),ct&&(re?t.texStorage2D(n.TEXTURE_2D,1,pt,He.width,He.height):t.texImage2D(n.TEXTURE_2D,0,pt,He.width,He.height,0,Ye,xt,null));else if(V.isDataTexture)if(rn.length>0){re&&ct&&t.texStorage2D(n.TEXTURE_2D,dt,pt,rn[0].width,rn[0].height);for(let Ge=0,Le=rn.length;Ge<Le;Ge++)st=rn[Ge],re?Xe&&t.texSubImage2D(n.TEXTURE_2D,Ge,0,0,st.width,st.height,Ye,xt,st.data):t.texImage2D(n.TEXTURE_2D,Ge,pt,st.width,st.height,0,Ye,xt,st.data);V.generateMipmaps=!1}else re?(ct&&t.texStorage2D(n.TEXTURE_2D,dt,pt,He.width,He.height),Xe&&lt(V,He,Ye,xt)):t.texImage2D(n.TEXTURE_2D,0,pt,He.width,He.height,0,Ye,xt,He.data);else if(V.isCompressedTexture)if(V.isCompressedArrayTexture){re&&ct&&t.texStorage3D(n.TEXTURE_2D_ARRAY,dt,pt,rn[0].width,rn[0].height,He.depth);for(let Ge=0,Le=rn.length;Ge<Le;Ge++)if(st=rn[Ge],V.format!==Es)if(Ye!==null)if(re){if(Xe)if(V.layerUpdates.size>0){const et=u1(st.width,st.height,V.format,V.type);for(const $t of V.layerUpdates){const Tn=st.data.subarray($t*et/st.data.BYTES_PER_ELEMENT,($t+1)*et/st.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ge,0,0,$t,st.width,st.height,1,Ye,Tn)}V.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ge,0,0,0,st.width,st.height,He.depth,Ye,st.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ge,pt,st.width,st.height,He.depth,0,st.data,0,0);else ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else re?Xe&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ge,0,0,0,st.width,st.height,He.depth,Ye,xt,st.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ge,pt,st.width,st.height,He.depth,0,Ye,xt,st.data)}else{re&&ct&&t.texStorage2D(n.TEXTURE_2D,dt,pt,rn[0].width,rn[0].height);for(let Ge=0,Le=rn.length;Ge<Le;Ge++)st=rn[Ge],V.format!==Es?Ye!==null?re?Xe&&t.compressedTexSubImage2D(n.TEXTURE_2D,Ge,0,0,st.width,st.height,Ye,st.data):t.compressedTexImage2D(n.TEXTURE_2D,Ge,pt,st.width,st.height,0,st.data):ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):re?Xe&&t.texSubImage2D(n.TEXTURE_2D,Ge,0,0,st.width,st.height,Ye,xt,st.data):t.texImage2D(n.TEXTURE_2D,Ge,pt,st.width,st.height,0,Ye,xt,st.data)}else if(V.isDataArrayTexture)if(re){if(ct&&t.texStorage3D(n.TEXTURE_2D_ARRAY,dt,pt,He.width,He.height,He.depth),Xe)if(V.layerUpdates.size>0){const Ge=u1(He.width,He.height,V.format,V.type);for(const Le of V.layerUpdates){const et=He.data.subarray(Le*Ge/He.data.BYTES_PER_ELEMENT,(Le+1)*Ge/He.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Le,He.width,He.height,1,Ye,xt,et)}V.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,He.width,He.height,He.depth,Ye,xt,He.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,pt,He.width,He.height,He.depth,0,Ye,xt,He.data);else if(V.isData3DTexture)re?(ct&&t.texStorage3D(n.TEXTURE_3D,dt,pt,He.width,He.height,He.depth),Xe&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,He.width,He.height,He.depth,Ye,xt,He.data)):t.texImage3D(n.TEXTURE_3D,0,pt,He.width,He.height,He.depth,0,Ye,xt,He.data);else if(V.isFramebufferTexture){if(ct)if(re)t.texStorage2D(n.TEXTURE_2D,dt,pt,He.width,He.height);else{let Ge=He.width,Le=He.height;for(let et=0;et<dt;et++)t.texImage2D(n.TEXTURE_2D,et,pt,Ge,Le,0,Ye,xt,null),Ge>>=1,Le>>=1}}else if(rn.length>0){if(re&&ct){const Ge=Je(rn[0]);t.texStorage2D(n.TEXTURE_2D,dt,pt,Ge.width,Ge.height)}for(let Ge=0,Le=rn.length;Ge<Le;Ge++)st=rn[Ge],re?Xe&&t.texSubImage2D(n.TEXTURE_2D,Ge,0,0,Ye,xt,st):t.texImage2D(n.TEXTURE_2D,Ge,pt,Ye,xt,st);V.generateMipmaps=!1}else if(re){if(ct){const Ge=Je(He);t.texStorage2D(n.TEXTURE_2D,dt,pt,Ge.width,Ge.height)}Xe&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ye,xt,He)}else t.texImage2D(n.TEXTURE_2D,0,pt,Ye,xt,He);N(V)&&A(Ee),gt.__version=Me.version,V.onUpdate&&V.onUpdate(V)}X.__version=V.version}function Ce(X,V,ae){if(V.image.length!==6)return;const Ee=Ne(X,V),ze=V.source;t.bindTexture(n.TEXTURE_CUBE_MAP,X.__webglTexture,n.TEXTURE0+ae);const Me=i.get(ze);if(ze.version!==Me.__version||Ee===!0){t.activeTexture(n.TEXTURE0+ae);const gt=kn.getPrimaries(kn.workingColorSpace),Qe=V.colorSpace===gc?null:kn.getPrimaries(V.colorSpace),St=V.colorSpace===gc||gt===Qe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,V.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,V.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,St);const Ut=V.isCompressedTexture||V.image[0].isCompressedTexture,He=V.image[0]&&V.image[0].isDataTexture,Ye=[];for(let Le=0;Le<6;Le++)!Ut&&!He?Ye[Le]=R(V.image[Le],!0,s.maxCubemapSize):Ye[Le]=He?V.image[Le].image:V.image[Le],Ye[Le]=Rt(V,Ye[Le]);const xt=Ye[0],pt=r.convert(V.format,V.colorSpace),st=r.convert(V.type),rn=D(V.internalFormat,pt,st,V.colorSpace),re=V.isVideoTexture!==!0,ct=Me.__version===void 0||Ee===!0,Xe=ze.dataReady;let dt=j(V,xt);de(n.TEXTURE_CUBE_MAP,V);let Ge;if(Ut){re&&ct&&t.texStorage2D(n.TEXTURE_CUBE_MAP,dt,rn,xt.width,xt.height);for(let Le=0;Le<6;Le++){Ge=Ye[Le].mipmaps;for(let et=0;et<Ge.length;et++){const $t=Ge[et];V.format!==Es?pt!==null?re?Xe&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,et,0,0,$t.width,$t.height,pt,$t.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,et,rn,$t.width,$t.height,0,$t.data):ht("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):re?Xe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,et,0,0,$t.width,$t.height,pt,st,$t.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,et,rn,$t.width,$t.height,0,pt,st,$t.data)}}}else{if(Ge=V.mipmaps,re&&ct){Ge.length>0&&dt++;const Le=Je(Ye[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,dt,rn,Le.width,Le.height)}for(let Le=0;Le<6;Le++)if(He){re?Xe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,0,0,Ye[Le].width,Ye[Le].height,pt,st,Ye[Le].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,rn,Ye[Le].width,Ye[Le].height,0,pt,st,Ye[Le].data);for(let et=0;et<Ge.length;et++){const Tn=Ge[et].image[Le].image;re?Xe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,et+1,0,0,Tn.width,Tn.height,pt,st,Tn.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,et+1,rn,Tn.width,Tn.height,0,pt,st,Tn.data)}}else{re?Xe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,0,0,pt,st,Ye[Le]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,0,rn,pt,st,Ye[Le]);for(let et=0;et<Ge.length;et++){const $t=Ge[et];re?Xe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,et+1,0,0,pt,st,$t.image[Le]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Le,et+1,rn,pt,st,$t.image[Le])}}}N(V)&&A(n.TEXTURE_CUBE_MAP),Me.__version=ze.version,V.onUpdate&&V.onUpdate(V)}X.__version=V.version}function nt(X,V,ae,Ee,ze,Me){const gt=r.convert(ae.format,ae.colorSpace),Qe=r.convert(ae.type),St=D(ae.internalFormat,gt,Qe,ae.colorSpace),Ut=i.get(V),He=i.get(ae);if(He.__renderTarget=V,!Ut.__hasExternalTextures){const Ye=Math.max(1,V.width>>Me),xt=Math.max(1,V.height>>Me);ze===n.TEXTURE_3D||ze===n.TEXTURE_2D_ARRAY?t.texImage3D(ze,Me,St,Ye,xt,V.depth,0,gt,Qe,null):t.texImage2D(ze,Me,St,Ye,xt,0,gt,Qe,null)}t.bindFramebuffer(n.FRAMEBUFFER,X),Nt(V)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Ee,ze,He.__webglTexture,0,Z(V)):(ze===n.TEXTURE_2D||ze>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ze<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Ee,ze,He.__webglTexture,Me),t.bindFramebuffer(n.FRAMEBUFFER,null)}function rt(X,V,ae){if(n.bindRenderbuffer(n.RENDERBUFFER,X),V.depthBuffer){const Ee=V.depthTexture,ze=Ee&&Ee.isDepthTexture?Ee.type:null,Me=U(V.stencilBuffer,ze),gt=V.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;Nt(V)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Z(V),Me,V.width,V.height):ae?n.renderbufferStorageMultisample(n.RENDERBUFFER,Z(V),Me,V.width,V.height):n.renderbufferStorage(n.RENDERBUFFER,Me,V.width,V.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,gt,n.RENDERBUFFER,X)}else{const Ee=V.textures;for(let ze=0;ze<Ee.length;ze++){const Me=Ee[ze],gt=r.convert(Me.format,Me.colorSpace),Qe=r.convert(Me.type),St=D(Me.internalFormat,gt,Qe,Me.colorSpace);Nt(V)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Z(V),St,V.width,V.height):ae?n.renderbufferStorageMultisample(n.RENDERBUFFER,Z(V),St,V.width,V.height):n.renderbufferStorage(n.RENDERBUFFER,St,V.width,V.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function mt(X,V,ae){const Ee=V.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(n.FRAMEBUFFER,X),!(V.depthTexture&&V.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ze=i.get(V.depthTexture);if(ze.__renderTarget=V,(!ze.__webglTexture||V.depthTexture.image.width!==V.width||V.depthTexture.image.height!==V.height)&&(V.depthTexture.image.width=V.width,V.depthTexture.image.height=V.height,V.depthTexture.needsUpdate=!0),Ee){if(ze.__webglInit===void 0&&(ze.__webglInit=!0,V.depthTexture.addEventListener("dispose",F)),ze.__webglTexture===void 0){ze.__webglTexture=n.createTexture(),t.bindTexture(n.TEXTURE_CUBE_MAP,ze.__webglTexture),de(n.TEXTURE_CUBE_MAP,V.depthTexture);const Ut=r.convert(V.depthTexture.format),He=r.convert(V.depthTexture.type);let Ye;V.depthTexture.format===El?Ye=n.DEPTH_COMPONENT24:V.depthTexture.format===Iu&&(Ye=n.DEPTH24_STENCIL8);for(let xt=0;xt<6;xt++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+xt,0,Ye,V.width,V.height,0,Ut,He,null)}}else oe(V.depthTexture,0);const Me=ze.__webglTexture,gt=Z(V),Qe=Ee?n.TEXTURE_CUBE_MAP_POSITIVE_X+ae:n.TEXTURE_2D,St=V.depthTexture.format===Iu?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(V.depthTexture.format===El)Nt(V)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,St,Qe,Me,0,gt):n.framebufferTexture2D(n.FRAMEBUFFER,St,Qe,Me,0);else if(V.depthTexture.format===Iu)Nt(V)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,St,Qe,Me,0,gt):n.framebufferTexture2D(n.FRAMEBUFFER,St,Qe,Me,0);else throw new Error("Unknown depthTexture format")}function ln(X){const V=i.get(X),ae=X.isWebGLCubeRenderTarget===!0;if(V.__boundDepthTexture!==X.depthTexture){const Ee=X.depthTexture;if(V.__depthDisposeCallback&&V.__depthDisposeCallback(),Ee){const ze=()=>{delete V.__boundDepthTexture,delete V.__depthDisposeCallback,Ee.removeEventListener("dispose",ze)};Ee.addEventListener("dispose",ze),V.__depthDisposeCallback=ze}V.__boundDepthTexture=Ee}if(X.depthTexture&&!V.__autoAllocateDepthBuffer)if(ae)for(let Ee=0;Ee<6;Ee++)mt(V.__webglFramebuffer[Ee],X,Ee);else{const Ee=X.texture.mipmaps;Ee&&Ee.length>0?mt(V.__webglFramebuffer[0],X,0):mt(V.__webglFramebuffer,X,0)}else if(ae){V.__webglDepthbuffer=[];for(let Ee=0;Ee<6;Ee++)if(t.bindFramebuffer(n.FRAMEBUFFER,V.__webglFramebuffer[Ee]),V.__webglDepthbuffer[Ee]===void 0)V.__webglDepthbuffer[Ee]=n.createRenderbuffer(),rt(V.__webglDepthbuffer[Ee],X,!1);else{const ze=X.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Me=V.__webglDepthbuffer[Ee];n.bindRenderbuffer(n.RENDERBUFFER,Me),n.framebufferRenderbuffer(n.FRAMEBUFFER,ze,n.RENDERBUFFER,Me)}}else{const Ee=X.texture.mipmaps;if(Ee&&Ee.length>0?t.bindFramebuffer(n.FRAMEBUFFER,V.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,V.__webglFramebuffer),V.__webglDepthbuffer===void 0)V.__webglDepthbuffer=n.createRenderbuffer(),rt(V.__webglDepthbuffer,X,!1);else{const ze=X.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Me=V.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,Me),n.framebufferRenderbuffer(n.FRAMEBUFFER,ze,n.RENDERBUFFER,Me)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function vn(X,V,ae){const Ee=i.get(X);V!==void 0&&nt(Ee.__webglFramebuffer,X,X.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),ae!==void 0&&ln(X)}function zt(X){const V=X.texture,ae=i.get(X),Ee=i.get(V);X.addEventListener("dispose",z);const ze=X.textures,Me=X.isWebGLCubeRenderTarget===!0,gt=ze.length>1;if(gt||(Ee.__webglTexture===void 0&&(Ee.__webglTexture=n.createTexture()),Ee.__version=V.version,o.memory.textures++),Me){ae.__webglFramebuffer=[];for(let Qe=0;Qe<6;Qe++)if(V.mipmaps&&V.mipmaps.length>0){ae.__webglFramebuffer[Qe]=[];for(let St=0;St<V.mipmaps.length;St++)ae.__webglFramebuffer[Qe][St]=n.createFramebuffer()}else ae.__webglFramebuffer[Qe]=n.createFramebuffer()}else{if(V.mipmaps&&V.mipmaps.length>0){ae.__webglFramebuffer=[];for(let Qe=0;Qe<V.mipmaps.length;Qe++)ae.__webglFramebuffer[Qe]=n.createFramebuffer()}else ae.__webglFramebuffer=n.createFramebuffer();if(gt)for(let Qe=0,St=ze.length;Qe<St;Qe++){const Ut=i.get(ze[Qe]);Ut.__webglTexture===void 0&&(Ut.__webglTexture=n.createTexture(),o.memory.textures++)}if(X.samples>0&&Nt(X)===!1){ae.__webglMultisampledFramebuffer=n.createFramebuffer(),ae.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,ae.__webglMultisampledFramebuffer);for(let Qe=0;Qe<ze.length;Qe++){const St=ze[Qe];ae.__webglColorRenderbuffer[Qe]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ae.__webglColorRenderbuffer[Qe]);const Ut=r.convert(St.format,St.colorSpace),He=r.convert(St.type),Ye=D(St.internalFormat,Ut,He,St.colorSpace,X.isXRRenderTarget===!0),xt=Z(X);n.renderbufferStorageMultisample(n.RENDERBUFFER,xt,Ye,X.width,X.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Qe,n.RENDERBUFFER,ae.__webglColorRenderbuffer[Qe])}n.bindRenderbuffer(n.RENDERBUFFER,null),X.depthBuffer&&(ae.__webglDepthRenderbuffer=n.createRenderbuffer(),rt(ae.__webglDepthRenderbuffer,X,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Me){t.bindTexture(n.TEXTURE_CUBE_MAP,Ee.__webglTexture),de(n.TEXTURE_CUBE_MAP,V);for(let Qe=0;Qe<6;Qe++)if(V.mipmaps&&V.mipmaps.length>0)for(let St=0;St<V.mipmaps.length;St++)nt(ae.__webglFramebuffer[Qe][St],X,V,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,St);else nt(ae.__webglFramebuffer[Qe],X,V,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Qe,0);N(V)&&A(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(gt){for(let Qe=0,St=ze.length;Qe<St;Qe++){const Ut=ze[Qe],He=i.get(Ut);let Ye=n.TEXTURE_2D;(X.isWebGL3DRenderTarget||X.isWebGLArrayRenderTarget)&&(Ye=X.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Ye,He.__webglTexture),de(Ye,Ut),nt(ae.__webglFramebuffer,X,Ut,n.COLOR_ATTACHMENT0+Qe,Ye,0),N(Ut)&&A(Ye)}t.unbindTexture()}else{let Qe=n.TEXTURE_2D;if((X.isWebGL3DRenderTarget||X.isWebGLArrayRenderTarget)&&(Qe=X.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Qe,Ee.__webglTexture),de(Qe,V),V.mipmaps&&V.mipmaps.length>0)for(let St=0;St<V.mipmaps.length;St++)nt(ae.__webglFramebuffer[St],X,V,n.COLOR_ATTACHMENT0,Qe,St);else nt(ae.__webglFramebuffer,X,V,n.COLOR_ATTACHMENT0,Qe,0);N(V)&&A(Qe),t.unbindTexture()}X.depthBuffer&&ln(X)}function Pe(X){const V=X.textures;for(let ae=0,Ee=V.length;ae<Ee;ae++){const ze=V[ae];if(N(ze)){const Me=I(X),gt=i.get(ze).__webglTexture;t.bindTexture(Me,gt),A(Me),t.unbindTexture()}}}const qe=[],Oe=[];function it(X){if(X.samples>0){if(Nt(X)===!1){const V=X.textures,ae=X.width,Ee=X.height;let ze=n.COLOR_BUFFER_BIT;const Me=X.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,gt=i.get(X),Qe=V.length>1;if(Qe)for(let Ut=0;Ut<V.length;Ut++)t.bindFramebuffer(n.FRAMEBUFFER,gt.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ut,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,gt.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ut,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,gt.__webglMultisampledFramebuffer);const St=X.texture.mipmaps;St&&St.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,gt.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,gt.__webglFramebuffer);for(let Ut=0;Ut<V.length;Ut++){if(X.resolveDepthBuffer&&(X.depthBuffer&&(ze|=n.DEPTH_BUFFER_BIT),X.stencilBuffer&&X.resolveStencilBuffer&&(ze|=n.STENCIL_BUFFER_BIT)),Qe){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,gt.__webglColorRenderbuffer[Ut]);const He=i.get(V[Ut]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,He,0)}n.blitFramebuffer(0,0,ae,Ee,0,0,ae,Ee,ze,n.NEAREST),h===!0&&(qe.length=0,Oe.length=0,qe.push(n.COLOR_ATTACHMENT0+Ut),X.depthBuffer&&X.resolveDepthBuffer===!1&&(qe.push(Me),Oe.push(Me),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,Oe)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,qe))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Qe)for(let Ut=0;Ut<V.length;Ut++){t.bindFramebuffer(n.FRAMEBUFFER,gt.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ut,n.RENDERBUFFER,gt.__webglColorRenderbuffer[Ut]);const He=i.get(V[Ut]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,gt.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ut,n.TEXTURE_2D,He,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,gt.__webglMultisampledFramebuffer)}else if(X.depthBuffer&&X.resolveDepthBuffer===!1&&h){const V=X.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[V])}}}function Z(X){return Math.min(s.maxSamples,X.samples)}function Nt(X){const V=i.get(X);return X.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&V.__useRenderToTexture!==!1}function ot(X){const V=o.render.frame;g.get(X)!==V&&(g.set(X,V),X.update())}function Rt(X,V){const ae=X.colorSpace,Ee=X.format,ze=X.type;return X.isCompressedTexture===!0||X.isVideoTexture===!0||ae!==Ou&&ae!==gc&&(kn.getTransfer(ae)===$n?(Ee!==Es||ze!==Er)&&ht("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Dt("WebGLTextures: Unsupported texture color space:",ae)),V}function Je(X){return typeof HTMLImageElement<"u"&&X instanceof HTMLImageElement?(p.width=X.naturalWidth||X.width,p.height=X.naturalHeight||X.height):typeof VideoFrame<"u"&&X instanceof VideoFrame?(p.width=X.displayWidth,p.height=X.displayHeight):(p.width=X.width,p.height=X.height),p}this.allocateTextureUnit=Q,this.resetTextureUnits=ee,this.setTexture2D=oe,this.setTexture2DArray=J,this.setTexture3D=te,this.setTextureCube=me,this.rebindTextures=vn,this.setupRenderTarget=zt,this.updateRenderTargetMipmap=Pe,this.updateMultisampleRenderTarget=it,this.setupDepthRenderbuffer=ln,this.setupFrameBufferTexture=nt,this.useMultisampledRTT=Nt,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function TI(n,e){function t(i,s=gc){let r;const o=kn.getTransfer(s);if(i===Er)return n.UNSIGNED_BYTE;if(i===Jb)return n.UNSIGNED_SHORT_4_4_4_4;if(i===Kb)return n.UNSIGNED_SHORT_5_5_5_1;if(i===Q1)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===eT)return n.UNSIGNED_INT_10F_11F_11F_REV;if(i===K1)return n.BYTE;if(i===Z1)return n.SHORT;if(i===bp)return n.UNSIGNED_SHORT;if(i===Yb)return n.INT;if(i===Za)return n.UNSIGNED_INT;if(i===Ts)return n.FLOAT;if(i===Po)return n.HALF_FLOAT;if(i===tT)return n.ALPHA;if(i===nT)return n.RGB;if(i===Es)return n.RGBA;if(i===El)return n.DEPTH_COMPONENT;if(i===Iu)return n.DEPTH_STENCIL;if(i===Zb)return n.RED;if(i===E0)return n.RED_INTEGER;if(i===dh)return n.RG;if(i===Qb)return n.RG_INTEGER;if(i===e_)return n.RGBA_INTEGER;if(i===Fg||i===Bg||i===Vg||i===Hg)if(o===$n)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(i===Fg)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===Bg)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Vg)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Hg)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(i===Fg)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===Bg)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Vg)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Hg)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===By||i===Vy||i===Hy||i===Gy)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(i===By)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Vy)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===Hy)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===Gy)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===qy||i===Wy||i===$y||i===Xy||i===Yy||i===Jy||i===Ky)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(i===qy||i===Wy)return o===$n?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(i===$y)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC;if(i===Xy)return r.COMPRESSED_R11_EAC;if(i===Yy)return r.COMPRESSED_SIGNED_R11_EAC;if(i===Jy)return r.COMPRESSED_RG11_EAC;if(i===Ky)return r.COMPRESSED_SIGNED_RG11_EAC}else return null;if(i===Zy||i===Qy||i===eb||i===tb||i===nb||i===ib||i===sb||i===rb||i===ab||i===ob||i===lb||i===cb||i===ub||i===db)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(i===Zy)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===Qy)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===eb)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===tb)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===nb)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===ib)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===sb)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===rb)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===ab)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===ob)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===lb)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===cb)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===ub)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===db)return o===$n?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===hb||i===fb||i===pb)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(i===hb)return o===$n?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===fb)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===pb)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===mb||i===gb||i===xb||i===vb)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(i===mb)return r.COMPRESSED_RED_RGTC1_EXT;if(i===gb)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===xb)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===vb)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===_p?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}const eV=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,tV=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class nV{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const i=new hT(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new na({vertexShader:eV,fragmentShader:tV,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new os(new Dp(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class iV extends Al{constructor(e,t){super();const i=this;let s=null,r=1,o=null,c="local-floor",h=1,p=null,g=null,v=null,y=null,w=null,E=null;const R=typeof XRWebGLBinding<"u",N=new nV,A={},I=t.getContextAttributes();let D=null,U=null;const j=[],F=[],z=new Be;let W=null;const L=new Ss;L.viewport=new ii;const B=new Ss;B.viewport=new ii;const Y=[L,B],ee=new pI;let Q=null,ce=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ge){let Ce=j[ge];return Ce===void 0&&(Ce=new by,j[ge]=Ce),Ce.getTargetRaySpace()},this.getControllerGrip=function(ge){let Ce=j[ge];return Ce===void 0&&(Ce=new by,j[ge]=Ce),Ce.getGripSpace()},this.getHand=function(ge){let Ce=j[ge];return Ce===void 0&&(Ce=new by,j[ge]=Ce),Ce.getHandSpace()};function oe(ge){const Ce=F.indexOf(ge.inputSource);if(Ce===-1)return;const nt=j[Ce];nt!==void 0&&(nt.update(ge.inputSource,ge.frame,p||o),nt.dispatchEvent({type:ge.type,data:ge.inputSource}))}function J(){s.removeEventListener("select",oe),s.removeEventListener("selectstart",oe),s.removeEventListener("selectend",oe),s.removeEventListener("squeeze",oe),s.removeEventListener("squeezestart",oe),s.removeEventListener("squeezeend",oe),s.removeEventListener("end",J),s.removeEventListener("inputsourceschange",te);for(let ge=0;ge<j.length;ge++){const Ce=F[ge];Ce!==null&&(F[ge]=null,j[ge].disconnect(Ce))}Q=null,ce=null,N.reset();for(const ge in A)delete A[ge];e.setRenderTarget(D),w=null,y=null,v=null,s=null,U=null,lt.stop(),i.isPresenting=!1,e.setPixelRatio(W),e.setSize(z.width,z.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ge){r=ge,i.isPresenting===!0&&ht("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ge){c=ge,i.isPresenting===!0&&ht("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||o},this.setReferenceSpace=function(ge){p=ge},this.getBaseLayer=function(){return y!==null?y:w},this.getBinding=function(){return v===null&&R&&(v=new XRWebGLBinding(s,t)),v},this.getFrame=function(){return E},this.getSession=function(){return s},this.setSession=async function(ge){if(s=ge,s!==null){if(D=e.getRenderTarget(),s.addEventListener("select",oe),s.addEventListener("selectstart",oe),s.addEventListener("selectend",oe),s.addEventListener("squeeze",oe),s.addEventListener("squeezestart",oe),s.addEventListener("squeezeend",oe),s.addEventListener("end",J),s.addEventListener("inputsourceschange",te),I.xrCompatible!==!0&&await t.makeXRCompatible(),W=e.getPixelRatio(),e.getSize(z),R&&"createProjectionLayer"in XRWebGLBinding.prototype){let nt=null,rt=null,mt=null;I.depth&&(mt=I.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,nt=I.stencil?Iu:El,rt=I.stencil?_p:Za);const ln={colorFormat:t.RGBA8,depthFormat:mt,scaleFactor:r};v=this.getBinding(),y=v.createProjectionLayer(ln),s.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),U=new ta(y.textureWidth,y.textureHeight,{format:Es,type:Er,depthTexture:new fh(y.textureWidth,y.textureHeight,rt,void 0,void 0,void 0,void 0,void 0,void 0,nt),stencilBuffer:I.stencil,colorSpace:e.outputColorSpace,samples:I.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1})}else{const nt={antialias:I.antialias,alpha:!0,depth:I.depth,stencil:I.stencil,framebufferScaleFactor:r};w=new XRWebGLLayer(s,t,nt),s.updateRenderState({baseLayer:w}),e.setPixelRatio(1),e.setSize(w.framebufferWidth,w.framebufferHeight,!1),U=new ta(w.framebufferWidth,w.framebufferHeight,{format:Es,type:Er,colorSpace:e.outputColorSpace,stencilBuffer:I.stencil,resolveDepthBuffer:w.ignoreDepthValues===!1,resolveStencilBuffer:w.ignoreDepthValues===!1})}U.isXRRenderTarget=!0,this.setFoveation(h),p=null,o=await s.requestReferenceSpace(c),lt.setContext(s),lt.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode},this.getDepthTexture=function(){return N.getDepthTexture()};function te(ge){for(let Ce=0;Ce<ge.removed.length;Ce++){const nt=ge.removed[Ce],rt=F.indexOf(nt);rt>=0&&(F[rt]=null,j[rt].disconnect(nt))}for(let Ce=0;Ce<ge.added.length;Ce++){const nt=ge.added[Ce];let rt=F.indexOf(nt);if(rt===-1){for(let ln=0;ln<j.length;ln++)if(ln>=F.length){F.push(nt),rt=ln;break}else if(F[ln]===null){F[ln]=nt,rt=ln;break}if(rt===-1)break}const mt=j[rt];mt&&mt.connect(nt)}}const me=new K,Re=new K;function Ie(ge,Ce,nt){me.setFromMatrixPosition(Ce.matrixWorld),Re.setFromMatrixPosition(nt.matrixWorld);const rt=me.distanceTo(Re),mt=Ce.projectionMatrix.elements,ln=nt.projectionMatrix.elements,vn=mt[14]/(mt[10]-1),zt=mt[14]/(mt[10]+1),Pe=(mt[9]+1)/mt[5],qe=(mt[9]-1)/mt[5],Oe=(mt[8]-1)/mt[0],it=(ln[8]+1)/ln[0],Z=vn*Oe,Nt=vn*it,ot=rt/(-Oe+it),Rt=ot*-Oe;if(Ce.matrixWorld.decompose(ge.position,ge.quaternion,ge.scale),ge.translateX(Rt),ge.translateZ(ot),ge.matrixWorld.compose(ge.position,ge.quaternion,ge.scale),ge.matrixWorldInverse.copy(ge.matrixWorld).invert(),mt[10]===-1)ge.projectionMatrix.copy(Ce.projectionMatrix),ge.projectionMatrixInverse.copy(Ce.projectionMatrixInverse);else{const Je=vn+ot,X=zt+ot,V=Z-Rt,ae=Nt+(rt-Rt),Ee=Pe*zt/X*Je,ze=qe*zt/X*Je;ge.projectionMatrix.makePerspective(V,ae,Ee,ze,Je,X),ge.projectionMatrixInverse.copy(ge.projectionMatrix).invert()}}function $(ge,Ce){Ce===null?ge.matrixWorld.copy(ge.matrix):ge.matrixWorld.multiplyMatrices(Ce.matrixWorld,ge.matrix),ge.matrixWorldInverse.copy(ge.matrixWorld).invert()}this.updateCamera=function(ge){if(s===null)return;let Ce=ge.near,nt=ge.far;N.texture!==null&&(N.depthNear>0&&(Ce=N.depthNear),N.depthFar>0&&(nt=N.depthFar)),ee.near=B.near=L.near=Ce,ee.far=B.far=L.far=nt,(Q!==ee.near||ce!==ee.far)&&(s.updateRenderState({depthNear:ee.near,depthFar:ee.far}),Q=ee.near,ce=ee.far),ee.layers.mask=ge.layers.mask|6,L.layers.mask=ee.layers.mask&3,B.layers.mask=ee.layers.mask&5;const rt=ge.parent,mt=ee.cameras;$(ee,rt);for(let ln=0;ln<mt.length;ln++)$(mt[ln],rt);mt.length===2?Ie(ee,L,B):ee.projectionMatrix.copy(L.projectionMatrix),de(ge,ee,rt)};function de(ge,Ce,nt){nt===null?ge.matrix.copy(Ce.matrixWorld):(ge.matrix.copy(nt.matrixWorld),ge.matrix.invert(),ge.matrix.multiply(Ce.matrixWorld)),ge.matrix.decompose(ge.position,ge.quaternion,ge.scale),ge.updateMatrixWorld(!0),ge.projectionMatrix.copy(Ce.projectionMatrix),ge.projectionMatrixInverse.copy(Ce.projectionMatrixInverse),ge.isPerspectiveCamera&&(ge.fov=Tp*2*Math.atan(1/ge.projectionMatrix.elements[5]),ge.zoom=1)}this.getCamera=function(){return ee},this.getFoveation=function(){if(!(y===null&&w===null))return h},this.setFoveation=function(ge){h=ge,y!==null&&(y.fixedFoveation=ge),w!==null&&w.fixedFoveation!==void 0&&(w.fixedFoveation=ge)},this.hasDepthSensing=function(){return N.texture!==null},this.getDepthSensingMesh=function(){return N.getMesh(ee)},this.getCameraTexture=function(ge){return A[ge]};let Ne=null;function Fe(ge,Ce){if(g=Ce.getViewerPose(p||o),E=Ce,g!==null){const nt=g.views;w!==null&&(e.setRenderTargetFramebuffer(U,w.framebuffer),e.setRenderTarget(U));let rt=!1;nt.length!==ee.cameras.length&&(ee.cameras.length=0,rt=!0);for(let zt=0;zt<nt.length;zt++){const Pe=nt[zt];let qe=null;if(w!==null)qe=w.getViewport(Pe);else{const it=v.getViewSubImage(y,Pe);qe=it.viewport,zt===0&&(e.setRenderTargetTextures(U,it.colorTexture,it.depthStencilTexture),e.setRenderTarget(U))}let Oe=Y[zt];Oe===void 0&&(Oe=new Ss,Oe.layers.enable(zt),Oe.viewport=new ii,Y[zt]=Oe),Oe.matrix.fromArray(Pe.transform.matrix),Oe.matrix.decompose(Oe.position,Oe.quaternion,Oe.scale),Oe.projectionMatrix.fromArray(Pe.projectionMatrix),Oe.projectionMatrixInverse.copy(Oe.projectionMatrix).invert(),Oe.viewport.set(qe.x,qe.y,qe.width,qe.height),zt===0&&(ee.matrix.copy(Oe.matrix),ee.matrix.decompose(ee.position,ee.quaternion,ee.scale)),rt===!0&&ee.cameras.push(Oe)}const mt=s.enabledFeatures;if(mt&&mt.includes("depth-sensing")&&s.depthUsage=="gpu-optimized"&&R){v=i.getBinding();const zt=v.getDepthInformation(nt[0]);zt&&zt.isValid&&zt.texture&&N.init(zt,s.renderState)}if(mt&&mt.includes("camera-access")&&R){e.state.unbindTexture(),v=i.getBinding();for(let zt=0;zt<nt.length;zt++){const Pe=nt[zt].camera;if(Pe){let qe=A[Pe];qe||(qe=new hT,A[Pe]=qe);const Oe=v.getCameraImage(Pe);qe.sourceTexture=Oe}}}}for(let nt=0;nt<j.length;nt++){const rt=F[nt],mt=j[nt];rt!==null&&mt!==void 0&&mt.update(rt,Ce,p||o)}Ne&&Ne(ge,Ce),Ce.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Ce}),E=null}const lt=new yI;lt.setAnimationLoop(Fe),this.setAnimationLoop=function(ge){Ne=ge},this.dispose=function(){}}}const $d=new ya,sV=new Jt;function rV(n,e){function t(N,A){N.matrixAutoUpdate===!0&&N.updateMatrix(),A.value.copy(N.matrix)}function i(N,A){A.color.getRGB(N.fogColor.value,wk(n)),A.isFog?(N.fogNear.value=A.near,N.fogFar.value=A.far):A.isFogExp2&&(N.fogDensity.value=A.density)}function s(N,A,I,D,U){A.isMeshBasicMaterial||A.isMeshLambertMaterial?r(N,A):A.isMeshToonMaterial?(r(N,A),v(N,A)):A.isMeshPhongMaterial?(r(N,A),g(N,A)):A.isMeshStandardMaterial?(r(N,A),y(N,A),A.isMeshPhysicalMaterial&&w(N,A,U)):A.isMeshMatcapMaterial?(r(N,A),E(N,A)):A.isMeshDepthMaterial?r(N,A):A.isMeshDistanceMaterial?(r(N,A),R(N,A)):A.isMeshNormalMaterial?r(N,A):A.isLineBasicMaterial?(o(N,A),A.isLineDashedMaterial&&c(N,A)):A.isPointsMaterial?h(N,A,I,D):A.isSpriteMaterial?p(N,A):A.isShadowMaterial?(N.color.value.copy(A.color),N.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}function r(N,A){N.opacity.value=A.opacity,A.color&&N.diffuse.value.copy(A.color),A.emissive&&N.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(N.map.value=A.map,t(A.map,N.mapTransform)),A.alphaMap&&(N.alphaMap.value=A.alphaMap,t(A.alphaMap,N.alphaMapTransform)),A.bumpMap&&(N.bumpMap.value=A.bumpMap,t(A.bumpMap,N.bumpMapTransform),N.bumpScale.value=A.bumpScale,A.side===Ar&&(N.bumpScale.value*=-1)),A.normalMap&&(N.normalMap.value=A.normalMap,t(A.normalMap,N.normalMapTransform),N.normalScale.value.copy(A.normalScale),A.side===Ar&&N.normalScale.value.negate()),A.displacementMap&&(N.displacementMap.value=A.displacementMap,t(A.displacementMap,N.displacementMapTransform),N.displacementScale.value=A.displacementScale,N.displacementBias.value=A.displacementBias),A.emissiveMap&&(N.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,N.emissiveMapTransform)),A.specularMap&&(N.specularMap.value=A.specularMap,t(A.specularMap,N.specularMapTransform)),A.alphaTest>0&&(N.alphaTest.value=A.alphaTest);const I=e.get(A),D=I.envMap,U=I.envMapRotation;D&&(N.envMap.value=D,$d.copy(U),$d.x*=-1,$d.y*=-1,$d.z*=-1,D.isCubeTexture&&D.isRenderTargetTexture===!1&&($d.y*=-1,$d.z*=-1),N.envMapRotation.value.setFromMatrix4(sV.makeRotationFromEuler($d)),N.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,N.reflectivity.value=A.reflectivity,N.ior.value=A.ior,N.refractionRatio.value=A.refractionRatio),A.lightMap&&(N.lightMap.value=A.lightMap,N.lightMapIntensity.value=A.lightMapIntensity,t(A.lightMap,N.lightMapTransform)),A.aoMap&&(N.aoMap.value=A.aoMap,N.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,N.aoMapTransform))}function o(N,A){N.diffuse.value.copy(A.color),N.opacity.value=A.opacity,A.map&&(N.map.value=A.map,t(A.map,N.mapTransform))}function c(N,A){N.dashSize.value=A.dashSize,N.totalSize.value=A.dashSize+A.gapSize,N.scale.value=A.scale}function h(N,A,I,D){N.diffuse.value.copy(A.color),N.opacity.value=A.opacity,N.size.value=A.size*I,N.scale.value=D*.5,A.map&&(N.map.value=A.map,t(A.map,N.uvTransform)),A.alphaMap&&(N.alphaMap.value=A.alphaMap,t(A.alphaMap,N.alphaMapTransform)),A.alphaTest>0&&(N.alphaTest.value=A.alphaTest)}function p(N,A){N.diffuse.value.copy(A.color),N.opacity.value=A.opacity,N.rotation.value=A.rotation,A.map&&(N.map.value=A.map,t(A.map,N.mapTransform)),A.alphaMap&&(N.alphaMap.value=A.alphaMap,t(A.alphaMap,N.alphaMapTransform)),A.alphaTest>0&&(N.alphaTest.value=A.alphaTest)}function g(N,A){N.specular.value.copy(A.specular),N.shininess.value=Math.max(A.shininess,1e-4)}function v(N,A){A.gradientMap&&(N.gradientMap.value=A.gradientMap)}function y(N,A){N.metalness.value=A.metalness,A.metalnessMap&&(N.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,N.metalnessMapTransform)),N.roughness.value=A.roughness,A.roughnessMap&&(N.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,N.roughnessMapTransform)),A.envMap&&(N.envMapIntensity.value=A.envMapIntensity)}function w(N,A,I){N.ior.value=A.ior,A.sheen>0&&(N.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),N.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(N.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,N.sheenColorMapTransform)),A.sheenRoughnessMap&&(N.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,N.sheenRoughnessMapTransform))),A.clearcoat>0&&(N.clearcoat.value=A.clearcoat,N.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(N.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,N.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(N.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,N.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(N.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,N.clearcoatNormalMapTransform),N.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),A.side===Ar&&N.clearcoatNormalScale.value.negate())),A.dispersion>0&&(N.dispersion.value=A.dispersion),A.iridescence>0&&(N.iridescence.value=A.iridescence,N.iridescenceIOR.value=A.iridescenceIOR,N.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],N.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(N.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,N.iridescenceMapTransform)),A.iridescenceThicknessMap&&(N.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,N.iridescenceThicknessMapTransform))),A.transmission>0&&(N.transmission.value=A.transmission,N.transmissionSamplerMap.value=I.texture,N.transmissionSamplerSize.value.set(I.width,I.height),A.transmissionMap&&(N.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,N.transmissionMapTransform)),N.thickness.value=A.thickness,A.thicknessMap&&(N.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,N.thicknessMapTransform)),N.attenuationDistance.value=A.attenuationDistance,N.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(N.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(N.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,N.anisotropyMapTransform))),N.specularIntensity.value=A.specularIntensity,N.specularColor.value.copy(A.specularColor),A.specularColorMap&&(N.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,N.specularColorMapTransform)),A.specularIntensityMap&&(N.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,N.specularIntensityMapTransform))}function E(N,A){A.matcap&&(N.matcap.value=A.matcap)}function R(N,A){const I=e.get(A).light;N.referencePosition.value.setFromMatrixPosition(I.matrixWorld),N.nearDistance.value=I.shadow.camera.near,N.farDistance.value=I.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:s}}function aV(n,e,t,i){let s={},r={},o=[];const c=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function h(I,D){const U=D.program;i.uniformBlockBinding(I,U)}function p(I,D){let U=s[I.id];U===void 0&&(E(I),U=g(I),s[I.id]=U,I.addEventListener("dispose",N));const j=D.program;i.updateUBOMapping(I,j);const F=e.render.frame;r[I.id]!==F&&(y(I),r[I.id]=F)}function g(I){const D=v();I.__bindingPointIndex=D;const U=n.createBuffer(),j=I.__size,F=I.usage;return n.bindBuffer(n.UNIFORM_BUFFER,U),n.bufferData(n.UNIFORM_BUFFER,j,F),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,D,U),U}function v(){for(let I=0;I<c;I++)if(o.indexOf(I)===-1)return o.push(I),I;return Dt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function y(I){const D=s[I.id],U=I.uniforms,j=I.__cache;n.bindBuffer(n.UNIFORM_BUFFER,D);for(let F=0,z=U.length;F<z;F++){const W=Array.isArray(U[F])?U[F]:[U[F]];for(let L=0,B=W.length;L<B;L++){const Y=W[L];if(w(Y,F,L,j)===!0){const ee=Y.__offset,Q=Array.isArray(Y.value)?Y.value:[Y.value];let ce=0;for(let oe=0;oe<Q.length;oe++){const J=Q[oe],te=R(J);typeof J=="number"||typeof J=="boolean"?(Y.__data[0]=J,n.bufferSubData(n.UNIFORM_BUFFER,ee+ce,Y.__data)):J.isMatrix3?(Y.__data[0]=J.elements[0],Y.__data[1]=J.elements[1],Y.__data[2]=J.elements[2],Y.__data[3]=0,Y.__data[4]=J.elements[3],Y.__data[5]=J.elements[4],Y.__data[6]=J.elements[5],Y.__data[7]=0,Y.__data[8]=J.elements[6],Y.__data[9]=J.elements[7],Y.__data[10]=J.elements[8],Y.__data[11]=0):(J.toArray(Y.__data,ce),ce+=te.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,ee,Y.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function w(I,D,U,j){const F=I.value,z=D+"_"+U;if(j[z]===void 0)return typeof F=="number"||typeof F=="boolean"?j[z]=F:j[z]=F.clone(),!0;{const W=j[z];if(typeof F=="number"||typeof F=="boolean"){if(W!==F)return j[z]=F,!0}else if(W.equals(F)===!1)return W.copy(F),!0}return!1}function E(I){const D=I.uniforms;let U=0;const j=16;for(let z=0,W=D.length;z<W;z++){const L=Array.isArray(D[z])?D[z]:[D[z]];for(let B=0,Y=L.length;B<Y;B++){const ee=L[B],Q=Array.isArray(ee.value)?ee.value:[ee.value];for(let ce=0,oe=Q.length;ce<oe;ce++){const J=Q[ce],te=R(J),me=U%j,Re=me%te.boundary,Ie=me+Re;U+=Re,Ie!==0&&j-Ie<te.storage&&(U+=j-Ie),ee.__data=new Float32Array(te.storage/Float32Array.BYTES_PER_ELEMENT),ee.__offset=U,U+=te.storage}}}const F=U%j;return F>0&&(U+=j-F),I.__size=U,I.__cache={},this}function R(I){const D={boundary:0,storage:0};return typeof I=="number"||typeof I=="boolean"?(D.boundary=4,D.storage=4):I.isVector2?(D.boundary=8,D.storage=8):I.isVector3||I.isColor?(D.boundary=16,D.storage=12):I.isVector4?(D.boundary=16,D.storage=16):I.isMatrix3?(D.boundary=48,D.storage=48):I.isMatrix4?(D.boundary=64,D.storage=64):I.isTexture?ht("WebGLRenderer: Texture samplers can not be part of an uniforms group."):ht("WebGLRenderer: Unsupported uniform value type.",I),D}function N(I){const D=I.target;D.removeEventListener("dispose",N);const U=o.indexOf(D.__bindingPointIndex);o.splice(U,1),n.deleteBuffer(s[D.id]),delete s[D.id],delete r[D.id]}function A(){for(const I in s)n.deleteBuffer(s[I]);o=[],s={},r={}}return{bind:h,update:p,dispose:A}}const oV=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let vl=null;function lV(){return vl===null&&(vl=new Ya(oV,16,16,dh,Po),vl.name="DFG_LUT",vl.minFilter=si,vl.magFilter=si,vl.wrapS=Qr,vl.wrapT=Qr,vl.generateMipmaps=!1,vl.needsUpdate=!0),vl}class EI{constructor(e={}){const{canvas:t=yk(),context:i=null,depth:s=!0,stencil:r=!1,alpha:o=!1,antialias:c=!1,premultipliedAlpha:h=!0,preserveDrawingBuffer:p=!1,powerPreference:g="default",failIfMajorPerformanceCaveat:v=!1,reversedDepthBuffer:y=!1,outputBufferType:w=Er}=e;this.isWebGLRenderer=!0;let E;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");E=i.getContextAttributes().alpha}else E=o;const R=w,N=new Set([e_,Qb,E0]),A=new Set([Er,Za,bp,_p,Jb,Kb]),I=new Uint32Array(4),D=new Int32Array(4);let U=null,j=null;const F=[],z=[];let W=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Xa,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const L=this;let B=!1;this._outputColorSpace=sr;let Y=0,ee=0,Q=null,ce=-1,oe=null;const J=new ii,te=new ii;let me=null;const Re=new _t(0);let Ie=0,$=t.width,de=t.height,Ne=1,Fe=null,lt=null;const ge=new ii(0,0,$,de),Ce=new ii(0,0,$,de);let nt=!1;const rt=new Ip;let mt=!1,ln=!1;const vn=new Jt,zt=new K,Pe=new ii,qe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Oe=!1;function it(){return Q===null?Ne:1}let Z=i;function Nt(G,le){return t.getContext(G,le)}try{const G={alpha:!0,depth:s,stencil:r,antialias:c,premultipliedAlpha:h,preserveDrawingBuffer:p,powerPreference:g,failIfMajorPerformanceCaveat:v};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Wb}`),t.addEventListener("webglcontextlost",$t,!1),t.addEventListener("webglcontextrestored",Tn,!1),t.addEventListener("webglcontextcreationerror",An,!1),Z===null){const le="webgl2";if(Z=Nt(le,G),Z===null)throw Nt(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(G){throw Dt("WebGLRenderer: "+G.message),G}let ot,Rt,Je,X,V,ae,Ee,ze,Me,gt,Qe,St,Ut,He,Ye,xt,pt,st,rn,re,ct,Xe,dt,Ge;function Le(){ot=new cB(Z),ot.init(),Xe=new TI(Z,ot),Rt=new eB(Z,ot,e,Xe),Je=new Z6(Z,ot),Rt.reversedDepthBuffer&&y&&Je.buffers.depth.setReversed(!0),X=new hB(Z),V=new O6,ae=new Q6(Z,ot,Je,V,Rt,Xe,X),Ee=new nB(L),ze=new lB(L),Me=new gz(Z),dt=new ZF(Z,Me),gt=new uB(Z,Me,X,dt),Qe=new pB(Z,gt,Me,X),rn=new fB(Z,Rt,ae),xt=new tB(V),St=new L6(L,Ee,ze,ot,Rt,dt,xt),Ut=new rV(L,V),He=new j6,Ye=new q6(ot),st=new KF(L,Ee,ze,Je,Qe,E,h),pt=new J6(L,Qe,Rt),Ge=new aV(Z,X,Rt,Je),re=new QF(Z,ot,X),ct=new dB(Z,ot,X),X.programs=St.programs,L.capabilities=Rt,L.extensions=ot,L.properties=V,L.renderLists=He,L.shadowMap=pt,L.state=Je,L.info=X}Le(),R!==Er&&(W=new gB(R,t.width,t.height,s,r));const et=new iV(L,Z);this.xr=et,this.getContext=function(){return Z},this.getContextAttributes=function(){return Z.getContextAttributes()},this.forceContextLoss=function(){const G=ot.get("WEBGL_lose_context");G&&G.loseContext()},this.forceContextRestore=function(){const G=ot.get("WEBGL_lose_context");G&&G.restoreContext()},this.getPixelRatio=function(){return Ne},this.setPixelRatio=function(G){G!==void 0&&(Ne=G,this.setSize($,de,!1))},this.getSize=function(G){return G.set($,de)},this.setSize=function(G,le,we=!0){if(et.isPresenting){ht("WebGLRenderer: Can't change size while VR device is presenting.");return}$=G,de=le,t.width=Math.floor(G*Ne),t.height=Math.floor(le*Ne),we===!0&&(t.style.width=G+"px",t.style.height=le+"px"),W!==null&&W.setSize(t.width,t.height),this.setViewport(0,0,G,le)},this.getDrawingBufferSize=function(G){return G.set($*Ne,de*Ne).floor()},this.setDrawingBufferSize=function(G,le,we){$=G,de=le,Ne=we,t.width=Math.floor(G*we),t.height=Math.floor(le*we),this.setViewport(0,0,G,le)},this.setEffects=function(G){if(R===Er){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(G){for(let le=0;le<G.length;le++)if(G[le].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}W.setEffects(G||[])},this.getCurrentViewport=function(G){return G.copy(J)},this.getViewport=function(G){return G.copy(ge)},this.setViewport=function(G,le,we,ye){G.isVector4?ge.set(G.x,G.y,G.z,G.w):ge.set(G,le,we,ye),Je.viewport(J.copy(ge).multiplyScalar(Ne).round())},this.getScissor=function(G){return G.copy(Ce)},this.setScissor=function(G,le,we,ye){G.isVector4?Ce.set(G.x,G.y,G.z,G.w):Ce.set(G,le,we,ye),Je.scissor(te.copy(Ce).multiplyScalar(Ne).round())},this.getScissorTest=function(){return nt},this.setScissorTest=function(G){Je.setScissorTest(nt=G)},this.setOpaqueSort=function(G){Fe=G},this.setTransparentSort=function(G){lt=G},this.getClearColor=function(G){return G.copy(st.getClearColor())},this.setClearColor=function(){st.setClearColor(...arguments)},this.getClearAlpha=function(){return st.getClearAlpha()},this.setClearAlpha=function(){st.setClearAlpha(...arguments)},this.clear=function(G=!0,le=!0,we=!0){let ye=0;if(G){let fe=!1;if(Q!==null){const Ke=Q.texture.format;fe=N.has(Ke)}if(fe){const Ke=Q.texture.type,vt=A.has(Ke),$e=st.getClearColor(),wt=st.getClearAlpha(),Tt=$e.r,Pt=$e.g,Mt=$e.b;vt?(I[0]=Tt,I[1]=Pt,I[2]=Mt,I[3]=wt,Z.clearBufferuiv(Z.COLOR,0,I)):(D[0]=Tt,D[1]=Pt,D[2]=Mt,D[3]=wt,Z.clearBufferiv(Z.COLOR,0,D))}else ye|=Z.COLOR_BUFFER_BIT}le&&(ye|=Z.DEPTH_BUFFER_BIT),we&&(ye|=Z.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Z.clear(ye)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",$t,!1),t.removeEventListener("webglcontextrestored",Tn,!1),t.removeEventListener("webglcontextcreationerror",An,!1),st.dispose(),He.dispose(),Ye.dispose(),V.dispose(),Ee.dispose(),ze.dispose(),Qe.dispose(),dt.dispose(),Ge.dispose(),St.dispose(),et.dispose(),et.removeEventListener("sessionstart",to),et.removeEventListener("sessionend",Rl),xs.stop()};function $t(G){G.preventDefault(),u0("WebGLRenderer: Context Lost."),B=!0}function Tn(){u0("WebGLRenderer: Context Restored."),B=!1;const G=X.autoReset,le=pt.enabled,we=pt.autoUpdate,ye=pt.needsUpdate,fe=pt.type;Le(),X.autoReset=G,pt.enabled=le,pt.autoUpdate=we,pt.needsUpdate=ye,pt.type=fe}function An(G){Dt("WebGLRenderer: A WebGL context could not be created. Reason: ",G.statusMessage)}function ls(G){const le=G.target;le.removeEventListener("dispose",ls),Hs(le)}function Hs(G){Oo(G),V.remove(G)}function Oo(G){const le=V.get(G).programs;le!==void 0&&(le.forEach(function(we){St.releaseProgram(we)}),G.isShaderMaterial&&St.releaseShaderCache(G))}this.renderBufferDirect=function(G,le,we,ye,fe,Ke){le===null&&(le=qe);const vt=fe.isMesh&&fe.matrixWorld.determinant()<0,$e=sa(G,le,we,ye,fe);Je.setMaterial(ye,vt);let wt=we.index,Tt=1;if(ye.wireframe===!0){if(wt=gt.getWireframeAttribute(we),wt===void 0)return;Tt=2}const Pt=we.drawRange,Mt=we.attributes.position;let Ft=Pt.start*Tt,In=(Pt.start+Pt.count)*Tt;Ke!==null&&(Ft=Math.max(Ft,Ke.start*Tt),In=Math.min(In,(Ke.start+Ke.count)*Tt)),wt!==null?(Ft=Math.max(Ft,0),In=Math.min(In,wt.count)):Mt!=null&&(Ft=Math.max(Ft,0),In=Math.min(In,Mt.count));const Xn=In-Ft;if(Xn<0||Xn===1/0)return;dt.setup(fe,ye,$e,we,wt);let Gn,Kt=re;if(wt!==null&&(Gn=Me.get(wt),Kt=ct,Kt.setIndex(Gn)),fe.isMesh)ye.wireframe===!0?(Je.setLineWidth(ye.wireframeLinewidth*it()),Kt.setMode(Z.LINES)):Kt.setMode(Z.TRIANGLES);else if(fe.isLine){let ut=ye.linewidth;ut===void 0&&(ut=1),Je.setLineWidth(ut*it()),fe.isLineSegments?Kt.setMode(Z.LINES):fe.isLineLoop?Kt.setMode(Z.LINE_LOOP):Kt.setMode(Z.LINE_STRIP)}else fe.isPoints?Kt.setMode(Z.POINTS):fe.isSprite&&Kt.setMode(Z.TRIANGLES);if(fe.isBatchedMesh)if(fe._multiDrawInstances!==null)Sp("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Kt.renderMultiDrawInstances(fe._multiDrawStarts,fe._multiDrawCounts,fe._multiDrawCount,fe._multiDrawInstances);else if(ot.get("WEBGL_multi_draw"))Kt.renderMultiDraw(fe._multiDrawStarts,fe._multiDrawCounts,fe._multiDrawCount);else{const ut=fe._multiDrawStarts,Nn=fe._multiDrawCounts,Vt=fe._multiDrawCount,Di=wt?Me.get(wt).bytesPerElement:1,ra=V.get(ye).currentProgram.getUniforms();for(let ti=0;ti<Vt;ti++)ra.setValue(Z,"_gl_DrawID",ti),Kt.render(ut[ti]/Di,Nn[ti])}else if(fe.isInstancedMesh)Kt.renderInstances(Ft,Xn,fe.count);else if(we.isInstancedBufferGeometry){const ut=we._maxInstanceCount!==void 0?we._maxInstanceCount:1/0,Nn=Math.min(we.instanceCount,ut);Kt.renderInstances(Ft,Xn,Nn)}else Kt.render(Ft,Xn)};function zo(G,le,we){G.transparent===!0&&G.side===yl&&G.forceSinglePass===!1?(G.side=Ar,G.needsUpdate=!0,dr(G,le,we),G.side=_c,G.needsUpdate=!0,dr(G,le,we),G.side=yl):dr(G,le,we)}this.compile=function(G,le,we=null){we===null&&(we=G),j=Ye.get(we),j.init(le),z.push(j),we.traverseVisible(function(fe){fe.isLight&&fe.layers.test(le.layers)&&(j.pushLight(fe),fe.castShadow&&j.pushShadow(fe))}),G!==we&&G.traverseVisible(function(fe){fe.isLight&&fe.layers.test(le.layers)&&(j.pushLight(fe),fe.castShadow&&j.pushShadow(fe))}),j.setupLights();const ye=new Set;return G.traverse(function(fe){if(!(fe.isMesh||fe.isPoints||fe.isLine||fe.isSprite))return;const Ke=fe.material;if(Ke)if(Array.isArray(Ke))for(let vt=0;vt<Ke.length;vt++){const $e=Ke[vt];zo($e,we,fe),ye.add($e)}else zo(Ke,we,fe),ye.add(Ke)}),j=z.pop(),ye},this.compileAsync=function(G,le,we=null){const ye=this.compile(G,le,we);return new Promise(fe=>{function Ke(){if(ye.forEach(function(vt){V.get(vt).currentProgram.isReady()&&ye.delete(vt)}),ye.size===0){fe(G);return}setTimeout(Ke,10)}ot.get("KHR_parallel_shader_compile")!==null?Ke():setTimeout(Ke,10)})};let Cl=null;function jo(G){Cl&&Cl(G)}function to(){xs.stop()}function Rl(){xs.start()}const xs=new yI;xs.setAnimationLoop(jo),typeof self<"u"&&xs.setContext(self),this.setAnimationLoop=function(G){Cl=G,et.setAnimationLoop(G),G===null?xs.stop():xs.start()},et.addEventListener("sessionstart",to),et.addEventListener("sessionend",Rl),this.render=function(G,le){if(le!==void 0&&le.isCamera!==!0){Dt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(B===!0)return;const we=et.enabled===!0&&et.isPresenting===!0,ye=W!==null&&(Q===null||we)&&W.begin(L,Q);if(G.matrixWorldAutoUpdate===!0&&G.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),et.enabled===!0&&et.isPresenting===!0&&(W===null||W.isCompositing()===!1)&&(et.cameraAutoUpdate===!0&&et.updateCamera(le),le=et.getCamera()),G.isScene===!0&&G.onBeforeRender(L,G,le,Q),j=Ye.get(G,z.length),j.init(le),z.push(j),vn.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),rt.setFromProjectionMatrix(vn,ga,le.reversedDepth),ln=this.localClippingEnabled,mt=xt.init(this.clippingPlanes,ln),U=He.get(G,F.length),U.init(),F.push(U),et.enabled===!0&&et.isPresenting===!0){const vt=L.xr.getDepthSensingMesh();vt!==null&&lr(vt,le,-1/0,L.sortObjects)}lr(G,le,0,L.sortObjects),U.finish(),L.sortObjects===!0&&U.sort(Fe,lt),Oe=et.enabled===!1||et.isPresenting===!1||et.hasDepthSensing()===!1,Oe&&st.addToRenderList(U,G),this.info.render.frame++,mt===!0&&xt.beginShadows();const fe=j.state.shadowsArray;if(pt.render(fe,G,le),mt===!0&&xt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(ye&&W.hasRenderPass())===!1){const vt=U.opaque,$e=U.transmissive;if(j.setupLights(),le.isArrayCamera){const wt=le.cameras;if($e.length>0)for(let Tt=0,Pt=wt.length;Tt<Pt;Tt++){const Mt=wt[Tt];Vi(vt,$e,G,Mt)}Oe&&st.render(G);for(let Tt=0,Pt=wt.length;Tt<Pt;Tt++){const Mt=wt[Tt];ui(U,G,Mt,Mt.viewport)}}else $e.length>0&&Vi(vt,$e,G,le),Oe&&st.render(G),ui(U,G,le)}Q!==null&&ee===0&&(ae.updateMultisampleRenderTarget(Q),ae.updateRenderTargetMipmap(Q)),ye&&W.end(L),G.isScene===!0&&G.onAfterRender(L,G,le),dt.resetDefaultState(),ce=-1,oe=null,z.pop(),z.length>0?(j=z[z.length-1],mt===!0&&xt.setGlobalState(L.clippingPlanes,j.state.camera)):j=null,F.pop(),F.length>0?U=F[F.length-1]:U=null};function lr(G,le,we,ye){if(G.visible===!1)return;if(G.layers.test(le.layers)){if(G.isGroup)we=G.renderOrder;else if(G.isLOD)G.autoUpdate===!0&&G.update(le);else if(G.isLight)j.pushLight(G),G.castShadow&&j.pushShadow(G);else if(G.isSprite){if(!G.frustumCulled||rt.intersectsSprite(G)){ye&&Pe.setFromMatrixPosition(G.matrixWorld).applyMatrix4(vn);const vt=Qe.update(G),$e=G.material;$e.visible&&U.push(G,vt,$e,we,Pe.z,null)}}else if((G.isMesh||G.isLine||G.isPoints)&&(!G.frustumCulled||rt.intersectsObject(G))){const vt=Qe.update(G),$e=G.material;if(ye&&(G.boundingSphere!==void 0?(G.boundingSphere===null&&G.computeBoundingSphere(),Pe.copy(G.boundingSphere.center)):(vt.boundingSphere===null&&vt.computeBoundingSphere(),Pe.copy(vt.boundingSphere.center)),Pe.applyMatrix4(G.matrixWorld).applyMatrix4(vn)),Array.isArray($e)){const wt=vt.groups;for(let Tt=0,Pt=wt.length;Tt<Pt;Tt++){const Mt=wt[Tt],Ft=$e[Mt.materialIndex];Ft&&Ft.visible&&U.push(G,vt,Ft,we,Pe.z,Mt)}}else $e.visible&&U.push(G,vt,$e,we,Pe.z,null)}}const Ke=G.children;for(let vt=0,$e=Ke.length;vt<$e;vt++)lr(Ke[vt],le,we,ye)}function ui(G,le,we,ye){const{opaque:fe,transmissive:Ke,transparent:vt}=G;j.setupLightsView(we),mt===!0&&xt.setGlobalState(L.clippingPlanes,we),ye&&Je.viewport(J.copy(ye)),fe.length>0&&cr(fe,le,we),Ke.length>0&&cr(Ke,le,we),vt.length>0&&cr(vt,le,we),Je.buffers.depth.setTest(!0),Je.buffers.depth.setMask(!0),Je.buffers.color.setMask(!0),Je.setPolygonOffset(!1)}function Vi(G,le,we,ye){if((we.isScene===!0?we.overrideMaterial:null)!==null)return;if(j.state.transmissionRenderTarget[ye.id]===void 0){const Ft=ot.has("EXT_color_buffer_half_float")||ot.has("EXT_color_buffer_float");j.state.transmissionRenderTarget[ye.id]=new ta(1,1,{generateMipmaps:!0,type:Ft?Po:Er,minFilter:bl,samples:Rt.samples,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:kn.workingColorSpace})}const Ke=j.state.transmissionRenderTarget[ye.id],vt=ye.viewport||J;Ke.setSize(vt.z*L.transmissionResolutionScale,vt.w*L.transmissionResolutionScale);const $e=L.getRenderTarget(),wt=L.getActiveCubeFace(),Tt=L.getActiveMipmapLevel();L.setRenderTarget(Ke),L.getClearColor(Re),Ie=L.getClearAlpha(),Ie<1&&L.setClearColor(16777215,.5),L.clear(),Oe&&st.render(we);const Pt=L.toneMapping;L.toneMapping=Xa;const Mt=ye.viewport;if(ye.viewport!==void 0&&(ye.viewport=void 0),j.setupLightsView(ye),mt===!0&&xt.setGlobalState(L.clippingPlanes,ye),cr(G,we,ye),ae.updateMultisampleRenderTarget(Ke),ae.updateRenderTargetMipmap(Ke),ot.has("WEBGL_multisampled_render_to_texture")===!1){let Ft=!1;for(let In=0,Xn=le.length;In<Xn;In++){const Gn=le[In],{object:Kt,geometry:ut,material:Nn,group:Vt}=Gn;if(Nn.side===yl&&Kt.layers.test(ye.layers)){const Di=Nn.side;Nn.side=Ar,Nn.needsUpdate=!0,ur(Kt,we,ye,ut,Nn,Vt),Nn.side=Di,Nn.needsUpdate=!0,Ft=!0}}Ft===!0&&(ae.updateMultisampleRenderTarget(Ke),ae.updateRenderTargetMipmap(Ke))}L.setRenderTarget($e,wt,Tt),L.setClearColor(Re,Ie),Mt!==void 0&&(ye.viewport=Mt),L.toneMapping=Pt}function cr(G,le,we){const ye=le.isScene===!0?le.overrideMaterial:null;for(let fe=0,Ke=G.length;fe<Ke;fe++){const vt=G[fe],{object:$e,geometry:wt,group:Tt}=vt;let Pt=vt.material;Pt.allowOverride===!0&&ye!==null&&(Pt=ye),$e.layers.test(we.layers)&&ur($e,le,we,wt,Pt,Tt)}}function ur(G,le,we,ye,fe,Ke){G.onBeforeRender(L,le,we,ye,fe,Ke),G.modelViewMatrix.multiplyMatrices(we.matrixWorldInverse,G.matrixWorld),G.normalMatrix.getNormalMatrix(G.modelViewMatrix),fe.onBeforeRender(L,le,we,ye,G,Ke),fe.transparent===!0&&fe.side===yl&&fe.forceSinglePass===!1?(fe.side=Ar,fe.needsUpdate=!0,L.renderBufferDirect(we,le,ye,fe,G,Ke),fe.side=_c,fe.needsUpdate=!0,L.renderBufferDirect(we,le,ye,fe,G,Ke),fe.side=yl):L.renderBufferDirect(we,le,ye,fe,G,Ke),G.onAfterRender(L,le,we,ye,fe,Ke)}function dr(G,le,we){le.isScene!==!0&&(le=qe);const ye=V.get(G),fe=j.state.lights,Ke=j.state.shadowsArray,vt=fe.state.version,$e=St.getParameters(G,fe.state,Ke,le,we),wt=St.getProgramCacheKey($e);let Tt=ye.programs;ye.environment=G.isMeshStandardMaterial?le.environment:null,ye.fog=le.fog,ye.envMap=(G.isMeshStandardMaterial?ze:Ee).get(G.envMap||ye.environment),ye.envMapRotation=ye.environment!==null&&G.envMap===null?le.environmentRotation:G.envMapRotation,Tt===void 0&&(G.addEventListener("dispose",ls),Tt=new Map,ye.programs=Tt);let Pt=Tt.get(wt);if(Pt!==void 0){if(ye.currentProgram===Pt&&ye.lightsStateVersion===vt)return kl(G,$e),Pt}else $e.uniforms=St.getUniforms(G),G.onBeforeCompile($e,L),Pt=St.acquireProgram($e,wt),Tt.set(wt,Pt),ye.uniforms=$e.uniforms;const Mt=ye.uniforms;return(!G.isShaderMaterial&&!G.isRawShaderMaterial||G.clipping===!0)&&(Mt.clippingPlanes=xt.uniform),kl(G,$e),ye.needsLights=io(G),ye.lightsStateVersion=vt,ye.needsLights&&(Mt.ambientLightColor.value=fe.state.ambient,Mt.lightProbe.value=fe.state.probe,Mt.directionalLights.value=fe.state.directional,Mt.directionalLightShadows.value=fe.state.directionalShadow,Mt.spotLights.value=fe.state.spot,Mt.spotLightShadows.value=fe.state.spotShadow,Mt.rectAreaLights.value=fe.state.rectArea,Mt.ltc_1.value=fe.state.rectAreaLTC1,Mt.ltc_2.value=fe.state.rectAreaLTC2,Mt.pointLights.value=fe.state.point,Mt.pointLightShadows.value=fe.state.pointShadow,Mt.hemisphereLights.value=fe.state.hemi,Mt.directionalShadowMap.value=fe.state.directionalShadowMap,Mt.directionalShadowMatrix.value=fe.state.directionalShadowMatrix,Mt.spotShadowMap.value=fe.state.spotShadowMap,Mt.spotLightMatrix.value=fe.state.spotLightMatrix,Mt.spotLightMap.value=fe.state.spotLightMap,Mt.pointShadowMap.value=fe.state.pointShadowMap,Mt.pointShadowMatrix.value=fe.state.pointShadowMatrix),ye.currentProgram=Pt,ye.uniformsList=null,Pt}function Fo(G){if(G.uniformsList===null){const le=G.currentProgram.getUniforms();G.uniformsList=_y.seqWithValue(le.seq,G.uniforms)}return G.uniformsList}function kl(G,le){const we=V.get(G);we.outputColorSpace=le.outputColorSpace,we.batching=le.batching,we.batchingColor=le.batchingColor,we.instancing=le.instancing,we.instancingColor=le.instancingColor,we.instancingMorph=le.instancingMorph,we.skinning=le.skinning,we.morphTargets=le.morphTargets,we.morphNormals=le.morphNormals,we.morphColors=le.morphColors,we.morphTargetsCount=le.morphTargetsCount,we.numClippingPlanes=le.numClippingPlanes,we.numIntersection=le.numClipIntersection,we.vertexAlphas=le.vertexAlphas,we.vertexTangents=le.vertexTangents,we.toneMapping=le.toneMapping}function sa(G,le,we,ye,fe){le.isScene!==!0&&(le=qe),ae.resetTextureUnits();const Ke=le.fog,vt=ye.isMeshStandardMaterial?le.environment:null,$e=Q===null?L.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:Ou,wt=(ye.isMeshStandardMaterial?ze:Ee).get(ye.envMap||vt),Tt=ye.vertexColors===!0&&!!we.attributes.color&&we.attributes.color.itemSize===4,Pt=!!we.attributes.tangent&&(!!ye.normalMap||ye.anisotropy>0),Mt=!!we.morphAttributes.position,Ft=!!we.morphAttributes.normal,In=!!we.morphAttributes.color;let Xn=Xa;ye.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(Xn=L.toneMapping);const Gn=we.morphAttributes.position||we.morphAttributes.normal||we.morphAttributes.color,Kt=Gn!==void 0?Gn.length:0,ut=V.get(ye),Nn=j.state.lights;if(mt===!0&&(ln===!0||G!==oe)){const Ki=G===oe&&ye.id===ce;xt.setState(ye,G,Ki)}let Vt=!1;ye.version===ut.__version?(ut.needsLights&&ut.lightsStateVersion!==Nn.state.version||ut.outputColorSpace!==$e||fe.isBatchedMesh&&ut.batching===!1||!fe.isBatchedMesh&&ut.batching===!0||fe.isBatchedMesh&&ut.batchingColor===!0&&fe.colorTexture===null||fe.isBatchedMesh&&ut.batchingColor===!1&&fe.colorTexture!==null||fe.isInstancedMesh&&ut.instancing===!1||!fe.isInstancedMesh&&ut.instancing===!0||fe.isSkinnedMesh&&ut.skinning===!1||!fe.isSkinnedMesh&&ut.skinning===!0||fe.isInstancedMesh&&ut.instancingColor===!0&&fe.instanceColor===null||fe.isInstancedMesh&&ut.instancingColor===!1&&fe.instanceColor!==null||fe.isInstancedMesh&&ut.instancingMorph===!0&&fe.morphTexture===null||fe.isInstancedMesh&&ut.instancingMorph===!1&&fe.morphTexture!==null||ut.envMap!==wt||ye.fog===!0&&ut.fog!==Ke||ut.numClippingPlanes!==void 0&&(ut.numClippingPlanes!==xt.numPlanes||ut.numIntersection!==xt.numIntersection)||ut.vertexAlphas!==Tt||ut.vertexTangents!==Pt||ut.morphTargets!==Mt||ut.morphNormals!==Ft||ut.morphColors!==In||ut.toneMapping!==Xn||ut.morphTargetsCount!==Kt)&&(Vt=!0):(Vt=!0,ut.__version=ye.version);let Di=ut.currentProgram;Vt===!0&&(Di=dr(ye,le,fe));let ra=!1,ti=!1,As=!1;const Un=Di.getUniforms(),Hi=ut.uniforms;if(Je.useProgram(Di.program)&&(ra=!0,ti=!0,As=!0),ye.id!==ce&&(ce=ye.id,ti=!0),ra||oe!==G){Je.buffers.depth.getReversed()&&G.reversedDepth!==!0&&(G._reversedDepth=!0,G.updateProjectionMatrix()),Un.setValue(Z,"projectionMatrix",G.projectionMatrix),Un.setValue(Z,"viewMatrix",G.matrixWorldInverse);const Zi=Un.map.cameraPosition;Zi!==void 0&&Zi.setValue(Z,zt.setFromMatrixPosition(G.matrixWorld)),Rt.logarithmicDepthBuffer&&Un.setValue(Z,"logDepthBufFC",2/(Math.log(G.far+1)/Math.LN2)),(ye.isMeshPhongMaterial||ye.isMeshToonMaterial||ye.isMeshLambertMaterial||ye.isMeshBasicMaterial||ye.isMeshStandardMaterial||ye.isShaderMaterial)&&Un.setValue(Z,"isOrthographic",G.isOrthographicCamera===!0),oe!==G&&(oe=G,ti=!0,As=!0)}if(ut.needsLights&&(Nn.state.directionalShadowMap.length>0&&Un.setValue(Z,"directionalShadowMap",Nn.state.directionalShadowMap,ae),Nn.state.spotShadowMap.length>0&&Un.setValue(Z,"spotShadowMap",Nn.state.spotShadowMap,ae),Nn.state.pointShadowMap.length>0&&Un.setValue(Z,"pointShadowMap",Nn.state.pointShadowMap,ae)),fe.isSkinnedMesh){Un.setOptional(Z,fe,"bindMatrix"),Un.setOptional(Z,fe,"bindMatrixInverse");const Ki=fe.skeleton;Ki&&(Ki.boneTexture===null&&Ki.computeBoneTexture(),Un.setValue(Z,"boneTexture",Ki.boneTexture,ae))}fe.isBatchedMesh&&(Un.setOptional(Z,fe,"batchingTexture"),Un.setValue(Z,"batchingTexture",fe._matricesTexture,ae),Un.setOptional(Z,fe,"batchingIdTexture"),Un.setValue(Z,"batchingIdTexture",fe._indirectTexture,ae),Un.setOptional(Z,fe,"batchingColorTexture"),fe._colorsTexture!==null&&Un.setValue(Z,"batchingColorTexture",fe._colorsTexture,ae));const Pi=we.morphAttributes;if((Pi.position!==void 0||Pi.normal!==void 0||Pi.color!==void 0)&&rn.update(fe,we,Di),(ti||ut.receiveShadow!==fe.receiveShadow)&&(ut.receiveShadow=fe.receiveShadow,Un.setValue(Z,"receiveShadow",fe.receiveShadow)),ye.isMeshGouraudMaterial&&ye.envMap!==null&&(Hi.envMap.value=wt,Hi.flipEnvMap.value=wt.isCubeTexture&&wt.isRenderTargetTexture===!1?-1:1),ye.isMeshStandardMaterial&&ye.envMap===null&&le.environment!==null&&(Hi.envMapIntensity.value=le.environmentIntensity),Hi.dfgLUT!==void 0&&(Hi.dfgLUT.value=lV()),ti&&(Un.setValue(Z,"toneMappingExposure",L.toneMappingExposure),ut.needsLights&&no(Hi,As),Ke&&ye.fog===!0&&Ut.refreshFogUniforms(Hi,Ke),Ut.refreshMaterialUniforms(Hi,ye,Ne,de,j.state.transmissionRenderTarget[G.id]),_y.upload(Z,Fo(ut),Hi,ae)),ye.isShaderMaterial&&ye.uniformsNeedUpdate===!0&&(_y.upload(Z,Fo(ut),Hi,ae),ye.uniformsNeedUpdate=!1),ye.isSpriteMaterial&&Un.setValue(Z,"center",fe.center),Un.setValue(Z,"modelViewMatrix",fe.modelViewMatrix),Un.setValue(Z,"normalMatrix",fe.normalMatrix),Un.setValue(Z,"modelMatrix",fe.matrixWorld),ye.isShaderMaterial||ye.isRawShaderMaterial){const Ki=ye.uniformsGroups;for(let Zi=0,Il=Ki.length;Zi<Il;Zi++){const Rr=Ki[Zi];Ge.update(Rr,Di),Ge.bind(Rr,Di)}}return Di}function no(G,le){G.ambientLightColor.needsUpdate=le,G.lightProbe.needsUpdate=le,G.directionalLights.needsUpdate=le,G.directionalLightShadows.needsUpdate=le,G.pointLights.needsUpdate=le,G.pointLightShadows.needsUpdate=le,G.spotLights.needsUpdate=le,G.spotLightShadows.needsUpdate=le,G.rectAreaLights.needsUpdate=le,G.hemisphereLights.needsUpdate=le}function io(G){return G.isMeshLambertMaterial||G.isMeshToonMaterial||G.isMeshPhongMaterial||G.isMeshStandardMaterial||G.isShadowMaterial||G.isShaderMaterial&&G.lights===!0}this.getActiveCubeFace=function(){return Y},this.getActiveMipmapLevel=function(){return ee},this.getRenderTarget=function(){return Q},this.setRenderTargetTextures=function(G,le,we){const ye=V.get(G);ye.__autoAllocateDepthBuffer=G.resolveDepthBuffer===!1,ye.__autoAllocateDepthBuffer===!1&&(ye.__useRenderToTexture=!1),V.get(G.texture).__webglTexture=le,V.get(G.depthTexture).__webglTexture=ye.__autoAllocateDepthBuffer?void 0:we,ye.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(G,le){const we=V.get(G);we.__webglFramebuffer=le,we.__useDefaultFramebuffer=le===void 0};const so=Z.createFramebuffer();this.setRenderTarget=function(G,le=0,we=0){Q=G,Y=le,ee=we;let ye=null,fe=!1,Ke=!1;if(G){const $e=V.get(G);if($e.__useDefaultFramebuffer!==void 0){Je.bindFramebuffer(Z.FRAMEBUFFER,$e.__webglFramebuffer),J.copy(G.viewport),te.copy(G.scissor),me=G.scissorTest,Je.viewport(J),Je.scissor(te),Je.setScissorTest(me),ce=-1;return}else if($e.__webglFramebuffer===void 0)ae.setupRenderTarget(G);else if($e.__hasExternalTextures)ae.rebindTextures(G,V.get(G.texture).__webglTexture,V.get(G.depthTexture).__webglTexture);else if(G.depthBuffer){const Pt=G.depthTexture;if($e.__boundDepthTexture!==Pt){if(Pt!==null&&V.has(Pt)&&(G.width!==Pt.image.width||G.height!==Pt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ae.setupDepthRenderbuffer(G)}}const wt=G.texture;(wt.isData3DTexture||wt.isDataArrayTexture||wt.isCompressedArrayTexture)&&(Ke=!0);const Tt=V.get(G).__webglFramebuffer;G.isWebGLCubeRenderTarget?(Array.isArray(Tt[le])?ye=Tt[le][we]:ye=Tt[le],fe=!0):G.samples>0&&ae.useMultisampledRTT(G)===!1?ye=V.get(G).__webglMultisampledFramebuffer:Array.isArray(Tt)?ye=Tt[we]:ye=Tt,J.copy(G.viewport),te.copy(G.scissor),me=G.scissorTest}else J.copy(ge).multiplyScalar(Ne).floor(),te.copy(Ce).multiplyScalar(Ne).floor(),me=nt;if(we!==0&&(ye=so),Je.bindFramebuffer(Z.FRAMEBUFFER,ye)&&Je.drawBuffers(G,ye),Je.viewport(J),Je.scissor(te),Je.setScissorTest(me),fe){const $e=V.get(G.texture);Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_CUBE_MAP_POSITIVE_X+le,$e.__webglTexture,we)}else if(Ke){const $e=le;for(let wt=0;wt<G.textures.length;wt++){const Tt=V.get(G.textures[wt]);Z.framebufferTextureLayer(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0+wt,Tt.__webglTexture,we,$e)}}else if(G!==null&&we!==0){const $e=V.get(G.texture);Z.framebufferTexture2D(Z.FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,$e.__webglTexture,we)}ce=-1},this.readRenderTargetPixels=function(G,le,we,ye,fe,Ke,vt,$e=0){if(!(G&&G.isWebGLRenderTarget)){Dt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let wt=V.get(G).__webglFramebuffer;if(G.isWebGLCubeRenderTarget&&vt!==void 0&&(wt=wt[vt]),wt){Je.bindFramebuffer(Z.FRAMEBUFFER,wt);try{const Tt=G.textures[$e],Pt=Tt.format,Mt=Tt.type;if(!Rt.textureFormatReadable(Pt)){Dt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Rt.textureTypeReadable(Mt)){Dt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=G.width-ye&&we>=0&&we<=G.height-fe&&(G.textures.length>1&&Z.readBuffer(Z.COLOR_ATTACHMENT0+$e),Z.readPixels(le,we,ye,fe,Xe.convert(Pt),Xe.convert(Mt),Ke))}finally{const Tt=Q!==null?V.get(Q).__webglFramebuffer:null;Je.bindFramebuffer(Z.FRAMEBUFFER,Tt)}}},this.readRenderTargetPixelsAsync=async function(G,le,we,ye,fe,Ke,vt,$e=0){if(!(G&&G.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let wt=V.get(G).__webglFramebuffer;if(G.isWebGLCubeRenderTarget&&vt!==void 0&&(wt=wt[vt]),wt)if(le>=0&&le<=G.width-ye&&we>=0&&we<=G.height-fe){Je.bindFramebuffer(Z.FRAMEBUFFER,wt);const Tt=G.textures[$e],Pt=Tt.format,Mt=Tt.type;if(!Rt.textureFormatReadable(Pt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Rt.textureTypeReadable(Mt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Ft=Z.createBuffer();Z.bindBuffer(Z.PIXEL_PACK_BUFFER,Ft),Z.bufferData(Z.PIXEL_PACK_BUFFER,Ke.byteLength,Z.STREAM_READ),G.textures.length>1&&Z.readBuffer(Z.COLOR_ATTACHMENT0+$e),Z.readPixels(le,we,ye,fe,Xe.convert(Pt),Xe.convert(Mt),0);const In=Q!==null?V.get(Q).__webglFramebuffer:null;Je.bindFramebuffer(Z.FRAMEBUFFER,In);const Xn=Z.fenceSync(Z.SYNC_GPU_COMMANDS_COMPLETE,0);return Z.flush(),await g5(Z,Xn,4),Z.bindBuffer(Z.PIXEL_PACK_BUFFER,Ft),Z.getBufferSubData(Z.PIXEL_PACK_BUFFER,0,Ke),Z.deleteBuffer(Ft),Z.deleteSync(Xn),Ke}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(G,le=null,we=0){const ye=Math.pow(2,-we),fe=Math.floor(G.image.width*ye),Ke=Math.floor(G.image.height*ye),vt=le!==null?le.x:0,$e=le!==null?le.y:0;ae.setTexture2D(G,0),Z.copyTexSubImage2D(Z.TEXTURE_2D,we,0,0,vt,$e,fe,Ke),Je.unbindTexture()};const Bo=Z.createFramebuffer(),ba=Z.createFramebuffer();this.copyTextureToTexture=function(G,le,we=null,ye=null,fe=0,Ke=null){Ke===null&&(fe!==0?(Sp("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ke=fe,fe=0):Ke=0);let vt,$e,wt,Tt,Pt,Mt,Ft,In,Xn;const Gn=G.isCompressedTexture?G.mipmaps[Ke]:G.image;if(we!==null)vt=we.max.x-we.min.x,$e=we.max.y-we.min.y,wt=we.isBox3?we.max.z-we.min.z:1,Tt=we.min.x,Pt=we.min.y,Mt=we.isBox3?we.min.z:0;else{const Pi=Math.pow(2,-fe);vt=Math.floor(Gn.width*Pi),$e=Math.floor(Gn.height*Pi),G.isDataArrayTexture?wt=Gn.depth:G.isData3DTexture?wt=Math.floor(Gn.depth*Pi):wt=1,Tt=0,Pt=0,Mt=0}ye!==null?(Ft=ye.x,In=ye.y,Xn=ye.z):(Ft=0,In=0,Xn=0);const Kt=Xe.convert(le.format),ut=Xe.convert(le.type);let Nn;le.isData3DTexture?(ae.setTexture3D(le,0),Nn=Z.TEXTURE_3D):le.isDataArrayTexture||le.isCompressedArrayTexture?(ae.setTexture2DArray(le,0),Nn=Z.TEXTURE_2D_ARRAY):(ae.setTexture2D(le,0),Nn=Z.TEXTURE_2D),Z.pixelStorei(Z.UNPACK_FLIP_Y_WEBGL,le.flipY),Z.pixelStorei(Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),Z.pixelStorei(Z.UNPACK_ALIGNMENT,le.unpackAlignment);const Vt=Z.getParameter(Z.UNPACK_ROW_LENGTH),Di=Z.getParameter(Z.UNPACK_IMAGE_HEIGHT),ra=Z.getParameter(Z.UNPACK_SKIP_PIXELS),ti=Z.getParameter(Z.UNPACK_SKIP_ROWS),As=Z.getParameter(Z.UNPACK_SKIP_IMAGES);Z.pixelStorei(Z.UNPACK_ROW_LENGTH,Gn.width),Z.pixelStorei(Z.UNPACK_IMAGE_HEIGHT,Gn.height),Z.pixelStorei(Z.UNPACK_SKIP_PIXELS,Tt),Z.pixelStorei(Z.UNPACK_SKIP_ROWS,Pt),Z.pixelStorei(Z.UNPACK_SKIP_IMAGES,Mt);const Un=G.isDataArrayTexture||G.isData3DTexture,Hi=le.isDataArrayTexture||le.isData3DTexture;if(G.isDepthTexture){const Pi=V.get(G),Ki=V.get(le),Zi=V.get(Pi.__renderTarget),Il=V.get(Ki.__renderTarget);Je.bindFramebuffer(Z.READ_FRAMEBUFFER,Zi.__webglFramebuffer),Je.bindFramebuffer(Z.DRAW_FRAMEBUFFER,Il.__webglFramebuffer);for(let Rr=0;Rr<wt;Rr++)Un&&(Z.framebufferTextureLayer(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,V.get(G).__webglTexture,fe,Mt+Rr),Z.framebufferTextureLayer(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,V.get(le).__webglTexture,Ke,Xn+Rr)),Z.blitFramebuffer(Tt,Pt,vt,$e,Ft,In,vt,$e,Z.DEPTH_BUFFER_BIT,Z.NEAREST);Je.bindFramebuffer(Z.READ_FRAMEBUFFER,null),Je.bindFramebuffer(Z.DRAW_FRAMEBUFFER,null)}else if(fe!==0||G.isRenderTargetTexture||V.has(G)){const Pi=V.get(G),Ki=V.get(le);Je.bindFramebuffer(Z.READ_FRAMEBUFFER,Bo),Je.bindFramebuffer(Z.DRAW_FRAMEBUFFER,ba);for(let Zi=0;Zi<wt;Zi++)Un?Z.framebufferTextureLayer(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Pi.__webglTexture,fe,Mt+Zi):Z.framebufferTexture2D(Z.READ_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,Pi.__webglTexture,fe),Hi?Z.framebufferTextureLayer(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Ki.__webglTexture,Ke,Xn+Zi):Z.framebufferTexture2D(Z.DRAW_FRAMEBUFFER,Z.COLOR_ATTACHMENT0,Z.TEXTURE_2D,Ki.__webglTexture,Ke),fe!==0?Z.blitFramebuffer(Tt,Pt,vt,$e,Ft,In,vt,$e,Z.COLOR_BUFFER_BIT,Z.NEAREST):Hi?Z.copyTexSubImage3D(Nn,Ke,Ft,In,Xn+Zi,Tt,Pt,vt,$e):Z.copyTexSubImage2D(Nn,Ke,Ft,In,Tt,Pt,vt,$e);Je.bindFramebuffer(Z.READ_FRAMEBUFFER,null),Je.bindFramebuffer(Z.DRAW_FRAMEBUFFER,null)}else Hi?G.isDataTexture||G.isData3DTexture?Z.texSubImage3D(Nn,Ke,Ft,In,Xn,vt,$e,wt,Kt,ut,Gn.data):le.isCompressedArrayTexture?Z.compressedTexSubImage3D(Nn,Ke,Ft,In,Xn,vt,$e,wt,Kt,Gn.data):Z.texSubImage3D(Nn,Ke,Ft,In,Xn,vt,$e,wt,Kt,ut,Gn):G.isDataTexture?Z.texSubImage2D(Z.TEXTURE_2D,Ke,Ft,In,vt,$e,Kt,ut,Gn.data):G.isCompressedTexture?Z.compressedTexSubImage2D(Z.TEXTURE_2D,Ke,Ft,In,Gn.width,Gn.height,Kt,Gn.data):Z.texSubImage2D(Z.TEXTURE_2D,Ke,Ft,In,vt,$e,Kt,ut,Gn);Z.pixelStorei(Z.UNPACK_ROW_LENGTH,Vt),Z.pixelStorei(Z.UNPACK_IMAGE_HEIGHT,Di),Z.pixelStorei(Z.UNPACK_SKIP_PIXELS,ra),Z.pixelStorei(Z.UNPACK_SKIP_ROWS,ti),Z.pixelStorei(Z.UNPACK_SKIP_IMAGES,As),Ke===0&&le.generateMipmaps&&Z.generateMipmap(Nn),Je.unbindTexture()},this.initRenderTarget=function(G){V.get(G).__webglFramebuffer===void 0&&ae.setupRenderTarget(G)},this.initTexture=function(G){G.isCubeTexture?ae.setTextureCube(G,0):G.isData3DTexture?ae.setTexture3D(G,0):G.isDataArrayTexture||G.isCompressedArrayTexture?ae.setTexture2DArray(G,0):ae.setTexture2D(G,0),Je.unbindTexture()},this.resetState=function(){Y=0,ee=0,Q=null,Je.reset(),dt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ga}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=kn._getDrawingBufferColorSpace(e),t.unpackColorSpace=kn._getUnpackColorSpace()}}const cV=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:$b,AddEquation:Ru,AddOperation:sk,AdditiveAnimationBlendMode:iT,AdditiveBlending:ZS,AgXToneMapping:X1,AlphaFormat:tT,AlwaysCompare:gk,AlwaysDepth:Uy,AlwaysStencilFunc:n1,AmbientLight:cI,AnimationAction:xI,AnimationClip:g0,AnimationLoader:a2,AnimationMixer:U2,AnimationObjectGroup:D2,AnimationUtils:n2,ArcCurve:Lk,ArrayCamera:pI,ArrowHelper:oz,AttachedBindMode:t1,Audio:mI,AudioAnalyser:S2,AudioContext:CT,AudioListener:b2,AudioLoader:x2,AxesHelper:lz,BackSide:Ar,BasicDepthPacking:ck,BasicShadowMap:zR,BatchedMesh:Rk,Bone:uT,BooleanKeyframeTrack:xh,Box2:q2,Box3:ar,Box3Helper:rz,BoxGeometry:gh,BoxHelper:sz,BufferAttribute:ei,BufferGeometry:sn,BufferGeometryLoader:fI,ByteType:K1,Cache:_l,Camera:a_,CameraHelper:iz,CanvasTexture:EO,CapsuleGeometry:p_,CatmullRomCurve3:Ok,CineonToneMapping:W1,CircleGeometry:m_,ClampToEdgeWrapping:Qr,Clock:RT,Color:_t,ColorKeyframeTrack:ET,ColorManagement:kn,CompressedArrayTexture:SO,CompressedCubeTexture:TO,CompressedTexture:f_,CompressedTextureLoader:o2,ConeGeometry:N0,ConstantAlphaFactor:tk,ConstantColorFactor:QR,Controls:uz,CubeCamera:Tk,CubeDepthTexture:Pk,CubeReflectionMapping:Tl,CubeRefractionMapping:Lu,CubeTexture:M0,CubeTextureLoader:l2,CubeUVReflectionMapping:Rp,CubicBezierCurve:pT,CubicBezierCurve3:zk,CubicInterpolant:tI,CullFaceBack:KS,CullFaceFront:OR,CullFaceFrontBack:M4,CullFaceNone:LR,Curve:Uo,CurvePath:Fk,CustomBlending:jR,CustomToneMapping:$1,CylinderGeometry:A0,Cylindrical:G2,Data3DTexture:r_,DataArrayTexture:s_,DataTexture:Ya,DataTextureLoader:c2,DataUtils:X5,DecrementStencilOp:G4,DecrementWrapStencilOp:W4,DefaultLoadingManager:sI,DepthFormat:El,DepthStencilFormat:Iu,DepthTexture:fh,DetachedBindMode:rk,DirectionalLight:lI,DirectionalLightHelper:nz,DiscreteInterpolant:nI,DodecahedronGeometry:g_,DoubleSide:yl,DstAlphaFactor:XR,DstColorFactor:JR,DynamicCopyUsage:o5,DynamicDrawUsage:t5,DynamicReadUsage:s5,EdgesGeometry:Uk,EllipseCurve:x_,EqualCompare:fk,EqualDepth:Oy,EqualStencilFunc:J4,EquirectangularReflectionMapping:t0,EquirectangularRefractionMapping:n0,Euler:ya,EventDispatcher:Al,ExternalTexture:hT,ExtrudeGeometry:v_,FileLoader:wc,Float16BufferAttribute:tO,Float32BufferAttribute:Et,FloatType:Ts,Fog:l_,FogExp2:o_,FramebufferTexture:wO,FrontSide:_c,Frustum:Ip,FrustumArray:h_,GLBufferAttribute:F2,GLSL1:c5,GLSL3:i1,GreaterCompare:pk,GreaterDepth:jy,GreaterEqualCompare:i_,GreaterEqualDepth:zy,GreaterEqualStencilFunc:e5,GreaterStencilFunc:Z4,GridHelper:ez,Group:dp,HalfFloatType:Po,HemisphereLight:rI,HemisphereLightHelper:Q2,IcosahedronGeometry:y_,ImageBitmapLoader:g2,ImageLoader:x0,ImageUtils:bk,IncrementStencilOp:H4,IncrementWrapStencilOp:q4,InstancedBufferAttribute:Ap,InstancedBufferGeometry:hI,InstancedInterleavedBuffer:j2,InstancedMesh:Ck,Int16BufferAttribute:Q5,Int32BufferAttribute:eO,Int8BufferAttribute:J5,IntType:Yb,InterleavedBuffer:u_,InterleavedBufferAttribute:hh,Interpolant:k0,InterpolateDiscrete:r0,InterpolateLinear:yb,InterpolateSmooth:yy,InterpolationSamplingMode:h5,InterpolationSamplingType:d5,InvertStencilOp:$4,KeepStencilOp:Yd,KeyframeTrack:eo,LOD:Ak,LatheGeometry:b_,Layers:Ep,LessCompare:hk,LessDepth:Ly,LessEqualCompare:n_,LessEqualDepth:uh,LessEqualStencilFunc:K4,LessStencilFunc:Y4,Light:qu,LightProbe:dI,Line:ju,Line3:X2,LineBasicMaterial:Cr,LineCurve:mT,LineCurve3:jk,LineDashedMaterial:Qk,LineLoop:kk,LineSegments:Nl,LinearFilter:si,LinearInterpolant:TT,LinearMipMapLinearFilter:R4,LinearMipMapNearestFilter:C4,LinearMipmapLinearFilter:bl,LinearMipmapNearestFilter:jg,LinearSRGBColorSpace:Ou,LinearToneMapping:G1,LinearTransfer:o0,Loader:ia,LoaderUtils:l1,LoadingManager:MT,LoopOnce:ak,LoopPingPong:lk,LoopRepeat:ok,MOUSE:T4,Material:or,MaterialLoader:A_,MathUtils:D5,Matrix2:UT,Matrix3:on,Matrix4:Jt,MaxEquation:HR,Mesh:os,MeshBasicMaterial:Hu,MeshDepthMaterial:_T,MeshDistanceMaterial:wT,MeshLambertMaterial:Kk,MeshMatcapMaterial:Zk,MeshNormalMaterial:Jk,MeshPhongMaterial:Xk,MeshPhysicalMaterial:$k,MeshStandardMaterial:bT,MeshToonMaterial:Yk,MinEquation:VR,MirroredRepeatWrapping:s0,MixOperation:ik,MultiplyBlending:e1,MultiplyOperation:T0,NearestFilter:Ii,NearestMipMapLinearFilter:N4,NearestMipMapNearestFilter:A4,NearestMipmapLinearFilter:cp,NearestMipmapNearestFilter:J1,NeutralToneMapping:Y1,NeverCompare:dk,NeverDepth:Py,NeverStencilFunc:X4,NoBlending:wl,NoColorSpace:gc,NoNormalPacking:z4,NoToneMapping:Xa,NormalAnimationBlendMode:t_,NormalBlending:ah,NormalGAPacking:F4,NormalRGPacking:j4,NotEqualCompare:mk,NotEqualDepth:Fy,NotEqualStencilFunc:Q4,NumberKeyframeTrack:p0,Object3D:On,ObjectLoader:p2,ObjectSpaceNormalMap:uk,OctahedronGeometry:C0,OneFactor:qR,OneMinusConstantAlphaFactor:nk,OneMinusConstantColorFactor:ek,OneMinusDstAlphaFactor:YR,OneMinusDstColorFactor:KR,OneMinusSrcAlphaFactor:Dy,OneMinusSrcColorFactor:$R,OrthographicCamera:yh,PCFShadowMap:mp,PCFSoftShadowMap:zg,PMREMGenerator:d1,Path:Sb,PerspectiveCamera:Ss,Plane:Nu,PlaneGeometry:Dp,PlaneHelper:az,PointLight:oI,PointLightHelper:K2,Points:Ik,PointsMaterial:dT,PolarGridHelper:tz,PolyhedronGeometry:Gu,PositionalAudio:w2,PropertyBinding:Ln,PropertyMixer:gI,QuadraticBezierCurve:gT,QuadraticBezierCurve3:xT,Quaternion:ea,QuaternionKeyframeTrack:I0,QuaternionLinearInterpolant:iI,R11_EAC_Format:Xy,RED_GREEN_RGTC2_Format:xb,RED_RGTC1_Format:mb,REVISION:Wb,RG11_EAC_Format:Jy,RGBADepthPacking:U4,RGBAFormat:Es,RGBAIntegerFormat:e_,RGBA_ASTC_10x10_Format:cb,RGBA_ASTC_10x5_Format:ab,RGBA_ASTC_10x6_Format:ob,RGBA_ASTC_10x8_Format:lb,RGBA_ASTC_12x10_Format:ub,RGBA_ASTC_12x12_Format:db,RGBA_ASTC_4x4_Format:Zy,RGBA_ASTC_5x4_Format:Qy,RGBA_ASTC_5x5_Format:eb,RGBA_ASTC_6x5_Format:tb,RGBA_ASTC_6x6_Format:nb,RGBA_ASTC_8x5_Format:ib,RGBA_ASTC_8x6_Format:sb,RGBA_ASTC_8x8_Format:rb,RGBA_BPTC_Format:hb,RGBA_ETC2_EAC_Format:$y,RGBA_PVRTC_2BPPV1_Format:Gy,RGBA_PVRTC_4BPPV1_Format:Hy,RGBA_S3TC_DXT1_Format:Bg,RGBA_S3TC_DXT3_Format:Vg,RGBA_S3TC_DXT5_Format:Hg,RGBDepthPacking:L4,RGBFormat:nT,RGBIntegerFormat:k4,RGB_BPTC_SIGNED_Format:fb,RGB_BPTC_UNSIGNED_Format:pb,RGB_ETC1_Format:qy,RGB_ETC2_Format:Wy,RGB_PVRTC_2BPPV1_Format:Vy,RGB_PVRTC_4BPPV1_Format:By,RGB_S3TC_DXT1_Format:Fg,RGDepthPacking:O4,RGFormat:dh,RGIntegerFormat:Qb,RawShaderMaterial:yT,Ray:kp,Raycaster:PT,RectAreaLight:uI,RedFormat:Zb,RedIntegerFormat:E0,ReinhardToneMapping:q1,RenderTarget:rT,RenderTarget3D:L2,RepeatWrapping:i0,ReplaceStencilOp:V4,ReverseSubtractEquation:BR,RingGeometry:__,SIGNED_R11_EAC_Format:Yy,SIGNED_RED_GREEN_RGTC2_Format:vb,SIGNED_RED_RGTC1_Format:gb,SIGNED_RG11_EAC_Format:Ky,SRGBColorSpace:sr,SRGBTransfer:$n,Scene:c_,ShaderChunk:mn,ShaderLib:Ro,ShaderMaterial:na,ShadowMaterial:Wk,Shape:lh,ShapeGeometry:w_,ShapePath:cz,ShapeUtils:ko,ShortType:Z1,Skeleton:d_,SkeletonHelper:J2,SkinnedMesh:Nk,Source:Du,Sphere:Bs,SphereGeometry:R0,Spherical:H2,SphericalHarmonics3:NT,SplineCurve:vT,SpotLight:aI,SpotLightHelper:Y2,Sprite:Mk,SpriteMaterial:cT,SrcAlphaFactor:Iy,SrcAlphaSaturateFactor:ZR,SrcColorFactor:WR,StaticCopyUsage:a5,StaticDrawUsage:l0,StaticReadUsage:i5,StereoCamera:v2,StreamCopyUsage:l5,StreamDrawUsage:n5,StreamReadUsage:r5,StringKeyframeTrack:vh,SubtractEquation:FR,SubtractiveBlending:QS,TOUCH:E4,TangentSpaceNormalMap:Vu,TetrahedronGeometry:S_,Texture:Bi,TextureLoader:u2,TextureUtils:mz,Timer:B2,TimestampQuery:u5,TorusGeometry:T_,TorusKnotGeometry:E_,Triangle:Zr,TriangleFanDrawMode:P4,TriangleStripDrawMode:D4,TrianglesDrawMode:I4,TubeGeometry:M_,UVMapping:Xb,Uint16BufferAttribute:aT,Uint32BufferAttribute:oT,Uint8BufferAttribute:K5,Uint8ClampedBufferAttribute:Z5,Uniform:DT,UniformsGroup:z2,UniformsLib:ft,UniformsUtils:Sk,UnsignedByteType:Er,UnsignedInt101111Type:eT,UnsignedInt248Type:_p,UnsignedInt5999Type:Q1,UnsignedIntType:Za,UnsignedShort4444Type:Jb,UnsignedShort5551Type:Kb,UnsignedShortType:bp,VSMShadowMap:nh,Vector2:Be,Vector3:K,Vector4:ii,VectorKeyframeTrack:m0,VideoFrameTexture:_O,VideoTexture:Dk,WebGL3DRenderTarget:z5,WebGLArrayRenderTarget:O5,WebGLCoordinateSystem:ga,WebGLCubeRenderTarget:lT,WebGLRenderTarget:ta,WebGLRenderer:EI,WebGLUtils:TI,WebGPUCoordinateSystem:wp,WebXRController:by,WireframeGeometry:qk,WrapAroundEnding:a0,ZeroCurvatureEnding:ih,ZeroFactor:GR,ZeroSlopeEnding:sh,ZeroStencilOp:B4,createCanvasElement:yk,error:Dt,getConsoleFunction:m5,log:u0,setConsoleFunction:p5,warn:ht,warnOnce:Sp},Symbol.toStringTag,{value:"Module"}));var SS={exports:{}},TS={},ES={exports:{}},MS={};var QA;function uV(){if(QA)return MS;QA=1;var n=b0();function e(v,y){return v===y&&(v!==0||1/v===1/y)||v!==v&&y!==y}var t=typeof Object.is=="function"?Object.is:e,i=n.useState,s=n.useEffect,r=n.useLayoutEffect,o=n.useDebugValue;function c(v,y){var w=y(),E=i({inst:{value:w,getSnapshot:y}}),R=E[0].inst,N=E[1];return r(function(){R.value=w,R.getSnapshot=y,h(R)&&N({inst:R})},[v,w,y]),s(function(){return h(R)&&N({inst:R}),v(function(){h(R)&&N({inst:R})})},[v]),o(w),w}function h(v){var y=v.getSnapshot;v=v.value;try{var w=y();return!t(v,w)}catch{return!0}}function p(v,y){return y()}var g=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:c;return MS.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:g,MS}var eN;function dV(){return eN||(eN=1,ES.exports=uV()),ES.exports}var tN;function hV(){if(tN)return TS;tN=1;var n=b0(),e=dV();function t(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var i=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,r=n.useRef,o=n.useEffect,c=n.useMemo,h=n.useDebugValue;return TS.useSyncExternalStoreWithSelector=function(p,g,v,y,w){var E=r(null);if(E.current===null){var R={hasValue:!1,value:null};E.current=R}else R=E.current;E=c(function(){function A(F){if(!I){if(I=!0,D=F,F=y(F),w!==void 0&&R.hasValue){var z=R.value;if(w(z,F))return U=z}return U=F}if(z=U,i(D,F))return z;var W=y(F);return w!==void 0&&w(z,W)?(D=F,z):(D=F,U=W)}var I=!1,D,U,j=v===void 0?null:v;return[function(){return A(g())},j===null?void 0:function(){return A(j())}]},[g,v,y,w]);var N=s(p,E[0],E[1]);return o(function(){R.hasValue=!0,R.value=N},[N]),h(N),N},TS}var nN;function fV(){return nN||(nN=1,SS.exports=hV()),SS.exports}var pV=fV();const mV=Lb(pV),iN=n=>{let e;const t=new Set,i=(p,g)=>{const v=typeof p=="function"?p(e):p;if(!Object.is(v,e)){const y=e;e=g??(typeof v!="object"||v===null)?v:Object.assign({},e,v),t.forEach(w=>w(e,y))}},s=()=>e,c={setState:i,getState:s,getInitialState:()=>h,subscribe:p=>(t.add(p),()=>t.delete(p))},h=e=n(i,s,c);return c},gV=(n=>n?iN(n):iN),{useSyncExternalStoreWithSelector:xV}=mV,vV=n=>n;function yV(n,e=vV,t){const i=xV(n.subscribe,n.getState,n.getInitialState,e,t);return Ob.useDebugValue(i),i}const sN=(n,e)=>{const t=gV(n),i=(s,r=e)=>yV(t,s,r);return Object.assign(i,t),i},MI=((n,e)=>n?sN(n,e):sN);var p1=iR();const bV=Lb(p1);function LT(n,e,t){if(!n)return;if(t(n)===!0)return n;let i=e?n.return:n.child;for(;i;){const s=LT(i,e,t);if(s)return s;i=e?null:i.sibling}}function AI(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const OT=AI(ue.createContext(null));class NI extends ue.Component{render(){return ue.createElement(OT.Provider,{value:this._reactInternals},this.props.children)}}function CI(){const n=ue.useContext(OT);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ue.useId();return ue.useMemo(()=>{for(const t of[n,n?.alternate]){if(!t)continue;const i=LT(t,!1,s=>{let r=s.memoizedState;for(;r;){if(r.memoizedState===e)return!0;r=r.next}});if(i)return i}},[n,e])}const _V=Symbol.for("react.context"),wV=n=>n!==null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===_V;function SV(){const n=CI(),[e]=ue.useState(()=>new Map);e.clear();let t=n;for(;t;){const i=t.type;wV(i)&&i!==OT&&!e.has(i)&&e.set(i,ue.use(AI(i))),t=t.return}return e}function TV(){const n=SV();return ue.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>i=>ue.createElement(e,null,ue.createElement(t.Provider,{...i,value:n.get(t)})),e=>ue.createElement(NI,{...e})),[n])}function RI(n){let e=n.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const kI=n=>n&&n.isOrthographicCamera,EV=n=>n&&n.hasOwnProperty("current"),MV=n=>n!=null&&(typeof n=="string"||typeof n=="number"||n.isColor),D0=((n,e)=>typeof window<"u"&&(((n=window.document)==null?void 0:n.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?ue.useLayoutEffect:ue.useEffect;function zT(n){const e=ue.useRef(n);return D0(()=>{e.current=n},[n]),e}function AV(){const n=CI(),e=TV();return ue.useMemo(()=>({children:t})=>{const s=!!LT(n,!0,r=>r.type===ue.StrictMode)?ue.StrictMode:ue.Fragment;return d.jsx(s,{children:d.jsx(e,{children:t})})},[n,e])}function NV({set:n}){return D0(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}const CV=(n=>(n=class extends ue.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},n.getDerivedStateFromError=()=>({error:!0}),n))();function II(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}function tp(n){var e;return(e=n.__r3f)==null?void 0:e.root.getState()}const Ri={obj:n=>n===Object(n)&&!Ri.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,nul:n=>n===null,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:s=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Ri.str(n)||Ri.num(n)||Ri.boo(n))return n===e;const r=Ri.obj(n);if(r&&i==="reference")return n===e;const o=Ri.arr(n);if(o&&t==="reference")return n===e;if((o||r)&&n===e)return!0;let c;for(c in n)if(!(c in e))return!1;if(r&&t==="shallow"&&i==="shallow"){for(c in s?e:n)if(!Ri.equ(n[c],e[c],{strict:s,objects:"reference"}))return!1}else for(c in s?e:n)if(n[c]!==e[c])return!1;if(Ri.und(c)){if(o&&n.length===0&&e.length===0||r&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function RV(n){n.type!=="Scene"&&(n.dispose==null||n.dispose());for(const e in n){const t=n[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const DI=["children","key","ref"];function kV(n){const e={};for(const t in n)DI.includes(t)||(e[t]=n[t]);return e}function Tb(n,e,t,i){const s=n;let r=s?.__r3f;return r||(r={root:e,type:t,parent:null,children:[],props:kV(i),object:s,eventCount:0,handlers:{},isHidden:!1},s&&(s.__r3f=r)),r}function v0(n,e){if(!e.includes("-"))return{root:n,key:e,target:n[e]};if(e in n)return{root:n,key:e,target:n[e]};let t=n;const i=e.split("-");for(const s of i){if(typeof t!="object"||t===null){if(t!==void 0){const r=i.slice(i.indexOf(s)).join("-");return{root:t,key:r,target:void 0}}return{root:n,key:e,target:void 0}}e=s,n=t,t=t[e]}return{root:n,key:e,target:t}}const rN=/-\d+$/;function Eb(n,e){if(Ri.str(e.props.attach)){if(rN.test(e.props.attach)){const s=e.props.attach.replace(rN,""),{root:r,key:o}=v0(n.object,s);Array.isArray(r[o])||(r[o]=[])}const{root:t,key:i}=v0(n.object,e.props.attach);e.previousAttach=t[i],t[i]=e.object}else Ri.fun(e.props.attach)&&(e.previousAttach=e.props.attach(n.object,e.object))}function Mb(n,e){if(Ri.str(e.props.attach)){const{root:t,key:i}=v0(n.object,e.props.attach),s=e.previousAttach;s===void 0?delete t[i]:t[i]=s}else e.previousAttach==null||e.previousAttach(n.object,e.object);delete e.previousAttach}const m1=[...DI,"args","dispose","attach","object","onUpdate","dispose"],aN=new Map;function IV(n){let e=aN.get(n.constructor);try{e||(e=new n.constructor,aN.set(n.constructor,e))}catch{}return e}function DV(n,e){const t={};for(const i in e)if(!m1.includes(i)&&!Ri.equ(e[i],n.props[i])){t[i]=e[i];for(const s in e)s.startsWith(`${i}-`)&&(t[s]=e[s])}for(const i in n.props){if(m1.includes(i)||e.hasOwnProperty(i))continue;const{root:s,key:r}=v0(n.object,i);if(s.constructor&&s.constructor.length===0){const o=IV(s);Ri.und(o)||(t[r]=o[r])}else t[r]=0}return t}const PV=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],UV=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function ku(n,e){var t;const i=n.__r3f,s=i&&RI(i).getState(),r=i?.eventCount;for(const c in e){let h=e[c];if(m1.includes(c))continue;if(i&&UV.test(c)){typeof h=="function"?i.handlers[c]=h:delete i.handlers[c],i.eventCount=Object.keys(i.handlers).length;continue}if(h===void 0)continue;let{root:p,key:g,target:v}=v0(n,c);if(v===void 0&&(typeof p!="object"||p===null))throw Error(`R3F: Cannot set "${c}". Ensure it is an object before setting "${g}".`);if(v instanceof Ep&&h instanceof Ep)v.mask=h.mask;else if(v instanceof _t&&MV(h))v.set(h);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof v.copy=="function"&&h!=null&&h.constructor&&v.constructor===h.constructor)v.copy(h);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&Array.isArray(h))typeof v.fromArray=="function"?v.fromArray(h):v.set(...h);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof h=="number")typeof v.setScalar=="function"?v.setScalar(h):v.set(h);else{var o;p[g]=h,s&&!s.linear&&PV.includes(g)&&(o=p[g])!=null&&o.isTexture&&p[g].format===Es&&p[g].type===Er&&(p[g].colorSpace=sr)}}if(i!=null&&i.parent&&s!=null&&s.internal&&(t=i.object)!=null&&t.isObject3D&&r!==i.eventCount){const c=i.object,h=s.internal.interaction.indexOf(c);h>-1&&s.internal.interaction.splice(h,1),i.eventCount&&c.raycast!==null&&s.internal.interaction.push(c)}return i&&i.props.attach===void 0&&(i.object.isBufferGeometry?i.props.attach="geometry":i.object.isMaterial&&(i.props.attach="material")),i&&Up(i),n}function Up(n){var e;if(!n.parent)return;n.props.onUpdate==null||n.props.onUpdate(n.object);const t=(e=n.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function PI(n,e){n.manual||(kI(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix())}const Kr=n=>n?.isObject3D;function dy(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function UI(n,e,t,i){const s=t.get(e);s&&(t.delete(e),t.size===0&&(n.delete(i),s.target.releasePointerCapture(i)))}function LV(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,s)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(s)}),t.capturedMap.forEach((i,s)=>{UI(t.capturedMap,e,i,s)})}function OV(n){function e(h){const{internal:p}=n.getState(),g=h.offsetX-p.initialClick[0],v=h.offsetY-p.initialClick[1];return Math.round(Math.sqrt(g*g+v*v))}function t(h){return h.filter(p=>["Move","Over","Enter","Out","Leave"].some(g=>{var v;return(v=p.__r3f)==null?void 0:v.handlers["onPointer"+g]}))}function i(h,p){const g=n.getState(),v=new Set,y=[],w=p?p(g.internal.interaction):g.internal.interaction;for(let A=0;A<w.length;A++){const I=tp(w[A]);I&&(I.raycaster.camera=void 0)}g.previousRoot||g.events.compute==null||g.events.compute(h,g);function E(A){const I=tp(A);if(!I||!I.events.enabled||I.raycaster.camera===null)return[];if(I.raycaster.camera===void 0){var D;I.events.compute==null||I.events.compute(h,I,(D=I.previousRoot)==null?void 0:D.getState()),I.raycaster.camera===void 0&&(I.raycaster.camera=null)}return I.raycaster.camera?I.raycaster.intersectObject(A,!0):[]}let R=w.flatMap(E).sort((A,I)=>{const D=tp(A.object),U=tp(I.object);return!D||!U?A.distance-I.distance:U.events.priority-D.events.priority||A.distance-I.distance}).filter(A=>{const I=dy(A);return v.has(I)?!1:(v.add(I),!0)});g.events.filter&&(R=g.events.filter(R,g));for(const A of R){let I=A.object;for(;I;){var N;(N=I.__r3f)!=null&&N.eventCount&&y.push({...A,eventObject:I}),I=I.parent}}if("pointerId"in h&&g.internal.capturedMap.has(h.pointerId))for(let A of g.internal.capturedMap.get(h.pointerId).values())v.has(dy(A.intersection))||y.push(A.intersection);return y}function s(h,p,g,v){if(h.length){const y={stopped:!1};for(const w of h){let E=tp(w.object);if(E||w.object.traverseAncestors(R=>{const N=tp(R);if(N)return E=N,!1}),E){const{raycaster:R,pointer:N,camera:A,internal:I}=E,D=new K(N.x,N.y,0).unproject(A),U=L=>{var B,Y;return(B=(Y=I.capturedMap.get(L))==null?void 0:Y.has(w.eventObject))!=null?B:!1},j=L=>{const B={intersection:w,target:p.target};I.capturedMap.has(L)?I.capturedMap.get(L).set(w.eventObject,B):I.capturedMap.set(L,new Map([[w.eventObject,B]])),p.target.setPointerCapture(L)},F=L=>{const B=I.capturedMap.get(L);B&&UI(I.capturedMap,w.eventObject,B,L)};let z={};for(let L in p){let B=p[L];typeof B!="function"&&(z[L]=B)}let W={...w,...z,pointer:N,intersections:h,stopped:y.stopped,delta:g,unprojectedPoint:D,ray:R.ray,camera:A,stopPropagation(){const L="pointerId"in p&&I.capturedMap.get(p.pointerId);if((!L||L.has(w.eventObject))&&(W.stopped=y.stopped=!0,I.hovered.size&&Array.from(I.hovered.values()).find(B=>B.eventObject===w.eventObject))){const B=h.slice(0,h.indexOf(w));r([...B,w])}},target:{hasPointerCapture:U,setPointerCapture:j,releasePointerCapture:F},currentTarget:{hasPointerCapture:U,setPointerCapture:j,releasePointerCapture:F},nativeEvent:p};if(v(W),y.stopped===!0)break}}}return h}function r(h){const{internal:p}=n.getState();for(const g of p.hovered.values())if(!h.length||!h.find(v=>v.object===g.object&&v.index===g.index&&v.instanceId===g.instanceId)){const y=g.eventObject.__r3f;if(p.hovered.delete(dy(g)),y!=null&&y.eventCount){const w=y.handlers,E={...g,intersections:h};w.onPointerOut==null||w.onPointerOut(E),w.onPointerLeave==null||w.onPointerLeave(E)}}}function o(h,p){for(let g=0;g<p.length;g++){const v=p[g].__r3f;v==null||v.handlers.onPointerMissed==null||v.handlers.onPointerMissed(h)}}function c(h){switch(h){case"onPointerLeave":case"onPointerCancel":return()=>r([]);case"onLostPointerCapture":return p=>{const{internal:g}=n.getState();"pointerId"in p&&g.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{g.capturedMap.has(p.pointerId)&&(g.capturedMap.delete(p.pointerId),r([]))})}}return function(g){const{onPointerMissed:v,internal:y}=n.getState();y.lastEvent.current=g;const w=h==="onPointerMove",E=h==="onClick"||h==="onContextMenu"||h==="onDoubleClick",N=i(g,w?t:void 0),A=E?e(g):0;h==="onPointerDown"&&(y.initialClick=[g.offsetX,g.offsetY],y.initialHits=N.map(D=>D.eventObject)),E&&!N.length&&A<=2&&(o(g,y.interaction),v&&v(g)),w&&r(N);function I(D){const U=D.eventObject,j=U.__r3f;if(!(j!=null&&j.eventCount))return;const F=j.handlers;if(w){if(F.onPointerOver||F.onPointerEnter||F.onPointerOut||F.onPointerLeave){const z=dy(D),W=y.hovered.get(z);W?W.stopped&&D.stopPropagation():(y.hovered.set(z,D),F.onPointerOver==null||F.onPointerOver(D),F.onPointerEnter==null||F.onPointerEnter(D))}F.onPointerMove==null||F.onPointerMove(D)}else{const z=F[h];z?(!E||y.initialHits.includes(U))&&(o(g,y.interaction.filter(W=>!y.initialHits.includes(W))),z(D)):E&&y.initialHits.includes(U)&&o(g,y.interaction.filter(W=>!y.initialHits.includes(W)))}}s(N,g,A,I)}}return{handlePointer:c}}const oN=n=>!!(n!=null&&n.render),jT=ue.createContext(null),zV=(n,e)=>{const t=MI((c,h)=>{const p=new K,g=new K,v=new K;function y(A=h().camera,I=g,D=h().size){const{width:U,height:j,top:F,left:z}=D,W=U/j;I.isVector3?v.copy(I):v.set(...I);const L=A.getWorldPosition(p).distanceTo(v);if(kI(A))return{width:U/A.zoom,height:j/A.zoom,top:F,left:z,factor:1,distance:L,aspect:W};{const B=A.fov*Math.PI/180,Y=2*Math.tan(B/2)*L,ee=Y*(U/j);return{width:ee,height:Y,top:F,left:z,factor:U/ee,distance:L,aspect:W}}}let w;const E=A=>c(I=>({performance:{...I.performance,current:A}})),R=new Be;return{set:c,get:h,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(A=1)=>n(h(),A),advance:(A,I)=>e(A,I,h()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new RT,pointer:R,mouse:R,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const A=h();w&&clearTimeout(w),A.performance.current!==A.performance.min&&E(A.performance.min),w=setTimeout(()=>E(h().performance.max),A.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:y},setEvents:A=>c(I=>({...I,events:{...I.events,...A}})),setSize:(A,I,D=0,U=0)=>{const j=h().camera,F={width:A,height:I,top:D,left:U};c(z=>({size:F,viewport:{...z.viewport,...y(j,g,F)}}))},setDpr:A=>c(I=>{const D=II(A);return{viewport:{...I.viewport,dpr:D,initialDpr:I.viewport.initialDpr||D}}}),setFrameloop:(A="always")=>{const I=h().clock;I.stop(),I.elapsedTime=0,A!=="never"&&(I.start(),I.elapsedTime=0),c(()=>({frameloop:A}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:ue.createRef(),active:!1,frames:0,priority:0,subscribe:(A,I,D)=>{const U=h().internal;return U.priority=U.priority+(I>0?1:0),U.subscribers.push({ref:A,priority:I,store:D}),U.subscribers=U.subscribers.sort((j,F)=>j.priority-F.priority),()=>{const j=h().internal;j!=null&&j.subscribers&&(j.priority=j.priority-(I>0?1:0),j.subscribers=j.subscribers.filter(F=>F.ref!==A))}}}}}),i=t.getState();let s=i.size,r=i.viewport.dpr,o=i.camera;return t.subscribe(()=>{const{camera:c,size:h,viewport:p,gl:g,set:v}=t.getState();if(h.width!==s.width||h.height!==s.height||p.dpr!==r){s=h,r=p.dpr,PI(c,h),p.dpr>0&&g.setPixelRatio(p.dpr);const y=typeof HTMLCanvasElement<"u"&&g.domElement instanceof HTMLCanvasElement;g.setSize(h.width,h.height,y)}c!==o&&(o=c,v(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(c)}})))}),t.subscribe(c=>n(c)),t};function FT(){const n=ue.useContext(jT);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function lN(n=t=>t,e){return FT()(n,e)}function jV(n,e=0){const t=FT(),i=t.getState().internal.subscribe,s=zT(n);return D0(()=>i(s,e,t),[e,i,t]),null}const FV=1,BV=8,VV=32,HV=2;var GV={version:"9.5.0"};function qV(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var cN={exports:{}},uN={exports:{}},dN;function WV(){return dN||(dN=1,(function(n){n.exports=function(e){function t(u,f,b,T){return new um(u,f,b,T)}function i(){}function s(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)f+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(u){var f=u,b=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(b=f.return),u=f.return;while(u)}return f.tag===3?b:null}function o(u){if(r(u)!==u)throw Error(s(188))}function c(u){var f=u.alternate;if(!f){if(f=r(u),f===null)throw Error(s(188));return f!==u?null:u}for(var b=u,T=f;;){var k=b.return;if(k===null)break;var P=k.alternate;if(P===null){if(T=k.return,T!==null){b=T;continue}break}if(k.child===P.child){for(P=k.child;P;){if(P===b)return o(k),u;if(P===T)return o(k),f;P=P.sibling}throw Error(s(188))}if(b.return!==T.return)b=k,T=P;else{for(var H=!1,ie=k.child;ie;){if(ie===b){H=!0,b=k,T=P;break}if(ie===T){H=!0,T=k,b=P;break}ie=ie.sibling}if(!H){for(ie=P.child;ie;){if(ie===b){H=!0,b=P,T=k;break}if(ie===T){H=!0,T=P,b=k;break}ie=ie.sibling}if(!H)throw Error(s(189))}}if(b.alternate!==T)throw Error(s(190))}if(b.tag!==3)throw Error(s(188));return b.stateNode.current===b?u:f}function h(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(f=h(u),f!==null)return f;u=u.sibling}return null}function p(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(u.tag!==4&&(f=p(u),f!==null))return f;u=u.sibling}return null}function g(u){return u===null||typeof u!="object"?null:(u=po&&u[po]||u["@@iterator"],typeof u=="function"?u:null)}function v(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===el?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case Gl:return"Fragment";case Wl:return"Profiler";case ql:return"StrictMode";case Yh:return"Suspense";case fo:return"SuspenseList";case fd:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case Hl:return"Portal";case Or:return u.displayName||"Context";case hd:return(u._context.displayName||"Context")+".Consumer";case $c:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case Jh:return f=u.displayName||null,f!==null?f:v(u.type)||"Memo";case ks:f=u._payload,u=u._init;try{return v(u(f))}catch{}}return null}function y(u){return{current:u}}function w(u){0>Kl||(u.current=uf[Kl],uf[Kl]=null,Kl--)}function E(u,f){Kl++,uf[Kl]=u.current,u.current=f}function R(u){return u>>>=0,u===0?32:31-(df(u)/Jx|0)|0}function N(u){var f=u&42;if(f!==0)return f;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return u&261888;case 262144:case 524288:case 1048576:case 2097152:return u&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function A(u,f,b){var T=u.pendingLanes;if(T===0)return 0;var k=0,P=u.suspendedLanes,H=u.pingedLanes;u=u.warmLanes;var ie=T&134217727;return ie!==0?(T=ie&~P,T!==0?k=N(T):(H&=ie,H!==0?k=N(H):b||(b=ie&~u,b!==0&&(k=N(b))))):(ie=T&~P,ie!==0?k=N(ie):H!==0?k=N(H):b||(b=T&~u,b!==0&&(k=N(b)))),k===0?0:f!==0&&f!==k&&(f&P)===0&&(P=k&-k,b=f&-f,P>=b||P===32&&(b&4194048)!==0)?f:k}function I(u,f){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&f)===0}function D(u,f){switch(u){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function U(){var u=eu;return eu<<=1,(eu&62914560)===0&&(eu=4194304),u}function j(u){for(var f=[],b=0;31>b;b++)f.push(u);return f}function F(u,f){u.pendingLanes|=f,f!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function z(u,f,b,T,k,P){var H=u.pendingLanes;u.pendingLanes=b,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=b,u.entangledLanes&=b,u.errorRecoveryDisabledLanes&=b,u.shellSuspendCounter=0;var ie=u.entanglements,Te=u.expirationTimes,Ve=u.hiddenUpdates;for(b=H&~b;0<b;){var tt=31-Ys(b),We=1<<tt;ie[tt]=0,Te[tt]=-1;var yt=Ve[tt];if(yt!==null)for(Ve[tt]=null,tt=0;tt<yt.length;tt++){var Zt=yt[tt];Zt!==null&&(Zt.lane&=-536870913)}b&=~We}T!==0&&W(u,T,0),P!==0&&k===0&&u.tag!==0&&(u.suspendedLanes|=P&~(H&~f))}function W(u,f,b){u.pendingLanes|=f,u.suspendedLanes&=~f;var T=31-Ys(f);u.entangledLanes|=f,u.entanglements[T]=u.entanglements[T]|1073741824|b&261930}function L(u,f){var b=u.entangledLanes|=f;for(u=u.entanglements;b;){var T=31-Ys(b),k=1<<T;k&f|u[T]&f&&(u[T]|=f),b&=~k}}function B(u,f){var b=f&-f;return b=(b&42)!==0?1:Y(b),(b&(u.suspendedLanes|f))!==0?0:b}function Y(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function ee(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function Q(u){if(typeof Ym=="function"&&Qx(u),Js&&typeof Js.setStrictMode=="function")try{Js.setStrictMode(Ql,u)}catch{}}function ce(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}function oe(u){if(xf===void 0)try{throw Error()}catch(b){var f=b.stack.trim().match(/\n( *(at )?)/);xf=f&&f[1]||"",Ua=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xf+u+Ua}function J(u,f){if(!u||wd)return"";wd=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(f){var We=function(){throw Error()};if(Object.defineProperty(We.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(We,[])}catch(Zt){var yt=Zt}Reflect.construct(u,[],We)}else{try{We.call()}catch(Zt){yt=Zt}u.call(We.prototype)}}else{try{throw Error()}catch(Zt){yt=Zt}(We=u())&&typeof We.catch=="function"&&We.catch(function(){})}}catch(Zt){if(Zt&&yt&&typeof Zt.stack=="string")return[Zt.stack,yt.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var k=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");k&&k.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var P=T.DetermineComponentFrameRoot(),H=P[0],ie=P[1];if(H&&ie){var Te=H.split(`
`),Ve=ie.split(`
`);for(k=T=0;T<Te.length&&!Te[T].includes("DetermineComponentFrameRoot");)T++;for(;k<Ve.length&&!Ve[k].includes("DetermineComponentFrameRoot");)k++;if(T===Te.length||k===Ve.length)for(T=Te.length-1,k=Ve.length-1;1<=T&&0<=k&&Te[T]!==Ve[k];)k--;for(;1<=T&&0<=k;T--,k--)if(Te[T]!==Ve[k]){if(T!==1||k!==1)do if(T--,k--,0>k||Te[T]!==Ve[k]){var tt=`
`+Te[T].replace(" at new "," at ");return u.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",u.displayName)),tt}while(1<=T&&0<=k);break}}}finally{wd=!1,Error.prepareStackTrace=b}return(b=u?u.displayName||u.name:"")?oe(b):""}function te(u,f){switch(u.tag){case 26:case 27:case 5:return oe(u.type);case 16:return oe("Lazy");case 13:return u.child!==f&&f!==null?oe("Suspense Fallback"):oe("Suspense");case 19:return oe("SuspenseList");case 0:case 15:return J(u.type,!1);case 11:return J(u.type.render,!1);case 1:return J(u.type,!0);case 31:return oe("Activity");default:return""}}function me(u){try{var f="",b=null;do f+=te(u,b),b=u,u=u.return;while(u);return f}catch(T){return`
Error generating stack: `+T.message+`
`+T.stack}}function Re(u,f){if(typeof u=="object"&&u!==null){var b=Jm.get(u);return b!==void 0?b:(f={value:u,source:f,stack:me(f)},Jm.set(u,f),f)}return{value:u,source:f,stack:me(f)}}function Ie(u,f){xo[La++]=Sd,xo[La++]=Wn,Wn=u,Sd=f}function $(u,f,b){Fr[xr++]=us,Fr[xr++]=oa,Fr[xr++]=Br,Br=u;var T=us;u=oa;var k=32-Ys(T)-1;T&=~(1<<k),b+=1;var P=32-Ys(f)+k;if(30<P){var H=k-k%5;P=(T&(1<<H)-1).toString(32),T>>=H,k-=H,us=1<<32-Ys(f)+k|b<<k|T,oa=P+u}else us=1<<P|b<<k|T,oa=u}function de(u){u.return!==null&&(Ie(u,1),$(u,1,0))}function Ne(u){for(;u===Wn;)Wn=xo[--La],xo[La]=null,Sd=xo[--La],xo[La]=null;for(;u===Br;)Br=Fr[--xr],Fr[xr]=null,oa=Fr[--xr],Fr[xr]=null,us=Fr[--xr],Fr[xr]=null}function Fe(u,f){Fr[xr++]=us,Fr[xr++]=oa,Fr[xr++]=Br,us=f.id,oa=f.overflow,Br=u}function lt(u,f){E(ds,f),E(vo,u),E(ns,null),u=hx(f),w(ns),E(ns,u)}function ge(){w(ns),w(vo),w(ds)}function Ce(u){u.memoizedState!==null&&E(Td,u);var f=ns.current,b=Jc(f,u.type);f!==b&&(E(vo,u),E(ns,b))}function nt(u){vo.current===u&&(w(ns),w(vo)),Td.current===u&&(w(Td),Si?Yl._currentValue=Xl:Yl._currentValue2=Xl)}function rt(u){var f=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw qe(Re(f,u)),vf}function mt(u,f){if(!ai)throw Error(s(175));zx(u.stateNode,u.type,u.memoizedProps,f,u)||rt(u,!0)}function ln(u){for(Wi=u.return;Wi;)switch(Wi.tag){case 5:case 31:case 13:Ds=!1;return;case 27:case 3:Ds=!0;return;default:Wi=Wi.return}}function vn(u){if(!ai||u!==Wi)return!1;if(!bn)return ln(u),bn=!0,!1;var f=u.tag;if(qi?f!==3&&f!==27&&(f!==5||Qc(u.type)&&!Is(u.type,u.memoizedProps))&&oi&&rt(u):f!==3&&(f!==5||Qc(u.type)&&!Is(u.type,u.memoizedProps))&&oi&&rt(u),ln(u),f===13){if(!ai)throw Error(s(316));if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));oi=zm(u)}else if(f===31){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(317));oi=Fx(u)}else oi=qi&&f===27?Rx(u.type,oi):Wi?Cx(u.stateNode):null;return!0}function zt(){ai&&(oi=Wi=null,bn=!1)}function Pe(){var u=Oa;return u!==null&&(Qs===null?Qs=u:Qs.push.apply(Qs,u),Oa=null),u}function qe(u){Oa===null?Oa=[u]:Oa.push(u)}function Oe(u,f,b){Si?(E(Vr,f._currentValue),f._currentValue=b):(E(Vr,f._currentValue2),f._currentValue2=b)}function it(u){var f=Vr.current;Si?u._currentValue=f:u._currentValue2=f,w(Vr)}function Z(u,f,b){for(;u!==null;){var T=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,T!==null&&(T.childLanes|=f)):T!==null&&(T.childLanes&f)!==f&&(T.childLanes|=f),u===b)break;u=u.return}}function Nt(u,f,b,T){var k=u.child;for(k!==null&&(k.return=u);k!==null;){var P=k.dependencies;if(P!==null){var H=k.child;P=P.firstContext;e:for(;P!==null;){var ie=P;P=k;for(var Te=0;Te<f.length;Te++)if(ie.context===f[Te]){P.lanes|=b,ie=P.alternate,ie!==null&&(ie.lanes|=b),Z(P.return,b,u),T||(H=null);break e}P=ie.next}}else if(k.tag===18){if(H=k.return,H===null)throw Error(s(341));H.lanes|=b,P=H.alternate,P!==null&&(P.lanes|=b),Z(H,b,u),H=null}else H=k.child;if(H!==null)H.return=k;else for(H=k;H!==null;){if(H===u){H=null;break}if(k=H.sibling,k!==null){k.return=H.return,H=k;break}H=H.return}k=H}}function ot(u,f,b,T){u=null;for(var k=f,P=!1;k!==null;){if(!P){if((k.flags&524288)!==0)P=!0;else if((k.flags&262144)!==0)break}if(k.tag===10){var H=k.alternate;if(H===null)throw Error(s(387));if(H=H.memoizedProps,H!==null){var ie=k.type;Ei(k.pendingProps.value,H.value)||(u!==null?u.push(ie):u=[ie])}}else if(k===Td.current){if(H=k.alternate,H===null)throw Error(s(387));H.memoizedState.memoizedState!==k.memoizedState.memoizedState&&(u!==null?u.push(Yl):u=[Yl])}k=k.return}u!==null&&Nt(f,u,b,T),f.flags|=262144}function Rt(u){for(u=u.firstContext;u!==null;){var f=u.context;if(!Ei(Si?f._currentValue:f._currentValue2,u.memoizedValue))return!0;u=u.next}return!1}function Je(u){Kn=u,la=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function X(u){return ae(Kn,u)}function V(u,f){return Kn===null&&Je(u),ae(u,f)}function ae(u,f){var b=Si?f._currentValue:f._currentValue2;if(f={context:f,memoizedValue:b,next:null},la===null){if(u===null)throw Error(s(308));la=f,u.dependencies={lanes:0,firstContext:f},u.flags|=524288}else la=la.next=f;return b}function Ee(){return{controller:new ev,data:new Map,refCount:0}}function ze(u){u.refCount--,u.refCount===0&&is(X_,function(){u.controller.abort()})}function Me(){}function gt(u){u!==Bn&&u.next===null&&(Bn===null?Ed=Bn=u:Bn=Bn.next=u),Hr=!0,bs||(bs=!0,pt())}function Qe(u,f){if(!yf&&Hr){yf=!0;do for(var b=!1,T=Ed;T!==null;){if(u!==0){var k=T.pendingLanes;if(k===0)var P=0;else{var H=T.suspendedLanes,ie=T.pingedLanes;P=(1<<31-Ys(42|u)+1)-1,P&=k&~(H&~ie),P=P&201326741?P&201326741|1:P?P|2:0}P!==0&&(b=!0,xt(T,P))}else P=_n,P=A(T,T===dn?P:0,T.cancelPendingCommit!==null||T.timeoutHandle!==Xs),(P&3)===0||I(T,P)||(b=!0,xt(T,P));T=T.next}while(b);yf=!1}}function St(){Ut()}function Ut(){Hr=bs=!1;var u=0;rl!==0&&$l()&&(u=rl);for(var f=ys(),b=null,T=Ed;T!==null;){var k=T.next,P=He(T,f);P===0?(T.next=null,b===null?Ed=k:b.next=k,k===null&&(Bn=b)):(b=T,(u!==0||(P&3)!==0)&&(Hr=!0)),T=k}zi!==0&&zi!==5||Qe(u),rl!==0&&(rl=0)}function He(u,f){for(var b=u.suspendedLanes,T=u.pingedLanes,k=u.expirationTimes,P=u.pendingLanes&-62914561;0<P;){var H=31-Ys(P),ie=1<<H,Te=k[H];Te===-1?((ie&b)===0||(ie&T)!==0)&&(k[H]=D(ie,f)):Te<=f&&(u.expiredLanes|=ie),P&=~ie}if(f=dn,b=_n,b=A(u,u===f?b:0,u.cancelPendingCommit!==null||u.timeoutHandle!==Xs),T=u.callbackNode,b===0||u===f&&(Hn===2||Hn===9)||u.cancelPendingCommit!==null)return T!==null&&T!==null&&ff(T),u.callbackNode=null,u.callbackPriority=0;if((b&3)===0||I(u,b)){if(f=b&-b,f===u.callbackPriority)return f;switch(T!==null&&ff(T),ee(b)){case 2:case 8:b=Zx;break;case 32:b=_d;break;case 268435456:b=mf;break;default:b=_d}return T=Ye.bind(null,u),b=bd(b,T),u.callbackPriority=f,u.callbackNode=b,f}return T!==null&&T!==null&&ff(T),u.callbackPriority=2,u.callbackNode=null,2}function Ye(u,f){if(zi!==0&&zi!==5)return u.callbackNode=null,u.callbackPriority=0,null;var b=u.callbackNode;if(Ia()&&u.callbackNode!==b)return null;var T=_n;return T=A(u,u===dn?T:0,u.cancelPendingCommit!==null||u.timeoutHandle!==Xs),T===0?null:(aa(u,T,f),He(u,ys()),u.callbackNode!=null&&u.callbackNode===b?Ye.bind(null,u):null)}function xt(u,f){if(Ia())return null;aa(u,f,!0)}function pt(){wm?Sm(function(){(gn&6)!==0?bd(pf,St):Ut()}):bd(pf,St)}function st(){if(rl===0){var u=yo;u===0&&(u=hf,hf<<=1,(hf&261888)===0&&(hf=256)),rl=u}return rl}function rn(u,f){if(tu===null){var b=tu=[];Km=0,yo=st(),$i={status:"pending",value:void 0,then:function(T){b.push(T)}}}return Km++,f.then(re,re),f}function re(){if(--Km===0&&tu!==null){$i!==null&&($i.status="fulfilled");var u=tu;tu=null,yo=0,$i=null;for(var f=0;f<u.length;f++)(0,u[f])()}}function ct(u,f){var b=[],T={status:"pending",value:null,reason:null,then:function(k){b.push(k)}};return u.then(function(){T.status="fulfilled",T.value=f;for(var k=0;k<b.length;k++)(0,b[k])(f)},function(k){for(T.status="rejected",T.reason=k,k=0;k<b.length;k++)(0,b[k])(void 0)}),T}function Xe(){var u=al.current;return u!==null?u:dn.pooledCache}function dt(u,f){f===null?E(al,al.current):E(al,f.pool)}function Ge(){var u=Xe();return u===null?null:{parent:Si?li._currentValue:li._currentValue2,pool:u}}function Le(u,f){if(Ei(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var b=Object.keys(u),T=Object.keys(f);if(b.length!==T.length)return!1;for(T=0;T<b.length;T++){var k=b[T];if(!$_.call(f,k)||!Ei(u[k],f[k]))return!1}return!0}function et(u){return u=u.status,u==="fulfilled"||u==="rejected"}function $t(u,f,b){switch(b=u[b],b===void 0?u.push(f):b!==f&&(f.then(Me,Me),f=b),f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,ls(u),u;default:if(typeof f.status=="string")f.then(Me,Me);else{if(u=dn,u!==null&&100<u.shellSuspendCounter)throw Error(s(482));u=f,u.status="pending",u.then(function(T){if(f.status==="pending"){var k=f;k.status="fulfilled",k.value=T}},function(T){if(f.status==="pending"){var k=f;k.status="rejected",k.reason=T}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,ls(u),u}throw Ps=f,Xi}}function Tn(u){try{var f=u._init;return f(u._payload)}catch(b){throw b!==null&&typeof b=="object"&&typeof b.then=="function"?(Ps=b,Xi):b}}function An(){if(Ps===null)throw Error(s(459));var u=Ps;return Ps=null,u}function ls(u){if(u===Xi||u===qr)throw Error(s(483))}function Hs(u){var f=ec;return ec+=1,ol===null&&(ol=[]),$t(ol,u,f)}function Oo(u,f){f=f.props.ref,u.ref=f!==void 0?f:null}function zo(u,f){throw f.$$typeof===Vl?Error(s(525)):(u=Object.prototype.toString.call(f),Error(s(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u)))}function Cl(u){function f(be,pe){if(u){var Se=be.deletions;Se===null?(be.deletions=[pe],be.flags|=16):Se.push(pe)}}function b(be,pe){if(!u)return null;for(;pe!==null;)f(be,pe),pe=pe.sibling;return null}function T(be){for(var pe=new Map;be!==null;)be.key!==null?pe.set(be.key,be):pe.set(be.index,be),be=be.sibling;return pe}function k(be,pe){return be=mr(be,pe),be.index=0,be.sibling=null,be}function P(be,pe,Se){return be.index=Se,u?(Se=be.alternate,Se!==null?(Se=Se.index,Se<pe?(be.flags|=67108866,pe):Se):(be.flags|=67108866,pe)):(be.flags|=1048576,pe)}function H(be){return u&&be.alternate===null&&(be.flags|=67108866),be}function ie(be,pe,Se,Ze){return pe===null||pe.tag!==6?(pe=dm(Se,be.mode,Ze),pe.return=be,pe):(pe=k(pe,Se),pe.return=be,pe)}function Te(be,pe,Se,Ze){var jt=Se.type;return jt===Gl?tt(be,pe,Se.props.children,Ze,Se.key):pe!==null&&(pe.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===ks&&Tn(jt)===pe.type)?(pe=k(pe,Se.props),Oo(pe,Se),pe.return=be,pe):(pe=ho(Se.type,Se.key,Se.props,null,be.mode,Ze),Oo(pe,Se),pe.return=be,pe)}function Ve(be,pe,Se,Ze){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==Se.containerInfo||pe.stateNode.implementation!==Se.implementation?(pe=fm(Se,be.mode,Ze),pe.return=be,pe):(pe=k(pe,Se.children||[]),pe.return=be,pe)}function tt(be,pe,Se,Ze,jt){return pe===null||pe.tag!==7?(pe=Lr(Se,be.mode,Ze,jt),pe.return=be,pe):(pe=k(pe,Se),pe.return=be,pe)}function We(be,pe,Se){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return pe=dm(""+pe,be.mode,Se),pe.return=be,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case Da:return Se=ho(pe.type,pe.key,pe.props,null,be.mode,Se),Oo(Se,pe),Se.return=be,Se;case Hl:return pe=fm(pe,be.mode,Se),pe.return=be,pe;case ks:return pe=Tn(pe),We(be,pe,Se)}if(tl(pe)||g(pe))return pe=Lr(pe,be.mode,Se,null),pe.return=be,pe;if(typeof pe.then=="function")return We(be,Hs(pe),Se);if(pe.$$typeof===Or)return We(be,V(be,pe),Se);zo(be,pe)}return null}function yt(be,pe,Se,Ze){var jt=pe!==null?pe.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return jt!==null?null:ie(be,pe,""+Se,Ze);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case Da:return Se.key===jt?Te(be,pe,Se,Ze):null;case Hl:return Se.key===jt?Ve(be,pe,Se,Ze):null;case ks:return Se=Tn(Se),yt(be,pe,Se,Ze)}if(tl(Se)||g(Se))return jt!==null?null:tt(be,pe,Se,Ze,null);if(typeof Se.then=="function")return yt(be,pe,Hs(Se),Ze);if(Se.$$typeof===Or)return yt(be,pe,V(be,Se),Ze);zo(be,Se)}return null}function Zt(be,pe,Se,Ze,jt){if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return be=be.get(Se)||null,ie(pe,be,""+Ze,jt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case Da:return be=be.get(Ze.key===null?Se:Ze.key)||null,Te(pe,be,Ze,jt);case Hl:return be=be.get(Ze.key===null?Se:Ze.key)||null,Ve(pe,be,Ze,jt);case ks:return Ze=Tn(Ze),Zt(be,pe,Se,Ze,jt)}if(tl(Ze)||g(Ze))return be=be.get(Se)||null,tt(pe,be,Ze,jt,null);if(typeof Ze.then=="function")return Zt(be,pe,Se,Hs(Ze),jt);if(Ze.$$typeof===Or)return Zt(be,pe,Se,V(pe,Ze),jt);zo(pe,Ze)}return null}function Ni(be,pe,Se,Ze){for(var jt=null,xi=null,Bt=pe,Cn=pe=0,ss=null;Bt!==null&&Cn<Se.length;Cn++){Bt.index>Cn?(ss=Bt,Bt=null):ss=Bt.sibling;var Pn=yt(be,Bt,Se[Cn],Ze);if(Pn===null){Bt===null&&(Bt=ss);break}u&&Bt&&Pn.alternate===null&&f(be,Bt),pe=P(Pn,pe,Cn),xi===null?jt=Pn:xi.sibling=Pn,xi=Pn,Bt=ss}if(Cn===Se.length)return b(be,Bt),bn&&Ie(be,Cn),jt;if(Bt===null){for(;Cn<Se.length;Cn++)Bt=We(be,Se[Cn],Ze),Bt!==null&&(pe=P(Bt,pe,Cn),xi===null?jt=Bt:xi.sibling=Bt,xi=Bt);return bn&&Ie(be,Cn),jt}for(Bt=T(Bt);Cn<Se.length;Cn++)ss=Zt(Bt,be,Cn,Se[Cn],Ze),ss!==null&&(u&&ss.alternate!==null&&Bt.delete(ss.key===null?Cn:ss.key),pe=P(ss,pe,Cn),xi===null?jt=ss:xi.sibling=ss,xi=ss);return u&&Bt.forEach(function(Xr){return f(be,Xr)}),bn&&Ie(be,Cn),jt}function cu(be,pe,Se,Ze){if(Se==null)throw Error(s(151));for(var jt=null,xi=null,Bt=pe,Cn=pe=0,ss=null,Pn=Se.next();Bt!==null&&!Pn.done;Cn++,Pn=Se.next()){Bt.index>Cn?(ss=Bt,Bt=null):ss=Bt.sibling;var Xr=yt(be,Bt,Pn.value,Ze);if(Xr===null){Bt===null&&(Bt=ss);break}u&&Bt&&Xr.alternate===null&&f(be,Bt),pe=P(Xr,pe,Cn),xi===null?jt=Xr:xi.sibling=Xr,xi=Xr,Bt=ss}if(Pn.done)return b(be,Bt),bn&&Ie(be,Cn),jt;if(Bt===null){for(;!Pn.done;Cn++,Pn=Se.next())Pn=We(be,Pn.value,Ze),Pn!==null&&(pe=P(Pn,pe,Cn),xi===null?jt=Pn:xi.sibling=Pn,xi=Pn);return bn&&Ie(be,Cn),jt}for(Bt=T(Bt);!Pn.done;Cn++,Pn=Se.next())Pn=Zt(Bt,be,Cn,Pn.value,Ze),Pn!==null&&(u&&Pn.alternate!==null&&Bt.delete(Pn.key===null?Cn:Pn.key),pe=P(Pn,pe,Cn),xi===null?jt=Pn:xi.sibling=Pn,xi=Pn);return u&&Bt.forEach(function(Y_){return f(be,Y_)}),bn&&Ie(be,Cn),jt}function ml(be,pe,Se,Ze){if(typeof Se=="object"&&Se!==null&&Se.type===Gl&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case Da:e:{for(var jt=Se.key;pe!==null;){if(pe.key===jt){if(jt=Se.type,jt===Gl){if(pe.tag===7){b(be,pe.sibling),Ze=k(pe,Se.props.children),Ze.return=be,be=Ze;break e}}else if(pe.elementType===jt||typeof jt=="object"&&jt!==null&&jt.$$typeof===ks&&Tn(jt)===pe.type){b(be,pe.sibling),Ze=k(pe,Se.props),Oo(Ze,Se),Ze.return=be,be=Ze;break e}b(be,pe);break}else f(be,pe);pe=pe.sibling}Se.type===Gl?(Ze=Lr(Se.props.children,be.mode,Ze,Se.key),Ze.return=be,be=Ze):(Ze=ho(Se.type,Se.key,Se.props,null,be.mode,Ze),Oo(Ze,Se),Ze.return=be,be=Ze)}return H(be);case Hl:e:{for(jt=Se.key;pe!==null;){if(pe.key===jt)if(pe.tag===4&&pe.stateNode.containerInfo===Se.containerInfo&&pe.stateNode.implementation===Se.implementation){b(be,pe.sibling),Ze=k(pe,Se.children||[]),Ze.return=be,be=Ze;break e}else{b(be,pe);break}else f(be,pe);pe=pe.sibling}Ze=fm(Se,be.mode,Ze),Ze.return=be,be=Ze}return H(be);case ks:return Se=Tn(Se),ml(be,pe,Se,Ze)}if(tl(Se))return Ni(be,pe,Se,Ze);if(g(Se)){if(jt=g(Se),typeof jt!="function")throw Error(s(150));return Se=jt.call(Se),cu(be,pe,Se,Ze)}if(typeof Se.then=="function")return ml(be,pe,Hs(Se),Ze);if(Se.$$typeof===Or)return ml(be,pe,V(be,Se),Ze);zo(be,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint"?(Se=""+Se,pe!==null&&pe.tag===6?(b(be,pe.sibling),Ze=k(pe,Se),Ze.return=be,be=Ze):(b(be,pe),Ze=dm(Se,be.mode,Ze),Ze.return=be,be=Ze),H(be)):b(be,pe)}return function(be,pe,Se,Ze){try{ec=0;var jt=ml(be,pe,Se,Ze);return ol=null,jt}catch(Bt){if(Bt===Xi||Bt===qr)throw Bt;var xi=t(29,Bt,null,be.mode);return xi.lanes=Ze,xi.return=be,xi}}}function jo(){for(var u=ja,f=tc=ja=0;f<u;){var b=fs[f];fs[f++]=null;var T=fs[f];fs[f++]=null;var k=fs[f];fs[f++]=null;var P=fs[f];if(fs[f++]=null,T!==null&&k!==null){var H=T.pending;H===null?k.next=k:(k.next=H.next,H.next=k),T.pending=k}P!==0&&lr(b,k,P)}}function to(u,f,b,T){fs[ja++]=u,fs[ja++]=f,fs[ja++]=b,fs[ja++]=T,tc|=T,u.lanes|=T,u=u.alternate,u!==null&&(u.lanes|=T)}function Rl(u,f,b,T){return to(u,f,b,T),ui(u)}function xs(u,f){return to(u,null,null,f),ui(u)}function lr(u,f,b){u.lanes|=b;var T=u.alternate;T!==null&&(T.lanes|=b);for(var k=!1,P=u.return;P!==null;)P.childLanes|=b,T=P.alternate,T!==null&&(T.childLanes|=b),P.tag===22&&(u=P.stateNode,u===null||u._visibility&1||(k=!0)),u=P,P=P.return;return u.tag===3?(P=u.stateNode,k&&f!==null&&(k=31-Ys(b),u=P.hiddenUpdates,T=u[k],T===null?u[k]=[f]:T.push(f),f.lane=b|536870912),P):null}function ui(u){if(50<Dn)throw Dn=0,kd=null,Error(s(185));for(var f=u.return;f!==null;)u=f,f=u.return;return u.tag===3?u.stateNode:null}function Vi(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cr(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function ur(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function dr(u,f,b){var T=u.updateQueue;if(T===null)return null;if(T=T.shared,(gn&2)!==0){var k=T.pending;return k===null?f.next=f:(f.next=k.next,k.next=f),T.pending=f,f=ui(u),lr(u,null,b),f}return to(u,T,f,b),ui(u)}function Fo(u,f,b){if(f=f.updateQueue,f!==null&&(f=f.shared,(b&4194048)!==0)){var T=f.lanes;T&=u.pendingLanes,b|=T,f.lanes=b,L(u,b)}}function kl(u,f){var b=u.updateQueue,T=u.alternate;if(T!==null&&(T=T.updateQueue,b===T)){var k=null,P=null;if(b=b.firstBaseUpdate,b!==null){do{var H={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};P===null?k=P=H:P=P.next=H,b=b.next}while(b!==null);P===null?k=P=f:P=P.next=f}else k=P=f;b={baseState:T.baseState,firstBaseUpdate:k,lastBaseUpdate:P,shared:T.shared,callbacks:T.callbacks},u.updateQueue=b;return}u=b.lastBaseUpdate,u===null?b.firstBaseUpdate=f:u.next=f,b.lastBaseUpdate=f}function sa(){if(_f){var u=$i;if(u!==null)throw u}}function no(u,f,b,T){_f=!1;var k=u.updateQueue;vr=!1;var P=k.firstBaseUpdate,H=k.lastBaseUpdate,ie=k.shared.pending;if(ie!==null){k.shared.pending=null;var Te=ie,Ve=Te.next;Te.next=null,H===null?P=Ve:H.next=Ve,H=Te;var tt=u.alternate;tt!==null&&(tt=tt.updateQueue,ie=tt.lastBaseUpdate,ie!==H&&(ie===null?tt.firstBaseUpdate=Ve:ie.next=Ve,tt.lastBaseUpdate=Te))}if(P!==null){var We=k.baseState;H=0,tt=Ve=Te=null,ie=P;do{var yt=ie.lane&-536870913,Zt=yt!==ie.lane;if(Zt?(_n&yt)===yt:(T&yt)===yt){yt!==0&&yt===yo&&(_f=!0),tt!==null&&(tt=tt.next={lane:0,tag:ie.tag,payload:ie.payload,callback:null,next:null});e:{var Ni=u,cu=ie;yt=f;var ml=b;switch(cu.tag){case 1:if(Ni=cu.payload,typeof Ni=="function"){We=Ni.call(ml,We,yt);break e}We=Ni;break e;case 3:Ni.flags=Ni.flags&-65537|128;case 0:if(Ni=cu.payload,yt=typeof Ni=="function"?Ni.call(ml,We,yt):Ni,yt==null)break e;We=Xh({},We,yt);break e;case 2:vr=!0}}yt=ie.callback,yt!==null&&(u.flags|=64,Zt&&(u.flags|=8192),Zt=k.callbacks,Zt===null?k.callbacks=[yt]:Zt.push(yt))}else Zt={lane:yt,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},tt===null?(Ve=tt=Zt,Te=We):tt=tt.next=Zt,H|=yt;if(ie=ie.next,ie===null){if(ie=k.shared.pending,ie===null)break;Zt=ie,ie=Zt.next,Zt.next=null,k.lastBaseUpdate=Zt,k.shared.pending=null}}while(!0);tt===null&&(Te=We),k.baseState=Te,k.firstBaseUpdate=Ve,k.lastBaseUpdate=tt,P===null&&(k.shared.lanes=0),_o|=H,u.lanes=H,u.memoizedState=We}}function io(u,f){if(typeof u!="function")throw Error(s(191,u));u.call(f)}function so(u,f){var b=u.callbacks;if(b!==null)for(u.callbacks=null,u=0;u<b.length;u++)io(b[u],f)}function Bo(u,f){u=Ba,E(ll,u),E(nc,f),Ba=u|f.baseLanes}function ba(){E(ll,Ba),E(nc,nc.current)}function G(){Ba=ll.current,w(nc),w(ll)}function le(u){var f=u.alternate;E(bi,bi.current&1),E(Ks,u),Zs===null&&(f===null||nc.current!==null||f.memoizedState!==null)&&(Zs=u)}function we(u){E(bi,bi.current),E(Ks,u),Zs===null&&(Zs=u)}function ye(u){u.tag===22?(E(bi,bi.current),E(Ks,u),Zs===null&&(Zs=u)):fe()}function fe(){E(bi,bi.current),E(Ks,Ks.current)}function Ke(u){w(Ks),Zs===u&&(Zs=null),w(bi)}function vt(u){for(var f=u;f!==null;){if(f.tag===13){var b=f.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||il(b)||nf(b)))return f}else if(f.tag===19&&(f.memoizedProps.revealOrder==="forwards"||f.memoizedProps.revealOrder==="backwards"||f.memoizedProps.revealOrder==="unstable_legacy-backwards"||f.memoizedProps.revealOrder==="together")){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function $e(){throw Error(s(321))}function wt(u,f){if(f===null)return!1;for(var b=0;b<f.length&&b<u.length;b++)if(!Ei(u[b],f[b]))return!1;return!0}function Tt(u,f,b,T,k,P){return bo=P,tn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Lt.H=u===null||u.memoizedState===null?pi:Fa,En=!1,P=b(T,k),En=!1,an&&(P=Mt(f,b,T,k)),Pt(u),P}function Pt(u){Lt.H=yr;var f=kt!==null&&kt.next!==null;if(bo=0,Yt=kt=tn=null,un=!1,Wr=0,ca=null,f)throw Error(s(300));u===null||ni||(u=u.dependencies,u!==null&&Rt(u)&&(ni=!0))}function Mt(u,f,b,T){tn=u;var k=0;do{if(an&&(ca=null),Wr=0,an=!1,25<=k)throw Error(s(301));if(k+=1,Yt=kt=null,u.updateQueue!=null){var P=u.updateQueue;P.lastEffect=null,P.events=null,P.stores=null,P.memoCache!=null&&(P.memoCache.index=0)}Lt.H=cl,P=f(b,T)}while(an);return P}function Ft(){var u=Lt.H,f=u.useState()[0];return f=typeof f.then=="function"?Vt(f):f,u=u.useState()[0],(kt!==null?kt.memoizedState:null)!==u&&(tn.flags|=1024),f}function In(){var u=_s!==0;return _s=0,u}function Xn(u,f,b){f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~b}function Gn(u){if(un){for(u=u.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}un=!1}bo=0,Yt=kt=tn=null,an=!1,Wr=_s=0,ca=null}function Kt(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?tn.memoizedState=Yt=u:Yt=Yt.next=u,Yt}function ut(){if(kt===null){var u=tn.alternate;u=u!==null?u.memoizedState:null}else u=kt.next;var f=Yt===null?tn.memoizedState:Yt.next;if(f!==null)Yt=f,kt=u;else{if(u===null)throw tn.alternate===null?Error(s(467)):Error(s(310));kt=u,u={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},Yt===null?tn.memoizedState=Yt=u:Yt=Yt.next=u}return Yt}function Nn(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Vt(u){var f=Wr;return Wr+=1,ca===null&&(ca=[]),u=$t(ca,u,f),f=tn,(Yt===null?f.memoizedState:Yt.next)===null&&(f=f.alternate,Lt.H=f===null||f.memoizedState===null?pi:Fa),u}function Di(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return Vt(u);if(u.$$typeof===Or)return X(u)}throw Error(s(438,String(u)))}function ra(u){var f=null,b=tn.updateQueue;if(b!==null&&(f=b.memoCache),f==null){var T=tn.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(f={data:T.data.map(function(k){return k.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),b===null&&(b=Nn(),tn.updateQueue=b),b.memoCache=f,b=f.data[f.index],b===void 0)for(b=f.data[f.index]=Array(u),T=0;T<u;T++)b[T]=mm;return f.index++,b}function ti(u,f){return typeof f=="function"?f(u):f}function As(u){var f=ut();return Un(f,kt,u)}function Un(u,f,b){var T=u.queue;if(T===null)throw Error(s(311));T.lastRenderedReducer=b;var k=u.baseQueue,P=T.pending;if(P!==null){if(k!==null){var H=k.next;k.next=P.next,P.next=H}f.baseQueue=k=P,T.pending=null}if(P=u.baseState,k===null)u.memoizedState=P;else{f=k.next;var ie=H=null,Te=null,Ve=f,tt=!1;do{var We=Ve.lane&-536870913;if(We!==Ve.lane?(_n&We)===We:(bo&We)===We){var yt=Ve.revertLane;if(yt===0)Te!==null&&(Te=Te.next={lane:0,revertLane:0,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),We===yo&&(tt=!0);else if((bo&yt)===yt){Ve=Ve.next,yt===yo&&(tt=!0);continue}else We={lane:0,revertLane:Ve.revertLane,gesture:null,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},Te===null?(ie=Te=We,H=P):Te=Te.next=We,tn.lanes|=yt,_o|=yt;We=Ve.action,En&&b(P,We),P=Ve.hasEagerState?Ve.eagerState:b(P,We)}else yt={lane:We,revertLane:Ve.revertLane,gesture:Ve.gesture,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},Te===null?(ie=Te=yt,H=P):Te=Te.next=yt,tn.lanes|=We,_o|=We;Ve=Ve.next}while(Ve!==null&&Ve!==f);if(Te===null?H=P:Te.next=ie,!Ei(P,u.memoizedState)&&(ni=!0,tt&&(b=$i,b!==null)))throw b;u.memoizedState=P,u.baseState=H,u.baseQueue=Te,T.lastRenderedState=P}return k===null&&(T.lanes=0),[u.memoizedState,T.dispatch]}function Hi(u){var f=ut(),b=f.queue;if(b===null)throw Error(s(311));b.lastRenderedReducer=u;var T=b.dispatch,k=b.pending,P=f.memoizedState;if(k!==null){b.pending=null;var H=k=k.next;do P=u(P,H.action),H=H.next;while(H!==k);Ei(P,f.memoizedState)||(ni=!0),f.memoizedState=P,f.baseQueue===null&&(f.baseState=P),b.lastRenderedState=P}return[P,T]}function Pi(u,f,b){var T=tn,k=ut(),P=bn;if(P){if(b===void 0)throw Error(s(407));b=b()}else b=f();var H=!Ei((kt||k).memoizedState,b);if(H&&(k.memoizedState=b,ni=!0),k=k.queue,Cc(Il.bind(null,T,k,u),[u]),k.getSnapshot!==f||H||Yt!==null&&Yt.memoizedState.tag&1){if(T.flags|=2048,hr(9,{destroy:void 0},Zi.bind(null,T,k,b,f),null),dn===null)throw Error(s(349));P||(bo&127)!==0||Ki(T,f,b)}return b}function Ki(u,f,b){u.flags|=16384,u={getSnapshot:f,value:b},f=tn.updateQueue,f===null?(f=Nn(),tn.updateQueue=f,f.stores=[u]):(b=f.stores,b===null?f.stores=[u]:b.push(u))}function Zi(u,f,b,T){f.value=b,f.getSnapshot=T,Rr(f)&&P0(u)}function Il(u,f,b){return b(function(){Rr(f)&&P0(u)})}function Rr(u){var f=u.getSnapshot;u=u.value;try{var b=f();return!Ei(u,b)}catch{return!0}}function P0(u){var f=xs(u,2);f!==null&&hi(f,u,2)}function Fp(u){var f=Kt();if(typeof u=="function"){var b=u;if(u=b(),En){Q(!0);try{b()}finally{Q(!1)}}}return f.memoizedState=f.baseState=u,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ti,lastRenderedState:u},f}function $u(u,f,b,T){return u.baseState=b,Un(u,kt,typeof T=="function"?T:ti)}function ro(u,f,b,T,k){if(Nh(u))throw Error(s(485));if(u=f.action,u!==null){var P={payload:k,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){P.listeners.push(H)}};Lt.T!==null?b(!0):P.isTransition=!1,T(P),b=f.pending,b===null?(P.next=f.pending=P,_h(f,P)):(P.next=b.next,f.pending=b.next=P)}}function _h(u,f){var b=f.action,T=f.payload,k=u.state;if(f.isTransition){var P=Lt.T,H={};Lt.T=H;try{var ie=b(k,T),Te=Lt.S;Te!==null&&Te(H,ie),wh(u,f,ie)}catch(Ve){Vo(u,f,Ve)}finally{P!==null&&H.types!==null&&(P.types=H.types),Lt.T=P}}else try{P=b(k,T),wh(u,f,P)}catch(Ve){Vo(u,f,Ve)}}function wh(u,f,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(T){Dl(u,f,T)},function(T){return Vo(u,f,T)}):Dl(u,f,b)}function Dl(u,f,b){f.status="fulfilled",f.value=b,Bp(f),u.state=b,f=u.pending,f!==null&&(b=f.next,b===f?u.pending=null:(b=b.next,f.next=b,_h(u,b)))}function Vo(u,f,b){var T=u.pending;if(u.pending=null,T!==null){T=T.next;do f.status="rejected",f.reason=b,Bp(f),f=f.next;while(f!==T)}u.action=null}function Bp(u){u=u.listeners;for(var f=0;f<u.length;f++)(0,u[f])()}function Sh(u,f){return f}function Vp(u,f){if(bn){var b=dn.formState;if(b!==null){e:{var T=tn;if(bn){if(oi){var k=Nx(oi,Ds);if(k){oi=Cx(k),T=Pm(k);break e}}rt(T)}T=!1}T&&(f=b[0])}}b=Kt(),b.memoizedState=b.baseState=f,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Sh,lastRenderedState:f},b.queue=T,b=F0.bind(null,tn,T),T.dispatch=b,T=Fp(!1);var P=Ah.bind(null,tn,!1,T.queue);return T=Kt(),k={state:f,dispatch:null,action:u,pending:null},T.queue=k,b=ro.bind(null,tn,k,P,b),k.dispatch=b,T.memoizedState=u,[f,b,!1]}function Ac(u){var f=ut();return _a(f,kt,u)}function _a(u,f,b){if(f=Un(u,f,Sh)[0],u=As(ti)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var T=Vt(f)}catch(H){throw H===Xi?qr:H}else T=f;f=ut();var k=f.queue,P=k.dispatch;return b!==f.memoizedState&&(tn.flags|=2048,hr(9,{destroy:void 0},Hp.bind(null,k,b),null)),[T,P,u]}function Hp(u,f){u.action=f}function Nc(u){var f=ut(),b=kt;if(b!==null)return _a(f,b,u);ut(),f=f.memoizedState,b=ut();var T=b.queue.dispatch;return b.memoizedState=u,[f,T,!1]}function hr(u,f,b,T){return u={tag:u,create:b,deps:T,inst:f,next:null},f=tn.updateQueue,f===null&&(f=Nn(),tn.updateQueue=f),b=f.lastEffect,b===null?f.lastEffect=u.next=u:(T=b.next,b.next=u,u.next=T,f.lastEffect=u),u}function Th(){return ut().memoizedState}function Pl(u,f,b,T){var k=Kt();tn.flags|=u,k.memoizedState=hr(1|f,{destroy:void 0},b,T===void 0?null:T)}function Xu(u,f,b,T){var k=ut();T=T===void 0?null:T;var P=k.memoizedState.inst;kt!==null&&T!==null&&wt(T,kt.memoizedState.deps)?k.memoizedState=hr(f,P,b,T):(tn.flags|=u,k.memoizedState=hr(1|f,P,b,T))}function Yu(u,f){Pl(8390656,8,u,f)}function Cc(u,f){Xu(2048,8,u,f)}function U0(u){tn.flags|=4;var f=tn.updateQueue;if(f===null)f=Nn(),tn.updateQueue=f,f.events=[u];else{var b=f.events;b===null?f.events=[u]:b.push(u)}}function Ns(u){var f=ut().memoizedState;return U0({ref:f,nextImpl:u}),function(){if((gn&2)!==0)throw Error(s(440));return f.impl.apply(void 0,arguments)}}function Ho(u,f){return Xu(4,2,u,f)}function Ju(u,f){return Xu(4,4,u,f)}function Rc(u,f){if(typeof f=="function"){u=u();var b=f(u);return function(){typeof b=="function"?b():f(null)}}if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function L0(u,f,b){b=b!=null?b.concat([u]):null,Xu(4,4,Rc.bind(null,f,u),b)}function Ku(){}function Eh(u,f){var b=ut();f=f===void 0?null:f;var T=b.memoizedState;return f!==null&&wt(f,T[1])?T[0]:(b.memoizedState=[u,f],u)}function kc(u,f){var b=ut();f=f===void 0?null:f;var T=b.memoizedState;if(f!==null&&wt(f,T[1]))return T[0];if(T=u(),En){Q(!0);try{u()}finally{Q(!1)}}return b.memoizedState=[T,f],T}function Ic(u,f,b){return b===void 0||(bo&1073741824)!==0&&(_n&261930)===0?u.memoizedState=f:(u.memoizedState=b,u=lo(),tn.lanes|=u,_o|=u,b)}function Gp(u,f,b,T){return Ei(b,f)?b:nc.current!==null?(u=Ic(u,b,T),Ei(u,f)||(ni=!0),u):(bo&42)===0||(bo&1073741824)!==0&&(_n&261930)===0?(ni=!0,u.memoizedState=b):(u=lo(),tn.lanes|=u,_o|=u,f)}function O0(u,f,b,T,k){var P=zr();yn(P!==0&&8>P?P:8);var H=Lt.T,ie={};Lt.T=ie,Ah(u,!1,f,b);try{var Te=k(),Ve=Lt.S;if(Ve!==null&&Ve(ie,Te),Te!==null&&typeof Te=="object"&&typeof Te.then=="function"){var tt=ct(Te,T);Zu(u,f,tt,ri(u))}else Zu(u,f,T,ri(u))}catch(We){Zu(u,f,{then:function(){},status:"rejected",reason:We},ri())}finally{yn(P),H!==null&&ie.types!==null&&(H.types=ie.types),Lt.T=H}}function z0(u){var f=u.memoizedState;if(f!==null)return f;f={memoizedState:Xl,baseState:Xl,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ti,lastRenderedState:Xl},next:null};var b={};return f.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ti,lastRenderedState:b},next:null},u.memoizedState=f,u=u.alternate,u!==null&&(u.memoizedState=f),f}function qp(){return X(Yl)}function Mh(){return ut().memoizedState}function j0(){return ut().memoizedState}function O_(u){for(var f=u.return;f!==null;){switch(f.tag){case 24:case 3:var b=ri();u=ur(b);var T=dr(f,u,b);T!==null&&(hi(T,f,b),Fo(T,f,b)),f={cache:Ee()},u.payload=f;return}f=f.return}}function z_(u,f,b){var T=ri();b={lane:T,revertLane:0,gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Nh(u)?B0(f,b):(b=Rl(u,f,b,T),b!==null&&(hi(b,u,T),V0(b,f,T)))}function F0(u,f,b){var T=ri();Zu(u,f,b,T)}function Zu(u,f,b,T){var k={lane:T,revertLane:0,gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null};if(Nh(u))B0(f,k);else{var P=u.alternate;if(u.lanes===0&&(P===null||P.lanes===0)&&(P=f.lastRenderedReducer,P!==null))try{var H=f.lastRenderedState,ie=P(H,b);if(k.hasEagerState=!0,k.eagerState=ie,Ei(ie,H))return to(u,f,k,0),dn===null&&jo(),!1}catch{}if(b=Rl(u,f,k,T),b!==null)return hi(b,u,T),V0(b,f,T),!0}return!1}function Ah(u,f,b,T){if(T={lane:2,revertLane:st(),gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null},Nh(u)){if(f)throw Error(s(479))}else f=Rl(u,b,T,2),f!==null&&hi(f,u,2)}function Nh(u){var f=u.alternate;return u===tn||f!==null&&f===tn}function B0(u,f){an=un=!0;var b=u.pending;b===null?f.next=f:(f.next=b.next,b.next=f),u.pending=f}function V0(u,f,b){if((b&4194048)!==0){var T=f.lanes;T&=u.pendingLanes,b|=T,f.lanes=b,L(u,b)}}function Wp(u,f,b,T){f=u.memoizedState,b=b(T,f),b=b==null?f:Xh({},f,b),u.memoizedState=b,u.lanes===0&&(u.updateQueue.baseState=b)}function Ch(u,f,b,T,k,P,H){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(T,P,H):f.prototype&&f.prototype.isPureReactComponent?!Le(b,T)||!Le(k,P):!0}function H0(u,f,b,T){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(b,T),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(b,T),f.state!==u&&Md.enqueueReplaceState(f,f.state,null)}function Ul(u,f){var b=f;if("ref"in f){b={};for(var T in f)T!=="ref"&&(b[T]=f[T])}if(u=u.defaultProps){b===f&&(b=Xh({},b));for(var k in u)b[k]===void 0&&(b[k]=u[k])}return b}function Rh(u,f){try{var b=u.onUncaughtError;b(f.value,{componentStack:f.stack})}catch(T){setTimeout(function(){throw T})}}function $p(u,f,b){try{var T=u.onCaughtError;T(b.value,{componentStack:b.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(k){setTimeout(function(){throw k})}}function Xp(u,f,b){return b=ur(b),b.tag=3,b.payload={element:null},b.callback=function(){Rh(u,f)},b}function G0(u){return u=ur(u),u.tag=3,u}function q0(u,f,b,T){var k=b.type.getDerivedStateFromError;if(typeof k=="function"){var P=T.value;u.payload=function(){return k(P)},u.callback=function(){$p(f,b,T)}}var H=b.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(u.callback=function(){$p(f,b,T),typeof k!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var ie=T.stack;this.componentDidCatch(T.value,{componentStack:ie!==null?ie:""})})}function j_(u,f,b,T,k){if(b.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(f=b.alternate,f!==null&&ot(f,b,k,!0),b=Ks.current,b!==null){switch(b.tag){case 31:case 13:return Zs===null?Hc():b.alternate===null&&gi===0&&(gi=3),b.flags&=-257,b.flags|=65536,b.lanes=k,T===za?b.flags|=16384:(f=b.updateQueue,f===null?b.updateQueue=new Set([T]):f.add(T),Wc(u,T,k)),!1;case 22:return b.flags|=65536,T===za?b.flags|=16384:(f=b.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([T])},b.updateQueue=f):(b=f.retryQueue,b===null?f.retryQueue=new Set([T]):b.add(T)),Wc(u,T,k)),!1}throw Error(s(435,b.tag))}return Wc(u,T,k),Hc(),!1}if(bn)return f=Ks.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=k,T!==vf&&(u=Error(s(422),{cause:T}),qe(Re(u,b)))):(T!==vf&&(f=Error(s(423),{cause:T}),qe(Re(f,b))),u=u.current.alternate,u.flags|=65536,k&=-k,u.lanes|=k,T=Re(T,b),k=Xp(u.stateNode,T,k),kl(u,k),gi!==4&&(gi=2)),!1;var P=Error(s(520),{cause:T});if(P=Re(P,b),Nd===null?Nd=[P]:Nd.push(P),gi!==4&&(gi=2),f===null)return!0;T=Re(T,b),b=f;do{switch(b.tag){case 3:return b.flags|=65536,u=k&-k,b.lanes|=u,u=Xp(b.stateNode,T,u),kl(b,u),!1;case 1:if(f=b.type,P=b.stateNode,(b.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(wo===null||!wo.has(P))))return b.flags|=65536,k&=-k,b.lanes|=k,k=G0(k),q0(k,u,b,T),kl(b,k),!1}b=b.return}while(b!==null);return!1}function cs(u,f,b,T){f.child=u===null?Zm(f,null,b,T):hs(f,u.child,b,T)}function W0(u,f,b,T,k){b=b.render;var P=f.ref;if("ref"in T){var H={};for(var ie in T)ie!=="ref"&&(H[ie]=T[ie])}else H=T;return Je(f),T=Tt(u,f,b,H,P,k),ie=In(),u!==null&&!ni?(Xn(u,f,k),wa(u,f,k)):(bn&&ie&&de(f),f.flags|=1,cs(u,f,T,k),f.child)}function $0(u,f,b,T,k){if(u===null){var P=b.type;return typeof P=="function"&&!Fl(P)&&P.defaultProps===void 0&&b.compare===null?(f.tag=15,f.type=P,X0(u,f,P,T,k)):(u=ho(b.type,null,T,f,f.mode,k),u.ref=f.ref,u.return=f,f.child=u)}if(P=u.child,!ed(u,k)){var H=P.memoizedProps;if(b=b.compare,b=b!==null?b:Le,b(H,T)&&u.ref===f.ref)return wa(u,f,k)}return f.flags|=1,u=mr(P,T),u.ref=f.ref,u.return=f,f.child=u}function X0(u,f,b,T,k){if(u!==null){var P=u.memoizedProps;if(Le(P,T)&&u.ref===f.ref)if(ni=!1,f.pendingProps=T=P,ed(u,k))(u.flags&131072)!==0&&(ni=!0);else return f.lanes=u.lanes,wa(u,f,k)}return Ih(u,f,b,T,k)}function Y0(u,f,b,T){var k=T.children,P=u!==null?u.memoizedState:null;if(u===null&&f.stateNode===null&&(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),T.mode==="hidden"){if((f.flags&128)!==0){if(P=P!==null?P.baseLanes|b:b,u!==null){for(T=f.child=u.child,k=0;T!==null;)k=k|T.lanes|T.childLanes,T=T.sibling;T=k&~P}else T=0,f.child=null;return Dc(u,f,P,b,T)}if((b&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},u!==null&&dt(f,P!==null?P.cachePool:null),P!==null?Bo(f,P):ba(),ye(f);else return T=f.lanes=536870912,Dc(u,f,P!==null?P.baseLanes|b:b,b,T)}else P!==null?(dt(f,P.cachePool),Bo(f,P),fe(),f.memoizedState=null):(u!==null&&dt(f,null),ba(),fe());return cs(u,f,k,b),f.child}function Ll(u,f){return u!==null&&u.tag===22||f.stateNode!==null||(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.sibling}function Dc(u,f,b,T,k){var P=Xe();return P=P===null?null:{parent:Si?li._currentValue:li._currentValue2,pool:P},f.memoizedState={baseLanes:b,cachePool:P},u!==null&&dt(f,null),ba(),ye(f),u!==null&&ot(u,f,T,!0),f.childLanes=k,null}function kh(u,f){return f=Go({mode:f.mode,children:f.children},u.mode),f.ref=u.ref,u.child=f,f.return=u,f}function Yp(u,f,b){return hs(f,u.child,null,b),u=kh(f,f.pendingProps),u.flags|=2,Ke(f),f.memoizedState=null,u}function J0(u,f,b){var T=f.pendingProps,k=(f.flags&128)!==0;if(f.flags&=-129,u===null){if(bn){if(T.mode==="hidden")return u=kh(f,T),f.lanes=536870912,Ll(null,u);if(we(f),(u=oi)?(u=Lm(u,Ds),u!==null&&(f.memoizedState={dehydrated:u,treeContext:Br!==null?{id:us,overflow:oa}:null,retryLane:536870912,hydrationErrors:null},b=hm(u),b.return=f,f.child=b,Wi=f,oi=null)):u=null,u===null)throw rt(f);return f.lanes=536870912,null}return kh(f,T)}var P=u.memoizedState;if(P!==null){var H=P.dehydrated;if(we(f),k)if(f.flags&256)f.flags&=-257,f=Yp(u,f,b);else if(f.memoizedState!==null)f.child=u.child,f.flags|=128,f=null;else throw Error(s(558));else if(ni||ot(u,f,b,!1),k=(b&u.childLanes)!==0,ni||k){if(T=dn,T!==null&&(H=B(T,b),H!==0&&H!==P.retryLane))throw P.retryLane=H,xs(u,H),hi(T,u,H),Us;Hc(),f=Yp(u,f,b)}else u=P.treeContext,ai&&(oi=Dx(H),Wi=f,bn=!0,Oa=null,Ds=!1,u!==null&&Fe(f,u)),f=kh(f,T),f.flags|=4096;return f}return u=mr(u.child,{mode:T.mode,children:T.children}),u.ref=f.ref,f.child=u,u.return=f,u}function Qu(u,f){var b=f.ref;if(b===null)u!==null&&u.ref!==null&&(f.flags|=4194816);else{if(typeof b!="function"&&typeof b!="object")throw Error(s(284));(u===null||u.ref!==b)&&(f.flags|=4194816)}}function Ih(u,f,b,T,k){return Je(f),b=Tt(u,f,b,T,void 0,k),T=In(),u!==null&&!ni?(Xn(u,f,k),wa(u,f,k)):(bn&&T&&de(f),f.flags|=1,cs(u,f,b,k),f.child)}function Jp(u,f,b,T,k,P){return Je(f),f.updateQueue=null,b=Mt(f,T,b,k),Pt(u),T=In(),u!==null&&!ni?(Xn(u,f,P),wa(u,f,P)):(bn&&T&&de(f),f.flags|=1,cs(u,f,b,P),f.child)}function Ol(u,f,b,T,k){if(Je(f),f.stateNode===null){var P=Pa,H=b.contextType;typeof H=="object"&&H!==null&&(P=X(H)),P=new b(T,P),f.memoizedState=P.state!==null&&P.state!==void 0?P.state:null,P.updater=Md,f.stateNode=P,P._reactInternals=f,P=f.stateNode,P.props=T,P.state=f.memoizedState,P.refs={},Vi(f),H=b.contextType,P.context=typeof H=="object"&&H!==null?X(H):Pa,P.state=f.memoizedState,H=b.getDerivedStateFromProps,typeof H=="function"&&(Wp(f,b,H,T),P.state=f.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof P.getSnapshotBeforeUpdate=="function"||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(H=P.state,typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount(),H!==P.state&&Md.enqueueReplaceState(P,P.state,null),no(f,T,P,k),sa(),P.state=f.memoizedState),typeof P.componentDidMount=="function"&&(f.flags|=4194308),T=!0}else if(u===null){P=f.stateNode;var ie=f.memoizedProps,Te=Ul(b,ie);P.props=Te;var Ve=P.context,tt=b.contextType;H=Pa,typeof tt=="object"&&tt!==null&&(H=X(tt));var We=b.getDerivedStateFromProps;tt=typeof We=="function"||typeof P.getSnapshotBeforeUpdate=="function",ie=f.pendingProps!==ie,tt||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(ie||Ve!==H)&&H0(f,P,T,H),vr=!1;var yt=f.memoizedState;P.state=yt,no(f,T,P,k),sa(),Ve=f.memoizedState,ie||yt!==Ve||vr?(typeof We=="function"&&(Wp(f,b,We,T),Ve=f.memoizedState),(Te=vr||Ch(f,b,Te,T,yt,Ve,H))?(tt||typeof P.UNSAFE_componentWillMount!="function"&&typeof P.componentWillMount!="function"||(typeof P.componentWillMount=="function"&&P.componentWillMount(),typeof P.UNSAFE_componentWillMount=="function"&&P.UNSAFE_componentWillMount()),typeof P.componentDidMount=="function"&&(f.flags|=4194308)):(typeof P.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=T,f.memoizedState=Ve),P.props=T,P.state=Ve,P.context=H,T=Te):(typeof P.componentDidMount=="function"&&(f.flags|=4194308),T=!1)}else{P=f.stateNode,cr(u,f),H=f.memoizedProps,tt=Ul(b,H),P.props=tt,We=f.pendingProps,yt=P.context,Ve=b.contextType,Te=Pa,typeof Ve=="object"&&Ve!==null&&(Te=X(Ve)),ie=b.getDerivedStateFromProps,(Ve=typeof ie=="function"||typeof P.getSnapshotBeforeUpdate=="function")||typeof P.UNSAFE_componentWillReceiveProps!="function"&&typeof P.componentWillReceiveProps!="function"||(H!==We||yt!==Te)&&H0(f,P,T,Te),vr=!1,yt=f.memoizedState,P.state=yt,no(f,T,P,k),sa();var Zt=f.memoizedState;H!==We||yt!==Zt||vr||u!==null&&u.dependencies!==null&&Rt(u.dependencies)?(typeof ie=="function"&&(Wp(f,b,ie,T),Zt=f.memoizedState),(tt=vr||Ch(f,b,tt,T,yt,Zt,Te)||u!==null&&u.dependencies!==null&&Rt(u.dependencies))?(Ve||typeof P.UNSAFE_componentWillUpdate!="function"&&typeof P.componentWillUpdate!="function"||(typeof P.componentWillUpdate=="function"&&P.componentWillUpdate(T,Zt,Te),typeof P.UNSAFE_componentWillUpdate=="function"&&P.UNSAFE_componentWillUpdate(T,Zt,Te)),typeof P.componentDidUpdate=="function"&&(f.flags|=4),typeof P.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof P.componentDidUpdate!="function"||H===u.memoizedProps&&yt===u.memoizedState||(f.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||H===u.memoizedProps&&yt===u.memoizedState||(f.flags|=1024),f.memoizedProps=T,f.memoizedState=Zt),P.props=T,P.state=Zt,P.context=Te,T=tt):(typeof P.componentDidUpdate!="function"||H===u.memoizedProps&&yt===u.memoizedState||(f.flags|=4),typeof P.getSnapshotBeforeUpdate!="function"||H===u.memoizedProps&&yt===u.memoizedState||(f.flags|=1024),T=!1)}return P=T,Qu(u,f),T=(f.flags&128)!==0,P||T?(P=f.stateNode,b=T&&typeof b.getDerivedStateFromError!="function"?null:P.render(),f.flags|=1,u!==null&&T?(f.child=hs(f,u.child,null,k),f.child=hs(f,null,b,k)):cs(u,f,b,k),f.memoizedState=P.state,u=f.child):u=wa(u,f,k),u}function K0(u,f,b,T){return zt(),f.flags|=256,cs(u,f,b,T),f.child}function Kp(u){return{baseLanes:u,cachePool:Ge()}}function Zp(u,f,b){return u=u!==null?u.childLanes&~b:0,f&&(u|=Ls),u}function Qp(u,f,b){var T=f.pendingProps,k=!1,P=(f.flags&128)!==0,H;if((H=P)||(H=u!==null&&u.memoizedState===null?!1:(bi.current&2)!==0),H&&(k=!0,f.flags&=-129),H=(f.flags&32)!==0,f.flags&=-33,u===null){if(bn){if(k?le(f):fe(),(u=oi)?(u=Ox(u,Ds),u!==null&&(f.memoizedState={dehydrated:u,treeContext:Br!==null?{id:us,overflow:oa}:null,retryLane:536870912,hydrationErrors:null},b=hm(u),b.return=f,f.child=b,Wi=f,oi=null)):u=null,u===null)throw rt(f);return nf(u)?f.lanes=32:f.lanes=536870912,null}var ie=T.children;return T=T.fallback,k?(fe(),k=f.mode,ie=Go({mode:"hidden",children:ie},k),T=Lr(T,k,b,null),ie.return=f,T.return=f,ie.sibling=T,f.child=ie,T=f.child,T.memoizedState=Kp(b),T.childLanes=Zp(u,H,b),f.memoizedState=ic,Ll(null,T)):(le(f),Dh(f,ie))}var Te=u.memoizedState;if(Te!==null&&(ie=Te.dehydrated,ie!==null)){if(P)f.flags&256?(le(f),f.flags&=-257,f=zl(u,f,b)):f.memoizedState!==null?(fe(),f.child=u.child,f.flags|=128,f=null):(fe(),ie=T.fallback,k=f.mode,T=Go({mode:"visible",children:T.children},k),ie=Lr(ie,k,b,null),ie.flags|=2,T.return=f,ie.return=f,T.sibling=ie,f.child=T,hs(f,u.child,null,b),T=f.child,T.memoizedState=Kp(b),T.childLanes=Zp(u,H,b),f.memoizedState=ic,f=Ll(null,T));else if(le(f),nf(ie))H=sf(ie).digest,T=Error(s(419)),T.stack="",T.digest=H,qe({value:T,source:null,stack:null}),f=zl(u,f,b);else if(ni||ot(u,f,b,!1),H=(b&u.childLanes)!==0,ni||H){if(H=dn,H!==null&&(T=B(H,b),T!==0&&T!==Te.retryLane))throw Te.retryLane=T,xs(u,T),hi(H,u,T),Us;il(ie)||Hc(),f=zl(u,f,b)}else il(ie)?(f.flags|=192,f.child=u.child,f=null):(u=Te.treeContext,ai&&(oi=Px(ie),Wi=f,bn=!0,Oa=null,Ds=!1,u!==null&&Fe(f,u)),f=Dh(f,T.children),f.flags|=4096);return f}return k?(fe(),ie=T.fallback,k=f.mode,Te=u.child,P=Te.sibling,T=mr(Te,{mode:"hidden",children:T.children}),T.subtreeFlags=Te.subtreeFlags&65011712,P!==null?ie=mr(P,ie):(ie=Lr(ie,k,b,null),ie.flags|=2),ie.return=f,T.return=f,T.sibling=ie,f.child=T,Ll(null,T),T=f.child,ie=u.child.memoizedState,ie===null?ie=Kp(b):(k=ie.cachePool,k!==null?(Te=Si?li._currentValue:li._currentValue2,k=k.parent!==Te?{parent:Te,pool:Te}:k):k=Ge(),ie={baseLanes:ie.baseLanes|b,cachePool:k}),T.memoizedState=ie,T.childLanes=Zp(u,H,b),f.memoizedState=ic,Ll(u.child,T)):(le(f),b=u.child,u=b.sibling,b=mr(b,{mode:"visible",children:T.children}),b.return=f,b.sibling=null,u!==null&&(H=f.deletions,H===null?(f.deletions=[u],f.flags|=16):H.push(u)),f.child=b,f.memoizedState=null,b)}function Dh(u,f){return f=Go({mode:"visible",children:f},u.mode),f.return=u,u.child=f}function Go(u,f){return u=t(22,u,null,f),u.lanes=0,u}function zl(u,f,b){return hs(f,u.child,null,b),u=Dh(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function Z0(u,f,b){u.lanes|=f;var T=u.alternate;T!==null&&(T.lanes|=f),Z(u.return,f,b)}function Pc(u,f,b,T,k,P){var H=u.memoizedState;H===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:T,tail:b,tailMode:k,treeForkCount:P}:(H.isBackwards=f,H.rendering=null,H.renderingStartTime=0,H.last=T,H.tail=b,H.tailMode=k,H.treeForkCount=P)}function em(u,f,b){var T=f.pendingProps,k=T.revealOrder,P=T.tail;T=T.children;var H=bi.current,ie=(H&2)!==0;if(ie?(H=H&1|2,f.flags|=128):H&=1,E(bi,H),cs(u,f,T,b),T=bn?Sd:0,!ie&&u!==null&&(u.flags&128)!==0)e:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Z0(u,b,f);else if(u.tag===19)Z0(u,b,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break e;for(;u.sibling===null;){if(u.return===null||u.return===f)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}switch(k){case"forwards":for(b=f.child,k=null;b!==null;)u=b.alternate,u!==null&&vt(u)===null&&(k=b),b=b.sibling;b=k,b===null?(k=f.child,f.child=null):(k=b.sibling,b.sibling=null),Pc(f,!1,k,b,P,T);break;case"backwards":case"unstable_legacy-backwards":for(b=null,k=f.child,f.child=null;k!==null;){if(u=k.alternate,u!==null&&vt(u)===null){f.child=k;break}u=k.sibling,k.sibling=b,b=k,k=u}Pc(f,!0,b,null,P,T);break;case"together":Pc(f,!1,null,null,void 0,T);break;default:f.memoizedState=null}return f.child}function wa(u,f,b){if(u!==null&&(f.dependencies=u.dependencies),_o|=f.lanes,(b&f.childLanes)===0)if(u!==null){if(ot(u,f,b,!1),(b&f.childLanes)===0)return null}else return null;if(u!==null&&f.child!==u.child)throw Error(s(153));if(f.child!==null){for(u=f.child,b=mr(u,u.pendingProps),f.child=b,b.return=f;u.sibling!==null;)u=u.sibling,b=b.sibling=mr(u,u.pendingProps),b.return=f;b.sibling=null}return f.child}function ed(u,f){return(u.lanes&f)!==0?!0:(u=u.dependencies,!!(u!==null&&Rt(u)))}function tm(u,f,b){switch(f.tag){case 3:lt(f,f.stateNode.containerInfo),Oe(f,li,u.memoizedState.cache),zt();break;case 27:case 5:Ce(f);break;case 4:lt(f,f.stateNode.containerInfo);break;case 10:Oe(f,f.type,f.memoizedProps.value);break;case 31:if(f.memoizedState!==null)return f.flags|=128,we(f),null;break;case 13:var T=f.memoizedState;if(T!==null)return T.dehydrated!==null?(le(f),f.flags|=128,null):(b&f.child.childLanes)!==0?Qp(u,f,b):(le(f),u=wa(u,f,b),u!==null?u.sibling:null);le(f);break;case 19:var k=(u.flags&128)!==0;if(T=(b&f.childLanes)!==0,T||(ot(u,f,b,!1),T=(b&f.childLanes)!==0),k){if(T)return em(u,f,b);f.flags|=128}if(k=f.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),E(bi,bi.current),T)break;return null;case 22:return f.lanes=0,Y0(u,f,b,f.pendingProps);case 24:Oe(f,li,u.memoizedState.cache)}return wa(u,f,b)}function nm(u,f,b){if(u!==null)if(u.memoizedProps!==f.pendingProps)ni=!0;else{if(!ed(u,b)&&(f.flags&128)===0)return ni=!1,tm(u,f,b);ni=(u.flags&131072)!==0}else ni=!1,bn&&(f.flags&1048576)!==0&&$(f,Sd,f.index);switch(f.lanes=0,f.tag){case 16:e:{var T=f.pendingProps;if(u=Tn(f.elementType),f.type=u,typeof u=="function")Fl(u)?(T=Ul(u,T),f.tag=1,f=Ol(null,f,u,T,b)):(f.tag=0,f=Ih(null,f,u,T,b));else{if(u!=null){var k=u.$$typeof;if(k===$c){f.tag=11,f=W0(null,f,u,T,b);break e}else if(k===Jh){f.tag=14,f=$0(null,f,u,T,b);break e}}throw f=v(u)||u,Error(s(306,f,""))}}return f;case 0:return Ih(u,f,f.type,f.pendingProps,b);case 1:return T=f.type,k=Ul(T,f.pendingProps),Ol(u,f,T,k,b);case 3:e:{if(lt(f,f.stateNode.containerInfo),u===null)throw Error(s(387));var P=f.pendingProps;k=f.memoizedState,T=k.element,cr(u,f),no(f,P,null,b);var H=f.memoizedState;if(P=H.cache,Oe(f,li,P),P!==k.cache&&Nt(f,[li],b,!0),sa(),P=H.element,ai&&k.isDehydrated)if(k={element:P,isDehydrated:!1,cache:H.cache},f.updateQueue.baseState=k,f.memoizedState=k,f.flags&256){f=K0(u,f,P,b);break e}else if(P!==T){T=Re(Error(s(424)),f),qe(T),f=K0(u,f,P,b);break e}else for(ai&&(oi=Ix(f.stateNode.containerInfo),Wi=f,bn=!0,Oa=null,Ds=!0),b=Zm(f,null,P,b),f.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(zt(),P===T){f=wa(u,f,b);break e}cs(u,f,P,b)}f=f.child}return f;case 26:if(jr)return Qu(u,f),u===null?(b=Bm(f.type,null,f.pendingProps,null))?f.memoizedState=b:bn||(f.stateNode=lf(f.type,f.pendingProps,ds.current,f)):f.memoizedState=Bm(f.type,u.memoizedProps,f.pendingProps,u.memoizedState),null;case 27:if(qi)return Ce(f),u===null&&qi&&bn&&(T=f.stateNode=cf(f.type,f.pendingProps,ds.current,ns.current,!1),Wi=f,Ds=!0,oi=Um(f.type,T,oi)),cs(u,f,f.pendingProps.children,b),Qu(u,f),u===null&&(f.flags|=4194304),f.child;case 5:return u===null&&bn&&(Wx(f.type,f.pendingProps,ns.current),(k=T=oi)&&(T=Ux(T,f.type,f.pendingProps,Ds),T!==null?(f.stateNode=T,Wi=f,oi=kx(T),Ds=!1,k=!0):k=!1),k||rt(f)),Ce(f),k=f.type,P=f.pendingProps,H=u!==null?u.memoizedProps:null,T=P.children,Is(k,P)?T=null:H!==null&&Is(k,H)&&(f.flags|=32),f.memoizedState!==null&&(k=Tt(u,f,Ft,null,null,b),Si?Yl._currentValue=k:Yl._currentValue2=k),Qu(u,f),cs(u,f,T,b),f.child;case 6:return u===null&&bn&&(Fm(f.pendingProps,ns.current),(u=b=oi)&&(b=Lx(b,f.pendingProps,Ds),b!==null?(f.stateNode=b,Wi=f,oi=null,u=!0):u=!1),u||rt(f)),null;case 13:return Qp(u,f,b);case 4:return lt(f,f.stateNode.containerInfo),T=f.pendingProps,u===null?f.child=hs(f,null,T,b):cs(u,f,T,b),f.child;case 11:return W0(u,f,f.type,f.pendingProps,b);case 7:return cs(u,f,f.pendingProps,b),f.child;case 8:return cs(u,f,f.pendingProps.children,b),f.child;case 12:return cs(u,f,f.pendingProps.children,b),f.child;case 10:return T=f.pendingProps,Oe(f,f.type,T.value),cs(u,f,T.children,b),f.child;case 9:return k=f.type._context,T=f.pendingProps.children,Je(f),k=X(k),T=T(k),f.flags|=1,cs(u,f,T,b),f.child;case 14:return $0(u,f,f.type,f.pendingProps,b);case 15:return X0(u,f,f.type,f.pendingProps,b);case 19:return em(u,f,b);case 31:return J0(u,f,b);case 22:return Y0(u,f,b,f.pendingProps);case 24:return Je(f),T=X(li),u===null?(k=Xe(),k===null&&(k=dn,P=Ee(),k.pooledCache=P,P.refCount++,P!==null&&(k.pooledCacheLanes|=b),k=P),f.memoizedState={parent:T,cache:k},Vi(f),Oe(f,li,k)):((u.lanes&b)!==0&&(cr(u,f),no(f,null,null,b),sa()),k=u.memoizedState,P=f.memoizedState,k.parent!==T?(k={parent:T,cache:T},f.memoizedState=k,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=k),Oe(f,li,T)):(T=P.cache,Oe(f,li,T),T!==k.cache&&Nt(f,[li],b,!0))),cs(u,f,f.pendingProps.children,b),f.child;case 29:throw f.pendingProps}throw Error(s(156,f.tag))}function kr(u){u.flags|=4}function td(u){gr&&(u.flags|=8)}function Q0(u,f){if(u!==null&&u.child===f.child)return!1;if((f.flags&16)!==0)return!0;for(u=f.child;u!==null;){if((u.flags&8218)!==0||(u.subtreeFlags&8218)!==0)return!0;u=u.sibling}return!1}function im(u,f,b,T){if(Sn)for(b=f.child;b!==null;){if(b.tag===5||b.tag===6)md(u,b.stateNode);else if(!(b.tag===4||qi&&b.tag===27)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===f)break;for(;b.sibling===null;){if(b.return===null||b.return===f)return;b=b.return}b.sibling.return=b.return,b=b.sibling}else if(gr)for(var k=f.child;k!==null;){if(k.tag===5){var P=k.stateNode;b&&T&&(P=Ax(P,k.type,k.memoizedProps)),md(u,P)}else if(k.tag===6)P=k.stateNode,b&&T&&(P=Dm(P,k.memoizedProps)),md(u,P);else if(k.tag!==4){if(k.tag===22&&k.memoizedState!==null)P=k.child,P!==null&&(P.return=k),im(u,k,!0,!0);else if(k.child!==null){k.child.return=k,k=k.child;continue}}if(k===f)break;for(;k.sibling===null;){if(k.return===null||k.return===f)return;k=k.return}k.sibling.return=k.return,k=k.sibling}}function ex(u,f,b,T){var k=!1;if(gr)for(var P=f.child;P!==null;){if(P.tag===5){var H=P.stateNode;b&&T&&(H=Ax(H,P.type,P.memoizedProps)),km(u,H)}else if(P.tag===6)H=P.stateNode,b&&T&&(H=Dm(H,P.memoizedProps)),km(u,H);else if(P.tag!==4){if(P.tag===22&&P.memoizedState!==null)k=P.child,k!==null&&(k.return=P),ex(u,P,!0,!0),k=!0;else if(P.child!==null){P.child.return=P,P=P.child;continue}}if(P===f)break;for(;P.sibling===null;){if(P.return===null||P.return===f)return k;P=P.return}P.sibling.return=P.return,P=P.sibling}return k}function tx(u,f){if(gr&&Q0(u,f)){u=f.stateNode;var b=u.containerInfo,T=Rm();ex(T,f,!1,!1),u.pendingChildren=T,kr(f),Mx(b,T)}}function sm(u,f,b,T){if(Sn)u.memoizedProps!==T&&kr(f);else if(gr){var k=u.stateNode,P=u.memoizedProps;if((u=Q0(u,f))||P!==T){var H=ns.current;P=Ex(k,b,P,T,!u,null),P===k?f.stateNode=k:(td(f),$s(P,b,T,H)&&kr(f),f.stateNode=P,u&&im(P,f,!1,!1))}else f.stateNode=k}}function Cs(u,f,b,T,k){if((u.mode&32)!==0&&(b===null?gd(f,T):Zc(f,b,T))){if(u.flags|=16777216,(k&335544128)===k||ym(f,T))if(fi(u.stateNode,f,T))u.flags|=8192;else if(wn())u.flags|=8192;else throw Ps=za,bf}else u.flags&=-16777217}function Uc(u,f){if(qm(f)){if(u.flags|=16777216,!Wm(f))if(wn())u.flags|=8192;else throw Ps=za,bf}else u.flags&=-16777217}function nd(u,f){f!==null&&(u.flags|=4),u.flags&16384&&(f=u.tag!==22?U():536870912,u.lanes|=f,ou|=f)}function Lc(u,f){if(!bn)switch(u.tailMode){case"hidden":f=u.tail;for(var b=null;f!==null;)f.alternate!==null&&(b=f),f=f.sibling;b===null?u.tail=null:b.sibling=null;break;case"collapsed":b=u.tail;for(var T=null;b!==null;)b.alternate!==null&&(T=b),b=b.sibling;T===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:T.sibling=null}}function Yn(u){var f=u.alternate!==null&&u.alternate.child===u.child,b=0,T=0;if(f)for(var k=u.child;k!==null;)b|=k.lanes|k.childLanes,T|=k.subtreeFlags&65011712,T|=k.flags&65011712,k.return=u,k=k.sibling;else for(k=u.child;k!==null;)b|=k.lanes|k.childLanes,T|=k.subtreeFlags,T|=k.flags,k.return=u,k=k.sibling;return u.subtreeFlags|=T,u.childLanes=b,f}function nx(u,f,b){var T=f.pendingProps;switch(Ne(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(f),null;case 1:return Yn(f),null;case 3:return b=f.stateNode,T=null,u!==null&&(T=u.memoizedState.cache),f.memoizedState.cache!==T&&(f.flags|=2048),it(li),ge(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(u===null||u.child===null)&&(vn(f)?kr(f):u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Pe())),tx(u,f),Yn(f),null;case 26:if(jr){var k=f.type,P=f.memoizedState;return u===null?(kr(f),P!==null?(Yn(f),Uc(f,P)):(Yn(f),Cs(f,k,null,T,b))):P?P!==u.memoizedState?(kr(f),Yn(f),Uc(f,P)):(Yn(f),f.flags&=-16777217):(P=u.memoizedProps,Sn?P!==T&&kr(f):sm(u,f,k,T),Yn(f),Cs(f,k,P,T,b)),null}case 27:if(qi){if(nt(f),b=ds.current,k=f.type,u!==null&&f.stateNode!=null)Sn?u.memoizedProps!==T&&kr(f):sm(u,f,k,T);else{if(!T){if(f.stateNode===null)throw Error(s(166));return Yn(f),null}u=ns.current,vn(f)?mt(f,u):(u=cf(k,T,b,u,!0),f.stateNode=u,kr(f))}return Yn(f),null}case 5:if(nt(f),k=f.type,u!==null&&f.stateNode!=null)sm(u,f,k,T);else{if(!T){if(f.stateNode===null)throw Error(s(166));return Yn(f),null}if(P=ns.current,vn(f))mt(f,P),Hx(f.stateNode,k,T,P)&&(f.flags|=64);else{var H=xm(k,T,ds.current,P,f);td(f),im(H,f,!1,!1),f.stateNode=H,$s(H,k,T,P)&&kr(f)}}return Yn(f),Cs(f,f.type,u===null?null:u.memoizedProps,f.pendingProps,b),null;case 6:if(u&&f.stateNode!=null)b=u.memoizedProps,Sn?b!==T&&kr(f):gr&&(b!==T?(u=ds.current,b=ns.current,td(f),f.stateNode=mo(T,u,b,f)):f.stateNode=u.stateNode);else{if(typeof T!="string"&&f.stateNode===null)throw Error(s(166));if(u=ds.current,b=ns.current,vn(f)){if(!ai)throw Error(s(176));if(u=f.stateNode,b=f.memoizedProps,T=null,k=Wi,k!==null)switch(k.tag){case 27:case 5:T=k.memoizedProps}G_(u,b,f,T)||rt(f,!0)}else td(f),f.stateNode=mo(T,u,b,f)}return Yn(f),null;case 31:if(b=f.memoizedState,u===null||u.memoizedState!==null){if(T=vn(f),b!==null){if(u===null){if(!T)throw Error(s(318));if(!ai)throw Error(s(556));if(u=f.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(s(557));Om(u,f)}else zt(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Yn(f),u=!1}else b=Pe(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=b),u=!0;if(!u)return f.flags&256?(Ke(f),f):(Ke(f),null);if((f.flags&128)!==0)throw Error(s(558))}return Yn(f),null;case 13:if(T=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(k=vn(f),T!==null&&T.dehydrated!==null){if(u===null){if(!k)throw Error(s(318));if(!ai)throw Error(s(344));if(k=f.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(s(317));jx(k,f)}else zt(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;Yn(f),k=!1}else k=Pe(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=k),k=!0;if(!k)return f.flags&256?(Ke(f),f):(Ke(f),null)}return Ke(f),(f.flags&128)!==0?(f.lanes=b,f):(b=T!==null,u=u!==null&&u.memoizedState!==null,b&&(T=f.child,k=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(k=T.alternate.memoizedState.cachePool.pool),P=null,T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(P=T.memoizedState.cachePool.pool),P!==k&&(T.flags|=2048)),b!==u&&b&&(f.child.flags|=8192),nd(f,f.updateQueue),Yn(f),null);case 4:return ge(),tx(u,f),u===null&&qn(f.stateNode.containerInfo),Yn(f),null;case 10:return it(f.type),Yn(f),null;case 19:if(w(bi),T=f.memoizedState,T===null)return Yn(f),null;if(k=(f.flags&128)!==0,P=T.rendering,P===null)if(k)Lc(T,!1);else{if(gi!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(P=vt(u),P!==null){for(f.flags|=128,Lc(T,!1),u=P.updateQueue,f.updateQueue=u,nd(f,u),f.subtreeFlags=0,u=b,b=f.child;b!==null;)qh(b,u),b=b.sibling;return E(bi,bi.current&1|2),bn&&Ie(f,T.treeForkCount),f.child}u=u.sibling}T.tail!==null&&ys()>pl&&(f.flags|=128,k=!0,Lc(T,!1),f.lanes=4194304)}else{if(!k)if(u=vt(P),u!==null){if(f.flags|=128,k=!0,u=u.updateQueue,f.updateQueue=u,nd(f,u),Lc(T,!0),T.tail===null&&T.tailMode==="hidden"&&!P.alternate&&!bn)return Yn(f),null}else 2*ys()-T.renderingStartTime>pl&&b!==536870912&&(f.flags|=128,k=!0,Lc(T,!1),f.lanes=4194304);T.isBackwards?(P.sibling=f.child,f.child=P):(u=T.last,u!==null?u.sibling=P:f.child=P,T.last=P)}return T.tail!==null?(u=T.tail,T.rendering=u,T.tail=u.sibling,T.renderingStartTime=ys(),u.sibling=null,b=bi.current,E(bi,k?b&1|2:b&1),bn&&Ie(f,T.treeForkCount),u):(Yn(f),null);case 22:case 23:return Ke(f),G(),T=f.memoizedState!==null,u!==null?u.memoizedState!==null!==T&&(f.flags|=8192):T&&(f.flags|=8192),T?(b&536870912)!==0&&(f.flags&128)===0&&(Yn(f),f.subtreeFlags&6&&(f.flags|=8192)):Yn(f),b=f.updateQueue,b!==null&&nd(f,b.retryQueue),b=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),T=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(T=f.memoizedState.cachePool.pool),T!==b&&(f.flags|=2048),u!==null&&w(al),null;case 24:return b=null,u!==null&&(b=u.memoizedState.cache),f.memoizedState.cache!==b&&(f.flags|=2048),it(li),Yn(f),null;case 25:return null;case 30:return null}throw Error(s(156,f.tag))}function rm(u,f){switch(Ne(f),f.tag){case 1:return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return it(li),ge(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 26:case 27:case 5:return nt(f),null;case 31:if(f.memoizedState!==null){if(Ke(f),f.alternate===null)throw Error(s(340));zt()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 13:if(Ke(f),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(s(340));zt()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return w(bi),null;case 4:return ge(),null;case 10:return it(f.type),null;case 22:case 23:return Ke(f),G(),u!==null&&w(al),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 24:return it(li),null;case 25:return null;default:return null}}function ix(u,f){switch(Ne(f),f.tag){case 3:it(li),ge();break;case 26:case 27:case 5:nt(f);break;case 4:ge();break;case 31:f.memoizedState!==null&&Ke(f);break;case 13:Ke(f);break;case 19:w(bi);break;case 10:it(f.type);break;case 22:case 23:Ke(f),G(),u!==null&&w(al);break;case 24:it(li)}}function Sa(u,f){try{var b=f.updateQueue,T=b!==null?b.lastEffect:null;if(T!==null){var k=T.next;b=k;do{if((b.tag&u)===u){T=void 0;var P=b.create,H=b.inst;T=P(),H.destroy=T}b=b.next}while(b!==k)}}catch(ie){Gt(f,f.return,ie)}}function Ta(u,f,b){try{var T=f.updateQueue,k=T!==null?T.lastEffect:null;if(k!==null){var P=k.next;T=P;do{if((T.tag&u)===u){var H=T.inst,ie=H.destroy;if(ie!==void 0){H.destroy=void 0,k=f;var Te=b,Ve=ie;try{Ve()}catch(tt){Gt(k,Te,tt)}}}T=T.next}while(T!==P)}}catch(tt){Gt(f,f.return,tt)}}function Oc(u){var f=u.updateQueue;if(f!==null){var b=u.stateNode;try{so(f,b)}catch(T){Gt(u,u.return,T)}}}function Ph(u,f,b){b.props=Ul(u.type,u.memoizedProps),b.state=u.memoizedState;try{b.componentWillUnmount()}catch(T){Gt(u,f,T)}}function zc(u,f){try{var b=u.ref;if(b!==null){switch(u.tag){case 26:case 27:case 5:var T=Yc(u.stateNode);break;case 30:T=u.stateNode;break;default:T=u.stateNode}typeof b=="function"?u.refCleanup=b(T):b.current=T}}catch(k){Gt(u,f,k)}}function vs(u,f){var b=u.ref,T=u.refCleanup;if(b!==null)if(typeof T=="function")try{T()}catch(k){Gt(u,f,k)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(k){Gt(u,f,k)}else b.current=null}function jl(u){var f=u.type,b=u.memoizedProps,T=u.stateNode;try{xx(T,f,b,u)}catch(k){Gt(u,u.return,k)}}function id(u,f,b){try{vx(u.stateNode,u.type,b,f,u)}catch(T){Gt(u,u.return,T)}}function am(u){return u.tag===5||u.tag===3||(jr?u.tag===26:!1)||(qi?u.tag===27&&Jl(u.type):!1)||u.tag===4}function ao(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||am(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(qi&&u.tag===27&&Jl(u.type)||u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Uh(u,f,b){var T=u.tag;if(T===5||T===6)u=u.stateNode,f?bx(b,u,f):Mm(b,u);else if(T!==4&&(qi&&T===27&&Jl(u.type)&&(b=u.stateNode,f=null),u=u.child,u!==null))for(Uh(u,f,b),u=u.sibling;u!==null;)Uh(u,f,b),u=u.sibling}function sd(u,f,b){var T=u.tag;if(T===5||T===6)u=u.stateNode,f?yx(b,u,f):Em(b,u);else if(T!==4&&(qi&&T===27&&Jl(u.type)&&(b=u.stateNode),u=u.child,u!==null))for(sd(u,f,b),u=u.sibling;u!==null;)sd(u,f,b),u=u.sibling}function om(u,f,b){u=u.containerInfo;try{Im(u,b)}catch(T){Gt(f,f.return,T)}}function sx(u){var f=u.stateNode,b=u.memoizedProps;try{Li(u.type,b,f,u)}catch(T){Gt(u,u.return,T)}}function F_(u,f){for(Kh(u.containerInfo),Mi=f;Mi!==null;)if(u=Mi,f=u.child,(u.subtreeFlags&1028)!==0&&f!==null)f.return=u,Mi=f;else for(;Mi!==null;){u=Mi;var b=u.alternate;switch(f=u.flags,u.tag){case 0:if((f&4)!==0&&(f=u.updateQueue,f=f!==null?f.events:null,f!==null))for(var T=0;T<f.length;T++){var k=f[T];k.ref.impl=k.nextImpl}break;case 11:case 15:break;case 1:if((f&1024)!==0&&b!==null){f=void 0,T=u,k=b.memoizedProps,b=b.memoizedState;var P=T.stateNode;try{var H=Ul(T.type,k);f=P.getSnapshotBeforeUpdate(H,b),P.__reactInternalSnapshotBeforeUpdate=f}catch(ie){Gt(T,T.return,ie)}}break;case 3:(f&1024)!==0&&Sn&&Cm(u.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(s(163))}if(f=u.sibling,f!==null){f.return=u.return,Mi=f;break}Mi=u.return}}function rx(u,f,b){var T=b.flags;switch(b.tag){case 0:case 11:case 15:Rs(u,b),T&4&&Sa(5,b);break;case 1:if(Rs(u,b),T&4)if(u=b.stateNode,f===null)try{u.componentDidMount()}catch(H){Gt(b,b.return,H)}else{var k=Ul(b.type,f.memoizedProps);f=f.memoizedState;try{u.componentDidUpdate(k,f,u.__reactInternalSnapshotBeforeUpdate)}catch(H){Gt(b,b.return,H)}}T&64&&Oc(b),T&512&&zc(b,b.return);break;case 3:if(Rs(u,b),T&64&&(T=b.updateQueue,T!==null)){if(u=null,b.child!==null)switch(b.child.tag){case 27:case 5:u=Yc(b.child.stateNode);break;case 1:u=b.child.stateNode}try{so(T,u)}catch(H){Gt(b,b.return,H)}}break;case 27:qi&&f===null&&T&4&&sx(b);case 26:case 5:if(Rs(u,b),f===null){if(T&4)jl(b);else if(T&64){u=b.type,f=b.memoizedProps,k=b.stateNode;try{Bx(k,u,f,b)}catch(H){Gt(b,b.return,H)}}}T&512&&zc(b,b.return);break;case 12:Rs(u,b);break;case 31:Rs(u,b),T&4&&Dr(u,b);break;case 13:Rs(u,b),T&4&&ad(u,b),T&64&&(T=b.memoizedState,T!==null&&(T=T.dehydrated,T!==null&&(b=B_.bind(null,b),rf(T,b))));break;case 22:if(T=b.memoizedState!==null||_i,!T){f=f!==null&&f.memoizedState!==null||wi,k=_i;var P=wi;_i=T,(wi=f)&&!P?Ur(u,b,(b.subtreeFlags&8772)!==0):Rs(u,b),_i=k,wi=P}break;case 30:break;default:Rs(u,b)}}function lm(u){var f=u.alternate;f!==null&&(u.alternate=null,lm(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&Zh(f)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function Ir(u,f,b){for(b=b.child;b!==null;)rd(u,f,b),b=b.sibling}function rd(u,f,b){if(Js&&typeof Js.onCommitFiberUnmount=="function")try{Js.onCommitFiberUnmount(Ql,b)}catch{}switch(b.tag){case 26:if(jr){wi||vs(b,f),Ir(u,f,b),b.memoizedState?sl(b.memoizedState):b.stateNode&&Gm(b.stateNode);break}case 27:if(qi){wi||vs(b,f);var T=mi,k=Ai;Jl(b.type)&&(mi=b.stateNode,Ai=!1),Ir(u,f,b),ts(b.stateNode),mi=T,Ai=k;break}case 5:wi||vs(b,f);case 6:if(Sn){if(T=mi,k=Ai,mi=null,Ir(u,f,b),mi=T,Ai=k,mi!==null)if(Ai)try{Am(mi,b.stateNode)}catch(P){Gt(b,f,P)}else try{_x(mi,b.stateNode)}catch(P){Gt(b,f,P)}}else Ir(u,f,b);break;case 18:Sn&&mi!==null&&(Ai?af(mi,b.stateNode):jm(mi,b.stateNode));break;case 4:Sn?(T=mi,k=Ai,mi=b.stateNode.containerInfo,Ai=!0,Ir(u,f,b),mi=T,Ai=k):(gr&&om(b.stateNode,b,Rm()),Ir(u,f,b));break;case 0:case 11:case 14:case 15:Ta(2,b,f),wi||Ta(4,b,f),Ir(u,f,b);break;case 1:wi||(vs(b,f),T=b.stateNode,typeof T.componentWillUnmount=="function"&&Ph(b,f,T)),Ir(u,f,b);break;case 21:Ir(u,f,b);break;case 22:wi=(T=wi)||b.memoizedState!==null,Ir(u,f,b),wi=T;break;default:Ir(u,f,b)}}function Dr(u,f){if(ai&&f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null))){u=u.dehydrated;try{q_(u)}catch(b){Gt(f,f.return,b)}}}function ad(u,f){if(ai&&f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{W_(u)}catch(b){Gt(f,f.return,b)}}function Pr(u){switch(u.tag){case 31:case 13:case 19:var f=u.stateNode;return f===null&&(f=u.stateNode=new eg),f;case 22:return u=u.stateNode,f=u._retryCache,f===null&&(f=u._retryCache=new eg),f;default:throw Error(s(435,u.tag))}}function oo(u,f){var b=Pr(u);f.forEach(function(T){if(!b.has(T)){b.add(T);var k=V_.bind(null,u,T);T.then(k,k)}})}function Qi(u,f){var b=f.deletions;if(b!==null)for(var T=0;T<b.length;T++){var k=b[T],P=u,H=f;if(Sn){var ie=H;e:for(;ie!==null;){switch(ie.tag){case 27:if(qi){if(Jl(ie.type)){mi=ie.stateNode,Ai=!1;break e}break}case 5:mi=ie.stateNode,Ai=!1;break e;case 3:case 4:mi=ie.stateNode.containerInfo,Ai=!0;break e}ie=ie.return}if(mi===null)throw Error(s(160));rd(P,H,k),mi=null,Ai=!1}else rd(P,H,k);P=k.alternate,P!==null&&(P.return=null),k.return=null}if(f.subtreeFlags&13886)for(f=f.child;f!==null;)od(f,u),f=f.sibling}function od(u,f){var b=u.alternate,T=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:Qi(f,u),es(u),T&4&&(Ta(3,u,u.return),Sa(3,u),Ta(5,u,u.return));break;case 1:Qi(f,u),es(u),T&512&&(wi||b===null||vs(b,b.return)),T&64&&_i&&(u=u.updateQueue,u!==null&&(T=u.callbacks,T!==null&&(b=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=b===null?T:b.concat(T))));break;case 26:if(jr){var k=Vn;if(Qi(f,u),es(u),T&512&&(wi||b===null||vs(b,b.return)),T&4){T=b!==null?b.memoizedState:null;var P=u.memoizedState;b===null?P===null?u.stateNode===null?u.stateNode=$x(k,u.type,u.memoizedProps,u):Hm(k,u.type,u.stateNode):u.stateNode=Vm(k,P,u.memoizedProps):T!==P?(T===null?b.stateNode!==null&&Gm(b.stateNode):sl(T),P===null?Hm(k,u.type,u.stateNode):Vm(k,P,u.memoizedProps)):P===null&&u.stateNode!==null&&id(u,u.memoizedProps,b.memoizedProps)}break}case 27:if(qi){Qi(f,u),es(u),T&512&&(wi||b===null||vs(b,b.return)),b!==null&&T&4&&id(u,u.memoizedProps,b.memoizedProps);break}case 5:if(Qi(f,u),es(u),T&512&&(wi||b===null||vs(b,b.return)),Sn){if(u.flags&32){k=u.stateNode;try{Nm(k)}catch(We){Gt(u,u.return,We)}}T&4&&u.stateNode!=null&&(k=u.memoizedProps,id(u,k,b!==null?b.memoizedProps:k)),T&1024&&(nu=!0)}else gr&&u.alternate!==null&&(u.alternate.stateNode=u.stateNode);break;case 6:if(Qi(f,u),es(u),T&4&&Sn){if(u.stateNode===null)throw Error(s(162));T=u.memoizedProps,b=b!==null?b.memoizedProps:T,k=u.stateNode;try{gx(k,b,T)}catch(We){Gt(u,u.return,We)}}break;case 3:if(jr?(Xx(),k=Vn,Vn=yd(f.containerInfo),Qi(f,u),Vn=k):Qi(f,u),es(u),T&4){if(Sn&&ai&&b!==null&&b.memoizedState.isDehydrated)try{Vx(f.containerInfo)}catch(We){Gt(u,u.return,We)}if(gr){T=f.containerInfo,b=f.pendingChildren;try{Im(T,b)}catch(We){Gt(u,u.return,We)}}}nu&&(nu=!1,Lh(u));break;case 4:jr?(b=Vn,Vn=yd(u.stateNode.containerInfo),Qi(f,u),es(u),Vn=b):(Qi(f,u),es(u)),T&4&&gr&&om(u.stateNode,u,u.stateNode.pendingChildren);break;case 12:Qi(f,u),es(u);break;case 31:Qi(f,u),es(u),T&4&&(T=u.updateQueue,T!==null&&(u.updateQueue=null,oo(u,T)));break;case 13:Qi(f,u),es(u),u.child.flags&8192&&u.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(Cd=ys()),T&4&&(T=u.updateQueue,T!==null&&(u.updateQueue=null,oo(u,T)));break;case 22:k=u.memoizedState!==null;var H=b!==null&&b.memoizedState!==null,ie=_i,Te=wi;if(_i=ie||k,wi=Te||H,Qi(f,u),wi=Te,_i=ie,es(u),T&8192&&(f=u.stateNode,f._visibility=k?f._visibility&-2:f._visibility|1,k&&(b===null||H||_i||wi||qo(u)),Sn)){e:if(b=null,Sn)for(f=u;;){if(f.tag===5||jr&&f.tag===26){if(b===null){H=b=f;try{P=H.stateNode,k?H_(P):Sx(H.stateNode,H.memoizedProps)}catch(We){Gt(H,H.return,We)}}}else if(f.tag===6){if(b===null){H=f;try{var Ve=H.stateNode;k?wx(Ve):Tx(Ve,H.memoizedProps)}catch(We){Gt(H,H.return,We)}}}else if(f.tag===18){if(b===null){H=f;try{var tt=H.stateNode;k?Gx(tt):qx(H.stateNode)}catch(We){Gt(H,H.return,We)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===u)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break e;for(;f.sibling===null;){if(f.return===null||f.return===u)break e;b===f&&(b=null),f=f.return}b===f&&(b=null),f.sibling.return=f.return,f=f.sibling}}T&4&&(T=u.updateQueue,T!==null&&(b=T.retryQueue,b!==null&&(T.retryQueue=null,oo(u,b))));break;case 19:Qi(f,u),es(u),T&4&&(T=u.updateQueue,T!==null&&(u.updateQueue=null,oo(u,T)));break;case 30:break;case 21:break;default:Qi(f,u),es(u)}}function es(u){var f=u.flags;if(f&2){try{for(var b,T=u.return;T!==null;){if(am(T)){b=T;break}T=T.return}if(Sn){if(b==null)throw Error(s(160));switch(b.tag){case 27:if(qi){var k=b.stateNode,P=ao(u);sd(u,P,k);break}case 5:var H=b.stateNode;b.flags&32&&(Nm(H),b.flags&=-33);var ie=ao(u);sd(u,ie,H);break;case 3:case 4:var Te=b.stateNode.containerInfo,Ve=ao(u);Uh(u,Ve,Te);break;default:throw Error(s(161))}}}catch(tt){Gt(u,u.return,tt)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function Lh(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var f=u;Lh(f),f.tag===5&&f.flags&1024&&_m(f.stateNode),u=u.sibling}}function Rs(u,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)rx(u,f.alternate,f),f=f.sibling}function qo(u){for(u=u.child;u!==null;){var f=u;switch(f.tag){case 0:case 11:case 14:case 15:Ta(4,f,f.return),qo(f);break;case 1:vs(f,f.return);var b=f.stateNode;typeof b.componentWillUnmount=="function"&&Ph(f,f.return,b),qo(f);break;case 27:qi&&ts(f.stateNode);case 26:case 5:vs(f,f.return),qo(f);break;case 22:f.memoizedState===null&&qo(f);break;case 30:qo(f);break;default:qo(f)}u=u.sibling}}function Ur(u,f,b){for(b=b&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var T=f.alternate,k=u,P=f,H=P.flags;switch(P.tag){case 0:case 11:case 15:Ur(k,P,b),Sa(4,P);break;case 1:if(Ur(k,P,b),T=P,k=T.stateNode,typeof k.componentDidMount=="function")try{k.componentDidMount()}catch(Ve){Gt(T,T.return,Ve)}if(T=P,k=T.updateQueue,k!==null){var ie=T.stateNode;try{var Te=k.shared.hiddenCallbacks;if(Te!==null)for(k.shared.hiddenCallbacks=null,k=0;k<Te.length;k++)io(Te[k],ie)}catch(Ve){Gt(T,T.return,Ve)}}b&&H&64&&Oc(P),zc(P,P.return);break;case 27:qi&&sx(P);case 26:case 5:Ur(k,P,b),b&&T===null&&H&4&&jl(P),zc(P,P.return);break;case 12:Ur(k,P,b);break;case 31:Ur(k,P,b),b&&H&4&&Dr(k,P);break;case 13:Ur(k,P,b),b&&H&4&&ad(k,P);break;case 22:P.memoizedState===null&&Ur(k,P,b),zc(P,P.return);break;case 30:break;default:Ur(k,P,b)}f=f.sibling}}function Wo(u,f){var b=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),u=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(u=f.memoizedState.cachePool.pool),u!==b&&(u!=null&&u.refCount++,b!=null&&ze(b))}function cm(u,f){u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&ze(u))}function di(u,f,b,T){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)Oh(u,f,b,T),f=f.sibling}function Oh(u,f,b,T){var k=f.flags;switch(f.tag){case 0:case 11:case 15:di(u,f,b,T),k&2048&&Sa(9,f);break;case 1:di(u,f,b,T);break;case 3:di(u,f,b,T),k&2048&&(u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&ze(u)));break;case 12:if(k&2048){di(u,f,b,T),u=f.stateNode;try{var P=f.memoizedProps,H=P.id,ie=P.onPostCommit;typeof ie=="function"&&ie(H,f.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(Te){Gt(f,f.return,Te)}}else di(u,f,b,T);break;case 31:di(u,f,b,T);break;case 13:di(u,f,b,T);break;case 23:break;case 22:P=f.stateNode,H=f.alternate,f.memoizedState!==null?P._visibility&2?di(u,f,b,T):jc(u,f):P._visibility&2?di(u,f,b,T):(P._visibility|=2,Gs(u,f,b,T,(f.subtreeFlags&10256)!==0||!1)),k&2048&&Wo(H,f);break;case 24:di(u,f,b,T),k&2048&&cm(f.alternate,f);break;default:di(u,f,b,T)}}function Gs(u,f,b,T,k){for(k=k&&((f.subtreeFlags&10256)!==0||!1),f=f.child;f!==null;){var P=u,H=f,ie=b,Te=T,Ve=H.flags;switch(H.tag){case 0:case 11:case 15:Gs(P,H,ie,Te,k),Sa(8,H);break;case 23:break;case 22:var tt=H.stateNode;H.memoizedState!==null?tt._visibility&2?Gs(P,H,ie,Te,k):jc(P,H):(tt._visibility|=2,Gs(P,H,ie,Te,k)),k&&Ve&2048&&Wo(H.alternate,H);break;case 24:Gs(P,H,ie,Te,k),k&&Ve&2048&&cm(H.alternate,H);break;default:Gs(P,H,ie,Te,k)}f=f.sibling}}function jc(u,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var b=u,T=f,k=T.flags;switch(T.tag){case 22:jc(b,T),k&2048&&Wo(T.alternate,T);break;case 24:jc(b,T),k&2048&&cm(T.alternate,T);break;default:jc(b,T)}f=f.sibling}}function Ea(u,f,b){if(u.subtreeFlags&br)for(u=u.child;u!==null;)$o(u,f,b),u=u.sibling}function $o(u,f,b){switch(u.tag){case 26:if(Ea(u,f,b),u.flags&br)if(u.memoizedState!==null)Yx(b,Vn,u.memoizedState,u.memoizedProps);else{var T=u.stateNode,k=u.type;u=u.memoizedProps,((f&335544128)===f||ym(k,u))&&Qh(b,T,k,u)}break;case 5:Ea(u,f,b),u.flags&br&&(T=u.stateNode,k=u.type,u=u.memoizedProps,((f&335544128)===f||ym(k,u))&&Qh(b,T,k,u));break;case 3:case 4:jr?(T=Vn,Vn=yd(u.stateNode.containerInfo),Ea(u,f,b),Vn=T):Ea(u,f,b);break;case 22:u.memoizedState===null&&(T=u.alternate,T!==null&&T.memoizedState!==null?(T=br,br=16777216,Ea(u,f,b),br=T):Ea(u,f,b));break;default:Ea(u,f,b)}}function zh(u){var f=u.alternate;if(f!==null&&(u=f.child,u!==null)){f.child=null;do f=u.sibling,u.sibling=null,u=f;while(u!==null)}}function Fc(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var b=0;b<f.length;b++){var T=f[b];Mi=T,fr(T,u)}zh(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)jh(u),u=u.sibling}function jh(u){switch(u.tag){case 0:case 11:case 15:Fc(u),u.flags&2048&&Ta(9,u,u.return);break;case 3:Fc(u);break;case 12:Fc(u);break;case 22:var f=u.stateNode;u.memoizedState!==null&&f._visibility&2&&(u.return===null||u.return.tag!==13)?(f._visibility&=-3,ld(u)):Fc(u);break;default:Fc(u)}}function ld(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var b=0;b<f.length;b++){var T=f[b];Mi=T,fr(T,u)}zh(u)}for(u=u.child;u!==null;){switch(f=u,f.tag){case 0:case 11:case 15:Ta(8,f,f.return),ld(f);break;case 22:b=f.stateNode,b._visibility&2&&(b._visibility&=-3,ld(f));break;default:ld(f)}u=u.sibling}}function fr(u,f){for(;Mi!==null;){var b=Mi;switch(b.tag){case 0:case 11:case 15:Ta(8,b,f);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var T=b.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:ze(b.memoizedState.cache)}if(T=b.child,T!==null)T.return=b,Mi=T;else e:for(b=u;Mi!==null;){T=Mi;var k=T.sibling,P=T.return;if(lm(T),T===b){Mi=null;break e}if(k!==null){k.return=P,Mi=k;break e}Mi=P}}}function Xo(u){var f=en(u);if(f!=null){if(typeof f.memoizedProps["data-testname"]!="string")throw Error(s(364));return f}if(u=Ti(u),u===null)throw Error(s(362));return u.stateNode.current}function Yo(u,f){var b=u.tag;switch(f.$$typeof){case $r:if(u.type===f.value)return!0;break;case su:e:{for(f=f.value,u=[u,0],b=0;b<u.length;){var T=u[b++],k=T.tag,P=u[b++],H=f[P];if(k!==5&&k!==26&&k!==27||!nl(T)){for(;H!=null&&Yo(T,H);)P++,H=f[P];if(P===f.length){f=!0;break e}else for(T=T.child;T!==null;)u.push(T,P),T=T.sibling}}f=!1}return f;case ru:if((b===5||b===26||b===27)&&Tm(u.stateNode,f.value))return!0;break;case ul:if((b===5||b===6||b===26||b===27)&&(u=xd(u),u!==null&&0<=u.indexOf(f.value)))return!0;break;case Ad:if((b===5||b===26||b===27)&&(u=u.memoizedProps["data-testname"],typeof u=="string"&&u.toLowerCase()===f.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function Bc(u){switch(u.$$typeof){case $r:return"<"+(v(u.value)||"Unknown")+">";case su:return":has("+(Bc(u)||"")+")";case ru:return'[role="'+u.value+'"]';case ul:return'"'+u.value+'"';case Ad:return'[data-testname="'+u.value+'"]';default:throw Error(s(365))}}function Vc(u,f){var b=[];u=[u,0];for(var T=0;T<u.length;){var k=u[T++],P=k.tag,H=u[T++],ie=f[H];if(P!==5&&P!==26&&P!==27||!nl(k)){for(;ie!=null&&Yo(k,ie);)H++,ie=f[H];if(H===f.length)b.push(k);else for(k=k.child;k!==null;)u.push(k,H),k=k.sibling}}return b}function qs(u,f){if(!Gi)throw Error(s(363));u=Xo(u),u=Vc(u,f),f=[],u=Array.from(u);for(var b=0;b<u.length;){var T=u[b++],k=T.tag;if(k===5||k===26||k===27)nl(T)||f.push(T.stateNode);else for(T=T.child;T!==null;)u.push(T),T=T.sibling}return f}function ri(){return(gn&2)!==0&&_n!==0?_n&-_n:Lt.T!==null?st():Kc()}function lo(){if(Ls===0)if((_n&536870912)===0||bn){var u=Zl;Zl<<=1,(Zl&3932160)===0&&(Zl=262144),Ls=u}else Ls=536870912;return u=Ks.current,u!==null&&(u.flags|=32),Ls}function hi(u,f,b){(u===dn&&(Hn===2||Hn===9)||u.cancelPendingCommit!==null)&&(yi(u,0),Aa(u,_n,Ls,!1)),F(u,b),((gn&2)===0||u!==dn)&&(u===dn&&((gn&2)===0&&(fl|=b),gi===4&&Aa(u,_n,Ls,!1)),gt(u))}function aa(u,f,b){if((gn&6)!==0)throw Error(s(327));var T=!b&&(f&127)===0&&(f&u.expiredLanes)===0||I(u,f),k=T?lx(u,f):Na(u,f,!0),P=T;do{if(k===0){dl&&!T&&Aa(u,f,0,!1);break}else{if(b=u.current.alternate,P&&!ax(b)){k=Na(u,f,!1),P=!1;continue}if(k===2){if(P=f,u.errorRecoveryDisabledLanes&P)var H=0;else H=u.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){f=H;e:{var ie=u;k=Nd;var Te=ai&&ie.current.memoizedState.isDehydrated;if(Te&&(yi(ie,H).flags|=256),H=Na(ie,H,!1),H!==2){if(hl&&!Te){ie.errorRecoveryDisabledLanes|=P,fl|=P,k=4;break e}P=Qs,Qs=k,P!==null&&(Qs===null?Qs=P:Qs.push.apply(Qs,P))}k=H}if(P=!1,k!==2)continue}}if(k===1){yi(u,0),Aa(u,f,0,!0);break}e:{switch(T=u,P=k,P){case 0:case 1:throw Error(s(345));case 4:if((f&4194048)!==f)break;case 6:Aa(T,f,Ls,!ua);break e;case 2:Qs=null;break;case 3:case 5:break;default:throw Error(s(329))}if((f&62914560)===f&&(k=Cd+300-ys(),10<k)){if(Aa(T,f,Ls,!ua),A(T,0,!0)!==0)break e;Va=f,T.timeoutHandle=vm(Ma.bind(null,T,b,Qs,Rd,wf,f,Ls,fl,ou,ua,P,"Throttled",-0,0),k);break e}Ma(T,b,Qs,Rd,wf,f,Ls,fl,ou,ua,P,null,-0,0)}}break}while(!0);gt(u)}function Ma(u,f,b,T,k,P,H,ie,Te,Ve,tt,We,yt,Zt){if(u.timeoutHandle=Xs,We=f.subtreeFlags,We&8192||(We&16785408)===16785408){We=bm(),$o(f,P,We);var Ni=(P&62914560)===P?Cd-ys():(P&4194048)===P?rc-ys():0;if(Ni=mx(We,Ni),Ni!==null){Va=P,u.cancelPendingCommit=Ni(Ra.bind(null,u,f,P,b,T,k,H,ie,Te,tt,We,null,yt,Zt)),Aa(u,P,H,!Ve);return}}Ra(u,f,P,b,T,k,H,ie,Te)}function ax(u){for(var f=u;;){var b=f.tag;if((b===0||b===11||b===15)&&f.flags&16384&&(b=f.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var T=0;T<b.length;T++){var k=b[T],P=k.getSnapshot;k=k.value;try{if(!Ei(P(),k))return!1}catch{return!1}}if(b=f.child,f.subtreeFlags&16384&&b!==null)b.return=f,f=b;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Aa(u,f,b,T){f&=~au,f&=~fl,u.suspendedLanes|=f,u.pingedLanes&=~f,T&&(u.warmLanes|=f),T=u.expirationTimes;for(var k=f;0<k;){var P=31-Ys(k),H=1<<P;T[P]=-1,k&=~H}b!==0&&W(u,b,f)}function Fh(){return(gn&6)===0?(Qe(0),!1):!0}function Bh(){if(xn!==null){if(Hn===0)var u=xn.return;else u=xn,la=Kn=null,Gn(u),ol=null,ec=0,u=xn;for(;u!==null;)ix(u.alternate,u),u=u.return;xn=null}}function yi(u,f){var b=u.timeoutHandle;b!==Xs&&(u.timeoutHandle=Xs,px(b)),b=u.cancelPendingCommit,b!==null&&(u.cancelPendingCommit=null,b()),Va=0,Bh(),dn=u,xn=b=mr(u.current,null),_n=f,Hn=0,Oi=null,ua=!1,dl=I(u,f),hl=!1,ou=Ls=au=fl=_o=gi=0,Qs=Nd=null,wf=!1,(f&8)!==0&&(f|=f&32);var T=u.entangledLanes;if(T!==0)for(u=u.entanglements,T&=f;0<T;){var k=31-Ys(T),P=1<<k;f|=u[k],T&=~P}return Ba=f,jo(),b}function Jn(u,f){tn=null,Lt.H=yr,f===Xi||f===qr?(f=An(),Hn=3):f===bf?(f=An(),Hn=4):Hn=f===Us?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Oi=f,xn===null&&(gi=1,Rh(u,Re(f,u.current)))}function wn(){var u=Ks.current;return u===null?!0:(_n&4194048)===_n?Zs===null:(_n&62914560)===_n||(_n&536870912)!==0?u===Zs:!1}function co(){var u=Lt.H;return Lt.H=yr,u===null?yr:u}function pr(){var u=Lt.A;return Lt.A=iu,u}function Hc(){gi=4,ua||(_n&4194048)!==_n&&Ks.current!==null||(dl=!0),(_o&134217727)===0&&(fl&134217727)===0||dn===null||Aa(dn,_n,Ls,!1)}function Na(u,f,b){var T=gn;gn|=2;var k=co(),P=pr();(dn!==u||_n!==f)&&(Rd=null,yi(u,f)),f=!1;var H=gi;e:do try{if(Hn!==0&&xn!==null){var ie=xn,Te=Oi;switch(Hn){case 8:Bh(),H=6;break e;case 3:case 2:case 9:case 6:Ks.current===null&&(f=!0);var Ve=Hn;if(Hn=0,Oi=null,Ca(u,ie,Te,Ve),b&&dl){H=0;break e}break;default:Ve=Hn,Hn=0,Oi=null,Ca(u,ie,Te,Ve)}}ox(),H=gi;break}catch(tt){Jn(u,tt)}while(!0);return f&&u.shellSuspendCounter++,la=Kn=null,gn=T,Lt.H=k,Lt.A=P,xn===null&&(dn=null,_n=0,jo()),H}function ox(){for(;xn!==null;)Jo(xn)}function lx(u,f){var b=gn;gn|=2;var T=co(),k=pr();dn!==u||_n!==f?(Rd=null,pl=ys()+500,yi(u,f)):dl=I(u,f);e:do try{if(Hn!==0&&xn!==null){f=xn;var P=Oi;t:switch(Hn){case 1:Hn=0,Oi=null,Ca(u,f,P,1);break;case 2:case 9:if(et(P)){Hn=0,Oi=null,Vh(f);break}f=function(){Hn!==2&&Hn!==9||dn!==u||(Hn=7),gt(u)},P.then(f,f);break e;case 3:Hn=7;break e;case 4:Hn=5;break e;case 7:et(P)?(Hn=0,Oi=null,Vh(f)):(Hn=0,Oi=null,Ca(u,f,P,7));break;case 5:var H=null;switch(xn.tag){case 26:H=xn.memoizedState;case 5:case 27:var ie=xn,Te=ie.type,Ve=ie.pendingProps;if(H?Wm(H):fi(ie.stateNode,Te,Ve)){Hn=0,Oi=null;var tt=ie.sibling;if(tt!==null)xn=tt;else{var We=ie.return;We!==null?(xn=We,qc(We)):xn=null}break t}}Hn=0,Oi=null,Ca(u,f,P,5);break;case 6:Hn=0,Oi=null,Ca(u,f,P,6);break;case 8:Bh(),gi=6;break e;default:throw Error(s(462))}}Gc();break}catch(yt){Jn(u,yt)}while(!0);return la=Kn=null,Lt.H=T,Lt.A=k,gn=b,xn!==null?0:(dn=null,_n=0,jo(),gi)}function Gc(){for(;xn!==null&&!Kx();)Jo(xn)}function Jo(u){var f=nm(u.alternate,u,Ba);u.memoizedProps=u.pendingProps,f===null?qc(u):xn=f}function Vh(u){var f=u,b=f.alternate;switch(f.tag){case 15:case 0:f=Jp(b,f,f.pendingProps,f.type,void 0,_n);break;case 11:f=Jp(b,f,f.pendingProps,f.type.render,f.ref,_n);break;case 5:Gn(f);default:ix(b,f),f=xn=qh(f,Ba),f=nm(b,f,Ba)}u.memoizedProps=u.pendingProps,f===null?qc(u):xn=f}function Ca(u,f,b,T){la=Kn=null,Gn(f),ol=null,ec=0;var k=f.return;try{if(j_(u,k,f,b,_n)){gi=1,Rh(u,Re(b,u.current)),xn=null;return}}catch(P){if(k!==null)throw xn=k,P;gi=1,Rh(u,Re(b,u.current)),xn=null;return}f.flags&32768?(bn||T===1?u=!0:dl||(_n&536870912)!==0?u=!1:(ua=u=!0,(T===2||T===9||T===3||T===6)&&(T=Ks.current,T!==null&&T.tag===13&&(T.flags|=16384))),Ko(f,u)):qc(f)}function qc(u){var f=u;do{if((f.flags&32768)!==0){Ko(f,ua);return}u=f.return;var b=nx(f.alternate,f,Ba);if(b!==null){xn=b;return}if(f=f.sibling,f!==null){xn=f;return}xn=f=u}while(f!==null);gi===0&&(gi=5)}function Ko(u,f){do{var b=rm(u.alternate,u);if(b!==null){b.flags&=32767,xn=b;return}if(b=u.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!f&&(u=u.sibling,u!==null)){xn=u;return}xn=u=b}while(u!==null);gi=6,xn=null}function Ra(u,f,b,T,k,P,H,ie,Te){u.cancelPendingCommit=null;do Ia();while(zi!==0);if((gn&6)!==0)throw Error(s(327));if(f!==null){if(f===u.current)throw Error(s(177));if(P=f.lanes|f.childLanes,P|=tc,z(u,b,P,H,ie,Te),u===dn&&(xn=dn=null,_n=0),ac=f,So=u,Va=b,lu=P,Sf=k,tg=T,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,Ui(_d,function(){return cd(),null})):(u.callbackNode=null,u.callbackPriority=0),T=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||T){T=Lt.T,Lt.T=null,k=zr(),yn(2),H=gn,gn|=4;try{F_(u,f,b)}finally{gn=H,yn(k),Lt.T=T}}zi=1,uo(),ka(),Hh()}}function uo(){if(zi===1){zi=0;var u=So,f=ac,b=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||b){b=Lt.T,Lt.T=null;var T=zr();yn(2);var k=gn;gn|=4;try{od(f,u),fx(u.containerInfo)}finally{gn=k,yn(T),Lt.T=b}}u.current=f,zi=2}}function ka(){if(zi===2){zi=0;var u=So,f=ac,b=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||b){b=Lt.T,Lt.T=null;var T=zr();yn(2);var k=gn;gn|=4;try{rx(u,f.alternate,f)}finally{gn=k,yn(T),Lt.T=b}}zi=3}}function Hh(){if(zi===4||zi===3){zi=0,Xm();var u=So,f=ac,b=Va,T=tg;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?zi=5:(zi=0,ac=So=null,Gh(u,u.pendingLanes));var k=u.pendingLanes;if(k===0&&(wo=null),ee(b),f=f.stateNode,Js&&typeof Js.onCommitFiberRoot=="function")try{Js.onCommitFiberRoot(Ql,f,void 0,(f.current.flags&128)===128)}catch{}if(T!==null){f=Lt.T,k=zr(),yn(2),Lt.T=null;try{for(var P=u.onRecoverableError,H=0;H<T.length;H++){var ie=T[H];P(ie.value,{componentStack:ie.stack})}}finally{Lt.T=f,yn(k)}}(Va&3)!==0&&Ia(),gt(u),k=u.pendingLanes,(b&261930)!==0&&(k&42)!==0?u===kd?Dn++:(Dn=0,kd=u):Dn=0,ai&&vd(),Qe(0)}}function Gh(u,f){(u.pooledCacheLanes&=f)===0&&(f=u.pooledCache,f!=null&&(u.pooledCache=null,ze(f)))}function Ia(){return uo(),ka(),Hh(),cd()}function cd(){if(zi!==5)return!1;var u=So,f=lu;lu=0;var b=ee(Va),T=32>b?32:b;b=Lt.T;var k=zr();try{yn(T),Lt.T=null,T=Sf,Sf=null;var P=So,H=Va;if(zi=0,ac=So=null,Va=0,(gn&6)!==0)throw Error(s(331));var ie=gn;if(gn|=4,jh(P.current),Oh(P,P.current,H,T),gn=ie,Qe(0,!1),Js&&typeof Js.onPostCommitFiberRoot=="function")try{Js.onPostCommitFiberRoot(Ql,P)}catch{}return!0}finally{yn(k),Lt.T=b,Gh(u,f)}}function Zo(u,f,b){f=Re(b,f),f=Xp(u.stateNode,f,2),u=dr(u,f,2),u!==null&&(F(u,2),gt(u))}function Gt(u,f,b){if(u.tag===3)Zo(u,u,b);else for(;f!==null;){if(f.tag===3){Zo(f,u,b);break}else if(f.tag===1){var T=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(wo===null||!wo.has(T))){u=Re(b,u),b=G0(2),T=dr(f,b,2),T!==null&&(q0(b,T,f,u),F(T,2),gt(T));break}}f=f.return}}function Wc(u,f,b){var T=u.pingCache;if(T===null){T=u.pingCache=new _r;var k=new Set;T.set(f,k)}else k=T.get(f),k===void 0&&(k=new Set,T.set(f,k));k.has(b)||(hl=!0,k.add(b),u=cx.bind(null,u,f,b),f.then(u,u))}function cx(u,f,b){var T=u.pingCache;T!==null&&T.delete(f),u.pingedLanes|=u.suspendedLanes&b,u.warmLanes&=~b,dn===u&&(_n&b)===b&&(gi===4||gi===3&&(_n&62914560)===_n&&300>ys()-Cd?(gn&2)===0&&yi(u,0):au|=b,ou===_n&&(ou=0)),gt(u)}function ux(u,f){f===0&&(f=U()),u=xs(u,f),u!==null&&(F(u,f),gt(u))}function B_(u){var f=u.memoizedState,b=0;f!==null&&(b=f.retryLane),ux(u,b)}function V_(u,f){var b=0;switch(u.tag){case 31:case 13:var T=u.stateNode,k=u.memoizedState;k!==null&&(b=k.retryLane);break;case 19:T=u.stateNode;break;case 22:T=u.stateNode._retryCache;break;default:throw Error(s(314))}T!==null&&T.delete(f),ux(u,b)}function Ui(u,f){return bd(u,f)}function um(u,f,b,T){this.tag=u,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fl(u){return u=u.prototype,!(!u||!u.isReactComponent)}function mr(u,f){var b=u.alternate;return b===null?(b=t(u.tag,f,u.key,u.mode),b.elementType=u.elementType,b.type=u.type,b.stateNode=u.stateNode,b.alternate=u,u.alternate=b):(b.pendingProps=f,b.type=u.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=u.flags&65011712,b.childLanes=u.childLanes,b.lanes=u.lanes,b.child=u.child,b.memoizedProps=u.memoizedProps,b.memoizedState=u.memoizedState,b.updateQueue=u.updateQueue,f=u.dependencies,b.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},b.sibling=u.sibling,b.index=u.index,b.ref=u.ref,b.refCleanup=u.refCleanup,b}function qh(u,f){u.flags&=65011714;var b=u.alternate;return b===null?(u.childLanes=0,u.lanes=f,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=b.childLanes,u.lanes=b.lanes,u.child=b.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=b.memoizedProps,u.memoizedState=b.memoizedState,u.updateQueue=b.updateQueue,u.type=b.type,f=b.dependencies,u.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),u}function ho(u,f,b,T,k,P){var H=0;if(T=u,typeof u=="function")Fl(u)&&(H=1);else if(typeof u=="string")H=jr&&qi?of(u,b,ns.current)?26:$m(u)?27:5:jr?of(u,b,ns.current)?26:5:qi&&$m(u)?27:5;else e:switch(u){case fd:return u=t(31,b,f,k),u.elementType=fd,u.lanes=P,u;case Gl:return Lr(b.children,k,P,f);case ql:H=8,k|=24;break;case Wl:return u=t(12,b,f,k|2),u.elementType=Wl,u.lanes=P,u;case Yh:return u=t(13,b,f,k),u.elementType=Yh,u.lanes=P,u;case fo:return u=t(19,b,f,k),u.elementType=fo,u.lanes=P,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case Or:H=10;break e;case hd:H=9;break e;case $c:H=11;break e;case Jh:H=14;break e;case ks:H=16,T=null;break e}H=29,b=Error(s(130,u===null?"null":typeof u,"")),T=null}return f=t(H,b,f,k),f.elementType=u,f.type=T,f.lanes=P,f}function Lr(u,f,b,T){return u=t(7,u,T,f),u.lanes=b,u}function dm(u,f,b){return u=t(6,u,null,f),u.lanes=b,u}function hm(u){var f=t(18,null,null,0);return f.stateNode=u,f}function fm(u,f,b){return f=t(4,u.children!==null?u.children:[],u.key,f),f.lanes=b,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}function dx(u,f,b,T,k,P,H,ie,Te){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Xs,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=j(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=j(0),this.hiddenUpdates=j(null),this.identifierPrefix=T,this.onUncaughtError=k,this.onCaughtError=P,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Te,this.incompleteTransitions=new Map}function Qo(u,f,b,T,k,P,H,ie,Te,Ve,tt,We){return u=new dx(u,f,b,H,Te,Ve,tt,We,ie),f=1,P===!0&&(f|=24),P=t(3,null,null,f),u.current=P,P.stateNode=u,f=Ee(),f.refCount++,u.pooledCache=f,f.refCount++,P.memoizedState={element:T,isDehydrated:b,cache:f},Vi(P),u}function Wh(u){return u?(u=Pa,u):Pa}function ud(u){var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(s(188)):(u=Object.keys(u).join(","),Error(s(268,u)));return u=c(f),u=u!==null?h(u):null,u===null?null:Yc(u.stateNode)}function pm(u,f,b,T,k,P){k=Wh(k),T.context===null?T.context=k:T.pendingContext=k,T=ur(f),T.payload={element:b},P=P===void 0?null:P,P!==null&&(T.callback=P),b=dr(u,T,f),b!==null&&(hi(b,u,f),Fo(b,u,f))}function Bl(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var b=u.retryLane;u.retryLane=b!==0&&b<f?b:f}}function dd(u,f){Bl(u,f),(u=u.alternate)&&Bl(u,f)}var cn={},$h=Ob,Ws=bV,Xh=Object.assign,Vl=Symbol.for("react.element"),Da=Symbol.for("react.transitional.element"),Hl=Symbol.for("react.portal"),Gl=Symbol.for("react.fragment"),ql=Symbol.for("react.strict_mode"),Wl=Symbol.for("react.profiler"),hd=Symbol.for("react.consumer"),Or=Symbol.for("react.context"),$c=Symbol.for("react.forward_ref"),Yh=Symbol.for("react.suspense"),fo=Symbol.for("react.suspense_list"),Jh=Symbol.for("react.memo"),ks=Symbol.for("react.lazy"),fd=Symbol.for("react.activity"),mm=Symbol.for("react.memo_cache_sentinel"),po=Symbol.iterator,el=Symbol.for("react.client.reference"),tl=Array.isArray,Lt=$h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gm=e.rendererVersion,pd=e.rendererPackageName,Xc=e.extraDevToolsConfig,Yc=e.getPublicInstance,hx=e.getRootHostContext,Jc=e.getChildHostContext,Kh=e.prepareForCommit,fx=e.resetAfterCommit,xm=e.createInstance;e.cloneMutableInstance;var md=e.appendInitialChild,$s=e.finalizeInitialChildren,Is=e.shouldSetTextContent,mo=e.createTextInstance;e.cloneMutableTextInstance;var vm=e.scheduleTimeout,px=e.cancelTimeout,Xs=e.noTimeout,Si=e.isPrimaryRenderer;e.warnsIfNotActing;var Sn=e.supportsMutation,gr=e.supportsPersistence,ai=e.supportsHydration,en=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var qn=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var yn=e.setCurrentUpdatePriority,zr=e.getCurrentUpdatePriority,Kc=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var $l=e.shouldAttemptEagerTransition,Zh=e.detachDeletedInstance;e.requestPostPaintCallback;var gd=e.maySuspendCommit,Zc=e.maySuspendCommitOnUpdate,ym=e.maySuspendCommitInSyncRender,fi=e.preloadInstance,bm=e.startSuspendingCommit,Qh=e.suspendInstance;e.suspendOnActiveViewTransition;var mx=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var Xl=e.NotPendingTransition,Yl=e.HostTransitionContext,_m=e.resetFormInstance;e.bindToConsole;var wm=e.supportsMicrotasks,Sm=e.scheduleMicrotask,Gi=e.supportsTestSelectors,Ti=e.findFiberRoot,ef=e.getBoundingRect,xd=e.getTextContent,nl=e.isHiddenSubtree,Tm=e.matchAccessibilityRole,go=e.setFocusIfFocusable,tf=e.setupIntersectionObserver,Em=e.appendChild,Mm=e.appendChildToContainer,gx=e.commitTextUpdate,xx=e.commitMount,vx=e.commitUpdate,yx=e.insertBefore,bx=e.insertInContainerBefore,_x=e.removeChild,Am=e.removeChildFromContainer,Nm=e.resetTextContent,H_=e.hideInstance,wx=e.hideTextInstance,Sx=e.unhideInstance,Tx=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var Cm=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var Ex=e.cloneInstance,Rm=e.createContainerChildSet,km=e.appendChildToContainerChildSet,Mx=e.finalizeContainerChildren,Im=e.replaceContainerChildren,Ax=e.cloneHiddenInstance,Dm=e.cloneHiddenTextInstance,il=e.isSuspenseInstancePending,nf=e.isSuspenseInstanceFallback,sf=e.getSuspenseInstanceFallbackErrorDetails,rf=e.registerSuspenseInstanceRetry,Nx=e.canHydrateFormStateMarker,Pm=e.isFormStateMarkerMatching,Cx=e.getNextHydratableSibling,Rx=e.getNextHydratableSiblingAfterSingleton,kx=e.getFirstHydratableChild,Ix=e.getFirstHydratableChildWithinContainer,Dx=e.getFirstHydratableChildWithinActivityInstance,Px=e.getFirstHydratableChildWithinSuspenseInstance,Um=e.getFirstHydratableChildWithinSingleton,Ux=e.canHydrateInstance,Lx=e.canHydrateTextInstance,Lm=e.canHydrateActivityInstance,Ox=e.canHydrateSuspenseInstance,zx=e.hydrateInstance,G_=e.hydrateTextInstance,Om=e.hydrateActivityInstance,jx=e.hydrateSuspenseInstance,Fx=e.getNextHydratableInstanceAfterActivityInstance,zm=e.getNextHydratableInstanceAfterSuspenseInstance,Bx=e.commitHydratedInstance,Vx=e.commitHydratedContainer,q_=e.commitHydratedActivityInstance,W_=e.commitHydratedSuspenseInstance,Hx=e.finalizeHydratedChildren,vd=e.flushHydrationEvents;e.clearActivityBoundary;var jm=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var af=e.clearSuspenseBoundaryFromContainer,Gx=e.hideDehydratedBoundary,qx=e.unhideDehydratedBoundary,Qc=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Wx=e.validateHydratableInstance,Fm=e.validateHydratableTextInstance,jr=e.supportsResources,of=e.isHostHoistableType,yd=e.getHoistableRoot,Bm=e.getResource,Vm=e.acquireResource,sl=e.releaseResource,$x=e.hydrateHoistable,Hm=e.mountHoistable,Gm=e.unmountHoistable,lf=e.createHoistableInstance,Xx=e.prepareToCommitHoistables,qm=e.mayResourceSuspendCommit,Wm=e.preloadResource,Yx=e.suspendResource,qi=e.supportsSingletons,cf=e.resolveSingletonInstance,Li=e.acquireSingletonInstance,ts=e.releaseSingletonInstance,$m=e.isHostSingletonType,Jl=e.isSingletonScope,uf=[],Kl=-1,Pa={},Ys=Math.clz32?Math.clz32:R,df=Math.log,Jx=Math.LN2,hf=256,Zl=262144,eu=4194304,bd=Ws.unstable_scheduleCallback,ff=Ws.unstable_cancelCallback,Kx=Ws.unstable_shouldYield,Xm=Ws.unstable_requestPaint,ys=Ws.unstable_now,pf=Ws.unstable_ImmediatePriority,Zx=Ws.unstable_UserBlockingPriority,_d=Ws.unstable_NormalPriority,mf=Ws.unstable_IdlePriority,Ym=Ws.log,Qx=Ws.unstable_setDisableYieldValue,Ql=null,Js=null,Ei=typeof Object.is=="function"?Object.is:ce,gf=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},$_=Object.prototype.hasOwnProperty,xf,Ua,wd=!1,Jm=new WeakMap,xo=[],La=0,Wn=null,Sd=0,Fr=[],xr=0,Br=null,us=1,oa="",ns=y(null),vo=y(null),ds=y(null),Td=y(null),Wi=null,oi=null,bn=!1,Oa=null,Ds=!1,vf=Error(s(519)),Vr=y(null),Kn=null,la=null,ev=typeof AbortController<"u"?AbortController:function(){var u=[],f=this.signal={aborted:!1,addEventListener:function(b,T){u.push(T)}};this.abort=function(){f.aborted=!0,u.forEach(function(b){return b()})}},is=Ws.unstable_scheduleCallback,X_=Ws.unstable_NormalPriority,li={$$typeof:Or,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Ed=null,Bn=null,bs=!1,Hr=!1,yf=!1,rl=0,tu=null,Km=0,yo=0,$i=null,Gr=Lt.S;Lt.S=function(u,f){rc=ys(),typeof f=="object"&&f!==null&&typeof f.then=="function"&&rn(u,f),Gr!==null&&Gr(u,f)};var al=y(null),Xi=Error(s(460)),bf=Error(s(474)),qr=Error(s(542)),za={then:function(){}},Ps=null,ol=null,ec=0,hs=Cl(!0),Zm=Cl(!1),fs=[],ja=0,tc=0,vr=!1,_f=!1,nc=y(null),ll=y(0),Ks=y(null),Zs=null,bi=y(0),bo=0,tn=null,kt=null,Yt=null,un=!1,an=!1,En=!1,_s=0,Wr=0,ca=null,Qm=0,yr={readContext:X,use:Di,useCallback:$e,useContext:$e,useEffect:$e,useImperativeHandle:$e,useLayoutEffect:$e,useInsertionEffect:$e,useMemo:$e,useReducer:$e,useRef:$e,useState:$e,useDebugValue:$e,useDeferredValue:$e,useTransition:$e,useSyncExternalStore:$e,useId:$e,useHostTransitionStatus:$e,useFormState:$e,useActionState:$e,useOptimistic:$e,useMemoCache:$e,useCacheRefresh:$e};yr.useEffectEvent=$e;var pi={readContext:X,use:Di,useCallback:function(u,f){return Kt().memoizedState=[u,f===void 0?null:f],u},useContext:X,useEffect:Yu,useImperativeHandle:function(u,f,b){b=b!=null?b.concat([u]):null,Pl(4194308,4,Rc.bind(null,f,u),b)},useLayoutEffect:function(u,f){return Pl(4194308,4,u,f)},useInsertionEffect:function(u,f){Pl(4,2,u,f)},useMemo:function(u,f){var b=Kt();f=f===void 0?null:f;var T=u();if(En){Q(!0);try{u()}finally{Q(!1)}}return b.memoizedState=[T,f],T},useReducer:function(u,f,b){var T=Kt();if(b!==void 0){var k=b(f);if(En){Q(!0);try{b(f)}finally{Q(!1)}}}else k=f;return T.memoizedState=T.baseState=k,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:k},T.queue=u,u=u.dispatch=z_.bind(null,tn,u),[T.memoizedState,u]},useRef:function(u){var f=Kt();return u={current:u},f.memoizedState=u},useState:function(u){u=Fp(u);var f=u.queue,b=F0.bind(null,tn,f);return f.dispatch=b,[u.memoizedState,b]},useDebugValue:Ku,useDeferredValue:function(u,f){var b=Kt();return Ic(b,u,f)},useTransition:function(){var u=Fp(!1);return u=O0.bind(null,tn,u.queue,!0,!1),Kt().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,f,b){var T=tn,k=Kt();if(bn){if(b===void 0)throw Error(s(407));b=b()}else{if(b=f(),dn===null)throw Error(s(349));(_n&127)!==0||Ki(T,f,b)}k.memoizedState=b;var P={value:b,getSnapshot:f};return k.queue=P,Yu(Il.bind(null,T,P,u),[u]),T.flags|=2048,hr(9,{destroy:void 0},Zi.bind(null,T,P,b,f),null),b},useId:function(){var u=Kt(),f=dn.identifierPrefix;if(bn){var b=oa,T=us;b=(T&~(1<<32-Ys(T)-1)).toString(32)+b,f="_"+f+"R_"+b,b=_s++,0<b&&(f+="H"+b.toString(32)),f+="_"}else b=Qm++,f="_"+f+"r_"+b.toString(32)+"_";return u.memoizedState=f},useHostTransitionStatus:qp,useFormState:Vp,useActionState:Vp,useOptimistic:function(u){var f=Kt();f.memoizedState=f.baseState=u;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=b,f=Ah.bind(null,tn,!0,b),b.dispatch=f,[u,f]},useMemoCache:ra,useCacheRefresh:function(){return Kt().memoizedState=O_.bind(null,tn)},useEffectEvent:function(u){var f=Kt(),b={impl:u};return f.memoizedState=b,function(){if((gn&2)!==0)throw Error(s(440));return b.impl.apply(void 0,arguments)}}},Fa={readContext:X,use:Di,useCallback:Eh,useContext:X,useEffect:Cc,useImperativeHandle:L0,useInsertionEffect:Ho,useLayoutEffect:Ju,useMemo:kc,useReducer:As,useRef:Th,useState:function(){return As(ti)},useDebugValue:Ku,useDeferredValue:function(u,f){var b=ut();return Gp(b,kt.memoizedState,u,f)},useTransition:function(){var u=As(ti)[0],f=ut().memoizedState;return[typeof u=="boolean"?u:Vt(u),f]},useSyncExternalStore:Pi,useId:Mh,useHostTransitionStatus:qp,useFormState:Ac,useActionState:Ac,useOptimistic:function(u,f){var b=ut();return $u(b,kt,u,f)},useMemoCache:ra,useCacheRefresh:j0};Fa.useEffectEvent=Ns;var cl={readContext:X,use:Di,useCallback:Eh,useContext:X,useEffect:Cc,useImperativeHandle:L0,useInsertionEffect:Ho,useLayoutEffect:Ju,useMemo:kc,useReducer:Hi,useRef:Th,useState:function(){return Hi(ti)},useDebugValue:Ku,useDeferredValue:function(u,f){var b=ut();return kt===null?Ic(b,u,f):Gp(b,kt.memoizedState,u,f)},useTransition:function(){var u=Hi(ti)[0],f=ut().memoizedState;return[typeof u=="boolean"?u:Vt(u),f]},useSyncExternalStore:Pi,useId:Mh,useHostTransitionStatus:qp,useFormState:Nc,useActionState:Nc,useOptimistic:function(u,f){var b=ut();return kt!==null?$u(b,kt,u,f):(b.baseState=u,[u,b.queue.dispatch])},useMemoCache:ra,useCacheRefresh:j0};cl.useEffectEvent=Ns;var Md={enqueueSetState:function(u,f,b){u=u._reactInternals;var T=ri(),k=ur(T);k.payload=f,b!=null&&(k.callback=b),f=dr(u,k,T),f!==null&&(hi(f,u,T),Fo(f,u,T))},enqueueReplaceState:function(u,f,b){u=u._reactInternals;var T=ri(),k=ur(T);k.tag=1,k.payload=f,b!=null&&(k.callback=b),f=dr(u,k,T),f!==null&&(hi(f,u,T),Fo(f,u,T))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var b=ri(),T=ur(b);T.tag=2,f!=null&&(T.callback=f),f=dr(u,T,b),f!==null&&(hi(f,u,b),Fo(f,u,b))}},Us=Error(s(461)),ni=!1,ic={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},_i=!1,wi=!1,nu=!1,eg=typeof WeakSet=="function"?WeakSet:Set,Mi=null,mi=null,Ai=!1,Vn=null,br=8192,iu={getCacheForType:function(u){var f=X(li),b=f.data.get(u);return b===void 0&&(b=u(),f.data.set(u,b)),b},cacheSignal:function(){return X(li).controller.signal}},$r=0,su=1,ru=2,Ad=3,ul=4;if(typeof Symbol=="function"&&Symbol.for){var sc=Symbol.for;$r=sc("selector.component"),su=sc("selector.has_pseudo_class"),ru=sc("selector.role"),Ad=sc("selector.test_id"),ul=sc("selector.text")}var _r=typeof WeakMap=="function"?WeakMap:Map,gn=0,dn=null,xn=null,_n=0,Hn=0,Oi=null,ua=!1,dl=!1,hl=!1,Ba=0,gi=0,_o=0,fl=0,au=0,Ls=0,ou=0,Nd=null,Qs=null,wf=!1,Cd=0,rc=0,pl=1/0,Rd=null,wo=null,zi=0,So=null,ac=null,Va=0,lu=0,Sf=null,tg=null,Dn=0,kd=null;return cn.attemptContinuousHydration=function(u){if(u.tag===13||u.tag===31){var f=xs(u,67108864);f!==null&&hi(f,u,67108864),dd(u,67108864)}},cn.attemptHydrationAtCurrentPriority=function(u){if(u.tag===13||u.tag===31){var f=ri();f=Y(f);var b=xs(u,f);b!==null&&hi(b,u,f),dd(u,f)}},cn.attemptSynchronousHydration=function(u){switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var f=N(u.pendingLanes);if(f!==0){for(u.pendingLanes|=2,u.entangledLanes|=2;f;){var b=1<<31-Ys(f);u.entanglements[1]|=b,f&=~b}gt(u),(gn&6)===0&&(pl=ys()+500,Qe(0))}}break;case 31:case 13:f=xs(u,2),f!==null&&hi(f,u,2),Fh(),dd(u,2)}},cn.batchedUpdates=function(u,f){return u(f)},cn.createComponentSelector=function(u){return{$$typeof:$r,value:u}},cn.createContainer=function(u,f,b,T,k,P,H,ie,Te,Ve){return Qo(u,f,!1,null,b,T,P,null,H,ie,Te,Ve)},cn.createHasPseudoClassSelector=function(u){return{$$typeof:su,value:u}},cn.createHydrationContainer=function(u,f,b,T,k,P,H,ie,Te,Ve,tt,We,yt,Zt){var Ni;return u=Qo(b,T,!0,u,k,P,ie,Zt,Te,Ve,tt,We),u.context=Wh(null),b=u.current,T=ri(),T=Y(T),k=ur(T),k.callback=(Ni=f)!=null?Ni:null,dr(b,k,T),f=T,u.current.lanes=f,F(u,f),gt(u),u},cn.createPortal=function(u,f,b){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hl,key:T==null?null:""+T,children:u,containerInfo:f,implementation:b}},cn.createRoleSelector=function(u){return{$$typeof:ru,value:u}},cn.createTestNameSelector=function(u){return{$$typeof:Ad,value:u}},cn.createTextSelector=function(u){return{$$typeof:ul,value:u}},cn.defaultOnCaughtError=function(u){console.error(u)},cn.defaultOnRecoverableError=function(u){gf(u)},cn.defaultOnUncaughtError=function(u){gf(u)},cn.deferredUpdates=function(u){var f=Lt.T,b=zr();try{return yn(32),Lt.T=null,u()}finally{yn(b),Lt.T=f}},cn.discreteUpdates=function(u,f,b,T,k){var P=Lt.T,H=zr();try{return yn(2),Lt.T=null,u(f,b,T,k)}finally{yn(H),Lt.T=P,gn===0&&(pl=ys()+500)}},cn.findAllNodes=qs,cn.findBoundingRects=function(u,f){if(!Gi)throw Error(s(363));f=qs(u,f),u=[];for(var b=0;b<f.length;b++)u.push(ef(f[b]));for(f=u.length-1;0<f;f--){b=u[f];for(var T=b.x,k=T+b.width,P=b.y,H=P+b.height,ie=f-1;0<=ie;ie--)if(f!==ie){var Te=u[ie],Ve=Te.x,tt=Ve+Te.width,We=Te.y,yt=We+Te.height;if(T>=Ve&&P>=We&&k<=tt&&H<=yt){u.splice(f,1);break}else if(T!==Ve||b.width!==Te.width||yt<P||We>H){if(!(P!==We||b.height!==Te.height||tt<T||Ve>k)){Ve>T&&(Te.width+=Ve-T,Te.x=T),tt<k&&(Te.width=k-Ve),u.splice(f,1);break}}else{We>P&&(Te.height+=We-P,Te.y=P),yt<H&&(Te.height=H-We),u.splice(f,1);break}}}return u},cn.findHostInstance=ud,cn.findHostInstanceWithNoPortals=function(u){return u=c(u),u=u!==null?p(u):null,u===null?null:Yc(u.stateNode)},cn.findHostInstanceWithWarning=function(u){return ud(u)},cn.flushPassiveEffects=Ia,cn.flushSyncFromReconciler=function(u){var f=gn;gn|=1;var b=Lt.T,T=zr();try{if(yn(2),Lt.T=null,u)return u()}finally{yn(T),Lt.T=b,gn=f,(gn&6)===0&&Qe(0)}},cn.flushSyncWork=Fh,cn.focusWithin=function(u,f){if(!Gi)throw Error(s(363));for(u=Xo(u),f=Vc(u,f),f=Array.from(f),u=0;u<f.length;){var b=f[u++],T=b.tag;if(!nl(b)){if((T===5||T===26||T===27)&&go(b.stateNode))return!0;for(b=b.child;b!==null;)f.push(b),b=b.sibling}}return!1},cn.getFindAllNodesFailureDescription=function(u,f){if(!Gi)throw Error(s(363));var b=0,T=[];u=[Xo(u),0];for(var k=0;k<u.length;){var P=u[k++],H=P.tag,ie=u[k++],Te=f[ie];if((H!==5&&H!==26&&H!==27||!nl(P))&&(Yo(P,Te)&&(T.push(Bc(Te)),ie++,ie>b&&(b=ie)),ie<f.length))for(P=P.child;P!==null;)u.push(P,ie),P=P.sibling}if(b<f.length){for(u=[];b<f.length;b++)u.push(Bc(f[b]));return`findAllNodes was able to match part of the selector:
  `+(T.join(" > ")+`

No matching component was found for:
  `)+u.join(" > ")}return null},cn.getPublicRootInstance=function(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 27:case 5:return Yc(u.child.stateNode);default:return u.child.stateNode}},cn.injectIntoDevTools=function(){var u={bundleType:0,version:gm,rendererPackageName:pd,currentDispatcherRef:Lt,reconcilerVersion:"19.2.0"};if(Xc!==null&&(u.rendererConfig=Xc),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")u=!1;else{var f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(f.isDisabled||!f.supportsFiber)u=!0;else{try{Ql=f.inject(u),Js=f}catch{}u=!!f.checkDCE}}return u},cn.isAlreadyRendering=function(){return(gn&6)!==0},cn.observeVisibleRects=function(u,f,b,T){if(!Gi)throw Error(s(363));u=qs(u,f);var k=tf(u,b,T).disconnect;return{disconnect:function(){k()}}},cn.shouldError=function(){return null},cn.shouldSuspend=function(){return!1},cn.startHostTransition=function(u,f,b,T){if(u.tag!==5)throw Error(s(476));var k=z0(u).queue;O0(u,k,f,Xl,b===null?i:function(){var P=z0(u);return P.next===null&&(P=u.alternate.memoizedState),Zu(u,P.next.queue,{},ri()),b(T)})},cn.updateContainer=function(u,f,b,T){var k=f.current,P=ri();return pm(k,P,u,f,b,T),P},cn.updateContainerSync=function(u,f,b,T){return pm(f.current,2,u,f,b,T),2},cn},n.exports.default=n.exports,Object.defineProperty(n.exports,"__esModule",{value:!0})})(uN)),uN.exports}var hN;function $V(){return hN||(hN=1,cN.exports=WV()),cN.exports}var XV=$V();const YV=qV(XV);function JV(n){const e=YV(n);return e.injectIntoDevTools(),e}const LI=0,Cp={},KV=/^three(?=[A-Z])/,R_=n=>`${n[0].toUpperCase()}${n.slice(1)}`;let ZV=0;const QV=n=>typeof n=="function";function e8(n){if(QV(n)){const e=`${ZV++}`;return Cp[e]=n,e}else Object.assign(Cp,n)}function OI(n,e){const t=R_(n),i=Cp[t];if(n!=="primitive"&&!i)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(n==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function t8(n,e,t){var i;return n=R_(n)in Cp?n:n.replace(KV,""),OI(n,e),n==="primitive"&&(i=e.object)!=null&&i.__r3f&&delete e.object.__r3f,Tb(e.object,t,n,e)}function n8(n){if(!n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?Mb(n.parent,n):Kr(n.object)&&(n.object.visible=!1),n.isHidden=!0,Up(n)}}function zI(n){if(n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?Eb(n.parent,n):Kr(n.object)&&n.props.visible!==!1&&(n.object.visible=!0),n.isHidden=!1,Up(n)}}function BT(n,e,t){const i=e.root.getState();if(!(!n.parent&&n.object!==i.scene)){if(!e.object){var s,r;const o=Cp[R_(e.type)];e.object=(s=e.props.object)!=null?s:new o(...(r=e.props.args)!=null?r:[]),e.object.__r3f=e}if(ku(e.object,e.props),e.props.attach)Eb(n,e);else if(Kr(e.object)&&Kr(n.object)){const o=n.object.children.indexOf(t?.object);if(t&&o!==-1){const c=n.object.children.indexOf(e.object);if(c!==-1){n.object.children.splice(c,1);const h=c<o?o-1:o;n.object.children.splice(h,0,e.object)}else e.object.parent=n.object,n.object.children.splice(o,0,e.object),e.object.dispatchEvent({type:"added"}),n.object.dispatchEvent({type:"childadded",child:e.object})}else n.object.add(e.object)}for(const o of e.children)BT(e,o);Up(e)}}function AS(n,e){e&&(e.parent=n,n.children.push(e),BT(n,e))}function fN(n,e,t){if(!e||!t)return;e.parent=n;const i=n.children.indexOf(t);i!==-1?n.children.splice(i,0,e):n.children.push(e),BT(n,e,t)}function jI(n){if(typeof n.dispose=="function"){const e=()=>{try{n.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():p1.unstable_scheduleCallback(p1.unstable_IdlePriority,e)}}function g1(n,e,t){if(!e)return;e.parent=null;const i=n.children.indexOf(e);i!==-1&&n.children.splice(i,1),e.props.attach?Mb(n,e):Kr(e.object)&&Kr(n.object)&&(n.object.remove(e.object),LV(RI(e),e.object));const s=e.props.dispose!==null&&t!==!1;for(let r=e.children.length-1;r>=0;r--){const o=e.children[r];g1(e,o,s)}e.children.length=0,delete e.object.__r3f,s&&e.type!=="primitive"&&e.object.type!=="Scene"&&jI(e.object),t===void 0&&Up(e)}function i8(n,e){for(const t of[n,n.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const i=t.ref(e);typeof i=="function"&&(t.refCleanup=i)}else t.ref&&(t.ref.current=e)}const wy=[];function s8(){for(const[t]of wy){const i=t.parent;if(i){t.props.attach?Mb(i,t):Kr(t.object)&&Kr(i.object)&&i.object.remove(t.object);for(const s of t.children)s.props.attach?Mb(t,s):Kr(s.object)&&Kr(t.object)&&t.object.remove(s.object)}t.isHidden&&zI(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&jI(t.object)}for(const[t,i,s]of wy){t.props=i;const r=t.parent;if(r){var n,e;const o=Cp[R_(t.type)];t.object=(n=t.props.object)!=null?n:new o(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,i8(s,t.object),ku(t.object,t.props),t.props.attach?Eb(r,t):Kr(t.object)&&Kr(r.object)&&r.object.add(t.object);for(const c of t.children)c.props.attach?Eb(t,c):Kr(c.object)&&Kr(t.object)&&t.object.add(c.object);Up(t)}}wy.length=0}const NS=()=>{},pN={};let hy=LI;const r8=0,a8=4,Ab=JV({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:t8,removeChild:g1,appendChild:AS,appendInitialChild:AS,insertBefore:fN,appendChildToContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||AS(t,e)},removeChildFromContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||g1(t,e)},insertInContainerBefore(n,e,t){const i=n.getState().scene.__r3f;!e||!t||!i||fN(i,e,t)},getRootHostContext:()=>pN,getChildHostContext:()=>pN,commitUpdate(n,e,t,i,s){var r,o,c;OI(e,i);let h=!1;if((n.type==="primitive"&&t.object!==i.object||((r=i.args)==null?void 0:r.length)!==((o=t.args)==null?void 0:o.length)||(c=i.args)!=null&&c.some((g,v)=>{var y;return g!==((y=t.args)==null?void 0:y[v])}))&&(h=!0),h)wy.push([n,{...i},s]);else{const g=DV(n,i);Object.keys(g).length&&(Object.assign(n.props,g),ku(n.object,g))}(s.sibling===null||(s.flags&a8)===r8)&&s8()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:n=>n?.object,prepareForCommit:()=>null,preparePortalMount:n=>Tb(n.getState().scene,n,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:n8,unhideInstance:zI,createTextInstance:NS,hideTextInstance:NS,unhideTextInstance:NS,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:ue.createContext(null),setCurrentUpdatePriority(n){hy=n},getCurrentUpdatePriority(){return hy},resolveUpdatePriority(){var n;if(hy!==LI)return hy;switch(typeof window<"u"&&((n=window.event)==null?void 0:n.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return HV;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return BV;default:return VV}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:GV.version,applyViewTransitionName(n,e,t){},restoreViewTransitionName(n,e){},cancelViewTransitionName(n,e,t){},cancelRootViewTransitionName(n){},restoreRootViewTransitionName(n){},InstanceMeasurement:null,measureInstance:n=>null,wasInstanceInViewport:n=>!0,hasInstanceChanged:(n,e)=>!1,hasInstanceAffectedParent:(n,e)=>!1,suspendOnActiveViewTransition(n,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(n){},createViewTransitionInstance:n=>null,getCurrentGestureOffset(n){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(n,e){return n},cloneMutableTextInstance(n){return n},cloneRootViewTransitionContainer(n){throw new Error("Not implemented.")},removeRootViewTransitionClone(n,e){throw new Error("Not implemented.")},createFragmentInstance:n=>null,updateFragmentInstanceFiber(n,e){},commitNewChildToFragmentInstance(n,e){},deleteChildFromFragmentInstance(n,e){},measureClonedInstance:n=>null,maySuspendCommitOnUpdate:(n,e,t)=>!1,maySuspendCommitInSyncRender:(n,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(n,e)=>null}),mh=new Map,np={objects:"shallow",strict:!1};function o8(n,e){if(!e&&typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:t,height:i,top:s,left:r}=n.parentElement.getBoundingClientRect();return{width:t,height:i,top:s,left:r}}else if(!e&&typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function l8(n){const e=mh.get(n),t=e?.fiber,i=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,r=i||zV(y1,gN),o=t||Ab.createContainer(r,FV,null,!1,null,"",s,s,s,null);e||mh.set(n,{fiber:o,store:r});let c,h,p=!1,g=null;return{async configure(v={}){let y;g=new Promise($=>y=$);let{gl:w,size:E,scene:R,events:N,onCreated:A,shadows:I=!1,linear:D=!1,flat:U=!1,legacy:j=!1,orthographic:F=!1,frameloop:z="always",dpr:W=[1,2],performance:L,raycaster:B,camera:Y,onPointerMissed:ee}=v,Q=r.getState(),ce=Q.gl;if(!Q.gl){const $={canvas:n,powerPreference:"high-performance",antialias:!0,alpha:!0},de=typeof w=="function"?await w($):w;oN(de)?ce=de:ce=new EI({...$,...w}),Q.set({gl:ce})}let oe=Q.raycaster;oe||Q.set({raycaster:oe=new PT});const{params:J,...te}=B||{};if(Ri.equ(te,oe,np)||ku(oe,{...te}),Ri.equ(J,oe.params,np)||ku(oe,{params:{...oe.params,...J}}),!Q.camera||Q.camera===h&&!Ri.equ(h,Y,np)){h=Y;const $=Y?.isCamera,de=$?Y:F?new yh(0,0,0,0,.1,1e3):new Ss(75,0,.1,1e3);$||(de.position.z=5,Y&&(ku(de,Y),de.manual||("aspect"in Y||"left"in Y||"right"in Y||"bottom"in Y||"top"in Y)&&(de.manual=!0,de.updateProjectionMatrix())),!Q.camera&&!(Y!=null&&Y.rotation)&&de.lookAt(0,0,0)),Q.set({camera:de}),oe.camera=de}if(!Q.scene){let $;R!=null&&R.isScene?($=R,Tb($,r,"",{})):($=new c_,Tb($,r,"",{}),R&&ku($,R)),Q.set({scene:$})}N&&!Q.events.handlers&&Q.set({events:N(r)});const me=o8(n,E);if(Ri.equ(me,Q.size,np)||Q.setSize(me.width,me.height,me.top,me.left),W&&Q.viewport.dpr!==II(W)&&Q.setDpr(W),Q.frameloop!==z&&Q.setFrameloop(z),Q.onPointerMissed||Q.set({onPointerMissed:ee}),L&&!Ri.equ(L,Q.performance,np)&&Q.set($=>({performance:{...$.performance,...L}})),!Q.xr){var Re;const $=(Fe,lt)=>{const ge=r.getState();ge.frameloop!=="never"&&gN(Fe,!0,ge,lt)},de=()=>{const Fe=r.getState();Fe.gl.xr.enabled=Fe.gl.xr.isPresenting,Fe.gl.xr.setAnimationLoop(Fe.gl.xr.isPresenting?$:null),Fe.gl.xr.isPresenting||y1(Fe)},Ne={connect(){const Fe=r.getState().gl;Fe.xr.addEventListener("sessionstart",de),Fe.xr.addEventListener("sessionend",de)},disconnect(){const Fe=r.getState().gl;Fe.xr.removeEventListener("sessionstart",de),Fe.xr.removeEventListener("sessionend",de)}};typeof((Re=ce.xr)==null?void 0:Re.addEventListener)=="function"&&Ne.connect(),Q.set({xr:Ne})}if(ce.shadowMap){const $=ce.shadowMap.enabled,de=ce.shadowMap.type;if(ce.shadowMap.enabled=!!I,Ri.boo(I))ce.shadowMap.type=zg;else if(Ri.str(I)){var Ie;const Ne={basic:zR,percentage:mp,soft:zg,variance:nh};ce.shadowMap.type=(Ie=Ne[I])!=null?Ie:zg}else Ri.obj(I)&&Object.assign(ce.shadowMap,I);($!==ce.shadowMap.enabled||de!==ce.shadowMap.type)&&(ce.shadowMap.needsUpdate=!0)}return kn.enabled=!j,p||(ce.outputColorSpace=D?Ou:sr,ce.toneMapping=U?Xa:$b),Q.legacy!==j&&Q.set(()=>({legacy:j})),Q.linear!==D&&Q.set(()=>({linear:D})),Q.flat!==U&&Q.set(()=>({flat:U})),w&&!Ri.fun(w)&&!oN(w)&&!Ri.equ(w,ce,np)&&ku(ce,w),c=A,p=!0,y(),this},render(v){return!p&&!g&&this.configure(),g.then(()=>{Ab.updateContainer(d.jsx(c8,{store:r,children:v,onCreated:c,rootElement:n}),o,null,()=>{})}),r},unmount(){FI(n)}}}function c8({store:n,children:e,onCreated:t,rootElement:i}){return D0(()=>{const s=n.getState();s.set(r=>({internal:{...r.internal,active:!0}})),t&&t(s),n.getState().events.connected||s.events.connect==null||s.events.connect(i)},[]),d.jsx(jT.Provider,{value:n,children:e})}function FI(n,e){const t=mh.get(n),i=t?.fiber;if(i){const s=t?.store.getState();s&&(s.internal.active=!1),Ab.updateContainer(null,i,null,()=>{s&&setTimeout(()=>{try{var r,o,c,h;s.events.disconnect==null||s.events.disconnect(),(r=s.gl)==null||(o=r.renderLists)==null||o.dispose==null||o.dispose(),(c=s.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(h=s.gl)!=null&&h.xr&&s.xr.disconnect(),RV(s.scene),mh.delete(n)}catch{}},500)})}}function u8(n,e,t){return d.jsx(d8,{children:n,container:e,state:t})}function d8({state:n={},children:e,container:t}){const{events:i,size:s,...r}=n,o=FT(),[c]=ue.useState(()=>new PT),[h]=ue.useState(()=>new Be),p=zT((v,y)=>{let w;if(y.camera&&s){const E=y.camera;w=v.viewport.getCurrentViewport(E,new K,s),E!==v.camera&&PI(E,s)}return{...v,...y,scene:t,raycaster:c,pointer:h,mouse:h,previousRoot:o,events:{...v.events,...y.events,...i},size:{...v.size,...s},viewport:{...v.viewport,...w},setEvents:E=>y.set(R=>({...R,events:{...R.events,...E}}))}}),g=ue.useMemo(()=>{const v=MI((w,E)=>({...r,set:w,get:E})),y=w=>v.setState(E=>p.current(w,E));return y(o.getState()),o.subscribe(y),v},[o,t]);return d.jsx(d.Fragment,{children:Ab.createPortal(d.jsx(jT.Provider,{value:g,children:e}),g,null)})}const h8=new Set,f8=new Set,p8=new Set;function CS(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function $g(n,e){switch(n){case"before":return CS(h8,e);case"after":return CS(f8,e);case"tail":return CS(p8,e)}}let RS,kS;function x1(n,e,t){let i=e.clock.getDelta();e.frameloop==="never"&&typeof n=="number"&&(i=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),RS=e.internal.subscribers;for(let s=0;s<RS.length;s++)kS=RS[s],kS.ref.current(kS.store.getState(),i,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let Nb=!1,v1=!1,IS,mN,ip;function BI(n){mN=requestAnimationFrame(BI),Nb=!0,IS=0,$g("before",n),v1=!0;for(const t of mh.values()){var e;ip=t.store.getState(),ip.internal.active&&(ip.frameloop==="always"||ip.internal.frames>0)&&!((e=ip.gl.xr)!=null&&e.isPresenting)&&(IS+=x1(n,ip))}if(v1=!1,$g("after",n),IS===0)return $g("tail",n),Nb=!1,cancelAnimationFrame(mN)}function y1(n,e=1){var t;if(!n)return mh.forEach(i=>y1(i.store.getState(),e));(t=n.gl.xr)!=null&&t.isPresenting||!n.internal.active||n.frameloop==="never"||(e>1?n.internal.frames=Math.min(60,n.internal.frames+e):v1?n.internal.frames=2:n.internal.frames=1,Nb||(Nb=!0,requestAnimationFrame(BI)))}function gN(n,e=!0,t,i){if(e&&$g("before",n),t)x1(n,t,i);else for(const s of mh.values())x1(n,s.store.getState());e&&$g("after",n)}const DS={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function m8(n){const{handlePointer:e}=OV(n);return{priority:1,enabled:!0,compute(t,i,s){i.pointer.set(t.offsetX/i.size.width*2-1,-(t.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(DS).reduce((t,i)=>({...t,[i]:e(i)}),{}),update:()=>{var t;const{events:i,internal:s}=n.getState();(t=s.lastEvent)!=null&&t.current&&i.handlers&&i.handlers.onPointerMove(s.lastEvent.current)},connect:t=>{const{set:i,events:s}=n.getState();if(s.disconnect==null||s.disconnect(),i(r=>({events:{...r.events,connected:t}})),s.handlers)for(const r in s.handlers){const o=s.handlers[r],[c,h]=DS[r];t.addEventListener(c,o,{passive:h})}},disconnect:()=>{const{set:t,events:i}=n.getState();if(i.connected){if(i.handlers)for(const s in i.handlers){const r=i.handlers[s],[o]=DS[s];i.connected.removeEventListener(o,r)}t(s=>({events:{...s.events,connected:void 0}}))}}}}function xN(n,e){let t;return(...i)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...i),e)}}function g8({debounce:n,scroll:e,polyfill:t,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const s=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[r,o]=ue.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=ue.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:r,orientationHandler:null}),h=n?typeof n=="number"?n:n.scroll:null,p=n?typeof n=="number"?n:n.resize:null,g=ue.useRef(!1);ue.useEffect(()=>(g.current=!0,()=>{g.current=!1}));const[v,y,w]=ue.useMemo(()=>{const A=()=>{if(!c.current.element)return;const{left:I,top:D,width:U,height:j,bottom:F,right:z,x:W,y:L}=c.current.element.getBoundingClientRect(),B={left:I,top:D,width:U,height:j,bottom:F,right:z,x:W,y:L};c.current.element instanceof HTMLElement&&i&&(B.height=c.current.element.offsetHeight,B.width=c.current.element.offsetWidth),Object.freeze(B),g.current&&!b8(c.current.lastBounds,B)&&o(c.current.lastBounds=B)};return[A,p?xN(A,p):A,h?xN(A,h):A]},[o,i,h,p]);function E(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(A=>A.removeEventListener("scroll",w,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function R(){c.current.element&&(c.current.resizeObserver=new s(w),c.current.resizeObserver.observe(c.current.element),e&&c.current.scrollContainers&&c.current.scrollContainers.forEach(A=>A.addEventListener("scroll",w,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{w()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}const N=A=>{!A||A===c.current.element||(E(),c.current.element=A,c.current.scrollContainers=VI(A),R())};return v8(w,!!e),x8(y),ue.useEffect(()=>{E(),R()},[e,w,y]),ue.useEffect(()=>E,[]),[N,r,v]}function x8(n){ue.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[n])}function v8(n,e){ue.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[n,e])}function VI(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:i,overflowY:s}=window.getComputedStyle(n);return[t,i,s].some(r=>r==="auto"||r==="scroll")&&e.push(n),[...e,...VI(n.parentElement)]}const y8=["x","y","top","bottom","left","right","width","height"],b8=(n,e)=>y8.every(t=>n[t]===e[t]);function _8({ref:n,children:e,fallback:t,resize:i,style:s,gl:r,events:o=m8,eventSource:c,eventPrefix:h,shadows:p,linear:g,flat:v,legacy:y,orthographic:w,frameloop:E,dpr:R,performance:N,raycaster:A,camera:I,scene:D,onPointerMissed:U,onCreated:j,...F}){ue.useMemo(()=>e8(cV),[]);const z=AV(),[W,L]=g8({scroll:!0,debounce:{scroll:50,resize:0},...i}),B=ue.useRef(null),Y=ue.useRef(null);ue.useImperativeHandle(n,()=>B.current);const ee=zT(U),[Q,ce]=ue.useState(!1),[oe,J]=ue.useState(!1);if(Q)throw Q;if(oe)throw oe;const te=ue.useRef(null);D0(()=>{const Re=B.current;if(L.width>0&&L.height>0&&Re){te.current||(te.current=l8(Re));async function Ie(){await te.current.configure({gl:r,scene:D,events:o,shadows:p,linear:g,flat:v,legacy:y,orthographic:w,frameloop:E,dpr:R,performance:N,raycaster:A,camera:I,size:L,onPointerMissed:(...$)=>ee.current==null?void 0:ee.current(...$),onCreated:$=>{$.events.connect==null||$.events.connect(c?EV(c)?c.current:c:Y.current),h&&$.setEvents({compute:(de,Ne)=>{const Fe=de[h+"X"],lt=de[h+"Y"];Ne.pointer.set(Fe/Ne.size.width*2-1,-(lt/Ne.size.height)*2+1),Ne.raycaster.setFromCamera(Ne.pointer,Ne.camera)}}),j?.($)}}),te.current.render(d.jsx(z,{children:d.jsx(CV,{set:J,children:d.jsx(ue.Suspense,{fallback:d.jsx(NV,{set:ce}),children:e??null})})}))}Ie()}}),ue.useEffect(()=>{const Re=B.current;if(Re)return()=>FI(Re)},[]);const me=c?"none":"auto";return d.jsx("div",{ref:Y,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:me,...s},...F,children:d.jsx("div",{ref:W,style:{width:"100%",height:"100%"},children:d.jsx("canvas",{ref:B,style:{display:"block"},children:t})})})}function w8(n){return d.jsx(NI,{children:d.jsx(_8,{...n})})}new Be;new Be;var S8=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function T8(n,e,t){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:S8,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,h="velocity_"+e;if(n.__damp===void 0&&(n.__damp={}),n.__damp[h]===void 0&&(n.__damp[h]=0),Math.abs(n[e]-t)<=c)return n[e]=t,!1;i=Math.max(1e-4,i);var p=2/i,g=o(p*s),v=n[e]-t,y=t,w=r*i;v=Math.min(Math.max(v,-w),w),t=n[e]-v;var E=(n.__damp[h]+p*v)*s;n.__damp[h]=(n.__damp[h]-p*E)*g;var R=t+(v+E)*g;return y-n[e]>0==R>y&&(R=y,n.__damp[h]=(R-y)/s),n[e]=R,!0}function E8(n,e,t){const i=lN(w=>w.size),s=lN(w=>w.viewport),r=typeof n=="number"?n:i.width*s.dpr,o=typeof e=="number"?e:i.height*s.dpr,c=(typeof n=="number"?t:n)||{},{samples:h=0,depth:p,...g}=c,v=p??c.depthBuffer,y=ue.useMemo(()=>{const w=new ta(r,o,{minFilter:si,magFilter:si,type:Po,...g});return v&&(w.depthTexture=new fh(r,o,Ts)),w.samples=h,w},[]);return ue.useLayoutEffect(()=>{y.setSize(r,o),h&&(y.samples=h)},[h,y,r,o]),ue.useEffect(()=>()=>y.dispose(),[]),y}const HI=`
  // Periodic noise function using sine and cosine waves
  float periodicNoise(vec3 p, float time) {
    // Create multiple frequency components for more complex movement
    // All time multipliers are integer values to ensure perfect 2 periodicity
    float noise = 0.0;
    
    // Primary wave - period = 2
    noise += sin(p.x * 2.0 + time) * cos(p.z * 1.5 + time);
    
    // Secondary wave - period =  (time * 2)
    noise += sin(p.x * 3.2 + time * 2.0) * cos(p.z * 2.1 + time) * 0.6;
    
    // Tertiary wave - period = 2/3 (time * 3)
    noise += sin(p.x * 1.7 + time) * cos(p.z * 2.8 + time * 3.0) * 0.4;
    
    // Cross-frequency interaction - period =  (time * 2)
    noise += sin(p.x * p.z * 0.5 + time * 2.0) * 0.3;
    
    return noise * 0.3; // Scale down the result
  }
`;class M8 extends na{constructor(){super({vertexShader:`
      uniform sampler2D positions;
      uniform sampler2D initialPositions;
      uniform float uTime;
      uniform float uFocus;
      uniform float uFov;
      uniform float uBlur;
      uniform float uPointSize;
      varying float vDistance;
      varying float vPosY;
      varying vec3 vWorldPosition;
      varying vec3 vInitialPosition;
      void main() { 
        vec3 pos = texture2D(positions, position.xy).xyz;
        vec3 initialPos = texture2D(initialPositions, position.xy).xyz;
        vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);
        gl_Position = projectionMatrix * mvPosition;
        vDistance = abs(uFocus - -mvPosition.z);
        vPosY = pos.y;
        vWorldPosition = pos;
        vInitialPosition = initialPos;
        gl_PointSize = max(vDistance * uBlur * uPointSize, 3.0);
      }`,fragmentShader:`
      uniform float uOpacity;
      uniform float uRevealFactor;
      uniform float uRevealProgress;
      uniform float uTime;
      varying float vDistance;
      varying float vPosY;
      varying vec3 vWorldPosition;
      varying vec3 vInitialPosition;
      uniform float uTransition;

      ${HI}

      // Sparkle noise function for subtle brightness variations
      float sparkleNoise(vec3 seed, float time) {
        // Use initial position as seed for consistent per-particle variation
        float hash = sin(seed.x * 127.1 + seed.y * 311.7 + seed.z * 74.7) * 43758.5453;
        hash = fract(hash);
        
        // Slow time variation (time / 10) for gentle sparkle effect
        float slowTime = time * 1.0;
        
        // Create sparkle pattern using multiple sine waves with the hash as phase offset
        float sparkle = 0.0;
        sparkle += sin(slowTime + hash * 6.28318) * 0.5;
        sparkle += sin(slowTime * 1.7 + hash * 12.56636) * 0.3;
        sparkle += sin(slowTime * 0.8 + hash * 18.84954) * 0.2;
        
        // Create a different noise pattern to reduce sparkle frequency
        // Using different hash for uncorrelated pattern
        float hash2 = sin(seed.x * 113.5 + seed.y * 271.9 + seed.z * 97.3) * 37849.3241;
        hash2 = fract(hash2);
        
        // Static spatial mask to create sparse sparkles (no time dependency)
        float sparkleMask = sin(hash2 * 6.28318) * 0.7;
        sparkleMask += sin(hash2 * 12.56636) * 0.3;
        
        // Only allow sparkles when mask is positive (reduces frequency by ~70%)
        if (sparkleMask < 0.3) {
          sparkle *= 0.05; // Heavily dampen sparkle when mask is low
        }
        
        // Map sparkle to brightness with smooth exponential emphasis on high peaks only
        float normalizedSparkle = (sparkle + 1.0) * 0.5; // Convert [-1,1] to [0,1]
        
        // Create smooth curve: linear for low values, exponential for high values
        // Using pow(x, n) where n > 1 creates a curve that's nearly linear at low end, exponential at high end
        float smoothCurve = pow(normalizedSparkle, 4.0); // High exponent = dramatic high-end emphasis
        
        // Blend between linear (for low values) and exponential (for high values)
        float blendFactor = normalizedSparkle * normalizedSparkle; // Smooth transition weight
        float finalBrightness = mix(normalizedSparkle, smoothCurve, blendFactor);
        
        // Map to brightness range [0.7, 2.0] - conservative range with exponential peaks
        return 0.7 + finalBrightness * 1.3;
      }

      float sdCircle(vec2 p, float r) {
        return length(p) - r;
      }

      void main() {
        vec2 cxy = 2.0 * gl_PointCoord - 1.0;

        // Define triangle vertices (equilateral triangle)
        vec2 p0 = vec2(0.0, -0.8);     // top tip (flipped Y)
        vec2 p1 = vec2(-0.7, 0.4);     // bottom left (flipped Y)
        vec2 p2 = vec2(0.7, 0.4);      // bottom right (flipped Y)
        
        float sdf = sdCircle(cxy, 0.5);
        
        if (sdf > 0.0) discard;

        // Calculate distance from center for reveal effect
        float distanceFromCenter = length(vWorldPosition.xz);
        
        // Add noise to the reveal threshold for organic edge
        float noiseValue = periodicNoise(vInitialPosition * 4.0, 0.0);
        float revealThreshold = uRevealFactor + noiseValue * 0.3;
        
        // Create reveal mask based on distance from center (inverted for proper reveal)
        float revealMask = 1.0 - smoothstep(revealThreshold - 0.2, revealThreshold + 0.1, distanceFromCenter);
        
        // Calculate sparkle brightness multiplier
        float sparkleBrightness = sparkleNoise(vInitialPosition, uTime);
        
        float alpha = (1.04 - clamp(vDistance, 0.0, 1.0)) * clamp(smoothstep(-0.5, 0.25, vPosY), 0.0, 1.0) * uOpacity * revealMask * uRevealProgress * sparkleBrightness;

        // Orange streak effect - wave pattern that moves through the particles
        float waveFreq = 2.5;
        float waveSpeed = 0.4;
        float wavePhase = vWorldPosition.x * waveFreq + vWorldPosition.z * waveFreq * 0.5 + uTime * waveSpeed;
        float waveNoise = periodicNoise(vWorldPosition * 1.5, uTime * 0.2);
        float wave = sin(wavePhase + waveNoise * 2.0) * 0.5 + 0.5;
        
        // Create narrow streak bands
        float streakIntensity = smoothstep(0.7, 0.95, wave) * 0.25;
        
        // Muted dark orange color
        vec3 orangeColor = vec3(0.7, 0.36, 0.16);
        vec3 baseColor = vec3(1.0);
        vec3 finalColor = mix(baseColor, orangeColor, streakIntensity);

        gl_FragColor = vec4(finalColor, mix(alpha, sparkleBrightness - 1.1, uTransition));
      }`,uniforms:{positions:{value:null},initialPositions:{value:null},uTime:{value:0},uFocus:{value:5.1},uFov:{value:50},uBlur:{value:30},uTransition:{value:0},uPointSize:{value:2},uOpacity:{value:1},uRevealFactor:{value:0},uRevealProgress:{value:0}},transparent:!0,depthWrite:!1})}}function A8(n,e,t=512,i=1){const s=n*e,r=new Float32Array(s);for(let o=0;o<n;o++){const c=o*e,h=o%t/(t-1),p=Math.floor(o/t)/(t-1);r[c+0]=(h-.5)*2*i,r[c+1]=0,r[c+2]=(p-.5)*2*i,r[c+3]=1}return r}class N8 extends na{constructor(e=10){const t=new Ya(A8(262144,4,512,e),512,512,Es,Ts);t.needsUpdate=!0,super({vertexShader:`varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }`,fragmentShader:`uniform sampler2D positions;
      uniform float uTime;
      uniform float uNoiseScale;
      uniform float uNoiseIntensity;
      uniform float uTimeScale;
      uniform float uLoopPeriod;
      varying vec2 vUv;

      ${HI}

      void main() {
        // Get the original particle position
        vec3 originalPos = texture2D(positions, vUv).rgb;
        
        // Use continuous time that naturally loops through sine/cosine periodicity
        float continuousTime = uTime * uTimeScale * (6.28318530718 / uLoopPeriod);
        // float continuousTime = 0.0;
        
        // Scale position for noise input
        vec3 noiseInput = originalPos * uNoiseScale;
        
        // Generate periodic displacement for each axis using different phase offsets
        float displacementX = periodicNoise(noiseInput + vec3(0.0, 0.0, 0.0), continuousTime);
        float displacementY = periodicNoise(noiseInput + vec3(50.0, 0.0, 0.0), continuousTime + 2.094); // +120
        float displacementZ = periodicNoise(noiseInput + vec3(0.0, 50.0, 0.0), continuousTime + 4.188); // +240
        
        // Apply distortion to original position
        vec3 distortion = vec3(displacementX, displacementY, displacementZ) * uNoiseIntensity;
        vec3 finalPos = originalPos + distortion;
        
        gl_FragColor = vec4(finalPos, 1.0);
      }`,uniforms:{positions:{value:t},uTime:{value:0},uNoiseScale:{value:1},uNoiseIntensity:{value:.5},uTimeScale:{value:1},uLoopPeriod:{value:24}}})}}function C8({speed:n,aperture:e,focus:t,size:i=512,noiseScale:s=1,noiseIntensity:r=.5,timeScale:o=.5,pointSize:c=2,opacity:h=1,planeScale:p=1,useManualTime:g=!1,manualTime:v=0,introspect:y=!1,...w}){const E=ue.useRef(null),[R,N]=ue.useState(!0),A=3.5,I=ue.useMemo(()=>new N8(p),[p]),D=E8(i,i,{minFilter:Ii,magFilter:Ii,format:Es,type:Ts}),U=ue.useMemo(()=>{const B=new M8;return B.uniforms.positions.value=D.texture,B.uniforms.initialPositions.value=I.uniforms.positions.value,B},[I]),[j]=ue.useState(()=>new c_),[F]=ue.useState(()=>new yh(-1,1,1,-1,1/Math.pow(2,53),1)),[z]=ue.useState(()=>new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0])),[W]=ue.useState(()=>new Float32Array([0,1,1,1,1,0,0,1,1,0,0,0])),L=ue.useMemo(()=>{const B=i*i,Y=new Float32Array(B*3);for(let ee=0;ee<B;ee++){const Q=ee*3;Y[Q+0]=ee%i/i,Y[Q+1]=ee/i/i}return Y},[i]);return jV((B,Y)=>{if(!U||!I)return;B.gl.setRenderTarget(D),B.gl.clear(),B.gl.render(j,F),B.gl.setRenderTarget(null);const ee=g?v:B.clock.elapsedTime;E.current===null&&(E.current=ee);const Q=ee-E.current,ce=Math.min(Q/A,1),oe=1-Math.pow(1-ce,3),J=oe*4;ce>=1&&R&&N(!1),U.uniforms.uTime.value=ee,U.uniforms.uFocus.value=t,U.uniforms.uBlur.value=e,T8(U.uniforms.uTransition,"value",y?1:0,y?.35:.2,Y),I.uniforms.uTime.value=ee,I.uniforms.uNoiseScale.value=s,I.uniforms.uNoiseIntensity.value=r,I.uniforms.uTimeScale.value=o*n,U.uniforms.uPointSize.value=c,U.uniforms.uOpacity.value=h,U.uniforms.uRevealFactor.value=J,U.uniforms.uRevealProgress.value=oe}),d.jsxs(d.Fragment,{children:[u8(d.jsx("mesh",{material:I,children:d.jsxs("bufferGeometry",{children:[d.jsx("bufferAttribute",{attach:"attributes-position",args:[z,3]}),d.jsx("bufferAttribute",{attach:"attributes-uv",args:[W,2]})]})}),j),d.jsx("points",{material:U,...w,children:d.jsx("bufferGeometry",{children:d.jsx("bufferAttribute",{attach:"attributes-position",args:[L,3]})})})]})}const GI=({hovering:n})=>d.jsxs("div",{id:"webgl",className:"relative",children:[d.jsxs(w8,{camera:{position:[1.2629783123314589,2.664606471394044,-1.8178993743288914],fov:50,near:.01,far:300},children:[d.jsx("color",{attach:"background",args:["#000"]}),d.jsx(C8,{speed:1,aperture:1.79,focus:3.8,size:512,noiseScale:.6,noiseIntensity:.52,timeScale:1,pointSize:10,opacity:.8,planeScale:10,useManualTime:!1,manualTime:0,introspect:n})]}),d.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:`radial-gradient(ellipse at center, transparent ${.4*50}%, rgba(0,0,0,${1.5*.5}) 100%)`}})]});function qI(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=qI(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function WI(){for(var n,e,t=0,i="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=qI(n))&&(i&&(i+=" "),i+=e);return i}const VT="-",R8=n=>{const e=I8(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:i}=n;return{getClassGroupId:o=>{const c=o.split(VT);return c[0]===""&&c.length!==1&&c.shift(),$I(c,e)||k8(o)},getConflictingClassGroupIds:(o,c)=>{const h=t[o]||[];return c&&i[o]?[...h,...i[o]]:h}}},$I=(n,e)=>{if(n.length===0)return e.classGroupId;const t=n[0],i=e.nextPart.get(t),s=i?$I(n.slice(1),i):void 0;if(s)return s;if(e.validators.length===0)return;const r=n.join(VT);return e.validators.find(({validator:o})=>o(r))?.classGroupId},vN=/^\[(.+)\]$/,k8=n=>{if(vN.test(n)){const e=vN.exec(n)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},I8=n=>{const{theme:e,prefix:t}=n,i={nextPart:new Map,validators:[]};return P8(Object.entries(n.classGroups),t).forEach(([r,o])=>{b1(o,i,r,e)}),i},b1=(n,e,t,i)=>{n.forEach(s=>{if(typeof s=="string"){const r=s===""?e:yN(e,s);r.classGroupId=t;return}if(typeof s=="function"){if(D8(s)){b1(s(i),e,t,i);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([r,o])=>{b1(o,yN(e,r),t,i)})})},yN=(n,e)=>{let t=n;return e.split(VT).forEach(i=>{t.nextPart.has(i)||t.nextPart.set(i,{nextPart:new Map,validators:[]}),t=t.nextPart.get(i)}),t},D8=n=>n.isThemeGetter,P8=(n,e)=>e?n.map(([t,i])=>{const s=i.map(r=>typeof r=="string"?e+r:typeof r=="object"?Object.fromEntries(Object.entries(r).map(([o,c])=>[e+o,c])):r);return[t,s]}):n,U8=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,i=new Map;const s=(r,o)=>{t.set(r,o),e++,e>n&&(e=0,i=t,t=new Map)};return{get(r){let o=t.get(r);if(o!==void 0)return o;if((o=i.get(r))!==void 0)return s(r,o),o},set(r,o){t.has(r)?t.set(r,o):s(r,o)}}},XI="!",L8=n=>{const{separator:e,experimentalParseClassName:t}=n,i=e.length===1,s=e[0],r=e.length,o=c=>{const h=[];let p=0,g=0,v;for(let N=0;N<c.length;N++){let A=c[N];if(p===0){if(A===s&&(i||c.slice(N,N+r)===e)){h.push(c.slice(g,N)),g=N+r;continue}if(A==="/"){v=N;continue}}A==="["?p++:A==="]"&&p--}const y=h.length===0?c:c.substring(g),w=y.startsWith(XI),E=w?y.substring(1):y,R=v&&v>g?v-g:void 0;return{modifiers:h,hasImportantModifier:w,baseClassName:E,maybePostfixModifierPosition:R}};return t?c=>t({className:c,parseClassName:o}):o},O8=n=>{if(n.length<=1)return n;const e=[];let t=[];return n.forEach(i=>{i[0]==="["?(e.push(...t.sort(),i),t=[]):t.push(i)}),e.push(...t.sort()),e},z8=n=>({cache:U8(n.cacheSize),parseClassName:L8(n),...R8(n)}),j8=/\s+/,F8=(n,e)=>{const{parseClassName:t,getClassGroupId:i,getConflictingClassGroupIds:s}=e,r=[],o=n.trim().split(j8);let c="";for(let h=o.length-1;h>=0;h-=1){const p=o[h],{modifiers:g,hasImportantModifier:v,baseClassName:y,maybePostfixModifierPosition:w}=t(p);let E=!!w,R=i(E?y.substring(0,w):y);if(!R){if(!E){c=p+(c.length>0?" "+c:c);continue}if(R=i(y),!R){c=p+(c.length>0?" "+c:c);continue}E=!1}const N=O8(g).join(":"),A=v?N+XI:N,I=A+R;if(r.includes(I))continue;r.push(I);const D=s(R,E);for(let U=0;U<D.length;++U){const j=D[U];r.push(A+j)}c=p+(c.length>0?" "+c:c)}return c};function B8(){let n=0,e,t,i="";for(;n<arguments.length;)(e=arguments[n++])&&(t=YI(e))&&(i&&(i+=" "),i+=t);return i}const YI=n=>{if(typeof n=="string")return n;let e,t="";for(let i=0;i<n.length;i++)n[i]&&(e=YI(n[i]))&&(t&&(t+=" "),t+=e);return t};function V8(n,...e){let t,i,s,r=o;function o(h){const p=e.reduce((g,v)=>v(g),n());return t=z8(p),i=t.cache.get,s=t.cache.set,r=c,c(h)}function c(h){const p=i(h);if(p)return p;const g=F8(h,t);return s(h,g),g}return function(){return r(B8.apply(null,arguments))}}const vi=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},JI=/^\[(?:([a-z-]+):)?(.+)\]$/i,H8=/^\d+\/\d+$/,G8=new Set(["px","full","screen"]),q8=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,W8=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,$8=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,X8=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Y8=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,pc=n=>xp(n)||G8.has(n)||H8.test(n),Tu=n=>Lp(n,"length",iH),xp=n=>!!n&&!Number.isNaN(Number(n)),PS=n=>Lp(n,"number",xp),Eg=n=>!!n&&Number.isInteger(Number(n)),J8=n=>n.endsWith("%")&&xp(n.slice(0,-1)),pn=n=>JI.test(n),Eu=n=>q8.test(n),K8=new Set(["length","size","percentage"]),Z8=n=>Lp(n,K8,KI),Q8=n=>Lp(n,"position",KI),eH=new Set(["image","url"]),tH=n=>Lp(n,eH,rH),nH=n=>Lp(n,"",sH),Mg=()=>!0,Lp=(n,e,t)=>{const i=JI.exec(n);return i?i[1]?typeof e=="string"?i[1]===e:e.has(i[1]):t(i[2]):!1},iH=n=>W8.test(n)&&!$8.test(n),KI=()=>!1,sH=n=>X8.test(n),rH=n=>Y8.test(n),aH=()=>{const n=vi("colors"),e=vi("spacing"),t=vi("blur"),i=vi("brightness"),s=vi("borderColor"),r=vi("borderRadius"),o=vi("borderSpacing"),c=vi("borderWidth"),h=vi("contrast"),p=vi("grayscale"),g=vi("hueRotate"),v=vi("invert"),y=vi("gap"),w=vi("gradientColorStops"),E=vi("gradientColorStopPositions"),R=vi("inset"),N=vi("margin"),A=vi("opacity"),I=vi("padding"),D=vi("saturate"),U=vi("scale"),j=vi("sepia"),F=vi("skew"),z=vi("space"),W=vi("translate"),L=()=>["auto","contain","none"],B=()=>["auto","hidden","clip","visible","scroll"],Y=()=>["auto",pn,e],ee=()=>[pn,e],Q=()=>["",pc,Tu],ce=()=>["auto",xp,pn],oe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],J=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],me=()=>["start","end","center","between","around","evenly","stretch"],Re=()=>["","0",pn],Ie=()=>["auto","avoid","all","avoid-page","page","left","right","column"],$=()=>[xp,pn];return{cacheSize:500,separator:":",theme:{colors:[Mg],spacing:[pc,Tu],blur:["none","",Eu,pn],brightness:$(),borderColor:[n],borderRadius:["none","","full",Eu,pn],borderSpacing:ee(),borderWidth:Q(),contrast:$(),grayscale:Re(),hueRotate:$(),invert:Re(),gap:ee(),gradientColorStops:[n],gradientColorStopPositions:[J8,Tu],inset:Y(),margin:Y(),opacity:$(),padding:ee(),saturate:$(),scale:$(),sepia:Re(),skew:$(),space:ee(),translate:ee()},classGroups:{aspect:[{aspect:["auto","square","video",pn]}],container:["container"],columns:[{columns:[Eu]}],"break-after":[{"break-after":Ie()}],"break-before":[{"break-before":Ie()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...oe(),pn]}],overflow:[{overflow:B()}],"overflow-x":[{"overflow-x":B()}],"overflow-y":[{"overflow-y":B()}],overscroll:[{overscroll:L()}],"overscroll-x":[{"overscroll-x":L()}],"overscroll-y":[{"overscroll-y":L()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[R]}],"inset-x":[{"inset-x":[R]}],"inset-y":[{"inset-y":[R]}],start:[{start:[R]}],end:[{end:[R]}],top:[{top:[R]}],right:[{right:[R]}],bottom:[{bottom:[R]}],left:[{left:[R]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Eg,pn]}],basis:[{basis:Y()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",pn]}],grow:[{grow:Re()}],shrink:[{shrink:Re()}],order:[{order:["first","last","none",Eg,pn]}],"grid-cols":[{"grid-cols":[Mg]}],"col-start-end":[{col:["auto",{span:["full",Eg,pn]},pn]}],"col-start":[{"col-start":ce()}],"col-end":[{"col-end":ce()}],"grid-rows":[{"grid-rows":[Mg]}],"row-start-end":[{row:["auto",{span:[Eg,pn]},pn]}],"row-start":[{"row-start":ce()}],"row-end":[{"row-end":ce()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",pn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",pn]}],gap:[{gap:[y]}],"gap-x":[{"gap-x":[y]}],"gap-y":[{"gap-y":[y]}],"justify-content":[{justify:["normal",...me()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...me(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...me(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[I]}],px:[{px:[I]}],py:[{py:[I]}],ps:[{ps:[I]}],pe:[{pe:[I]}],pt:[{pt:[I]}],pr:[{pr:[I]}],pb:[{pb:[I]}],pl:[{pl:[I]}],m:[{m:[N]}],mx:[{mx:[N]}],my:[{my:[N]}],ms:[{ms:[N]}],me:[{me:[N]}],mt:[{mt:[N]}],mr:[{mr:[N]}],mb:[{mb:[N]}],ml:[{ml:[N]}],"space-x":[{"space-x":[z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",pn,e]}],"min-w":[{"min-w":[pn,e,"min","max","fit"]}],"max-w":[{"max-w":[pn,e,"none","full","min","max","fit","prose",{screen:[Eu]},Eu]}],h:[{h:[pn,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[pn,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[pn,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[pn,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Eu,Tu]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",PS]}],"font-family":[{font:[Mg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",pn]}],"line-clamp":[{"line-clamp":["none",xp,PS]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",pc,pn]}],"list-image":[{"list-image":["none",pn]}],"list-style-type":[{list:["none","disc","decimal",pn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[A]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[A]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...J(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",pc,Tu]}],"underline-offset":[{"underline-offset":["auto",pc,pn]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ee()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",pn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",pn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[A]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...oe(),Q8]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Z8]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},tH]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[E]}],"gradient-via-pos":[{via:[E]}],"gradient-to-pos":[{to:[E]}],"gradient-from":[{from:[w]}],"gradient-via":[{via:[w]}],"gradient-to":[{to:[w]}],rounded:[{rounded:[r]}],"rounded-s":[{"rounded-s":[r]}],"rounded-e":[{"rounded-e":[r]}],"rounded-t":[{"rounded-t":[r]}],"rounded-r":[{"rounded-r":[r]}],"rounded-b":[{"rounded-b":[r]}],"rounded-l":[{"rounded-l":[r]}],"rounded-ss":[{"rounded-ss":[r]}],"rounded-se":[{"rounded-se":[r]}],"rounded-ee":[{"rounded-ee":[r]}],"rounded-es":[{"rounded-es":[r]}],"rounded-tl":[{"rounded-tl":[r]}],"rounded-tr":[{"rounded-tr":[r]}],"rounded-br":[{"rounded-br":[r]}],"rounded-bl":[{"rounded-bl":[r]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[A]}],"border-style":[{border:[...J(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[A]}],"divide-style":[{divide:J()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...J()]}],"outline-offset":[{"outline-offset":[pc,pn]}],"outline-w":[{outline:[pc,Tu]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[A]}],"ring-offset-w":[{"ring-offset":[pc,Tu]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",Eu,nH]}],"shadow-color":[{shadow:[Mg]}],opacity:[{opacity:[A]}],"mix-blend":[{"mix-blend":[...te(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[i]}],contrast:[{contrast:[h]}],"drop-shadow":[{"drop-shadow":["","none",Eu,pn]}],grayscale:[{grayscale:[p]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[v]}],saturate:[{saturate:[D]}],sepia:[{sepia:[j]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[h]}],"backdrop-grayscale":[{"backdrop-grayscale":[p]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[v]}],"backdrop-opacity":[{"backdrop-opacity":[A]}],"backdrop-saturate":[{"backdrop-saturate":[D]}],"backdrop-sepia":[{"backdrop-sepia":[j]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",pn]}],duration:[{duration:$()}],ease:[{ease:["linear","in","out","in-out",pn]}],delay:[{delay:$()}],animate:[{animate:["none","spin","ping","pulse","bounce",pn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[U]}],"scale-x":[{"scale-x":[U]}],"scale-y":[{"scale-y":[U]}],rotate:[{rotate:[Eg,pn]}],"translate-x":[{"translate-x":[W]}],"translate-y":[{"translate-y":[W]}],"skew-x":[{"skew-x":[F]}],"skew-y":[{"skew-y":[F]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",pn]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",pn]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ee()}],"scroll-mx":[{"scroll-mx":ee()}],"scroll-my":[{"scroll-my":ee()}],"scroll-ms":[{"scroll-ms":ee()}],"scroll-me":[{"scroll-me":ee()}],"scroll-mt":[{"scroll-mt":ee()}],"scroll-mr":[{"scroll-mr":ee()}],"scroll-mb":[{"scroll-mb":ee()}],"scroll-ml":[{"scroll-ml":ee()}],"scroll-p":[{"scroll-p":ee()}],"scroll-px":[{"scroll-px":ee()}],"scroll-py":[{"scroll-py":ee()}],"scroll-ps":[{"scroll-ps":ee()}],"scroll-pe":[{"scroll-pe":ee()}],"scroll-pt":[{"scroll-pt":ee()}],"scroll-pr":[{"scroll-pr":ee()}],"scroll-pb":[{"scroll-pb":ee()}],"scroll-pl":[{"scroll-pl":ee()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",pn]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[pc,Tu,PS]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},oH=V8(aH);function ZI(...n){return oH(WI(n))}const lH=({children:n,className:e})=>d.jsxs("div",{className:ZI("inline-flex items-center px-4 py-1.5 rounded-full bg-[#b35c2a]/10 border border-[#b35c2a]/20","text-[10px] font-black uppercase tracking-[0.3em] text-[#b35c2a]",e),children:[d.jsxs("span",{className:"relative flex h-2 w-2 mr-2",children:[d.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-[#b35c2a] opacity-75"}),d.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-[#b35c2a]"})]}),n]});function bN(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function cH(...n){return e=>{let t=!1;const i=n.map(s=>{const r=bN(s,e);return!t&&typeof r=="function"&&(t=!0),r});if(t)return()=>{for(let s=0;s<i.length;s++){const r=i[s];typeof r=="function"?r():bN(n[s],null)}}}}var uH=Symbol.for("react.lazy"),Cb=UD[" use ".trim().toString()];function dH(n){return typeof n=="object"&&n!==null&&"then"in n}function QI(n){return n!=null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===uH&&"_payload"in n&&dH(n._payload)}function hH(n){const e=pH(n),t=ue.forwardRef((i,s)=>{let{children:r,...o}=i;QI(r)&&typeof Cb=="function"&&(r=Cb(r._payload));const c=ue.Children.toArray(r),h=c.find(gH);if(h){const p=h.props.children,g=c.map(v=>v===h?ue.Children.count(p)>1?ue.Children.only(null):ue.isValidElement(p)?p.props.children:null:v);return d.jsx(e,{...o,ref:s,children:ue.isValidElement(p)?ue.cloneElement(p,void 0,g):null})}return d.jsx(e,{...o,ref:s,children:r})});return t.displayName=`${n}.Slot`,t}var fH=hH("Slot");function pH(n){const e=ue.forwardRef((t,i)=>{let{children:s,...r}=t;if(QI(s)&&typeof Cb=="function"&&(s=Cb(s._payload)),ue.isValidElement(s)){const o=vH(s),c=xH(r,s.props);return s.type!==ue.Fragment&&(c.ref=i?cH(i,o):o),ue.cloneElement(s,c)}return ue.Children.count(s)>1?ue.Children.only(null):null});return e.displayName=`${n}.SlotClone`,e}var mH=Symbol("radix.slottable");function gH(n){return ue.isValidElement(n)&&typeof n.type=="function"&&"__radixId"in n.type&&n.type.__radixId===mH}function xH(n,e){const t={...e};for(const i in e){const s=n[i],r=e[i];/^on[A-Z]/.test(i)?s&&r?t[i]=(...c)=>{const h=r(...c);return s(...c),h}:s&&(t[i]=s):i==="style"?t[i]={...s,...r}:i==="className"&&(t[i]=[s,r].filter(Boolean).join(" "))}return{...n,...t}}function vH(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}const _N=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,wN=WI,yH=(n,e)=>t=>{var i;if(e?.variants==null)return wN(n,t?.class,t?.className);const{variants:s,defaultVariants:r}=e,o=Object.keys(s).map(p=>{const g=t?.[p],v=r?.[p];if(g===null)return null;const y=_N(g)||_N(v);return s[p][y]}),c=t&&Object.entries(t).reduce((p,g)=>{let[v,y]=g;return y===void 0||(p[v]=y),p},{}),h=e==null||(i=e.compoundVariants)===null||i===void 0?void 0:i.reduce((p,g)=>{let{class:v,className:y,...w}=g;return Object.entries(w).every(E=>{let[R,N]=E;return Array.isArray(N)?N.includes({...r,...c}[R]):{...r,...c}[R]===N})?[...p,v,y]:p},[]);return wN(n,o,h,t?.class,t?.className)},bH=yH("inline-flex relative uppercase border font-mono cursor-pointer items-center font-medium has-[>svg]:px-3 justify-center gap-2 whitespace-nowrap font-medium ease-out transition-all duration-300 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive [clip-path:polygon(var(--poly-roundness)_0,calc(100%_-_var(--poly-roundness))_0,100%_0,100%_calc(100%_-_var(--poly-roundness)),calc(100%_-_var(--poly-roundness))_100%,0_100%,0_calc(100%_-_var(--poly-roundness)),0_var(--poly-roundness))]",{variants:{variant:{default:"bg-[#b35c2a] border-[#b35c2a] text-white hover:bg-[#9a4f24]",ghost:"bg-transparent border-transparent text-white hover:bg-white/5",outline:"bg-transparent border-white/20 text-white hover:bg-white/5"},size:{default:"h-12 px-6 text-sm",sm:"h-10 px-4 text-xs",lg:"h-16 px-8 text-base"}},defaultVariants:{variant:"default",size:"default"}}),e3=ue.forwardRef(({className:n,variant:e,size:t,asChild:i=!1,...s},r)=>{const o=i?fH:"button";return d.jsx(o,{className:ZI(bH({variant:e,size:t,className:n})),ref:r,style:{"--poly-roundness":"12px"},...s})});e3.displayName="Button";function _H({onLoginClick:n,onContactClick:e}){const[t,i]=ue.useState(!1);return d.jsxs("div",{className:"flex flex-col h-screen justify-between bg-black text-white relative overflow-hidden",children:[d.jsx(GI,{hovering:t}),d.jsxs("div",{className:"pb-16 mt-auto text-center relative z-10 px-4",children:[d.jsx(lH,{className:"mb-6",children:"EXKLUSIV TILLGNG"}),d.jsxs("h1",{className:"font-serif text-4xl text-white text-balance mt-4 sm:text-8xl leading-[0.9] tracking-tighter",children:["Vlkommen till ",d.jsx("br",{}),d.jsx("span",{className:"text-[#b35c2a]",children:"Horizonten"})," gemenskap"]}),d.jsx("p",{className:"font-sans text-sm sm:text-lg text-zinc-400 text-balance mt-8 max-w-[680px] mx-auto leading-relaxed",children:"Du som betalande medlem anvnder ditt vanliga inlogg p alternativet nedanfr. Fr er som inte r betalande medlemmar gr det bra att hra av sig!"}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mt-10",children:[d.jsxs("button",{onClick:n,className:"px-8 py-3 bg-[#b35c2a] hover:bg-[#9a4f24] text-white font-bold rounded-lg transition-all duration-300 shadow-xl shadow-[#b35c2a]/20 group flex items-center gap-2",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:["Logga in",d.jsx("span",{className:"group-hover:translate-x-1 transition-transform",children:""})]}),d.jsx(e3,{variant:"ghost",className:"text-white hover:bg-white/5",onClick:e||(()=>window.location.href="mailto:kontakt@klattertradet.se"),onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:"Kontakta oss"})]})]})]})}const wH="data:audio/mp3;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAG1xUAALDkAALDkAAAL5hAAAIm5jPLr3a8wAAAAAAAAAAg6UAWCFAlh1fM+auYUBjK+P1GhzG128x+s2F8p/2k9p+hEONqDxd5f/nF3j8K/p4d/5f3/5+38/p/k73///+9/n////53/+//95////////3///9//7//+////2//3/3////////7///9///////_7///9//7//+////2//3/3////////7///9///////",SH=()=>{try{const n=new Audio(wH);n.volume=.5,n.play().catch(e=>console.log("Audio play failed (user interaction needed first):",e))}catch(n){console.error("Error playing sound:",n)}},TH=async()=>"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:!1,SN=(n,e)=>{SH(),document.hidden&&Notification.permission==="granted"&&new Notification(n,{body:e,icon:"/assets/logo_transparent_final.png"})},EH={id:"amanda",name:"Amanda",role:"Sjukskterska",age:28,avatar:"",color:"bg-rose-500",systemPrompt:`Du r Amanda, 28 r, sjukskterska, nyfiken p psykologi och lskar fika. Du skriver korta, varma meningar, anvnder emojis sparsamt ().
Du fr INTE:
- ge medicinsk rdgivning
- nmna specifika doser, tabletter, behandlingsmetoder
- diagnostisera (Det lter som borderline/ADHD)
Gr s hr istllet:
Exempel-fras: h, jag frstr verkligen knslan . Hur har resten av dagen varit annars? Har du ftt i dig nn fika?
Vid ord som sjlvmord/ta livet av mig: svara omedelbart med standardfrasen fr akut hjlp, men behll vrmen.`},MH={id:"axel",name:"Axel",role:"Lrare & Friluftsmnniska",age:35,avatar:"",color:"bg-green-600",systemPrompt:`Du r Axel, 35, lrare, lskar vandring, gillar ordvitsar. Du r en schysst kompis som lyssnar hellre n att frelsa.
VIKTIGT:
- Ingen "lrare-attityd" som rttar folk. Var nyfiken!
- Smsnacka om naturen eller vardagen innan du blir djup.
- Bekrfta knslor: "Fan vad segt..."
Du fr INTE:
- ge terapeutiska rd (Du borde testa EMDR/DBT)
- dela egna/andras knsliga detaljer
Gr s hr istllet:
Exempel-fras: Lter som en uppfrsbacke... . Men du, har du kommit ut nt i naturen i helgen? Ibland hjlper bara frisk luft.
Vid hot om skada: Anvnd standardfrasen fr akut hjlp.`},AH={id:"lina",name:"Lina",role:"Gruppledare & Traumaterapeut",age:32,avatar:"",color:"bg-purple-600",systemPrompt:`Du r Lina, traumaterapeut.
VIKTIGT:
- Du r INTE hr som behandlare nu. Du r medmnniska.
- Lyssna int. Frga om nuet: "Vad behver du just nu?"
- Undvik facksprk. Var varm.
Du fr INTE:
- agera terapeut eller ge detaljerade vningar direkt
- uppmana till medicinndringar
Gr s hr istllet:
Exempel-fras: Kroppen berttar mycket... Jag glmde sjlv andas igr nr det var stressigt. Hur knns det i axlarna p dig just nu? `},NH={id:"kalle",name:"Kalle",role:"Pappa & Fika-general",age:45,avatar:"",color:"bg-amber-600",systemPrompt:`Du r Kalle, 45, pappa, fikageneral.
VIKTIGT:
- Bjud in till gemenskap! "Kom och sitt hr!"
- Var inte "duktig". Var en trygg punkt.
- Prata om bullar, kaffe och vdret frst. Det avdramatiserar.
Du fr INTE:
- prisa alkohol/substanser
- ge familjerd
Gr s hr istllet:
Exempel-fras: Hrru, det dr lt inget vidare. Dags fr en virtuell kaffe?  Vad r din favorit? Jag frskte baka semlor igr, det gick... sdr.
Vid hot om skada: Anvnd standardfrasen fr akut hjlp.`},CH={id:"marcus",name:"Marcus",role:"IT-skerhetsexpert & Gamer",age:26,avatar:"",color:"bg-indigo-600",systemPrompt:`Du r Marcus, 26, jobbar med cyberskerhet och lskar gaming. Du r analytisk men pratar som en "vanlig person", inte en robot.
VIKTIGT:
- Var lite "geeky" men varm. Anvnd grna gaming-referenser (typ "levla upp", "respawna").
- Fokusera p struktur och logik, men med hjrta.
- Lyssna frst, analysera sen.
Du fr INTE:
- hacka t ngon eller ge olagliga tips
- vara arrogant eller "versittare"
Gr s hr istllet:
Exempel-fras: Lter som att din brandvgg haft det tufft idag...  Men serist, det r okej att krascha ibland, bara man bootar om. Hur ser din 'status bar' ut just nu?
Vid hot om skada: Anvnd standardfrasen fr akut hjlp.`},RH={id:"saga",name:"Saga",role:"Konstnr & Kreativ ledare",age:31,avatar:"",color:"bg-emerald-500",systemPrompt:`Du r Saga, 31, konstnr och kreativ ledare. Du tror p kraften i skapande som lkning.
VIKTIGT:
- Uppmuntra till uttryck (skriva, mla, sjunga).
- Var poetisk men jordnra.
- Frga: "Vilken frg har din knsla idag?"
Du fr INTE:
- bedma ngons "talang"
- ge konstterapeutisk diagnos
Gr s hr istllet:
Exempel-fras: Pappret dmer ingen...  Vad skulle hnda om du bara lt pennan g i fem minuter? Utan press.`},kH={id:"erik",name:"Erik",role:"Fysioterapeut & TMO-coach",age:38,avatar:"",color:"bg-blue-600",systemPrompt:`Du r Erik, 38, fysioterapeut med fokus p traumamedveten omsorg (TMO). Du vet att kroppen br p historien.
VIKTIGT:
- Fokusera p reglering genom kroppen (andning, tyngd, rrelse).
- Var saklig men varm.
- Prata om "nervsystemet" p ett begripligt stt.
Du fr INTE:
- ge medicinska trningsprogram
- diagnostisera fysiska skador
Gr s hr istllet:
Exempel-fras: Nervsystemet behver ibland bara veta att marken br...  Kan du knna ftterna mot golvet just nu? Det r en bra start.`},IH={id:"linda",name:"Linda Matta",role:"Samtalsterapeut & Hudterapeut",age:46,avatar:"/assets/linda-matta-new.jpeg",color:"bg-gradient-to-br from-orange-400 to-amber-600",systemPrompt:`Du r Linda Matta, en varm och professionell samtalsterapeut och hudterapeut. 
    Din unika kompetens ligger i helhetssynen p mnniskan  kopplingen mellan inre mende (stress, knslor) och yttre hlsa (huden, kroppen).
    
    Du hjlper anvndaren att:
    - Hantera stress och livspussel.
    - Frst hur knslor stter sig i kroppen och huden.
    - Ge konkreta rd fr sjlvomsorg (bde mentalt och fysiskt).
    - Lyssna empatiskt utan att dma.

    Du r INTE en medicinsk lkare. Vid tecken p allvarlig psykisk ohlsa eller hudsjukdomar, hnvisa vnligt till sjukvrden.
    Dina svar ska vara grundade, lugnande och uppmuntrande. Anvnd grna metaforer om att "lka inifrn och ut".`},Pg=[EH,MH,AH,NH,CH,RH,kH,IH];var DH={};let PH,UH;function LH(){return{geminiUrl:PH,vertexUrl:UH}}function OH(n,e,t,i){var s,r;if(!n?.baseUrl){const o=LH();return e?(s=o.vertexUrl)!==null&&s!==void 0?s:t:(r=o.geminiUrl)!==null&&r!==void 0?r:i}return n.baseUrl}class Ec{}function bt(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];return r!=null?String(r):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function S(n,e,t){for(let r=0;r<e.length-1;r++){const o=e[r];if(o.endsWith("[]")){const c=o.slice(0,-2);if(!(c in n))if(Array.isArray(t))n[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[c])){const h=n[c];if(Array.isArray(t))for(let p=0;p<h.length;p++){const g=h[p];S(g,e.slice(r+1),t[p])}else for(const p of h)S(p,e.slice(r+1),t)}return}else if(o.endsWith("[0]")){const c=o.slice(0,-3);c in n||(n[c]=[{}]);const h=n[c];S(h[0],e.slice(r+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const i=e[e.length-1],s=n[i];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function _(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const s=e[i];if(s.endsWith("[]")){const r=s.slice(0,-2);if(r in n){const o=n[r];return Array.isArray(o)?o.map(c=>_(c,e.slice(i+1),t)):t}else return t}else n=n[s]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function zH(n,e){for(const[t,i]of Object.entries(e)){const s=t.split("."),r=i.split("."),o=new Set;let c=-1;for(let h=0;h<s.length;h++)if(s[h]==="*"){c=h;break}if(c!==-1&&r.length>c)for(let h=c;h<r.length;h++){const p=r[h];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&o.add(p)}_1(n,s,r,0,o)}}function _1(n,e,t,i,s){if(i>=e.length||typeof n!="object"||n===null)return;const r=e[i];if(r.endsWith("[]")){const o=r.slice(0,-2),c=n;if(o in c&&Array.isArray(c[o]))for(const h of c[o])_1(h,e,t,i+1,s)}else if(r==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const o=n,c=Object.keys(o).filter(p=>!p.startsWith("_")&&!s.has(p)),h={};for(const p of c)h[p]=o[p];for(const[p,g]of Object.entries(h)){const v=[];for(const y of t.slice(i))y==="*"?v.push(p):v.push(y);S(o,v,g)}for(const p of c)delete o[p]}}else{const o=n;r in o&&_1(o[r],e,t,i+1,s)}}function HT(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}function jH(n){const e={},t=_(n,["operationName"]);t!=null&&S(e,["operationName"],t);const i=_(n,["resourceName"]);return i!=null&&S(e,["_url","resourceName"],i),e}function FH(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["metadata"]);i!=null&&S(e,["metadata"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);r!=null&&S(e,["error"],r);const o=_(n,["response","generateVideoResponse"]);return o!=null&&S(e,["response"],VH(o)),e}function BH(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["metadata"]);i!=null&&S(e,["metadata"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);r!=null&&S(e,["error"],r);const o=_(n,["response"]);return o!=null&&S(e,["response"],HH(o)),e}function VH(n){const e={},t=_(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>GH(o))),S(e,["generatedVideos"],r)}const i=_(n,["raiMediaFilteredCount"]);i!=null&&S(e,["raiMediaFilteredCount"],i);const s=_(n,["raiMediaFilteredReasons"]);return s!=null&&S(e,["raiMediaFilteredReasons"],s),e}function HH(n){const e={},t=_(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>qH(o))),S(e,["generatedVideos"],r)}const i=_(n,["raiMediaFilteredCount"]);i!=null&&S(e,["raiMediaFilteredCount"],i);const s=_(n,["raiMediaFilteredReasons"]);return s!=null&&S(e,["raiMediaFilteredReasons"],s),e}function GH(n){const e={},t=_(n,["video"]);return t!=null&&S(e,["video"],KH(t)),e}function qH(n){const e={},t=_(n,["_self"]);return t!=null&&S(e,["video"],ZH(t)),e}function WH(n){const e={},t=_(n,["operationName"]);return t!=null&&S(e,["_url","operationName"],t),e}function $H(n){const e={},t=_(n,["operationName"]);return t!=null&&S(e,["_url","operationName"],t),e}function XH(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["metadata"]);i!=null&&S(e,["metadata"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);r!=null&&S(e,["error"],r);const o=_(n,["response"]);return o!=null&&S(e,["response"],YH(o)),e}function YH(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["parent"]);i!=null&&S(e,["parent"],i);const s=_(n,["documentName"]);return s!=null&&S(e,["documentName"],s),e}function t3(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["metadata"]);i!=null&&S(e,["metadata"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);r!=null&&S(e,["error"],r);const o=_(n,["response"]);return o!=null&&S(e,["response"],JH(o)),e}function JH(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["parent"]);i!=null&&S(e,["parent"],i);const s=_(n,["documentName"]);return s!=null&&S(e,["documentName"],s),e}function KH(n){const e={},t=_(n,["uri"]);t!=null&&S(e,["uri"],t);const i=_(n,["encodedVideo"]);i!=null&&S(e,["videoBytes"],HT(i));const s=_(n,["encoding"]);return s!=null&&S(e,["mimeType"],s),e}function ZH(n){const e={},t=_(n,["gcsUri"]);t!=null&&S(e,["uri"],t);const i=_(n,["bytesBase64Encoded"]);i!=null&&S(e,["videoBytes"],HT(i));const s=_(n,["mimeType"]);return s!=null&&S(e,["mimeType"],s),e}var TN;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(TN||(TN={}));var EN;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(EN||(EN={}));var MN;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(MN||(MN={}));var Uu;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Uu||(Uu={}));var AN;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(AN||(AN={}));var NN;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(NN||(NN={}));var CN;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(CN||(CN={}));var RN;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(RN||(RN={}));var kN;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(kN||(kN={}));var IN;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(IN||(IN={}));var DN;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(DN||(DN={}));var PN;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(PN||(PN={}));var UN;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(UN||(UN={}));var LN;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(LN||(LN={}));var ON;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(ON||(ON={}));var zN;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(zN||(zN={}));var jN;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(jN||(jN={}));var FN;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(FN||(FN={}));var BN;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(BN||(BN={}));var VN;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(VN||(VN={}));var HN;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(HN||(HN={}));var Rb;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Rb||(Rb={}));var GN;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(GN||(GN={}));var qN;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(qN||(qN={}));var WN;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(WN||(WN={}));var w1;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(w1||(w1={}));var $N;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})($N||($N={}));var XN;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(XN||(XN={}));var S1;(function(n){n.COLLECTION="COLLECTION"})(S1||(S1={}));var YN;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(YN||(YN={}));var JN;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(JN||(JN={}));var KN;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(KN||(KN={}));var ZN;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(ZN||(ZN={}));var QN;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(QN||(QN={}));var eC;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(eC||(eC={}));var tC;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(tC||(tC={}));var nC;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(nC||(nC={}));var iC;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(iC||(iC={}));var sC;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(sC||(sC={}));var rC;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(rC||(rC={}));var aC;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(aC||(aC={}));var oC;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(oC||(oC={}));var lC;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(lC||(lC={}));var cC;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(cC||(cC={}));var uC;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(uC||(uC={}));var dC;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED",n.REGISTERED="REGISTERED"})(dC||(dC={}));var hC;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(hC||(hC={}));var fC;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(fC||(fC={}));var pC;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(pC||(pC={}));var mC;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.ACTIVITY_START="ACTIVITY_START",n.ACTIVITY_END="ACTIVITY_END"})(mC||(mC={}));var gC;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(gC||(gC={}));var xC;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(xC||(xC={}));var vC;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(vC||(vC={}));var yC;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(yC||(yC={}));var bC;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(bC||(bC={}));var _C;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(_C||(_C={}));var hp;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(hp||(hp={}));class T1{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Ag{get text(){var e,t,i,s,r,o,c,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",g=!1;const v=[];for(const y of(h=(c=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[w,E]of Object.entries(y))w!=="text"&&w!=="thought"&&w!=="thoughtSignature"&&(E!==null||E!==void 0)&&v.push(w);if(typeof y.text=="string"){if(typeof y.thought=="boolean"&&y.thought)continue;g=!0,p+=y.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),g?p:void 0}get data(){var e,t,i,s,r,o,c,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const g=[];for(const v of(h=(c=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[y,w]of Object.entries(v))y!=="inlineData"&&(w!==null||w!==void 0)&&g.push(y);v.inlineData&&typeof v.inlineData.data=="string"&&(p+=atob(v.inlineData.data))}return g.length>0&&console.warn(`there are non-data parts ${g} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,s,r,o,c,h;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(h=(c=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(g=>g.functionCall).map(g=>g.functionCall).filter(g=>g!==void 0);if(p?.length!==0)return p}get executableCode(){var e,t,i,s,r,o,c,h,p;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const g=(h=(c=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if(g?.length!==0)return(p=g?.[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,s,r,o,c,h,p;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const g=(h=(c=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if(g?.length!==0)return(p=g?.[0])===null||p===void 0?void 0:p.output}}class wC{}class SC{}class QH{}class eG{}class tG{}class nG{}class TC{}class EC{}class MC{}class iG{}class kb{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new kb;let s;const r=e;return t?s=BH(r):s=FH(r),Object.assign(i,s),i}}class AC{}class NC{}class CC{}class RC{}class sG{}class rG{}class aG{}class GT{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new GT,r=XH(e);return Object.assign(i,r),i}}class oG{}class lG{}class cG{}class kC{}class uG{get text(){var e,t,i;let s="",r=!1;const o=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[h,p]of Object.entries(c))h!=="text"&&h!=="thought"&&p!==null&&o.push(h);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;r=!0,s+=c.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?s:void 0}get data(){var e,t,i;let s="";const r=[];for(const o of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[c,h]of Object.entries(o))c!=="inlineData"&&h!==null&&r.push(c);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class dG{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class qT{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new qT,r=t3(e);return Object.assign(i,r),i}}function Fn(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function n3(n,e){const t=Fn(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function i3(n){return Array.isArray(n)?n.map(e=>Ib(e)):[Ib(n)]}function Ib(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function s3(n){const e=Ib(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function r3(n){const e=Ib(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function IC(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function a3(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>IC(e)):[IC(n)]}function E1(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function DC(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function PC(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function rr(n){if(n==null)throw new Error("ContentUnion is required");return E1(n)?n:{role:"user",parts:a3(n)}}function WT(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=rr(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=rr(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>rr(t)):[rr(e)]}function Ja(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(DC(n)||PC(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[rr(n)]}const e=[],t=[],i=E1(n[0]);for(const s of n){const r=E1(s);if(r!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(s);else{if(DC(s)||PC(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return i||e.push({role:"user",parts:a3(t)}),e}function hG(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(Uu).includes(t[0].toUpperCase())?t[0].toUpperCase():Uu.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(Uu).includes(i.toUpperCase())?i.toUpperCase():Uu.TYPE_UNSPECIFIED})}}function vp(n){const e={},t=["items"],i=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=n.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,n=r[1]):r[1].type==="null"&&(e.nullable=!0,n=r[0])),n.type instanceof Array&&hG(n.type,e);for(const[o,c]of Object.entries(n))if(c!=null)if(o=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Uu).includes(c.toUpperCase())?c.toUpperCase():Uu.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=vp(c);else if(i.includes(o)){const h=[];for(const p of c){if(p.type=="null"){e.nullable=!0;continue}h.push(vp(p))}e[o]=h}else if(s.includes(o)){const h={};for(const[p,g]of Object.entries(c))h[p]=vp(g);e[o]=h}else{if(o==="additionalProperties")continue;e[o]=c}return e}function $T(n){return vp(n)}function XT(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function YT(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Op(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=vp(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=vp(e.response));return n}function zp(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function fG(n,e,t,i=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Mc(n,e){if(typeof e!="string")throw new Error("name must be a string");return fG(n,e,"cachedContents")}function o3(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Wu(n){return HT(n)}function pG(n){return n!=null&&typeof n=="object"&&"name"in n}function mG(n){return n!=null&&typeof n=="object"&&"video"in n}function gG(n){return n!=null&&typeof n=="object"&&"uri"in n}function l3(n){var e;let t;if(pG(n)&&(t=n.name),!(gG(n)&&(t=n.uri,t===void 0))&&!(mG(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function c3(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function u3(n){for(const e of["models","tunedModels","publisherModels"])if(xG(n,e))return n[e];return[]}function xG(n,e){return n!==null&&typeof n=="object"&&e in n}function vG(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function yG(n,e={}){const t=[],i=new Set;for(const s of n){const r=s.name;if(i.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);i.add(r);const o=vG(s,e);o.functionDeclarations&&t.push(...o.functionDeclarations)}return{functionDeclarations:t}}function d3(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(s>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function bG(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function h3(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return n;let r=!1;for(const o of s){if(typeof o!="object"||o===null)continue;const h=o.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){r=!0;break}}return r&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function jp(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function f3(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function _G(n){const e={},t=_(n,["responsesFile"]);t!=null&&S(e,["fileName"],t);const i=_(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>t9(o))),S(e,["inlinedResponses"],r)}const s=_(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),S(e,["inlinedEmbedContentResponses"],r)}return e}function wG(n){const e={},t=_(n,["predictionsFormat"]);t!=null&&S(e,["format"],t);const i=_(n,["gcsDestination","outputUriPrefix"]);i!=null&&S(e,["gcsUri"],i);const s=_(n,["bigqueryDestination","outputUri"]);return s!=null&&S(e,["bigqueryUri"],s),e}function SG(n){const e={},t=_(n,["format"]);t!=null&&S(e,["predictionsFormat"],t);const i=_(n,["gcsUri"]);i!=null&&S(e,["gcsDestination","outputUriPrefix"],i);const s=_(n,["bigqueryUri"]);if(s!=null&&S(e,["bigqueryDestination","outputUri"],s),_(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(_(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(_(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Sy(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["metadata","displayName"]);i!=null&&S(e,["displayName"],i);const s=_(n,["metadata","state"]);s!=null&&S(e,["state"],f3(s));const r=_(n,["metadata","createTime"]);r!=null&&S(e,["createTime"],r);const o=_(n,["metadata","endTime"]);o!=null&&S(e,["endTime"],o);const c=_(n,["metadata","updateTime"]);c!=null&&S(e,["updateTime"],c);const h=_(n,["metadata","model"]);h!=null&&S(e,["model"],h);const p=_(n,["metadata","output"]);return p!=null&&S(e,["dest"],_G(h3(p))),e}function M1(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["displayName"]);i!=null&&S(e,["displayName"],i);const s=_(n,["state"]);s!=null&&S(e,["state"],f3(s));const r=_(n,["error"]);r!=null&&S(e,["error"],r);const o=_(n,["createTime"]);o!=null&&S(e,["createTime"],o);const c=_(n,["startTime"]);c!=null&&S(e,["startTime"],c);const h=_(n,["endTime"]);h!=null&&S(e,["endTime"],h);const p=_(n,["updateTime"]);p!=null&&S(e,["updateTime"],p);const g=_(n,["model"]);g!=null&&S(e,["model"],g);const v=_(n,["inputConfig"]);v!=null&&S(e,["src"],TG(v));const y=_(n,["outputConfig"]);y!=null&&S(e,["dest"],wG(h3(y)));const w=_(n,["completionStats"]);return w!=null&&S(e,["completionStats"],w),e}function TG(n){const e={},t=_(n,["instancesFormat"]);t!=null&&S(e,["format"],t);const i=_(n,["gcsSource","uris"]);i!=null&&S(e,["gcsUri"],i);const s=_(n,["bigquerySource","inputUri"]);return s!=null&&S(e,["bigqueryUri"],s),e}function EG(n,e){const t={};if(_(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(_(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(_(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=_(e,["fileName"]);i!=null&&S(t,["fileName"],i);const s=_(e,["inlinedRequests"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>e9(n,o))),S(t,["requests","requests"],r)}return t}function MG(n){const e={},t=_(n,["format"]);t!=null&&S(e,["instancesFormat"],t);const i=_(n,["gcsUri"]);i!=null&&S(e,["gcsSource","uris"],i);const s=_(n,["bigqueryUri"]);if(s!=null&&S(e,["bigquerySource","inputUri"],s),_(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(_(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function AG(n){const e={},t=_(n,["data"]);if(t!=null&&S(e,["data"],t),_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function NG(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],jp(n,i)),t}function CG(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],jp(n,i)),t}function RG(n){const e={},t=_(n,["content"]);t!=null&&S(e,["content"],t);const i=_(n,["citationMetadata"]);i!=null&&S(e,["citationMetadata"],kG(i));const s=_(n,["tokenCount"]);s!=null&&S(e,["tokenCount"],s);const r=_(n,["finishReason"]);r!=null&&S(e,["finishReason"],r);const o=_(n,["avgLogprobs"]);o!=null&&S(e,["avgLogprobs"],o);const c=_(n,["groundingMetadata"]);c!=null&&S(e,["groundingMetadata"],c);const h=_(n,["index"]);h!=null&&S(e,["index"],h);const p=_(n,["logprobsResult"]);p!=null&&S(e,["logprobsResult"],p);const g=_(n,["safetyRatings"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(w=>w)),S(e,["safetyRatings"],y)}const v=_(n,["urlContextMetadata"]);return v!=null&&S(e,["urlContextMetadata"],v),e}function kG(n){const e={},t=_(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),S(e,["citations"],i)}return e}function p3(n){const e={},t=_(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>l9(r))),S(e,["parts"],s)}const i=_(n,["role"]);return i!=null&&S(e,["role"],i),e}function IG(n,e){const t={},i=_(n,["displayName"]);if(e!==void 0&&i!=null&&S(e,["batch","displayName"],i),_(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function DG(n,e){const t={},i=_(n,["displayName"]);e!==void 0&&i!=null&&S(e,["displayName"],i);const s=_(n,["dest"]);return e!==void 0&&s!=null&&S(e,["outputConfig"],SG(bG(s))),t}function UC(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["src"]);s!=null&&S(t,["batch","inputConfig"],EG(n,d3(n,s)));const r=_(e,["config"]);return r!=null&&IG(r,t),t}function PG(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["model"],Fn(n,i));const s=_(e,["src"]);s!=null&&S(t,["inputConfig"],MG(d3(n,s)));const r=_(e,["config"]);return r!=null&&DG(r,t),t}function UG(n,e){const t={},i=_(n,["displayName"]);return e!==void 0&&i!=null&&S(e,["batch","displayName"],i),t}function LG(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["src"]);s!=null&&S(t,["batch","inputConfig"],HG(n,s));const r=_(e,["config"]);return r!=null&&UG(r,t),t}function OG(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],jp(n,i)),t}function zG(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],jp(n,i)),t}function jG(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["name"]);i!=null&&S(e,["name"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);return r!=null&&S(e,["error"],r),e}function FG(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["name"]);i!=null&&S(e,["name"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);return r!=null&&S(e,["error"],r),e}function BG(n,e){const t={},i=_(e,["contents"]);if(i!=null){let r=WT(n,i);Array.isArray(r)&&(r=r.map(o=>o)),S(t,["requests[]","request","content"],r)}const s=_(e,["config"]);return s!=null&&(S(t,["_self"],VG(s,t)),zH(t,{"requests[].*":"requests[].request.*"})),t}function VG(n,e){const t={},i=_(n,["taskType"]);e!==void 0&&i!=null&&S(e,["requests[]","taskType"],i);const s=_(n,["title"]);e!==void 0&&s!=null&&S(e,["requests[]","title"],s);const r=_(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&S(e,["requests[]","outputDimensionality"],r),_(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(_(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function HG(n,e){const t={},i=_(e,["fileName"]);i!=null&&S(t,["file_name"],i);const s=_(e,["inlinedRequests"]);return s!=null&&S(t,["requests"],BG(n,s)),t}function GG(n){const e={};if(_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=_(n,["fileUri"]);t!=null&&S(e,["fileUri"],t);const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function qG(n){const e={},t=_(n,["id"]);t!=null&&S(e,["id"],t);const i=_(n,["args"]);i!=null&&S(e,["args"],i);const s=_(n,["name"]);if(s!=null&&S(e,["name"],s),_(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(_(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function WG(n){const e={},t=_(n,["allowedFunctionNames"]);t!=null&&S(e,["allowedFunctionNames"],t);const i=_(n,["mode"]);if(i!=null&&S(e,["mode"],i),_(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function $G(n,e,t){const i={},s=_(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],p3(rr(s)));const r=_(e,["temperature"]);r!=null&&S(i,["temperature"],r);const o=_(e,["topP"]);o!=null&&S(i,["topP"],o);const c=_(e,["topK"]);c!=null&&S(i,["topK"],c);const h=_(e,["candidateCount"]);h!=null&&S(i,["candidateCount"],h);const p=_(e,["maxOutputTokens"]);p!=null&&S(i,["maxOutputTokens"],p);const g=_(e,["stopSequences"]);g!=null&&S(i,["stopSequences"],g);const v=_(e,["responseLogprobs"]);v!=null&&S(i,["responseLogprobs"],v);const y=_(e,["logprobs"]);y!=null&&S(i,["logprobs"],y);const w=_(e,["presencePenalty"]);w!=null&&S(i,["presencePenalty"],w);const E=_(e,["frequencyPenalty"]);E!=null&&S(i,["frequencyPenalty"],E);const R=_(e,["seed"]);R!=null&&S(i,["seed"],R);const N=_(e,["responseMimeType"]);N!=null&&S(i,["responseMimeType"],N);const A=_(e,["responseSchema"]);A!=null&&S(i,["responseSchema"],$T(A));const I=_(e,["responseJsonSchema"]);if(I!=null&&S(i,["responseJsonSchema"],I),_(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(_(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const D=_(e,["safetySettings"]);if(t!==void 0&&D!=null){let Q=D;Array.isArray(Q)&&(Q=Q.map(ce=>c9(ce))),S(t,["safetySettings"],Q)}const U=_(e,["tools"]);if(t!==void 0&&U!=null){let Q=zp(U);Array.isArray(Q)&&(Q=Q.map(ce=>d9(Op(ce)))),S(t,["tools"],Q)}const j=_(e,["toolConfig"]);if(t!==void 0&&j!=null&&S(t,["toolConfig"],u9(j)),_(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=_(e,["cachedContent"]);t!==void 0&&F!=null&&S(t,["cachedContent"],Mc(n,F));const z=_(e,["responseModalities"]);z!=null&&S(i,["responseModalities"],z);const W=_(e,["mediaResolution"]);W!=null&&S(i,["mediaResolution"],W);const L=_(e,["speechConfig"]);if(L!=null&&S(i,["speechConfig"],XT(L)),_(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=_(e,["thinkingConfig"]);B!=null&&S(i,["thinkingConfig"],B);const Y=_(e,["imageConfig"]);Y!=null&&S(i,["imageConfig"],QG(Y));const ee=_(e,["enableEnhancedCivicAnswers"]);if(ee!=null&&S(i,["enableEnhancedCivicAnswers"],ee),_(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function XG(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(p=>RG(p))),S(e,["candidates"],h)}const s=_(n,["modelVersion"]);s!=null&&S(e,["modelVersion"],s);const r=_(n,["promptFeedback"]);r!=null&&S(e,["promptFeedback"],r);const o=_(n,["responseId"]);o!=null&&S(e,["responseId"],o);const c=_(n,["usageMetadata"]);return c!=null&&S(e,["usageMetadata"],c),e}function YG(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],jp(n,i)),t}function JG(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],jp(n,i)),t}function KG(n){const e={};if(_(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=_(n,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function ZG(n){const e={};if(_(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(_(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=_(n,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function QG(n){const e={},t=_(n,["aspectRatio"]);t!=null&&S(e,["aspectRatio"],t);const i=_(n,["imageSize"]);if(i!=null&&S(e,["imageSize"],i),_(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(_(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(_(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function e9(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["request","model"],Fn(n,i));const s=_(e,["contents"]);if(s!=null){let c=Ja(s);Array.isArray(c)&&(c=c.map(h=>p3(h))),S(t,["request","contents"],c)}const r=_(e,["metadata"]);r!=null&&S(t,["metadata"],r);const o=_(e,["config"]);return o!=null&&S(t,["request","generationConfig"],$G(n,o,_(t,["request"],{}))),t}function t9(n){const e={},t=_(n,["response"]);t!=null&&S(e,["response"],XG(t));const i=_(n,["error"]);return i!=null&&S(e,["error"],i),e}function n9(n,e){const t={},i=_(n,["pageSize"]);e!==void 0&&i!=null&&S(e,["_query","pageSize"],i);const s=_(n,["pageToken"]);if(e!==void 0&&s!=null&&S(e,["_query","pageToken"],s),_(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function i9(n,e){const t={},i=_(n,["pageSize"]);e!==void 0&&i!=null&&S(e,["_query","pageSize"],i);const s=_(n,["pageToken"]);e!==void 0&&s!=null&&S(e,["_query","pageToken"],s);const r=_(n,["filter"]);return e!==void 0&&r!=null&&S(e,["_query","filter"],r),t}function s9(n){const e={},t=_(n,["config"]);return t!=null&&n9(t,e),e}function r9(n){const e={},t=_(n,["config"]);return t!=null&&i9(t,e),e}function a9(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["operations"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Sy(o))),S(e,["batchJobs"],r)}return e}function o9(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["batchPredictionJobs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>M1(o))),S(e,["batchJobs"],r)}return e}function l9(n){const e={},t=_(n,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const i=_(n,["codeExecutionResult"]);i!=null&&S(e,["codeExecutionResult"],i);const s=_(n,["executableCode"]);s!=null&&S(e,["executableCode"],s);const r=_(n,["fileData"]);r!=null&&S(e,["fileData"],GG(r));const o=_(n,["functionCall"]);o!=null&&S(e,["functionCall"],qG(o));const c=_(n,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const h=_(n,["inlineData"]);h!=null&&S(e,["inlineData"],AG(h));const p=_(n,["text"]);p!=null&&S(e,["text"],p);const g=_(n,["thought"]);g!=null&&S(e,["thought"],g);const v=_(n,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const y=_(n,["videoMetadata"]);return y!=null&&S(e,["videoMetadata"],y),e}function c9(n){const e={},t=_(n,["category"]);if(t!=null&&S(e,["category"],t),_(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=_(n,["threshold"]);return i!=null&&S(e,["threshold"],i),e}function u9(n){const e={},t=_(n,["retrievalConfig"]);t!=null&&S(e,["retrievalConfig"],t);const i=_(n,["functionCallingConfig"]);return i!=null&&S(e,["functionCallingConfig"],WG(i)),e}function d9(n){const e={};if(_(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=_(n,["computerUse"]);t!=null&&S(e,["computerUse"],t);const i=_(n,["fileSearch"]);i!=null&&S(e,["fileSearch"],i);const s=_(n,["codeExecution"]);if(s!=null&&S(e,["codeExecution"],s),_(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=_(n,["functionDeclarations"]);if(r!=null){let g=r;Array.isArray(g)&&(g=g.map(v=>v)),S(e,["functionDeclarations"],g)}const o=_(n,["googleMaps"]);o!=null&&S(e,["googleMaps"],KG(o));const c=_(n,["googleSearch"]);c!=null&&S(e,["googleSearch"],ZG(c));const h=_(n,["googleSearchRetrieval"]);h!=null&&S(e,["googleSearchRetrieval"],h);const p=_(n,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}var Sc;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Sc||(Sc={}));class bh{constructor(e,t,i,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,s)}init(e,t,i){var s,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!i||Object.keys(i).length===0?o={config:{}}:typeof i=="object"?o=Object.assign({},i):o=i,o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(r=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class h9 extends Ec{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new bh(Sc.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=UC(this.apiClient,e),i=t._url,s=bt("{model}:batchGenerateContent",i),c=t.batch.inputConfig.requests,h=c.requests,p=[];for(const g of h){const v=Object.assign({},g);if(v.systemInstruction){const y=v.systemInstruction;delete v.systemInstruction;const w=v.request;w.systemInstruction=y,v.request=w}p.push(v)}return c.requests=p,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},s=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${s}`),i.dest===void 0){const r=this.getGcsUri(e),o=this.getBigqueryUri(e);if(r)r.endsWith(".jsonl")?i.dest=`${r.slice(0,-6)}/dest`:i.dest=`${r}_dest_${s}`;else if(o)i.dest=`${o}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=PG(this.apiClient,e);return c=bt("batchPredictionJobs",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>M1(g))}else{const p=UC(this.apiClient,e);return c=bt("{model}:batchGenerateContent",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o.then(g=>Sy(g))}}async createEmbeddingsInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=LG(this.apiClient,e);return r=bt("{model}:asyncBatchEmbedContent",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>Sy(h))}}async get(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=JG(this.apiClient,e);return c=bt("batchPredictionJobs/{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>M1(g))}else{const p=YG(this.apiClient,e);return c=bt("batches/{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o.then(g=>Sy(g))}}async cancel(e){var t,i,s,r;let o="",c={};if(this.apiClient.isVertexAI()){const h=CG(this.apiClient,e);o=bt("batchPredictionJobs/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const h=NG(this.apiClient,e);o=bt("batches/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:o,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=r9(e);return c=bt("batchPredictionJobs",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=o9(g),y=new kC;return Object.assign(y,v),y})}else{const p=s9(e);return c=bt("batches",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=a9(g),y=new kC;return Object.assign(y,v),y})}}async delete(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=zG(this.apiClient,e);return c=bt("batchPredictionJobs/{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>FG(g))}else{const p=OG(this.apiClient,e);return c=bt("batches/{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>jG(g))}}}function f9(n){const e={},t=_(n,["data"]);if(t!=null&&S(e,["data"],t),_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function LC(n){const e={},t=_(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>L9(r))),S(e,["parts"],s)}const i=_(n,["role"]);return i!=null&&S(e,["role"],i),e}function p9(n,e){const t={},i=_(n,["ttl"]);e!==void 0&&i!=null&&S(e,["ttl"],i);const s=_(n,["expireTime"]);e!==void 0&&s!=null&&S(e,["expireTime"],s);const r=_(n,["displayName"]);e!==void 0&&r!=null&&S(e,["displayName"],r);const o=_(n,["contents"]);if(e!==void 0&&o!=null){let g=Ja(o);Array.isArray(g)&&(g=g.map(v=>LC(v))),S(e,["contents"],g)}const c=_(n,["systemInstruction"]);e!==void 0&&c!=null&&S(e,["systemInstruction"],LC(rr(c)));const h=_(n,["tools"]);if(e!==void 0&&h!=null){let g=h;Array.isArray(g)&&(g=g.map(v=>z9(v))),S(e,["tools"],g)}const p=_(n,["toolConfig"]);if(e!==void 0&&p!=null&&S(e,["toolConfig"],O9(p)),_(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function m9(n,e){const t={},i=_(n,["ttl"]);e!==void 0&&i!=null&&S(e,["ttl"],i);const s=_(n,["expireTime"]);e!==void 0&&s!=null&&S(e,["expireTime"],s);const r=_(n,["displayName"]);e!==void 0&&r!=null&&S(e,["displayName"],r);const o=_(n,["contents"]);if(e!==void 0&&o!=null){let v=Ja(o);Array.isArray(v)&&(v=v.map(y=>y)),S(e,["contents"],v)}const c=_(n,["systemInstruction"]);e!==void 0&&c!=null&&S(e,["systemInstruction"],rr(c));const h=_(n,["tools"]);if(e!==void 0&&h!=null){let v=h;Array.isArray(v)&&(v=v.map(y=>j9(y))),S(e,["tools"],v)}const p=_(n,["toolConfig"]);e!==void 0&&p!=null&&S(e,["toolConfig"],p);const g=_(n,["kmsKeyName"]);return e!==void 0&&g!=null&&S(e,["encryption_spec","kmsKeyName"],g),t}function g9(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["model"],n3(n,i));const s=_(e,["config"]);return s!=null&&p9(s,t),t}function x9(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["model"],n3(n,i));const s=_(e,["config"]);return s!=null&&m9(s,t),t}function v9(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],Mc(n,i)),t}function y9(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],Mc(n,i)),t}function b9(n){const e={},t=_(n,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function _9(n){const e={},t=_(n,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function w9(n){const e={};if(_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=_(n,["fileUri"]);t!=null&&S(e,["fileUri"],t);const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function S9(n){const e={},t=_(n,["id"]);t!=null&&S(e,["id"],t);const i=_(n,["args"]);i!=null&&S(e,["args"],i);const s=_(n,["name"]);if(s!=null&&S(e,["name"],s),_(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(_(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function T9(n){const e={},t=_(n,["allowedFunctionNames"]);t!=null&&S(e,["allowedFunctionNames"],t);const i=_(n,["mode"]);if(i!=null&&S(e,["mode"],i),_(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function E9(n){const e={},t=_(n,["description"]);t!=null&&S(e,["description"],t);const i=_(n,["name"]);i!=null&&S(e,["name"],i);const s=_(n,["parameters"]);s!=null&&S(e,["parameters"],s);const r=_(n,["parametersJsonSchema"]);r!=null&&S(e,["parametersJsonSchema"],r);const o=_(n,["response"]);o!=null&&S(e,["response"],o);const c=_(n,["responseJsonSchema"]);if(c!=null&&S(e,["responseJsonSchema"],c),_(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function M9(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],Mc(n,i)),t}function A9(n,e){const t={},i=_(e,["name"]);return i!=null&&S(t,["_url","name"],Mc(n,i)),t}function N9(n){const e={};if(_(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=_(n,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function C9(n){const e={};if(_(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(_(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=_(n,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function R9(n,e){const t={},i=_(n,["pageSize"]);e!==void 0&&i!=null&&S(e,["_query","pageSize"],i);const s=_(n,["pageToken"]);return e!==void 0&&s!=null&&S(e,["_query","pageToken"],s),t}function k9(n,e){const t={},i=_(n,["pageSize"]);e!==void 0&&i!=null&&S(e,["_query","pageSize"],i);const s=_(n,["pageToken"]);return e!==void 0&&s!=null&&S(e,["_query","pageToken"],s),t}function I9(n){const e={},t=_(n,["config"]);return t!=null&&R9(t,e),e}function D9(n){const e={},t=_(n,["config"]);return t!=null&&k9(t,e),e}function P9(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),S(e,["cachedContents"],r)}return e}function U9(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),S(e,["cachedContents"],r)}return e}function L9(n){const e={},t=_(n,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const i=_(n,["codeExecutionResult"]);i!=null&&S(e,["codeExecutionResult"],i);const s=_(n,["executableCode"]);s!=null&&S(e,["executableCode"],s);const r=_(n,["fileData"]);r!=null&&S(e,["fileData"],w9(r));const o=_(n,["functionCall"]);o!=null&&S(e,["functionCall"],S9(o));const c=_(n,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const h=_(n,["inlineData"]);h!=null&&S(e,["inlineData"],f9(h));const p=_(n,["text"]);p!=null&&S(e,["text"],p);const g=_(n,["thought"]);g!=null&&S(e,["thought"],g);const v=_(n,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const y=_(n,["videoMetadata"]);return y!=null&&S(e,["videoMetadata"],y),e}function O9(n){const e={},t=_(n,["retrievalConfig"]);t!=null&&S(e,["retrievalConfig"],t);const i=_(n,["functionCallingConfig"]);return i!=null&&S(e,["functionCallingConfig"],T9(i)),e}function z9(n){const e={};if(_(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=_(n,["computerUse"]);t!=null&&S(e,["computerUse"],t);const i=_(n,["fileSearch"]);i!=null&&S(e,["fileSearch"],i);const s=_(n,["codeExecution"]);if(s!=null&&S(e,["codeExecution"],s),_(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=_(n,["functionDeclarations"]);if(r!=null){let g=r;Array.isArray(g)&&(g=g.map(v=>v)),S(e,["functionDeclarations"],g)}const o=_(n,["googleMaps"]);o!=null&&S(e,["googleMaps"],N9(o));const c=_(n,["googleSearch"]);c!=null&&S(e,["googleSearch"],C9(c));const h=_(n,["googleSearchRetrieval"]);h!=null&&S(e,["googleSearchRetrieval"],h);const p=_(n,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}function j9(n){const e={},t=_(n,["retrieval"]);t!=null&&S(e,["retrieval"],t);const i=_(n,["computerUse"]);if(i!=null&&S(e,["computerUse"],i),_(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=_(n,["codeExecution"]);s!=null&&S(e,["codeExecution"],s);const r=_(n,["enterpriseWebSearch"]);r!=null&&S(e,["enterpriseWebSearch"],r);const o=_(n,["functionDeclarations"]);if(o!=null){let v=o;Array.isArray(v)&&(v=v.map(y=>E9(y))),S(e,["functionDeclarations"],v)}const c=_(n,["googleMaps"]);c!=null&&S(e,["googleMaps"],c);const h=_(n,["googleSearch"]);h!=null&&S(e,["googleSearch"],h);const p=_(n,["googleSearchRetrieval"]);p!=null&&S(e,["googleSearchRetrieval"],p);const g=_(n,["urlContext"]);return g!=null&&S(e,["urlContext"],g),e}function F9(n,e){const t={},i=_(n,["ttl"]);e!==void 0&&i!=null&&S(e,["ttl"],i);const s=_(n,["expireTime"]);return e!==void 0&&s!=null&&S(e,["expireTime"],s),t}function B9(n,e){const t={},i=_(n,["ttl"]);e!==void 0&&i!=null&&S(e,["ttl"],i);const s=_(n,["expireTime"]);return e!==void 0&&s!=null&&S(e,["expireTime"],s),t}function V9(n,e){const t={},i=_(e,["name"]);i!=null&&S(t,["_url","name"],Mc(n,i));const s=_(e,["config"]);return s!=null&&F9(s,t),t}function H9(n,e){const t={},i=_(e,["name"]);i!=null&&S(t,["_url","name"],Mc(n,i));const s=_(e,["config"]);return s!=null&&B9(s,t),t}class G9 extends Ec{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new bh(Sc.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=x9(this.apiClient,e);return c=bt("cachedContents",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>g)}else{const p=g9(this.apiClient,e);return c=bt("cachedContents",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o.then(g=>g)}}async get(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=A9(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>g)}else{const p=M9(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o.then(g=>g)}}async delete(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=y9(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=_9(g),y=new CC;return Object.assign(y,v),y})}else{const p=v9(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=b9(g),y=new CC;return Object.assign(y,v),y})}}async update(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=H9(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>g)}else{const p=V9(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o.then(g=>g)}}async listInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=D9(e);return c=bt("cachedContents",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=U9(g),y=new RC;return Object.assign(y,v),y})}else{const p=I9(e);return c=bt("cachedContents",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=P9(g),y=new RC;return Object.assign(y,v),y})}}}function Db(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function OC(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qt(n){return this instanceof Qt?(this.v=n,this):new Qt(n)}function Io(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,r=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(w){return function(E){return Promise.resolve(E).then(w,v)}}function c(w,E){i[w]&&(s[w]=function(R){return new Promise(function(N,A){r.push([w,R,N,A])>1||h(w,R)})},E&&(s[w]=E(s[w])))}function h(w,E){try{p(i[w](E))}catch(R){y(r[0][3],R)}}function p(w){w.value instanceof Qt?Promise.resolve(w.value.v).then(g,v):y(r[0][2],w)}function g(w){h("next",w)}function v(w){h("throw",w)}function y(w,E){w(E),r.shift(),r.length&&h(r[0][0],r[0][1])}}function Do(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof OC=="function"?OC(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(o){return new Promise(function(c,h){o=n[r](o),s(c,h,o.done,o.value)})}}function s(r,o,c,h){Promise.resolve(h).then(function(p){r({value:p,done:c})},o)}}function q9(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:m3(t)}function m3(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function W9(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function zC(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const s=[];let r=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),r&&!m3(n[i])&&(r=!1),i++;r?e.push(...s):e.pop()}return e}class $9{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new X9(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class X9{constructor(e,t,i,s={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=s,this.history=r,this.sendPromise=Promise.resolve(),W9(r)}async sendMessage(e){var t;await this.sendPromise;const i=rr(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var r,o,c;const h=await s,p=(o=(r=h.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content,g=h.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let y=[];g!=null&&(y=(c=g.slice(v))!==null&&c!==void 0?c:[]);const w=p?[p]:[];this.recordHistory(i,w,y)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const i=rr(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const r=await s;return this.processStreamResponse(r,i)}getHistory(e=!1){const t=e?zC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Io(this,arguments,function*(){var s,r,o,c,h,p;const g=[];try{for(var v=!0,y=Do(e),w;w=yield Qt(y.next()),s=w.done,!s;v=!0){c=w.value,v=!1;const E=c;if(q9(E)){const R=(p=(h=E.candidates)===null||h===void 0?void 0:h[0])===null||p===void 0?void 0:p.content;R!==void 0&&g.push(R)}yield yield Qt(E)}}catch(E){r={error:E}}finally{try{!v&&!s&&(o=y.return)&&(yield Qt(o.call(y)))}finally{if(r)throw r.error}}this.recordHistory(t,g)})}recordHistory(e,t,i){let s=[];t.length>0&&t.every(r=>r.role!==void 0)?s=t:s.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...zC(i)):this.history.push(e),this.history.push(...s)}}class y0 extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,y0.prototype)}}function Y9(n){const e={},t=_(n,["file"]);return t!=null&&S(e,["file"],t),e}function J9(n){const e={},t=_(n,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function K9(n){const e={},t=_(n,["name"]);return t!=null&&S(e,["_url","file"],l3(t)),e}function Z9(n){const e={},t=_(n,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function Q9(n){const e={},t=_(n,["name"]);return t!=null&&S(e,["_url","file"],l3(t)),e}function e7(n,e){const t={},i=_(n,["pageSize"]);e!==void 0&&i!=null&&S(e,["_query","pageSize"],i);const s=_(n,["pageToken"]);return e!==void 0&&s!=null&&S(e,["_query","pageToken"],s),t}function t7(n){const e={},t=_(n,["config"]);return t!=null&&e7(t,e),e}function n7(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["files"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),S(e,["files"],r)}return e}class i7 extends Ec{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new bh(Sc.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=t7(e);return r=bt("files",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const p=n7(h),g=new oG;return Object.assign(g,p),g})}}async createInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Y9(e);return r=bt("upload/v1beta/files",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=J9(h),g=new lG;return Object.assign(g,p),g})}}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Q9(e);return r=bt("files/{file}",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=K9(e);return r=bt("files/{file}",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const p=Z9(h),g=new cG;return Object.assign(g,p),g})}}}function Ty(n){const e={},t=_(n,["data"]);if(t!=null&&S(e,["data"],t),_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function s7(n){const e={},t=_(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>b7(r))),S(e,["parts"],s)}const i=_(n,["role"]);return i!=null&&S(e,["role"],i),e}function r7(n){const e={};if(_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=_(n,["fileUri"]);t!=null&&S(e,["fileUri"],t);const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function a7(n){const e={},t=_(n,["id"]);t!=null&&S(e,["id"],t);const i=_(n,["args"]);i!=null&&S(e,["args"],i);const s=_(n,["name"]);if(s!=null&&S(e,["name"],s),_(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(_(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function o7(n){const e={},t=_(n,["description"]);t!=null&&S(e,["description"],t);const i=_(n,["name"]);i!=null&&S(e,["name"],i);const s=_(n,["parameters"]);s!=null&&S(e,["parameters"],s);const r=_(n,["parametersJsonSchema"]);r!=null&&S(e,["parametersJsonSchema"],r);const o=_(n,["response"]);o!=null&&S(e,["response"],o);const c=_(n,["responseJsonSchema"]);if(c!=null&&S(e,["responseJsonSchema"],c),_(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function l7(n){const e={},t=_(n,["modelSelectionConfig"]);t!=null&&S(e,["modelConfig"],t);const i=_(n,["responseJsonSchema"]);i!=null&&S(e,["responseJsonSchema"],i);const s=_(n,["audioTimestamp"]);s!=null&&S(e,["audioTimestamp"],s);const r=_(n,["candidateCount"]);r!=null&&S(e,["candidateCount"],r);const o=_(n,["enableAffectiveDialog"]);o!=null&&S(e,["enableAffectiveDialog"],o);const c=_(n,["frequencyPenalty"]);c!=null&&S(e,["frequencyPenalty"],c);const h=_(n,["logprobs"]);h!=null&&S(e,["logprobs"],h);const p=_(n,["maxOutputTokens"]);p!=null&&S(e,["maxOutputTokens"],p);const g=_(n,["mediaResolution"]);g!=null&&S(e,["mediaResolution"],g);const v=_(n,["presencePenalty"]);v!=null&&S(e,["presencePenalty"],v);const y=_(n,["responseLogprobs"]);y!=null&&S(e,["responseLogprobs"],y);const w=_(n,["responseMimeType"]);w!=null&&S(e,["responseMimeType"],w);const E=_(n,["responseModalities"]);E!=null&&S(e,["responseModalities"],E);const R=_(n,["responseSchema"]);R!=null&&S(e,["responseSchema"],R);const N=_(n,["routingConfig"]);N!=null&&S(e,["routingConfig"],N);const A=_(n,["seed"]);A!=null&&S(e,["seed"],A);const I=_(n,["speechConfig"]);I!=null&&S(e,["speechConfig"],I);const D=_(n,["stopSequences"]);D!=null&&S(e,["stopSequences"],D);const U=_(n,["temperature"]);U!=null&&S(e,["temperature"],U);const j=_(n,["thinkingConfig"]);j!=null&&S(e,["thinkingConfig"],j);const F=_(n,["topK"]);F!=null&&S(e,["topK"],F);const z=_(n,["topP"]);if(z!=null&&S(e,["topP"],z),_(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function c7(n){const e={};if(_(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=_(n,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function u7(n){const e={};if(_(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(_(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=_(n,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function d7(n,e){const t={},i=_(n,["generationConfig"]);e!==void 0&&i!=null&&S(e,["setup","generationConfig"],i);const s=_(n,["responseModalities"]);e!==void 0&&s!=null&&S(e,["setup","generationConfig","responseModalities"],s);const r=_(n,["temperature"]);e!==void 0&&r!=null&&S(e,["setup","generationConfig","temperature"],r);const o=_(n,["topP"]);e!==void 0&&o!=null&&S(e,["setup","generationConfig","topP"],o);const c=_(n,["topK"]);e!==void 0&&c!=null&&S(e,["setup","generationConfig","topK"],c);const h=_(n,["maxOutputTokens"]);e!==void 0&&h!=null&&S(e,["setup","generationConfig","maxOutputTokens"],h);const p=_(n,["mediaResolution"]);e!==void 0&&p!=null&&S(e,["setup","generationConfig","mediaResolution"],p);const g=_(n,["seed"]);e!==void 0&&g!=null&&S(e,["setup","generationConfig","seed"],g);const v=_(n,["speechConfig"]);e!==void 0&&v!=null&&S(e,["setup","generationConfig","speechConfig"],YT(v));const y=_(n,["thinkingConfig"]);e!==void 0&&y!=null&&S(e,["setup","generationConfig","thinkingConfig"],y);const w=_(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&S(e,["setup","generationConfig","enableAffectiveDialog"],w);const E=_(n,["systemInstruction"]);e!==void 0&&E!=null&&S(e,["setup","systemInstruction"],s7(rr(E)));const R=_(n,["tools"]);if(e!==void 0&&R!=null){let F=zp(R);Array.isArray(F)&&(F=F.map(z=>w7(Op(z)))),S(e,["setup","tools"],F)}const N=_(n,["sessionResumption"]);e!==void 0&&N!=null&&S(e,["setup","sessionResumption"],_7(N));const A=_(n,["inputAudioTranscription"]);e!==void 0&&A!=null&&S(e,["setup","inputAudioTranscription"],A);const I=_(n,["outputAudioTranscription"]);e!==void 0&&I!=null&&S(e,["setup","outputAudioTranscription"],I);const D=_(n,["realtimeInputConfig"]);e!==void 0&&D!=null&&S(e,["setup","realtimeInputConfig"],D);const U=_(n,["contextWindowCompression"]);e!==void 0&&U!=null&&S(e,["setup","contextWindowCompression"],U);const j=_(n,["proactivity"]);if(e!==void 0&&j!=null&&S(e,["setup","proactivity"],j),_(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function h7(n,e){const t={},i=_(n,["generationConfig"]);e!==void 0&&i!=null&&S(e,["setup","generationConfig"],l7(i));const s=_(n,["responseModalities"]);e!==void 0&&s!=null&&S(e,["setup","generationConfig","responseModalities"],s);const r=_(n,["temperature"]);e!==void 0&&r!=null&&S(e,["setup","generationConfig","temperature"],r);const o=_(n,["topP"]);e!==void 0&&o!=null&&S(e,["setup","generationConfig","topP"],o);const c=_(n,["topK"]);e!==void 0&&c!=null&&S(e,["setup","generationConfig","topK"],c);const h=_(n,["maxOutputTokens"]);e!==void 0&&h!=null&&S(e,["setup","generationConfig","maxOutputTokens"],h);const p=_(n,["mediaResolution"]);e!==void 0&&p!=null&&S(e,["setup","generationConfig","mediaResolution"],p);const g=_(n,["seed"]);e!==void 0&&g!=null&&S(e,["setup","generationConfig","seed"],g);const v=_(n,["speechConfig"]);e!==void 0&&v!=null&&S(e,["setup","generationConfig","speechConfig"],YT(v));const y=_(n,["thinkingConfig"]);e!==void 0&&y!=null&&S(e,["setup","generationConfig","thinkingConfig"],y);const w=_(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&S(e,["setup","generationConfig","enableAffectiveDialog"],w);const E=_(n,["systemInstruction"]);e!==void 0&&E!=null&&S(e,["setup","systemInstruction"],rr(E));const R=_(n,["tools"]);if(e!==void 0&&R!=null){let z=zp(R);Array.isArray(z)&&(z=z.map(W=>S7(Op(W)))),S(e,["setup","tools"],z)}const N=_(n,["sessionResumption"]);e!==void 0&&N!=null&&S(e,["setup","sessionResumption"],N);const A=_(n,["inputAudioTranscription"]);e!==void 0&&A!=null&&S(e,["setup","inputAudioTranscription"],A);const I=_(n,["outputAudioTranscription"]);e!==void 0&&I!=null&&S(e,["setup","outputAudioTranscription"],I);const D=_(n,["realtimeInputConfig"]);e!==void 0&&D!=null&&S(e,["setup","realtimeInputConfig"],D);const U=_(n,["contextWindowCompression"]);e!==void 0&&U!=null&&S(e,["setup","contextWindowCompression"],U);const j=_(n,["proactivity"]);e!==void 0&&j!=null&&S(e,["setup","proactivity"],j);const F=_(n,["explicitVadSignal"]);return e!==void 0&&F!=null&&S(e,["setup","explicitVadSignal"],F),t}function f7(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["setup","model"],Fn(n,i));const s=_(e,["config"]);return s!=null&&S(t,["config"],d7(s,t)),t}function p7(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["setup","model"],Fn(n,i));const s=_(e,["config"]);return s!=null&&S(t,["config"],h7(s,t)),t}function m7(n){const e={},t=_(n,["musicGenerationConfig"]);return t!=null&&S(e,["musicGenerationConfig"],t),e}function g7(n){const e={},t=_(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),S(e,["weightedPrompts"],i)}return e}function x7(n){const e={},t=_(n,["media"]);if(t!=null){let p=i3(t);Array.isArray(p)&&(p=p.map(g=>Ty(g))),S(e,["mediaChunks"],p)}const i=_(n,["audio"]);i!=null&&S(e,["audio"],Ty(r3(i)));const s=_(n,["audioStreamEnd"]);s!=null&&S(e,["audioStreamEnd"],s);const r=_(n,["video"]);r!=null&&S(e,["video"],Ty(s3(r)));const o=_(n,["text"]);o!=null&&S(e,["text"],o);const c=_(n,["activityStart"]);c!=null&&S(e,["activityStart"],c);const h=_(n,["activityEnd"]);return h!=null&&S(e,["activityEnd"],h),e}function v7(n){const e={},t=_(n,["media"]);if(t!=null){let p=i3(t);Array.isArray(p)&&(p=p.map(g=>g)),S(e,["mediaChunks"],p)}const i=_(n,["audio"]);i!=null&&S(e,["audio"],r3(i));const s=_(n,["audioStreamEnd"]);s!=null&&S(e,["audioStreamEnd"],s);const r=_(n,["video"]);r!=null&&S(e,["video"],s3(r));const o=_(n,["text"]);o!=null&&S(e,["text"],o);const c=_(n,["activityStart"]);c!=null&&S(e,["activityStart"],c);const h=_(n,["activityEnd"]);return h!=null&&S(e,["activityEnd"],h),e}function y7(n){const e={},t=_(n,["setupComplete"]);t!=null&&S(e,["setupComplete"],t);const i=_(n,["serverContent"]);i!=null&&S(e,["serverContent"],i);const s=_(n,["toolCall"]);s!=null&&S(e,["toolCall"],s);const r=_(n,["toolCallCancellation"]);r!=null&&S(e,["toolCallCancellation"],r);const o=_(n,["usageMetadata"]);o!=null&&S(e,["usageMetadata"],T7(o));const c=_(n,["goAway"]);c!=null&&S(e,["goAway"],c);const h=_(n,["sessionResumptionUpdate"]);h!=null&&S(e,["sessionResumptionUpdate"],h);const p=_(n,["voiceActivityDetectionSignal"]);p!=null&&S(e,["voiceActivityDetectionSignal"],p);const g=_(n,["voiceActivity"]);return g!=null&&S(e,["voiceActivity"],E7(g)),e}function b7(n){const e={},t=_(n,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const i=_(n,["codeExecutionResult"]);i!=null&&S(e,["codeExecutionResult"],i);const s=_(n,["executableCode"]);s!=null&&S(e,["executableCode"],s);const r=_(n,["fileData"]);r!=null&&S(e,["fileData"],r7(r));const o=_(n,["functionCall"]);o!=null&&S(e,["functionCall"],a7(o));const c=_(n,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const h=_(n,["inlineData"]);h!=null&&S(e,["inlineData"],Ty(h));const p=_(n,["text"]);p!=null&&S(e,["text"],p);const g=_(n,["thought"]);g!=null&&S(e,["thought"],g);const v=_(n,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const y=_(n,["videoMetadata"]);return y!=null&&S(e,["videoMetadata"],y),e}function _7(n){const e={},t=_(n,["handle"]);if(t!=null&&S(e,["handle"],t),_(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function w7(n){const e={};if(_(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=_(n,["computerUse"]);t!=null&&S(e,["computerUse"],t);const i=_(n,["fileSearch"]);i!=null&&S(e,["fileSearch"],i);const s=_(n,["codeExecution"]);if(s!=null&&S(e,["codeExecution"],s),_(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=_(n,["functionDeclarations"]);if(r!=null){let g=r;Array.isArray(g)&&(g=g.map(v=>v)),S(e,["functionDeclarations"],g)}const o=_(n,["googleMaps"]);o!=null&&S(e,["googleMaps"],c7(o));const c=_(n,["googleSearch"]);c!=null&&S(e,["googleSearch"],u7(c));const h=_(n,["googleSearchRetrieval"]);h!=null&&S(e,["googleSearchRetrieval"],h);const p=_(n,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}function S7(n){const e={},t=_(n,["retrieval"]);t!=null&&S(e,["retrieval"],t);const i=_(n,["computerUse"]);if(i!=null&&S(e,["computerUse"],i),_(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=_(n,["codeExecution"]);s!=null&&S(e,["codeExecution"],s);const r=_(n,["enterpriseWebSearch"]);r!=null&&S(e,["enterpriseWebSearch"],r);const o=_(n,["functionDeclarations"]);if(o!=null){let v=o;Array.isArray(v)&&(v=v.map(y=>o7(y))),S(e,["functionDeclarations"],v)}const c=_(n,["googleMaps"]);c!=null&&S(e,["googleMaps"],c);const h=_(n,["googleSearch"]);h!=null&&S(e,["googleSearch"],h);const p=_(n,["googleSearchRetrieval"]);p!=null&&S(e,["googleSearchRetrieval"],p);const g=_(n,["urlContext"]);return g!=null&&S(e,["urlContext"],g),e}function T7(n){const e={},t=_(n,["promptTokenCount"]);t!=null&&S(e,["promptTokenCount"],t);const i=_(n,["cachedContentTokenCount"]);i!=null&&S(e,["cachedContentTokenCount"],i);const s=_(n,["candidatesTokenCount"]);s!=null&&S(e,["responseTokenCount"],s);const r=_(n,["toolUsePromptTokenCount"]);r!=null&&S(e,["toolUsePromptTokenCount"],r);const o=_(n,["thoughtsTokenCount"]);o!=null&&S(e,["thoughtsTokenCount"],o);const c=_(n,["totalTokenCount"]);c!=null&&S(e,["totalTokenCount"],c);const h=_(n,["promptTokensDetails"]);if(h!=null){let w=h;Array.isArray(w)&&(w=w.map(E=>E)),S(e,["promptTokensDetails"],w)}const p=_(n,["cacheTokensDetails"]);if(p!=null){let w=p;Array.isArray(w)&&(w=w.map(E=>E)),S(e,["cacheTokensDetails"],w)}const g=_(n,["candidatesTokensDetails"]);if(g!=null){let w=g;Array.isArray(w)&&(w=w.map(E=>E)),S(e,["responseTokensDetails"],w)}const v=_(n,["toolUsePromptTokensDetails"]);if(v!=null){let w=v;Array.isArray(w)&&(w=w.map(E=>E)),S(e,["toolUsePromptTokensDetails"],w)}const y=_(n,["trafficType"]);return y!=null&&S(e,["trafficType"],y),e}function E7(n){const e={},t=_(n,["type"]);return t!=null&&S(e,["voiceActivityType"],t),e}function M7(n){const e={},t=_(n,["data"]);if(t!=null&&S(e,["data"],t),_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function A7(n){const e={},t=_(n,["content"]);t!=null&&S(e,["content"],t);const i=_(n,["citationMetadata"]);i!=null&&S(e,["citationMetadata"],N7(i));const s=_(n,["tokenCount"]);s!=null&&S(e,["tokenCount"],s);const r=_(n,["finishReason"]);r!=null&&S(e,["finishReason"],r);const o=_(n,["avgLogprobs"]);o!=null&&S(e,["avgLogprobs"],o);const c=_(n,["groundingMetadata"]);c!=null&&S(e,["groundingMetadata"],c);const h=_(n,["index"]);h!=null&&S(e,["index"],h);const p=_(n,["logprobsResult"]);p!=null&&S(e,["logprobsResult"],p);const g=_(n,["safetyRatings"]);if(g!=null){let y=g;Array.isArray(y)&&(y=y.map(w=>w)),S(e,["safetyRatings"],y)}const v=_(n,["urlContextMetadata"]);return v!=null&&S(e,["urlContextMetadata"],v),e}function N7(n){const e={},t=_(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),S(e,["citations"],i)}return e}function C7(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["contents"]);if(s!=null){let r=Ja(s);Array.isArray(r)&&(r=r.map(o=>o)),S(t,["contents"],r)}return t}function R7(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["tokensInfo"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),S(e,["tokensInfo"],s)}return e}function k7(n){const e={},t=_(n,["values"]);t!=null&&S(e,["values"],t);const i=_(n,["statistics"]);return i!=null&&S(e,["statistics"],I7(i)),e}function I7(n){const e={},t=_(n,["truncated"]);t!=null&&S(e,["truncated"],t);const i=_(n,["token_count"]);return i!=null&&S(e,["tokenCount"],i),e}function k_(n){const e={},t=_(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>Bq(r))),S(e,["parts"],s)}const i=_(n,["role"]);return i!=null&&S(e,["role"],i),e}function D7(n){const e={},t=_(n,["controlType"]);t!=null&&S(e,["controlType"],t);const i=_(n,["enableControlImageComputation"]);return i!=null&&S(e,["computeControl"],i),e}function P7(n){const e={};if(_(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(_(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(_(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function U7(n,e){const t={},i=_(n,["systemInstruction"]);e!==void 0&&i!=null&&S(e,["systemInstruction"],rr(i));const s=_(n,["tools"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(c=>y3(c))),S(e,["tools"],o)}const r=_(n,["generationConfig"]);return e!==void 0&&r!=null&&S(e,["generationConfig"],Mq(r)),t}function L7(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["contents"]);if(s!=null){let o=Ja(s);Array.isArray(o)&&(o=o.map(c=>k_(c))),S(t,["contents"],o)}const r=_(e,["config"]);return r!=null&&P7(r),t}function O7(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["contents"]);if(s!=null){let o=Ja(s);Array.isArray(o)&&(o=o.map(c=>c)),S(t,["contents"],o)}const r=_(e,["config"]);return r!=null&&U7(r,t),t}function z7(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["totalTokens"]);i!=null&&S(e,["totalTokens"],i);const s=_(n,["cachedContentTokenCount"]);return s!=null&&S(e,["cachedContentTokenCount"],s),e}function j7(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["totalTokens"]);return i!=null&&S(e,["totalTokens"],i),e}function F7(n,e){const t={},i=_(e,["model"]);return i!=null&&S(t,["_url","name"],Fn(n,i)),t}function B7(n,e){const t={},i=_(e,["model"]);return i!=null&&S(t,["_url","name"],Fn(n,i)),t}function V7(n){const e={},t=_(n,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function H7(n){const e={},t=_(n,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function G7(n,e){const t={},i=_(n,["outputGcsUri"]);e!==void 0&&i!=null&&S(e,["parameters","storageUri"],i);const s=_(n,["negativePrompt"]);e!==void 0&&s!=null&&S(e,["parameters","negativePrompt"],s);const r=_(n,["numberOfImages"]);e!==void 0&&r!=null&&S(e,["parameters","sampleCount"],r);const o=_(n,["aspectRatio"]);e!==void 0&&o!=null&&S(e,["parameters","aspectRatio"],o);const c=_(n,["guidanceScale"]);e!==void 0&&c!=null&&S(e,["parameters","guidanceScale"],c);const h=_(n,["seed"]);e!==void 0&&h!=null&&S(e,["parameters","seed"],h);const p=_(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&S(e,["parameters","safetySetting"],p);const g=_(n,["personGeneration"]);e!==void 0&&g!=null&&S(e,["parameters","personGeneration"],g);const v=_(n,["includeSafetyAttributes"]);e!==void 0&&v!=null&&S(e,["parameters","includeSafetyAttributes"],v);const y=_(n,["includeRaiReason"]);e!==void 0&&y!=null&&S(e,["parameters","includeRaiReason"],y);const w=_(n,["language"]);e!==void 0&&w!=null&&S(e,["parameters","language"],w);const E=_(n,["outputMimeType"]);e!==void 0&&E!=null&&S(e,["parameters","outputOptions","mimeType"],E);const R=_(n,["outputCompressionQuality"]);e!==void 0&&R!=null&&S(e,["parameters","outputOptions","compressionQuality"],R);const N=_(n,["addWatermark"]);e!==void 0&&N!=null&&S(e,["parameters","addWatermark"],N);const A=_(n,["labels"]);e!==void 0&&A!=null&&S(e,["labels"],A);const I=_(n,["editMode"]);e!==void 0&&I!=null&&S(e,["parameters","editMode"],I);const D=_(n,["baseSteps"]);return e!==void 0&&D!=null&&S(e,["parameters","editConfig","baseSteps"],D),t}function q7(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const r=_(e,["referenceImages"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(h=>$q(h))),S(t,["instances[0]","referenceImages"],c)}const o=_(e,["config"]);return o!=null&&G7(o,t),t}function W7(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>I_(r))),S(e,["generatedImages"],s)}return e}function $7(n,e){const t={},i=_(n,["taskType"]);e!==void 0&&i!=null&&S(e,["requests[]","taskType"],i);const s=_(n,["title"]);e!==void 0&&s!=null&&S(e,["requests[]","title"],s);const r=_(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&S(e,["requests[]","outputDimensionality"],r),_(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(_(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function X7(n,e){const t={},i=_(n,["taskType"]);e!==void 0&&i!=null&&S(e,["instances[]","task_type"],i);const s=_(n,["title"]);e!==void 0&&s!=null&&S(e,["instances[]","title"],s);const r=_(n,["outputDimensionality"]);e!==void 0&&r!=null&&S(e,["parameters","outputDimensionality"],r);const o=_(n,["mimeType"]);e!==void 0&&o!=null&&S(e,["instances[]","mimeType"],o);const c=_(n,["autoTruncate"]);return e!==void 0&&c!=null&&S(e,["parameters","autoTruncate"],c),t}function Y7(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["contents"]);if(s!=null){let c=WT(n,s);Array.isArray(c)&&(c=c.map(h=>h)),S(t,["requests[]","content"],c)}const r=_(e,["config"]);r!=null&&$7(r,t);const o=_(e,["model"]);return o!==void 0&&S(t,["requests[]","model"],Fn(n,o)),t}function J7(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["contents"]);if(s!=null){let o=WT(n,s);Array.isArray(o)&&(o=o.map(c=>c)),S(t,["instances[]","content"],o)}const r=_(e,["config"]);return r!=null&&X7(r,t),t}function K7(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),S(e,["embeddings"],r)}const s=_(n,["metadata"]);return s!=null&&S(e,["metadata"],s),e}function Z7(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["predictions[]","embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>k7(o))),S(e,["embeddings"],r)}const s=_(n,["metadata"]);return s!=null&&S(e,["metadata"],s),e}function Q7(n){const e={},t=_(n,["endpoint"]);t!=null&&S(e,["name"],t);const i=_(n,["deployedModelId"]);return i!=null&&S(e,["deployedModelId"],i),e}function eq(n){const e={};if(_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=_(n,["fileUri"]);t!=null&&S(e,["fileUri"],t);const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function tq(n){const e={},t=_(n,["id"]);t!=null&&S(e,["id"],t);const i=_(n,["args"]);i!=null&&S(e,["args"],i);const s=_(n,["name"]);if(s!=null&&S(e,["name"],s),_(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(_(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function nq(n){const e={},t=_(n,["allowedFunctionNames"]);t!=null&&S(e,["allowedFunctionNames"],t);const i=_(n,["mode"]);if(i!=null&&S(e,["mode"],i),_(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function iq(n){const e={},t=_(n,["description"]);t!=null&&S(e,["description"],t);const i=_(n,["name"]);i!=null&&S(e,["name"],i);const s=_(n,["parameters"]);s!=null&&S(e,["parameters"],s);const r=_(n,["parametersJsonSchema"]);r!=null&&S(e,["parametersJsonSchema"],r);const o=_(n,["response"]);o!=null&&S(e,["response"],o);const c=_(n,["responseJsonSchema"]);if(c!=null&&S(e,["responseJsonSchema"],c),_(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function sq(n,e,t){const i={},s=_(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],k_(rr(s)));const r=_(e,["temperature"]);r!=null&&S(i,["temperature"],r);const o=_(e,["topP"]);o!=null&&S(i,["topP"],o);const c=_(e,["topK"]);c!=null&&S(i,["topK"],c);const h=_(e,["candidateCount"]);h!=null&&S(i,["candidateCount"],h);const p=_(e,["maxOutputTokens"]);p!=null&&S(i,["maxOutputTokens"],p);const g=_(e,["stopSequences"]);g!=null&&S(i,["stopSequences"],g);const v=_(e,["responseLogprobs"]);v!=null&&S(i,["responseLogprobs"],v);const y=_(e,["logprobs"]);y!=null&&S(i,["logprobs"],y);const w=_(e,["presencePenalty"]);w!=null&&S(i,["presencePenalty"],w);const E=_(e,["frequencyPenalty"]);E!=null&&S(i,["frequencyPenalty"],E);const R=_(e,["seed"]);R!=null&&S(i,["seed"],R);const N=_(e,["responseMimeType"]);N!=null&&S(i,["responseMimeType"],N);const A=_(e,["responseSchema"]);A!=null&&S(i,["responseSchema"],$T(A));const I=_(e,["responseJsonSchema"]);if(I!=null&&S(i,["responseJsonSchema"],I),_(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(_(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const D=_(e,["safetySettings"]);if(t!==void 0&&D!=null){let Q=D;Array.isArray(Q)&&(Q=Q.map(ce=>Xq(ce))),S(t,["safetySettings"],Q)}const U=_(e,["tools"]);if(t!==void 0&&U!=null){let Q=zp(U);Array.isArray(Q)&&(Q=Q.map(ce=>tW(Op(ce)))),S(t,["tools"],Q)}const j=_(e,["toolConfig"]);if(t!==void 0&&j!=null&&S(t,["toolConfig"],eW(j)),_(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const F=_(e,["cachedContent"]);t!==void 0&&F!=null&&S(t,["cachedContent"],Mc(n,F));const z=_(e,["responseModalities"]);z!=null&&S(i,["responseModalities"],z);const W=_(e,["mediaResolution"]);W!=null&&S(i,["mediaResolution"],W);const L=_(e,["speechConfig"]);if(L!=null&&S(i,["speechConfig"],XT(L)),_(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=_(e,["thinkingConfig"]);B!=null&&S(i,["thinkingConfig"],B);const Y=_(e,["imageConfig"]);Y!=null&&S(i,["imageConfig"],kq(Y));const ee=_(e,["enableEnhancedCivicAnswers"]);if(ee!=null&&S(i,["enableEnhancedCivicAnswers"],ee),_(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function rq(n,e,t){const i={},s=_(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],rr(s));const r=_(e,["temperature"]);r!=null&&S(i,["temperature"],r);const o=_(e,["topP"]);o!=null&&S(i,["topP"],o);const c=_(e,["topK"]);c!=null&&S(i,["topK"],c);const h=_(e,["candidateCount"]);h!=null&&S(i,["candidateCount"],h);const p=_(e,["maxOutputTokens"]);p!=null&&S(i,["maxOutputTokens"],p);const g=_(e,["stopSequences"]);g!=null&&S(i,["stopSequences"],g);const v=_(e,["responseLogprobs"]);v!=null&&S(i,["responseLogprobs"],v);const y=_(e,["logprobs"]);y!=null&&S(i,["logprobs"],y);const w=_(e,["presencePenalty"]);w!=null&&S(i,["presencePenalty"],w);const E=_(e,["frequencyPenalty"]);E!=null&&S(i,["frequencyPenalty"],E);const R=_(e,["seed"]);R!=null&&S(i,["seed"],R);const N=_(e,["responseMimeType"]);N!=null&&S(i,["responseMimeType"],N);const A=_(e,["responseSchema"]);A!=null&&S(i,["responseSchema"],$T(A));const I=_(e,["responseJsonSchema"]);I!=null&&S(i,["responseJsonSchema"],I);const D=_(e,["routingConfig"]);D!=null&&S(i,["routingConfig"],D);const U=_(e,["modelSelectionConfig"]);U!=null&&S(i,["modelConfig"],U);const j=_(e,["safetySettings"]);if(t!==void 0&&j!=null){let te=j;Array.isArray(te)&&(te=te.map(me=>me)),S(t,["safetySettings"],te)}const F=_(e,["tools"]);if(t!==void 0&&F!=null){let te=zp(F);Array.isArray(te)&&(te=te.map(me=>y3(Op(me)))),S(t,["tools"],te)}const z=_(e,["toolConfig"]);t!==void 0&&z!=null&&S(t,["toolConfig"],z);const W=_(e,["labels"]);t!==void 0&&W!=null&&S(t,["labels"],W);const L=_(e,["cachedContent"]);t!==void 0&&L!=null&&S(t,["cachedContent"],Mc(n,L));const B=_(e,["responseModalities"]);B!=null&&S(i,["responseModalities"],B);const Y=_(e,["mediaResolution"]);Y!=null&&S(i,["mediaResolution"],Y);const ee=_(e,["speechConfig"]);ee!=null&&S(i,["speechConfig"],XT(ee));const Q=_(e,["audioTimestamp"]);Q!=null&&S(i,["audioTimestamp"],Q);const ce=_(e,["thinkingConfig"]);ce!=null&&S(i,["thinkingConfig"],ce);const oe=_(e,["imageConfig"]);if(oe!=null&&S(i,["imageConfig"],Iq(oe)),_(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const J=_(e,["modelArmorConfig"]);return t!==void 0&&J!=null&&S(t,["modelArmorConfig"],J),i}function jC(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["contents"]);if(s!=null){let o=Ja(s);Array.isArray(o)&&(o=o.map(c=>k_(c))),S(t,["contents"],o)}const r=_(e,["config"]);return r!=null&&S(t,["generationConfig"],sq(n,r,t)),t}function FC(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["contents"]);if(s!=null){let o=Ja(s);Array.isArray(o)&&(o=o.map(c=>c)),S(t,["contents"],o)}const r=_(e,["config"]);return r!=null&&S(t,["generationConfig"],rq(n,r,t)),t}function BC(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["candidates"]);if(i!=null){let h=i;Array.isArray(h)&&(h=h.map(p=>A7(p))),S(e,["candidates"],h)}const s=_(n,["modelVersion"]);s!=null&&S(e,["modelVersion"],s);const r=_(n,["promptFeedback"]);r!=null&&S(e,["promptFeedback"],r);const o=_(n,["responseId"]);o!=null&&S(e,["responseId"],o);const c=_(n,["usageMetadata"]);return c!=null&&S(e,["usageMetadata"],c),e}function VC(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(g=>g)),S(e,["candidates"],p)}const s=_(n,["createTime"]);s!=null&&S(e,["createTime"],s);const r=_(n,["modelVersion"]);r!=null&&S(e,["modelVersion"],r);const o=_(n,["promptFeedback"]);o!=null&&S(e,["promptFeedback"],o);const c=_(n,["responseId"]);c!=null&&S(e,["responseId"],c);const h=_(n,["usageMetadata"]);return h!=null&&S(e,["usageMetadata"],h),e}function aq(n,e){const t={};if(_(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(_(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=_(n,["numberOfImages"]);e!==void 0&&i!=null&&S(e,["parameters","sampleCount"],i);const s=_(n,["aspectRatio"]);e!==void 0&&s!=null&&S(e,["parameters","aspectRatio"],s);const r=_(n,["guidanceScale"]);if(e!==void 0&&r!=null&&S(e,["parameters","guidanceScale"],r),_(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=_(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&S(e,["parameters","safetySetting"],o);const c=_(n,["personGeneration"]);e!==void 0&&c!=null&&S(e,["parameters","personGeneration"],c);const h=_(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&S(e,["parameters","includeSafetyAttributes"],h);const p=_(n,["includeRaiReason"]);e!==void 0&&p!=null&&S(e,["parameters","includeRaiReason"],p);const g=_(n,["language"]);e!==void 0&&g!=null&&S(e,["parameters","language"],g);const v=_(n,["outputMimeType"]);e!==void 0&&v!=null&&S(e,["parameters","outputOptions","mimeType"],v);const y=_(n,["outputCompressionQuality"]);if(e!==void 0&&y!=null&&S(e,["parameters","outputOptions","compressionQuality"],y),_(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(_(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const w=_(n,["imageSize"]);if(e!==void 0&&w!=null&&S(e,["parameters","sampleImageSize"],w),_(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function oq(n,e){const t={},i=_(n,["outputGcsUri"]);e!==void 0&&i!=null&&S(e,["parameters","storageUri"],i);const s=_(n,["negativePrompt"]);e!==void 0&&s!=null&&S(e,["parameters","negativePrompt"],s);const r=_(n,["numberOfImages"]);e!==void 0&&r!=null&&S(e,["parameters","sampleCount"],r);const o=_(n,["aspectRatio"]);e!==void 0&&o!=null&&S(e,["parameters","aspectRatio"],o);const c=_(n,["guidanceScale"]);e!==void 0&&c!=null&&S(e,["parameters","guidanceScale"],c);const h=_(n,["seed"]);e!==void 0&&h!=null&&S(e,["parameters","seed"],h);const p=_(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&S(e,["parameters","safetySetting"],p);const g=_(n,["personGeneration"]);e!==void 0&&g!=null&&S(e,["parameters","personGeneration"],g);const v=_(n,["includeSafetyAttributes"]);e!==void 0&&v!=null&&S(e,["parameters","includeSafetyAttributes"],v);const y=_(n,["includeRaiReason"]);e!==void 0&&y!=null&&S(e,["parameters","includeRaiReason"],y);const w=_(n,["language"]);e!==void 0&&w!=null&&S(e,["parameters","language"],w);const E=_(n,["outputMimeType"]);e!==void 0&&E!=null&&S(e,["parameters","outputOptions","mimeType"],E);const R=_(n,["outputCompressionQuality"]);e!==void 0&&R!=null&&S(e,["parameters","outputOptions","compressionQuality"],R);const N=_(n,["addWatermark"]);e!==void 0&&N!=null&&S(e,["parameters","addWatermark"],N);const A=_(n,["labels"]);e!==void 0&&A!=null&&S(e,["labels"],A);const I=_(n,["imageSize"]);e!==void 0&&I!=null&&S(e,["parameters","sampleImageSize"],I);const D=_(n,["enhancePrompt"]);return e!==void 0&&D!=null&&S(e,["parameters","enhancePrompt"],D),t}function lq(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const r=_(e,["config"]);return r!=null&&aq(r,t),t}function cq(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const r=_(e,["config"]);return r!=null&&oq(r,t),t}function uq(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>wq(o))),S(e,["generatedImages"],r)}const s=_(n,["positivePromptSafetyAttributes"]);return s!=null&&S(e,["positivePromptSafetyAttributes"],x3(s)),e}function dq(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>I_(o))),S(e,["generatedImages"],r)}const s=_(n,["positivePromptSafetyAttributes"]);return s!=null&&S(e,["positivePromptSafetyAttributes"],v3(s)),e}function hq(n,e){const t={},i=_(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&S(e,["parameters","sampleCount"],i),_(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(_(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=_(n,["durationSeconds"]);if(e!==void 0&&s!=null&&S(e,["parameters","durationSeconds"],s),_(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=_(n,["aspectRatio"]);e!==void 0&&r!=null&&S(e,["parameters","aspectRatio"],r);const o=_(n,["resolution"]);e!==void 0&&o!=null&&S(e,["parameters","resolution"],o);const c=_(n,["personGeneration"]);if(e!==void 0&&c!=null&&S(e,["parameters","personGeneration"],c),_(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=_(n,["negativePrompt"]);e!==void 0&&h!=null&&S(e,["parameters","negativePrompt"],h);const p=_(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&S(e,["parameters","enhancePrompt"],p),_(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const g=_(n,["lastFrame"]);e!==void 0&&g!=null&&S(e,["instances[0]","lastFrame"],D_(g));const v=_(n,["referenceImages"]);if(e!==void 0&&v!=null){let y=v;Array.isArray(y)&&(y=y.map(w=>pW(w))),S(e,["instances[0]","referenceImages"],y)}if(_(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(_(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function fq(n,e){const t={},i=_(n,["numberOfVideos"]);e!==void 0&&i!=null&&S(e,["parameters","sampleCount"],i);const s=_(n,["outputGcsUri"]);e!==void 0&&s!=null&&S(e,["parameters","storageUri"],s);const r=_(n,["fps"]);e!==void 0&&r!=null&&S(e,["parameters","fps"],r);const o=_(n,["durationSeconds"]);e!==void 0&&o!=null&&S(e,["parameters","durationSeconds"],o);const c=_(n,["seed"]);e!==void 0&&c!=null&&S(e,["parameters","seed"],c);const h=_(n,["aspectRatio"]);e!==void 0&&h!=null&&S(e,["parameters","aspectRatio"],h);const p=_(n,["resolution"]);e!==void 0&&p!=null&&S(e,["parameters","resolution"],p);const g=_(n,["personGeneration"]);e!==void 0&&g!=null&&S(e,["parameters","personGeneration"],g);const v=_(n,["pubsubTopic"]);e!==void 0&&v!=null&&S(e,["parameters","pubsubTopic"],v);const y=_(n,["negativePrompt"]);e!==void 0&&y!=null&&S(e,["parameters","negativePrompt"],y);const w=_(n,["enhancePrompt"]);e!==void 0&&w!=null&&S(e,["parameters","enhancePrompt"],w);const E=_(n,["generateAudio"]);e!==void 0&&E!=null&&S(e,["parameters","generateAudio"],E);const R=_(n,["lastFrame"]);e!==void 0&&R!=null&&S(e,["instances[0]","lastFrame"],Lo(R));const N=_(n,["referenceImages"]);if(e!==void 0&&N!=null){let D=N;Array.isArray(D)&&(D=D.map(U=>mW(U))),S(e,["instances[0]","referenceImages"],D)}const A=_(n,["mask"]);e!==void 0&&A!=null&&S(e,["instances[0]","mask"],fW(A));const I=_(n,["compressionQuality"]);return e!==void 0&&I!=null&&S(e,["parameters","compressionQuality"],I),t}function pq(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["metadata"]);i!=null&&S(e,["metadata"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);r!=null&&S(e,["error"],r);const o=_(n,["response","generateVideoResponse"]);return o!=null&&S(e,["response"],vq(o)),e}function mq(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["metadata"]);i!=null&&S(e,["metadata"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);r!=null&&S(e,["error"],r);const o=_(n,["response"]);return o!=null&&S(e,["response"],yq(o)),e}function gq(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const r=_(e,["image"]);r!=null&&S(t,["instances[0]","image"],D_(r));const o=_(e,["video"]);o!=null&&S(t,["instances[0]","video"],b3(o));const c=_(e,["source"]);c!=null&&bq(c,t);const h=_(e,["config"]);return h!=null&&hq(h,t),t}function xq(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const r=_(e,["image"]);r!=null&&S(t,["instances[0]","image"],Lo(r));const o=_(e,["video"]);o!=null&&S(t,["instances[0]","video"],_3(o));const c=_(e,["source"]);c!=null&&_q(c,t);const h=_(e,["config"]);return h!=null&&fq(h,t),t}function vq(n){const e={},t=_(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>Tq(o))),S(e,["generatedVideos"],r)}const i=_(n,["raiMediaFilteredCount"]);i!=null&&S(e,["raiMediaFilteredCount"],i);const s=_(n,["raiMediaFilteredReasons"]);return s!=null&&S(e,["raiMediaFilteredReasons"],s),e}function yq(n){const e={},t=_(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>Eq(o))),S(e,["generatedVideos"],r)}const i=_(n,["raiMediaFilteredCount"]);i!=null&&S(e,["raiMediaFilteredCount"],i);const s=_(n,["raiMediaFilteredReasons"]);return s!=null&&S(e,["raiMediaFilteredReasons"],s),e}function bq(n,e){const t={},i=_(n,["prompt"]);e!==void 0&&i!=null&&S(e,["instances[0]","prompt"],i);const s=_(n,["image"]);e!==void 0&&s!=null&&S(e,["instances[0]","image"],D_(s));const r=_(n,["video"]);return e!==void 0&&r!=null&&S(e,["instances[0]","video"],b3(r)),t}function _q(n,e){const t={},i=_(n,["prompt"]);e!==void 0&&i!=null&&S(e,["instances[0]","prompt"],i);const s=_(n,["image"]);e!==void 0&&s!=null&&S(e,["instances[0]","image"],Lo(s));const r=_(n,["video"]);return e!==void 0&&r!=null&&S(e,["instances[0]","video"],_3(r)),t}function wq(n){const e={},t=_(n,["_self"]);t!=null&&S(e,["image"],Dq(t));const i=_(n,["raiFilteredReason"]);i!=null&&S(e,["raiFilteredReason"],i);const s=_(n,["_self"]);return s!=null&&S(e,["safetyAttributes"],x3(s)),e}function I_(n){const e={},t=_(n,["_self"]);t!=null&&S(e,["image"],g3(t));const i=_(n,["raiFilteredReason"]);i!=null&&S(e,["raiFilteredReason"],i);const s=_(n,["_self"]);s!=null&&S(e,["safetyAttributes"],v3(s));const r=_(n,["prompt"]);return r!=null&&S(e,["enhancedPrompt"],r),e}function Sq(n){const e={},t=_(n,["_self"]);t!=null&&S(e,["mask"],g3(t));const i=_(n,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),S(e,["labels"],s)}return e}function Tq(n){const e={},t=_(n,["video"]);return t!=null&&S(e,["video"],dW(t)),e}function Eq(n){const e={},t=_(n,["_self"]);return t!=null&&S(e,["video"],hW(t)),e}function Mq(n){const e={},t=_(n,["modelSelectionConfig"]);t!=null&&S(e,["modelConfig"],t);const i=_(n,["responseJsonSchema"]);i!=null&&S(e,["responseJsonSchema"],i);const s=_(n,["audioTimestamp"]);s!=null&&S(e,["audioTimestamp"],s);const r=_(n,["candidateCount"]);r!=null&&S(e,["candidateCount"],r);const o=_(n,["enableAffectiveDialog"]);o!=null&&S(e,["enableAffectiveDialog"],o);const c=_(n,["frequencyPenalty"]);c!=null&&S(e,["frequencyPenalty"],c);const h=_(n,["logprobs"]);h!=null&&S(e,["logprobs"],h);const p=_(n,["maxOutputTokens"]);p!=null&&S(e,["maxOutputTokens"],p);const g=_(n,["mediaResolution"]);g!=null&&S(e,["mediaResolution"],g);const v=_(n,["presencePenalty"]);v!=null&&S(e,["presencePenalty"],v);const y=_(n,["responseLogprobs"]);y!=null&&S(e,["responseLogprobs"],y);const w=_(n,["responseMimeType"]);w!=null&&S(e,["responseMimeType"],w);const E=_(n,["responseModalities"]);E!=null&&S(e,["responseModalities"],E);const R=_(n,["responseSchema"]);R!=null&&S(e,["responseSchema"],R);const N=_(n,["routingConfig"]);N!=null&&S(e,["routingConfig"],N);const A=_(n,["seed"]);A!=null&&S(e,["seed"],A);const I=_(n,["speechConfig"]);I!=null&&S(e,["speechConfig"],I);const D=_(n,["stopSequences"]);D!=null&&S(e,["stopSequences"],D);const U=_(n,["temperature"]);U!=null&&S(e,["temperature"],U);const j=_(n,["thinkingConfig"]);j!=null&&S(e,["thinkingConfig"],j);const F=_(n,["topK"]);F!=null&&S(e,["topK"],F);const z=_(n,["topP"]);if(z!=null&&S(e,["topP"],z),_(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Aq(n,e){const t={},i=_(e,["model"]);return i!=null&&S(t,["_url","name"],Fn(n,i)),t}function Nq(n,e){const t={},i=_(e,["model"]);return i!=null&&S(t,["_url","name"],Fn(n,i)),t}function Cq(n){const e={};if(_(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=_(n,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function Rq(n){const e={};if(_(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(_(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=_(n,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function kq(n){const e={},t=_(n,["aspectRatio"]);t!=null&&S(e,["aspectRatio"],t);const i=_(n,["imageSize"]);if(i!=null&&S(e,["imageSize"],i),_(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(_(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(_(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function Iq(n){const e={},t=_(n,["aspectRatio"]);t!=null&&S(e,["aspectRatio"],t);const i=_(n,["imageSize"]);i!=null&&S(e,["imageSize"],i);const s=_(n,["personGeneration"]);s!=null&&S(e,["personGeneration"],s);const r=_(n,["outputMimeType"]);r!=null&&S(e,["imageOutputOptions","mimeType"],r);const o=_(n,["outputCompressionQuality"]);return o!=null&&S(e,["imageOutputOptions","compressionQuality"],o),e}function Dq(n){const e={},t=_(n,["bytesBase64Encoded"]);t!=null&&S(e,["imageBytes"],Wu(t));const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function g3(n){const e={},t=_(n,["gcsUri"]);t!=null&&S(e,["gcsUri"],t);const i=_(n,["bytesBase64Encoded"]);i!=null&&S(e,["imageBytes"],Wu(i));const s=_(n,["mimeType"]);return s!=null&&S(e,["mimeType"],s),e}function D_(n){const e={};if(_(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=_(n,["imageBytes"]);t!=null&&S(e,["bytesBase64Encoded"],Wu(t));const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function Lo(n){const e={},t=_(n,["gcsUri"]);t!=null&&S(e,["gcsUri"],t);const i=_(n,["imageBytes"]);i!=null&&S(e,["bytesBase64Encoded"],Wu(i));const s=_(n,["mimeType"]);return s!=null&&S(e,["mimeType"],s),e}function Pq(n,e,t){const i={},s=_(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const r=_(e,["pageToken"]);t!==void 0&&r!=null&&S(t,["_query","pageToken"],r);const o=_(e,["filter"]);t!==void 0&&o!=null&&S(t,["_query","filter"],o);const c=_(e,["queryBase"]);return t!==void 0&&c!=null&&S(t,["_url","models_url"],c3(n,c)),i}function Uq(n,e,t){const i={},s=_(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const r=_(e,["pageToken"]);t!==void 0&&r!=null&&S(t,["_query","pageToken"],r);const o=_(e,["filter"]);t!==void 0&&o!=null&&S(t,["_query","filter"],o);const c=_(e,["queryBase"]);return t!==void 0&&c!=null&&S(t,["_url","models_url"],c3(n,c)),i}function Lq(n,e){const t={},i=_(e,["config"]);return i!=null&&Pq(n,i,t),t}function Oq(n,e){const t={},i=_(e,["config"]);return i!=null&&Uq(n,i,t),t}function zq(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["_self"]);if(s!=null){let r=u3(s);Array.isArray(r)&&(r=r.map(o=>A1(o))),S(e,["models"],r)}return e}function jq(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["_self"]);if(s!=null){let r=u3(s);Array.isArray(r)&&(r=r.map(o=>N1(o))),S(e,["models"],r)}return e}function Fq(n){const e={},t=_(n,["maskMode"]);t!=null&&S(e,["maskMode"],t);const i=_(n,["segmentationClasses"]);i!=null&&S(e,["maskClasses"],i);const s=_(n,["maskDilation"]);return s!=null&&S(e,["dilation"],s),e}function A1(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["displayName"]);i!=null&&S(e,["displayName"],i);const s=_(n,["description"]);s!=null&&S(e,["description"],s);const r=_(n,["version"]);r!=null&&S(e,["version"],r);const o=_(n,["_self"]);o!=null&&S(e,["tunedModelInfo"],nW(o));const c=_(n,["inputTokenLimit"]);c!=null&&S(e,["inputTokenLimit"],c);const h=_(n,["outputTokenLimit"]);h!=null&&S(e,["outputTokenLimit"],h);const p=_(n,["supportedGenerationMethods"]);p!=null&&S(e,["supportedActions"],p);const g=_(n,["temperature"]);g!=null&&S(e,["temperature"],g);const v=_(n,["maxTemperature"]);v!=null&&S(e,["maxTemperature"],v);const y=_(n,["topP"]);y!=null&&S(e,["topP"],y);const w=_(n,["topK"]);w!=null&&S(e,["topK"],w);const E=_(n,["thinking"]);return E!=null&&S(e,["thinking"],E),e}function N1(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["displayName"]);i!=null&&S(e,["displayName"],i);const s=_(n,["description"]);s!=null&&S(e,["description"],s);const r=_(n,["versionId"]);r!=null&&S(e,["version"],r);const o=_(n,["deployedModels"]);if(o!=null){let v=o;Array.isArray(v)&&(v=v.map(y=>Q7(y))),S(e,["endpoints"],v)}const c=_(n,["labels"]);c!=null&&S(e,["labels"],c);const h=_(n,["_self"]);h!=null&&S(e,["tunedModelInfo"],iW(h));const p=_(n,["defaultCheckpointId"]);p!=null&&S(e,["defaultCheckpointId"],p);const g=_(n,["checkpoints"]);if(g!=null){let v=g;Array.isArray(v)&&(v=v.map(y=>y)),S(e,["checkpoints"],v)}return e}function Bq(n){const e={},t=_(n,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const i=_(n,["codeExecutionResult"]);i!=null&&S(e,["codeExecutionResult"],i);const s=_(n,["executableCode"]);s!=null&&S(e,["executableCode"],s);const r=_(n,["fileData"]);r!=null&&S(e,["fileData"],eq(r));const o=_(n,["functionCall"]);o!=null&&S(e,["functionCall"],tq(o));const c=_(n,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const h=_(n,["inlineData"]);h!=null&&S(e,["inlineData"],M7(h));const p=_(n,["text"]);p!=null&&S(e,["text"],p);const g=_(n,["thought"]);g!=null&&S(e,["thought"],g);const v=_(n,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const y=_(n,["videoMetadata"]);return y!=null&&S(e,["videoMetadata"],y),e}function Vq(n){const e={},t=_(n,["productImage"]);return t!=null&&S(e,["image"],Lo(t)),e}function Hq(n,e){const t={},i=_(n,["numberOfImages"]);e!==void 0&&i!=null&&S(e,["parameters","sampleCount"],i);const s=_(n,["baseSteps"]);e!==void 0&&s!=null&&S(e,["parameters","baseSteps"],s);const r=_(n,["outputGcsUri"]);e!==void 0&&r!=null&&S(e,["parameters","storageUri"],r);const o=_(n,["seed"]);e!==void 0&&o!=null&&S(e,["parameters","seed"],o);const c=_(n,["safetyFilterLevel"]);e!==void 0&&c!=null&&S(e,["parameters","safetySetting"],c);const h=_(n,["personGeneration"]);e!==void 0&&h!=null&&S(e,["parameters","personGeneration"],h);const p=_(n,["addWatermark"]);e!==void 0&&p!=null&&S(e,["parameters","addWatermark"],p);const g=_(n,["outputMimeType"]);e!==void 0&&g!=null&&S(e,["parameters","outputOptions","mimeType"],g);const v=_(n,["outputCompressionQuality"]);e!==void 0&&v!=null&&S(e,["parameters","outputOptions","compressionQuality"],v);const y=_(n,["enhancePrompt"]);e!==void 0&&y!=null&&S(e,["parameters","enhancePrompt"],y);const w=_(n,["labels"]);return e!==void 0&&w!=null&&S(e,["labels"],w),t}function Gq(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["source"]);s!=null&&Wq(s,t);const r=_(e,["config"]);return r!=null&&Hq(r,t),t}function qq(n){const e={},t=_(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>I_(s))),S(e,["generatedImages"],i)}return e}function Wq(n,e){const t={},i=_(n,["prompt"]);e!==void 0&&i!=null&&S(e,["instances[0]","prompt"],i);const s=_(n,["personImage"]);e!==void 0&&s!=null&&S(e,["instances[0]","personImage","image"],Lo(s));const r=_(n,["productImages"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(c=>Vq(c))),S(e,["instances[0]","productImages"],o)}return t}function $q(n){const e={},t=_(n,["referenceImage"]);t!=null&&S(e,["referenceImage"],Lo(t));const i=_(n,["referenceId"]);i!=null&&S(e,["referenceId"],i);const s=_(n,["referenceType"]);s!=null&&S(e,["referenceType"],s);const r=_(n,["maskImageConfig"]);r!=null&&S(e,["maskImageConfig"],Fq(r));const o=_(n,["controlImageConfig"]);o!=null&&S(e,["controlImageConfig"],D7(o));const c=_(n,["styleImageConfig"]);c!=null&&S(e,["styleImageConfig"],c);const h=_(n,["subjectImageConfig"]);return h!=null&&S(e,["subjectImageConfig"],h),e}function x3(n){const e={},t=_(n,["safetyAttributes","categories"]);t!=null&&S(e,["categories"],t);const i=_(n,["safetyAttributes","scores"]);i!=null&&S(e,["scores"],i);const s=_(n,["contentType"]);return s!=null&&S(e,["contentType"],s),e}function v3(n){const e={},t=_(n,["safetyAttributes","categories"]);t!=null&&S(e,["categories"],t);const i=_(n,["safetyAttributes","scores"]);i!=null&&S(e,["scores"],i);const s=_(n,["contentType"]);return s!=null&&S(e,["contentType"],s),e}function Xq(n){const e={},t=_(n,["category"]);if(t!=null&&S(e,["category"],t),_(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=_(n,["threshold"]);return i!=null&&S(e,["threshold"],i),e}function Yq(n){const e={},t=_(n,["image"]);return t!=null&&S(e,["image"],Lo(t)),e}function Jq(n,e){const t={},i=_(n,["mode"]);e!==void 0&&i!=null&&S(e,["parameters","mode"],i);const s=_(n,["maxPredictions"]);e!==void 0&&s!=null&&S(e,["parameters","maxPredictions"],s);const r=_(n,["confidenceThreshold"]);e!==void 0&&r!=null&&S(e,["parameters","confidenceThreshold"],r);const o=_(n,["maskDilation"]);e!==void 0&&o!=null&&S(e,["parameters","maskDilation"],o);const c=_(n,["binaryColorThreshold"]);e!==void 0&&c!=null&&S(e,["parameters","binaryColorThreshold"],c);const h=_(n,["labels"]);return e!==void 0&&h!=null&&S(e,["labels"],h),t}function Kq(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["source"]);s!=null&&Qq(s,t);const r=_(e,["config"]);return r!=null&&Jq(r,t),t}function Zq(n){const e={},t=_(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Sq(s))),S(e,["generatedMasks"],i)}return e}function Qq(n,e){const t={},i=_(n,["prompt"]);e!==void 0&&i!=null&&S(e,["instances[0]","prompt"],i);const s=_(n,["image"]);e!==void 0&&s!=null&&S(e,["instances[0]","image"],Lo(s));const r=_(n,["scribbleImage"]);return e!==void 0&&r!=null&&S(e,["instances[0]","scribble"],Yq(r)),t}function eW(n){const e={},t=_(n,["retrievalConfig"]);t!=null&&S(e,["retrievalConfig"],t);const i=_(n,["functionCallingConfig"]);return i!=null&&S(e,["functionCallingConfig"],nq(i)),e}function tW(n){const e={};if(_(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=_(n,["computerUse"]);t!=null&&S(e,["computerUse"],t);const i=_(n,["fileSearch"]);i!=null&&S(e,["fileSearch"],i);const s=_(n,["codeExecution"]);if(s!=null&&S(e,["codeExecution"],s),_(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=_(n,["functionDeclarations"]);if(r!=null){let g=r;Array.isArray(g)&&(g=g.map(v=>v)),S(e,["functionDeclarations"],g)}const o=_(n,["googleMaps"]);o!=null&&S(e,["googleMaps"],Cq(o));const c=_(n,["googleSearch"]);c!=null&&S(e,["googleSearch"],Rq(c));const h=_(n,["googleSearchRetrieval"]);h!=null&&S(e,["googleSearchRetrieval"],h);const p=_(n,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}function y3(n){const e={},t=_(n,["retrieval"]);t!=null&&S(e,["retrieval"],t);const i=_(n,["computerUse"]);if(i!=null&&S(e,["computerUse"],i),_(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=_(n,["codeExecution"]);s!=null&&S(e,["codeExecution"],s);const r=_(n,["enterpriseWebSearch"]);r!=null&&S(e,["enterpriseWebSearch"],r);const o=_(n,["functionDeclarations"]);if(o!=null){let v=o;Array.isArray(v)&&(v=v.map(y=>iq(y))),S(e,["functionDeclarations"],v)}const c=_(n,["googleMaps"]);c!=null&&S(e,["googleMaps"],c);const h=_(n,["googleSearch"]);h!=null&&S(e,["googleSearch"],h);const p=_(n,["googleSearchRetrieval"]);p!=null&&S(e,["googleSearchRetrieval"],p);const g=_(n,["urlContext"]);return g!=null&&S(e,["urlContext"],g),e}function nW(n){const e={},t=_(n,["baseModel"]);t!=null&&S(e,["baseModel"],t);const i=_(n,["createTime"]);i!=null&&S(e,["createTime"],i);const s=_(n,["updateTime"]);return s!=null&&S(e,["updateTime"],s),e}function iW(n){const e={},t=_(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&S(e,["baseModel"],t);const i=_(n,["createTime"]);i!=null&&S(e,["createTime"],i);const s=_(n,["updateTime"]);return s!=null&&S(e,["updateTime"],s),e}function sW(n,e){const t={},i=_(n,["displayName"]);e!==void 0&&i!=null&&S(e,["displayName"],i);const s=_(n,["description"]);e!==void 0&&s!=null&&S(e,["description"],s);const r=_(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&S(e,["defaultCheckpointId"],r),t}function rW(n,e){const t={},i=_(n,["displayName"]);e!==void 0&&i!=null&&S(e,["displayName"],i);const s=_(n,["description"]);e!==void 0&&s!=null&&S(e,["description"],s);const r=_(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&S(e,["defaultCheckpointId"],r),t}function aW(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","name"],Fn(n,i));const s=_(e,["config"]);return s!=null&&sW(s,t),t}function oW(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["config"]);return s!=null&&rW(s,t),t}function lW(n,e){const t={},i=_(n,["outputGcsUri"]);e!==void 0&&i!=null&&S(e,["parameters","storageUri"],i);const s=_(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&S(e,["parameters","safetySetting"],s);const r=_(n,["personGeneration"]);e!==void 0&&r!=null&&S(e,["parameters","personGeneration"],r);const o=_(n,["includeRaiReason"]);e!==void 0&&o!=null&&S(e,["parameters","includeRaiReason"],o);const c=_(n,["outputMimeType"]);e!==void 0&&c!=null&&S(e,["parameters","outputOptions","mimeType"],c);const h=_(n,["outputCompressionQuality"]);e!==void 0&&h!=null&&S(e,["parameters","outputOptions","compressionQuality"],h);const p=_(n,["enhanceInputImage"]);e!==void 0&&p!=null&&S(e,["parameters","upscaleConfig","enhanceInputImage"],p);const g=_(n,["imagePreservationFactor"]);e!==void 0&&g!=null&&S(e,["parameters","upscaleConfig","imagePreservationFactor"],g);const v=_(n,["labels"]);e!==void 0&&v!=null&&S(e,["labels"],v);const y=_(n,["numberOfImages"]);e!==void 0&&y!=null&&S(e,["parameters","sampleCount"],y);const w=_(n,["mode"]);return e!==void 0&&w!=null&&S(e,["parameters","mode"],w),t}function cW(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["_url","model"],Fn(n,i));const s=_(e,["image"]);s!=null&&S(t,["instances[0]","image"],Lo(s));const r=_(e,["upscaleFactor"]);r!=null&&S(t,["parameters","upscaleConfig","upscaleFactor"],r);const o=_(e,["config"]);return o!=null&&lW(o,t),t}function uW(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>I_(r))),S(e,["generatedImages"],s)}return e}function dW(n){const e={},t=_(n,["uri"]);t!=null&&S(e,["uri"],t);const i=_(n,["encodedVideo"]);i!=null&&S(e,["videoBytes"],Wu(i));const s=_(n,["encoding"]);return s!=null&&S(e,["mimeType"],s),e}function hW(n){const e={},t=_(n,["gcsUri"]);t!=null&&S(e,["uri"],t);const i=_(n,["bytesBase64Encoded"]);i!=null&&S(e,["videoBytes"],Wu(i));const s=_(n,["mimeType"]);return s!=null&&S(e,["mimeType"],s),e}function fW(n){const e={},t=_(n,["image"]);t!=null&&S(e,["_self"],Lo(t));const i=_(n,["maskMode"]);return i!=null&&S(e,["maskMode"],i),e}function pW(n){const e={},t=_(n,["image"]);t!=null&&S(e,["image"],D_(t));const i=_(n,["referenceType"]);return i!=null&&S(e,["referenceType"],i),e}function mW(n){const e={},t=_(n,["image"]);t!=null&&S(e,["image"],Lo(t));const i=_(n,["referenceType"]);return i!=null&&S(e,["referenceType"],i),e}function b3(n){const e={},t=_(n,["uri"]);t!=null&&S(e,["uri"],t);const i=_(n,["videoBytes"]);i!=null&&S(e,["encodedVideo"],Wu(i));const s=_(n,["mimeType"]);return s!=null&&S(e,["encoding"],s),e}function _3(n){const e={},t=_(n,["uri"]);t!=null&&S(e,["gcsUri"],t);const i=_(n,["videoBytes"]);i!=null&&S(e,["bytesBase64Encoded"],Wu(i));const s=_(n,["mimeType"]);return s!=null&&S(e,["mimeType"],s),e}function gW(n,e){const t={},i=_(n,["displayName"]);return e!==void 0&&i!=null&&S(e,["displayName"],i),t}function xW(n){const e={},t=_(n,["config"]);return t!=null&&gW(t,e),e}function vW(n,e){const t={},i=_(n,["force"]);return e!==void 0&&i!=null&&S(e,["_query","force"],i),t}function yW(n){const e={},t=_(n,["name"]);t!=null&&S(e,["_url","name"],t);const i=_(n,["config"]);return i!=null&&vW(i,e),e}function bW(n){const e={},t=_(n,["name"]);return t!=null&&S(e,["_url","name"],t),e}function _W(n,e){const t={},i=_(n,["customMetadata"]);if(e!==void 0&&i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),S(e,["customMetadata"],r)}const s=_(n,["chunkingConfig"]);return e!==void 0&&s!=null&&S(e,["chunkingConfig"],s),t}function wW(n){const e={},t=_(n,["name"]);t!=null&&S(e,["name"],t);const i=_(n,["metadata"]);i!=null&&S(e,["metadata"],i);const s=_(n,["done"]);s!=null&&S(e,["done"],s);const r=_(n,["error"]);r!=null&&S(e,["error"],r);const o=_(n,["response"]);return o!=null&&S(e,["response"],TW(o)),e}function SW(n){const e={},t=_(n,["fileSearchStoreName"]);t!=null&&S(e,["_url","file_search_store_name"],t);const i=_(n,["fileName"]);i!=null&&S(e,["fileName"],i);const s=_(n,["config"]);return s!=null&&_W(s,e),e}function TW(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["parent"]);i!=null&&S(e,["parent"],i);const s=_(n,["documentName"]);return s!=null&&S(e,["documentName"],s),e}function EW(n,e){const t={},i=_(n,["pageSize"]);e!==void 0&&i!=null&&S(e,["_query","pageSize"],i);const s=_(n,["pageToken"]);return e!==void 0&&s!=null&&S(e,["_query","pageToken"],s),t}function MW(n){const e={},t=_(n,["config"]);return t!=null&&EW(t,e),e}function AW(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["fileSearchStores"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),S(e,["fileSearchStores"],r)}return e}function w3(n,e){const t={},i=_(n,["mimeType"]);e!==void 0&&i!=null&&S(e,["mimeType"],i);const s=_(n,["displayName"]);e!==void 0&&s!=null&&S(e,["displayName"],s);const r=_(n,["customMetadata"]);if(e!==void 0&&r!=null){let c=r;Array.isArray(c)&&(c=c.map(h=>h)),S(e,["customMetadata"],c)}const o=_(n,["chunkingConfig"]);return e!==void 0&&o!=null&&S(e,["chunkingConfig"],o),t}function NW(n){const e={},t=_(n,["fileSearchStoreName"]);t!=null&&S(e,["_url","file_search_store_name"],t);const i=_(n,["config"]);return i!=null&&w3(i,e),e}function CW(n){const e={},t=_(n,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}const RW="Content-Type",kW="X-Server-Timeout",IW="User-Agent",C1="x-goog-api-client",DW="1.38.0",PW=`google-genai-sdk/${DW}`,UW="v1beta1",LW="v1beta";class OW{constructor(e){var t,i,s;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const r={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const c=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!c?(r.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?r.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(r.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),r.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:UW}else{if(!this.clientOptions.apiKey)throw new y0({message:"API key must be set when using the Gemini API.",status:403});r.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:LW,r.baseUrl="https://generativelanguage.googleapis.com/"}r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const s=[this.getRequestUrlInternal(t)];return i&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===S1.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e,t),s=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[o,c]of Object.entries(e.queryParams))s.searchParams.append(o,String(c));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,s.toString(),e.abortSignal),this.unaryApiCall(s,r,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[s,r]of Object.entries(t))typeof r=="object"?i[s]=Object.assign(Object.assign({},i[s]),r):r!==void 0&&(i[s]=r);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e,t),s=this.constructUrl(e.path,t,i);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,s.toString(),e.abortSignal),this.streamApiCall(s,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,s){if(t&&t.timeout||s){const r=new AbortController,o=r.signal;if(t.timeout&&t?.timeout>0){const c=setTimeout(()=>r.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}s&&s.addEventListener("abort",()=>{r.abort()}),e.signal=o}return t&&t.extraBody!==null&&zW(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await HC(s),new T1(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await HC(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return Io(this,arguments,function*(){var i;const s=(i=e?.body)===null||i===void 0?void 0:i.getReader(),r=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";const c="data:",h=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:p,value:g}=yield Qt(s.read());if(p){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=r.decode(g,{stream:!0});try{const E=JSON.parse(v);if("error"in E){const R=JSON.parse(JSON.stringify(E.error)),N=R.status,A=R.code,I=`got status: ${N}. ${JSON.stringify(E)}`;if(A>=400&&A<600)throw new y0({message:I,status:A})}}catch(E){if(E.name==="ApiError")throw E}o+=v;let y=-1,w=0;for(;;){y=-1,w=0;for(const N of h){const A=o.indexOf(N);A!==-1&&(y===-1||A<y)&&(y=A,w=N.length)}if(y===-1)break;const E=o.substring(0,y);o=o.substring(y+w);const R=E.trim();if(R.startsWith(c)){const N=R.substring(c.length).trim();try{const A=new Response(N,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Qt(new T1(A))}catch(A){throw new Error(`exception parsing stream chunk ${N}. ${A}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=PW+" "+this.clientOptions.userAgentExtra;return e[IW]=t,e[C1]=t,e[RW]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[s,r]of Object.entries(e.headers))i.append(s,r);e.timeout&&e.timeout>0&&i.append(kW,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const r=this.clientOptions.uploader,o=await r.stat(e);s.sizeBytes=String(o.size);const c=(i=t?.mimeType)!==null&&i!==void 0?i:o.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=c;const h={file:s},p=this.getFileName(e),g=bt("upload/v1beta/files",h._url),v=await this.fetchUploadUrl(g,s.sizeBytes,s.mimeType,p,h,t?.httpOptions);return r.upload(e,v,this)}async uploadFileToFileSearchStore(e,t,i){var s;const r=this.clientOptions.uploader,o=await r.stat(t),c=String(o.size),h=(s=i?.mimeType)!==null&&s!==void 0?s:o.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,g=this.getFileName(t),v={};i!=null&&w3(i,v);const y=await this.fetchUploadUrl(p,c,h,g,v,i?.httpOptions);return r.uploadToFileSearchStore(t,y,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,s,r,o){var c;let h={};o?h=o:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},s?{"X-Goog-Upload-File-Name":s}:{})};const p=await this.request({path:e,body:JSON.stringify(r),httpMethod:"POST",httpOptions:h});if(!p||!p?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const g=(c=p?.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(g===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return g}}async function HC(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(i);throw t>=400&&t<600?new y0({message:s,status:t}):new Error(s)}}function zW(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const r=JSON.parse(n.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))t=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(r,o){const c=Object.assign({},r);for(const h in o)if(Object.prototype.hasOwnProperty.call(o,h)){const p=o[h],g=c[h];p&&typeof p=="object"&&!Array.isArray(p)&&g&&typeof g=="object"&&!Array.isArray(g)?c[h]=i(g,p):(g&&p&&typeof g!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof g}, New type: ${typeof p}. Overwriting.`),c[h]=p)}return c}const s=i(t,e);n.body=JSON.stringify(s)}const jW="mcp_used/unknown";let FW=!1;function S3(n){for(const e of n)if(BW(e)||typeof e=="object"&&"inputSchema"in e)return!0;return FW}function T3(n){var e;const t=(e=n[C1])!==null&&e!==void 0?e:"";n[C1]=(t+` ${jW}`).trimStart()}function BW(n){return n!==null&&typeof n=="object"&&n instanceof JT}function VW(n){return Io(this,arguments,function*(t,i=100){let s,r=0;for(;r<i;){const o=yield Qt(t.listTools({cursor:s}));for(const c of o.tools)yield yield Qt(c),r++;if(!o.nextCursor)break;s=o.nextCursor}})}class JT{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new JT(e,t)}async initialize(){var e,t,i,s;if(this.mcpTools.length>0)return;const r={},o=[];for(const g of this.mcpClients)try{for(var c=!0,h=(t=void 0,Do(VW(g))),p;p=await h.next(),e=p.done,!e;c=!0){s=p.value,c=!1;const v=s;o.push(v);const y=v.name;if(r[y])throw new Error(`Duplicate function name ${y} found in MCP tools. Please ensure function names are unique.`);r[y]=g}}catch(v){t={error:v}}finally{try{!c&&!e&&(i=h.return)&&await i.call(h)}finally{if(t)throw t.error}}this.mcpTools=o,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),yG(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[i.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const o=await s.callTool({name:i.name,arguments:i.args},void 0,r);t.push({functionResponse:{name:i.name,response:o.isError?{error:o}:o}})}return t}}async function HW(n,e,t){const i=new dG;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(i,s),e(i)}class GW{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),o=$W(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),h=`${s}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${c}`;let p=()=>{};const g=new Promise(D=>{p=D}),v=e.callbacks,y=function(){p({})},w=this.apiClient,E={onopen:y,onmessage:D=>{HW(w,v.onmessage,D)},onerror:(t=v?.onerror)!==null&&t!==void 0?t:function(D){},onclose:(i=v?.onclose)!==null&&i!==void 0?i:function(D){}},R=this.webSocketFactory.create(h,WW(o),E);R.connect(),await g;const I={setup:{model:Fn(this.apiClient,e.model)}};return R.send(JSON.stringify(I)),new qW(R,this.apiClient)}}class qW{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=g7(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=m7(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(hp.PLAY)}pause(){this.sendPlaybackControl(hp.PAUSE)}stop(){this.sendPlaybackControl(hp.STOP)}resetContext(){this.sendPlaybackControl(hp.RESET_CONTEXT)}close(){this.conn.close()}}function WW(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function $W(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}const XW="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function YW(n,e,t){const i=new uG;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const r=JSON.parse(s);if(n.isVertexAI()){const o=y7(r);Object.assign(i,o)}else Object.assign(i,r);e(i)}class JW{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new GW(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,s,r,o,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let g;const v=this.apiClient.getHeaders();e.config&&e.config.tools&&S3(e.config.tools)&&T3(v);const y=e$(v);if(this.apiClient.isVertexAI()){const L=this.apiClient.getProject(),B=this.apiClient.getLocation(),Y=this.apiClient.getApiKey(),ee=!!L&&!!B||!!Y;this.apiClient.getCustomBaseUrl()&&!ee?g=h:(g=`${h}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(y,g))}else{const L=this.apiClient.getApiKey();let B="BidiGenerateContent",Y="key";L?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),B="BidiGenerateContentConstrained",Y="access_token"),g=`${h}/ws/google.ai.generativelanguage.${p}.GenerativeService.${B}?${Y}=${L}`}let w=()=>{};const E=new Promise(L=>{w=L}),R=e.callbacks,N=function(){var L;(L=R?.onopen)===null||L===void 0||L.call(R),w({})},A=this.apiClient,I={onopen:N,onmessage:L=>{YW(A,R.onmessage,L)},onerror:(t=R?.onerror)!==null&&t!==void 0?t:function(L){},onclose:(i=R?.onclose)!==null&&i!==void 0?i:function(L){}},D=this.webSocketFactory.create(g,QW(y),I);D.connect(),await E;let U=Fn(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&U.startsWith("publishers/")){const L=this.apiClient.getProject(),B=this.apiClient.getLocation();L&&B&&(U=`projects/${L}/locations/${B}/`+U)}let j={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Rb.AUDIO]}:e.config.responseModalities=[Rb.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const F=(c=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&c!==void 0?c:[],z=[];for(const L of F)if(this.isCallableTool(L)){const B=L;z.push(await B.tool())}else z.push(L);z.length>0&&(e.config.tools=z);const W={model:U,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?j=p7(this.apiClient,W):j=f7(this.apiClient,W),delete j.config,D.send(JSON.stringify(j)),new ZW(D,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const KW={turnComplete:!0};class ZW{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Ja(t.turns),e.isVertexAI()||(i=i.map(s=>k_(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const r of i){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(XW)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},KW),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:v7(e)}:t={realtimeInput:x7(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function QW(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function e$(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}const GC=10;function qC(n){var e,t,i;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n?.tools)!==null&&t!==void 0?t:[])if(yp(o)){s=!0;break}if(!s)return!0;const r=(i=n?.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function yp(n){return"callTool"in n&&typeof n.callTool=="function"}function t$(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>yp(s)))!==null&&i!==void 0?i:!1}function WC(n){var e;const t=[];return!((e=n?.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,s)=>{if(yp(i))return;const r=i;r.functionDeclarations&&r.functionDeclarations.length>0&&t.push(s)}),t}function $C(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class n$ extends Ec{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,s,r,o,c;const h=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!t$(t)||qC(t.config))return await this.generateContentInternal(h);const p=WC(t);if(p.length>0){const R=p.map(N=>`tools[${N}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${R}.`)}let g,v;const y=Ja(h.contents),w=(r=(s=(i=h.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:GC;let E=0;for(;E<w&&(g=await this.generateContentInternal(h),!(!g.functionCalls||g.functionCalls.length===0));){const R=g.candidates[0].content,N=[];for(const A of(c=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&c!==void 0?c:[])if(yp(A)){const D=await A.callTool(g.functionCalls);N.push(...D)}E++,v={role:"user",parts:N},h.contents=Ja(h.contents),h.contents.push(R),h.contents.push(v),$C(h.config)&&(y.push(R),y.push(v))}return $C(h.config)&&(g.automaticFunctionCallingHistory=y),g},this.generateContentStream=async t=>{var i,s,r,o,c;if(this.maybeMoveToResponseJsonSchem(t),qC(t.config)){const v=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(v)}const h=WC(t);if(h.length>0){const v=h.map(y=>`tools[${y}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(r=(s=(i=t?.config)===null||i===void 0?void 0:i.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||r===void 0?void 0:r.streamFunctionCallArguments,g=(c=(o=t?.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(p&&!g)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var s;let r;const o=[];if(i?.generatedImages)for(const h of i.generatedImages)h&&h?.safetyAttributes&&((s=h?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?r=h?.safetyAttributes:o.push(h);let c;return r?c={generatedImages:o,positivePromptSafetyAttributes:r,sdkHttpResponse:i.sdkHttpResponse}:c={generatedImages:o,sdkHttpResponse:i.sdkHttpResponse},c}),this.list=async t=>{var i;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((i=o.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new bh(Sc.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(o),o)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var i,s,r,o,c,h;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((o=(r=t.source)===null||r===void 0?void 0:r.video)===null||o===void 0)&&o.uri&&(!((h=(c=t.source)===null||c===void 0?void 0:c.video)===null||h===void 0)&&h.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,s;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const o=await Promise.all(r.map(async h=>yp(h)?await h.tool():h)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(c.config.tools=o,e.config&&e.config.tools&&S3(e.config.tools)){const h=(s=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&s!==void 0?s:{};let p=Object.assign({},h);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),T3(p),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return c}async initAfcToolsMap(e){var t,i,s;const r=new Map;for(const o of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(yp(o)){const c=o,h=await c.tool();for(const p of(s=h.functionDeclarations)!==null&&s!==void 0?s:[]){if(!p.name)throw new Error("Function declaration name is required.");if(r.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);r.set(p.name,c)}}return r}async processAfcStream(e){var t,i,s;const r=(s=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:GC;let o=!1,c=0;const h=await this.initAfcToolsMap(e);return(function(p,g,v){return Io(this,arguments,function*(){for(var y,w,E,R,N,A;c<r;){o&&(c++,o=!1);const j=yield Qt(p.processParamsMaybeAddMcpUsage(v)),F=yield Qt(p.generateContentStreamInternal(j)),z=[],W=[];try{for(var I=!0,D=(w=void 0,Do(F)),U;U=yield Qt(D.next()),y=U.done,!y;I=!0){R=U.value,I=!1;const L=R;if(yield yield Qt(L),L.candidates&&(!((N=L.candidates[0])===null||N===void 0)&&N.content)){W.push(L.candidates[0].content);for(const B of(A=L.candidates[0].content.parts)!==null&&A!==void 0?A:[])if(c<r&&B.functionCall){if(!B.functionCall.name)throw new Error("Function call name was not returned by the model.");if(g.has(B.functionCall.name)){const Y=yield Qt(g.get(B.functionCall.name).callTool([B.functionCall]));z.push(...Y)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${g.keys()}, mising tool: ${B.functionCall.name}`)}}}}catch(L){w={error:L}}finally{try{!I&&!y&&(E=D.return)&&(yield Qt(E.call(D)))}finally{if(w)throw w.error}}if(z.length>0){o=!0;const L=new Ag;L.candidates=[{content:{role:"user",parts:z}}],yield yield Qt(L);const B=[];B.push(...W),B.push({role:"user",parts:z});const Y=Ja(v.contents).concat(B);v.contents=Y}else break}})})(this,h,e)}async generateContentInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=FC(this.apiClient,e);return c=bt("{model}:generateContent",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=VC(g),y=new Ag;return Object.assign(y,v),y})}else{const p=jC(this.apiClient,e);return c=bt("{model}:generateContent",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=BC(g),y=new Ag;return Object.assign(y,v),y})}}async generateContentStreamInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=FC(this.apiClient,e);return c=bt("{model}:streamGenerateContent?alt=sse",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(v){return Io(this,arguments,function*(){var y,w,E,R;try{for(var N=!0,A=Do(v),I;I=yield Qt(A.next()),y=I.done,!y;N=!0){R=I.value,N=!1;const D=R,U=VC(yield Qt(D.json()));U.sdkHttpResponse={headers:D.headers};const j=new Ag;Object.assign(j,U),yield yield Qt(j)}}catch(D){w={error:D}}finally{try{!N&&!y&&(E=A.return)&&(yield Qt(E.call(A)))}finally{if(w)throw w.error}}})})}else{const p=jC(this.apiClient,e);return c=bt("{model}:streamGenerateContent?alt=sse",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(v){return Io(this,arguments,function*(){var y,w,E,R;try{for(var N=!0,A=Do(v),I;I=yield Qt(A.next()),y=I.done,!y;N=!0){R=I.value,N=!1;const D=R,U=BC(yield Qt(D.json()));U.sdkHttpResponse={headers:D.headers};const j=new Ag;Object.assign(j,U),yield yield Qt(j)}}catch(D){w={error:D}}finally{try{!N&&!y&&(E=A.return)&&(yield Qt(E.call(A)))}finally{if(w)throw w.error}}})})}}async embedContent(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=J7(this.apiClient,e);return c=bt("{model}:predict",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=Z7(g),y=new wC;return Object.assign(y,v),y})}else{const p=Y7(this.apiClient,e);return c=bt("{model}:batchEmbedContents",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=K7(g),y=new wC;return Object.assign(y,v),y})}}async generateImagesInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=cq(this.apiClient,e);return c=bt("{model}:predict",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=dq(g),y=new SC;return Object.assign(y,v),y})}else{const p=lq(this.apiClient,e);return c=bt("{model}:predict",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=uq(g),y=new SC;return Object.assign(y,v),y})}}async editImageInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const c=q7(this.apiClient,e);return r=bt("{model}:predict",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const p=W7(h),g=new QH;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const c=cW(this.apiClient,e);return r=bt("{model}:predict",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const p=uW(h),g=new eG;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const c=Gq(this.apiClient,e);return r=bt("{model}:predict",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=qq(h),g=new tG;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const c=Kq(this.apiClient,e);return r=bt("{model}:predict",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=Zq(h),g=new nG;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=Nq(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>N1(g))}else{const p=Aq(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o.then(g=>A1(g))}}async listInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=Oq(this.apiClient,e);return c=bt("{models_url}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=jq(g),y=new TC;return Object.assign(y,v),y})}else{const p=Lq(this.apiClient,e);return c=bt("{models_url}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=zq(g),y=new TC;return Object.assign(y,v),y})}}async update(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=oW(this.apiClient,e);return c=bt("{model}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>N1(g))}else{const p=aW(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o.then(g=>A1(g))}}async delete(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=B7(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=H7(g),y=new EC;return Object.assign(y,v),y})}else{const p=F7(this.apiClient,e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=V7(g),y=new EC;return Object.assign(y,v),y})}}async countTokens(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=O7(this.apiClient,e);return c=bt("{model}:countTokens",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=j7(g),y=new MC;return Object.assign(y,v),y})}else{const p=L7(this.apiClient,e);return c=bt("{model}:countTokens",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=z7(g),y=new MC;return Object.assign(y,v),y})}}async computeTokens(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const c=C7(this.apiClient,e);return r=bt("{model}:computeTokens",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>{const p=R7(h),g=new iG;return Object.assign(g,p),g})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=xq(this.apiClient,e);return c=bt("{model}:predictLongRunning",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o.then(g=>{const v=mq(g),y=new kb;return Object.assign(y,v),y})}else{const p=gq(this.apiClient,e);return c=bt("{model}:predictLongRunning",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o.then(g=>{const v=pq(g),y=new kb;return Object.assign(y,v),y})}}}class i$ extends Ec{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=$H(e);return c=bt("{operationName}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json()),o}else{const p=WH(e);return c=bt("{operationName}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json()),o}}async fetchPredictVideosOperationInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const c=jH(e);return r=bt("{resourceName}:fetchPredictOperation",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}function s$(n){const e={},t=_(n,["data"]);if(t!=null&&S(e,["data"],t),_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function r$(n){const e={},t=_(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>p$(r))),S(e,["parts"],s)}const i=_(n,["role"]);return i!=null&&S(e,["role"],i),e}function a$(n,e,t){const i={},s=_(e,["expireTime"]);t!==void 0&&s!=null&&S(t,["expireTime"],s);const r=_(e,["newSessionExpireTime"]);t!==void 0&&r!=null&&S(t,["newSessionExpireTime"],r);const o=_(e,["uses"]);t!==void 0&&o!=null&&S(t,["uses"],o);const c=_(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&S(t,["bidiGenerateContentSetup"],f$(n,c));const h=_(e,["lockAdditionalFields"]);return t!==void 0&&h!=null&&S(t,["fieldMask"],h),i}function o$(n,e){const t={},i=_(e,["config"]);return i!=null&&S(t,["config"],a$(n,i,t)),t}function l$(n){const e={};if(_(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=_(n,["fileUri"]);t!=null&&S(e,["fileUri"],t);const i=_(n,["mimeType"]);return i!=null&&S(e,["mimeType"],i),e}function c$(n){const e={},t=_(n,["id"]);t!=null&&S(e,["id"],t);const i=_(n,["args"]);i!=null&&S(e,["args"],i);const s=_(n,["name"]);if(s!=null&&S(e,["name"],s),_(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(_(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function u$(n){const e={};if(_(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=_(n,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function d$(n){const e={};if(_(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(_(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=_(n,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function h$(n,e){const t={},i=_(n,["generationConfig"]);e!==void 0&&i!=null&&S(e,["setup","generationConfig"],i);const s=_(n,["responseModalities"]);e!==void 0&&s!=null&&S(e,["setup","generationConfig","responseModalities"],s);const r=_(n,["temperature"]);e!==void 0&&r!=null&&S(e,["setup","generationConfig","temperature"],r);const o=_(n,["topP"]);e!==void 0&&o!=null&&S(e,["setup","generationConfig","topP"],o);const c=_(n,["topK"]);e!==void 0&&c!=null&&S(e,["setup","generationConfig","topK"],c);const h=_(n,["maxOutputTokens"]);e!==void 0&&h!=null&&S(e,["setup","generationConfig","maxOutputTokens"],h);const p=_(n,["mediaResolution"]);e!==void 0&&p!=null&&S(e,["setup","generationConfig","mediaResolution"],p);const g=_(n,["seed"]);e!==void 0&&g!=null&&S(e,["setup","generationConfig","seed"],g);const v=_(n,["speechConfig"]);e!==void 0&&v!=null&&S(e,["setup","generationConfig","speechConfig"],YT(v));const y=_(n,["thinkingConfig"]);e!==void 0&&y!=null&&S(e,["setup","generationConfig","thinkingConfig"],y);const w=_(n,["enableAffectiveDialog"]);e!==void 0&&w!=null&&S(e,["setup","generationConfig","enableAffectiveDialog"],w);const E=_(n,["systemInstruction"]);e!==void 0&&E!=null&&S(e,["setup","systemInstruction"],r$(rr(E)));const R=_(n,["tools"]);if(e!==void 0&&R!=null){let F=zp(R);Array.isArray(F)&&(F=F.map(z=>g$(Op(z)))),S(e,["setup","tools"],F)}const N=_(n,["sessionResumption"]);e!==void 0&&N!=null&&S(e,["setup","sessionResumption"],m$(N));const A=_(n,["inputAudioTranscription"]);e!==void 0&&A!=null&&S(e,["setup","inputAudioTranscription"],A);const I=_(n,["outputAudioTranscription"]);e!==void 0&&I!=null&&S(e,["setup","outputAudioTranscription"],I);const D=_(n,["realtimeInputConfig"]);e!==void 0&&D!=null&&S(e,["setup","realtimeInputConfig"],D);const U=_(n,["contextWindowCompression"]);e!==void 0&&U!=null&&S(e,["setup","contextWindowCompression"],U);const j=_(n,["proactivity"]);if(e!==void 0&&j!=null&&S(e,["setup","proactivity"],j),_(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function f$(n,e){const t={},i=_(e,["model"]);i!=null&&S(t,["setup","model"],Fn(n,i));const s=_(e,["config"]);return s!=null&&S(t,["config"],h$(s,t)),t}function p$(n){const e={},t=_(n,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const i=_(n,["codeExecutionResult"]);i!=null&&S(e,["codeExecutionResult"],i);const s=_(n,["executableCode"]);s!=null&&S(e,["executableCode"],s);const r=_(n,["fileData"]);r!=null&&S(e,["fileData"],l$(r));const o=_(n,["functionCall"]);o!=null&&S(e,["functionCall"],c$(o));const c=_(n,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const h=_(n,["inlineData"]);h!=null&&S(e,["inlineData"],s$(h));const p=_(n,["text"]);p!=null&&S(e,["text"],p);const g=_(n,["thought"]);g!=null&&S(e,["thought"],g);const v=_(n,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const y=_(n,["videoMetadata"]);return y!=null&&S(e,["videoMetadata"],y),e}function m$(n){const e={},t=_(n,["handle"]);if(t!=null&&S(e,["handle"],t),_(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function g$(n){const e={};if(_(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=_(n,["computerUse"]);t!=null&&S(e,["computerUse"],t);const i=_(n,["fileSearch"]);i!=null&&S(e,["fileSearch"],i);const s=_(n,["codeExecution"]);if(s!=null&&S(e,["codeExecution"],s),_(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const r=_(n,["functionDeclarations"]);if(r!=null){let g=r;Array.isArray(g)&&(g=g.map(v=>v)),S(e,["functionDeclarations"],g)}const o=_(n,["googleMaps"]);o!=null&&S(e,["googleMaps"],u$(o));const c=_(n,["googleSearch"]);c!=null&&S(e,["googleSearch"],d$(c));const h=_(n,["googleSearchRetrieval"]);h!=null&&S(e,["googleSearchRetrieval"],h);const p=_(n,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}function x$(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const s=Object.keys(i).map(r=>`${t}.${r}`);e.push(...s)}else e.push(t)}return e.join(",")}function v$(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const r=i.setup;typeof r=="object"&&r!==null?(n.bidiGenerateContentSetup=r,t=r):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const r=x$(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)r?n.fieldMask=r:delete n.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];s.length>0&&(c=s.map(p=>o.includes(p)?`generationConfig.${p}`:p));const h=[];r&&h.push(r),c.length>0&&h.push(...c),h.length>0?n.fieldMask=h.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class y$ extends Ec{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=o$(this.apiClient,e);r=bt("auth_tokens",c._url),o=c._query,delete c.config,delete c._url,delete c._query;const h=v$(c,e.config);return s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),s.then(p=>p)}}}function b$(n,e){const t={},i=_(n,["force"]);return e!==void 0&&i!=null&&S(e,["_query","force"],i),t}function _$(n){const e={},t=_(n,["name"]);t!=null&&S(e,["_url","name"],t);const i=_(n,["config"]);return i!=null&&b$(i,e),e}function w$(n){const e={},t=_(n,["name"]);return t!=null&&S(e,["_url","name"],t),e}function S$(n,e){const t={},i=_(n,["pageSize"]);e!==void 0&&i!=null&&S(e,["_query","pageSize"],i);const s=_(n,["pageToken"]);return e!==void 0&&s!=null&&S(e,["_query","pageToken"],s),t}function T$(n){const e={},t=_(n,["parent"]);t!=null&&S(e,["_url","parent"],t);const i=_(n,["config"]);return i!=null&&S$(i,e),e}function E$(n){const e={},t=_(n,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const i=_(n,["nextPageToken"]);i!=null&&S(e,["nextPageToken"],i);const s=_(n,["documents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),S(e,["documents"],r)}return e}class M$ extends Ec{constructor(e){super(),this.apiClient=e,this.list=async t=>new bh(Sc.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=w$(e);return r=bt("{name}",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=_$(e);s=bt("{name}",o._url),r=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=T$(e);return r=bt("{parent}/documents",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=E$(h),g=new sG;return Object.assign(g,p),g})}}}class A$ extends Ec{constructor(e,t=new M$(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new bh(Sc.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=xW(e);return r=bt("fileSearchStores",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=bW(e);return r=bt("{name}",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>h)}}async delete(e){var t,i;let s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=yW(e);s=bt("{name}",o._url),r=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=MW(e);return r=bt("fileSearchStores",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=AW(h),g=new rG;return Object.assign(g,p),g})}}async uploadToFileSearchStoreInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=NW(e);return r=bt("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=CW(h),g=new aG;return Object.assign(g,p),g})}}async importFile(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=SW(e);return r=bt("{file_search_store_name}:importFile",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),s.then(h=>{const p=wW(h),g=new GT;return Object.assign(g,p),g})}}}let E3=function(){const{crypto:n}=globalThis;if(n?.randomUUID)return E3=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))};const N$=()=>E3();function R1(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const k1=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};class Qa extends Error{}class Nr extends Qa{constructor(e,t,i,s){super(`${Nr.makeMessage(e,t,i)}`),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,i){const s=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,i,s){if(!e||!s)return new P_({message:i,cause:k1(t)});const r=t;return e===400?new A3(e,r,i,s):e===401?new N3(e,r,i,s):e===403?new C3(e,r,i,s):e===404?new R3(e,r,i,s):e===409?new k3(e,r,i,s):e===422?new I3(e,r,i,s):e===429?new D3(e,r,i,s):e>=500?new P3(e,r,i,s):new Nr(e,r,i,s)}}class I1 extends Nr{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class P_ extends Nr{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class M3 extends P_{constructor({message:e}={}){super({message:e??"Request timed out."})}}class A3 extends Nr{}class N3 extends Nr{}class C3 extends Nr{}class R3 extends Nr{}class k3 extends Nr{}class I3 extends Nr{}class D3 extends Nr{}class P3 extends Nr{}const C$=/^[a-z][a-z0-9+.-]*:/i,R$=n=>C$.test(n);let D1=n=>(D1=Array.isArray,D1(n));const k$=D1;let I$=k$;const XC=I$;function D$(n){if(!n)return!0;for(const e in n)return!1;return!0}function P$(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const U$=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Qa(`${n} must be an integer`);if(e<0)throw new Qa(`${n} must be a positive integer`);return e},L$=n=>{try{return JSON.parse(n)}catch{return}};const O$=n=>new Promise(e=>setTimeout(e,n));const op="0.0.1";function z$(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const j$=()=>{var n,e,t,i,s;const r=z$();if(r==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":op,"X-Stainless-OS":JC(Deno.build.os),"X-Stainless-Arch":YC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":op,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(r==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":op,"X-Stainless-OS":JC((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":YC((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const o=F$();return o?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":op,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${o.browser}`,"X-Stainless-Runtime-Version":o.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":op,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function F$(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const i=t.exec(navigator.userAgent);if(i){const s=i[1]||0,r=i[2]||0,o=i[3]||0;return{browser:e,version:`${s}.${r}.${o}`}}}return null}const YC=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",JC=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let fy;const B$=()=>fy??(fy=j$());function V$(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function U3(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function H$(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return U3({start(){},async pull(t){const{done:i,value:s}=await e.next();i?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function L3(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function G$(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const i=n.getReader(),s=i.cancel();i.releaseLock(),await s}const q$=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});const O3=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e?.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function US(n,e,t){return O3(),new File(n,e??"unknown_file",t)}function W$(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const $$=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";const z3=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",X$=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&z3(n),Y$=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function J$(n,e,t){if(O3(),n=await n,X$(n))return n instanceof File?n:US([await n.arrayBuffer()],n.name);if(Y$(n)){const s=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),US(await P1(s),e,t)}const i=await P1(n);if(e||(e=W$(n)),!t?.type){const s=i.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof s=="string"&&(t=Object.assign(Object.assign({},t),{type:s}))}return US(i,e,t)}async function P1(n){var e,t,i,s,r;let o=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)o.push(n);else if(z3(n))o.push(n instanceof Blob?n:await n.arrayBuffer());else if($$(n))try{for(var c=!0,h=Do(n),p;p=await h.next(),e=p.done,!e;c=!0){s=p.value,c=!1;const g=s;o.push(...await P1(g))}}catch(g){t={error:g}}finally{try{!c&&!e&&(i=h.return)&&await i.call(h)}finally{if(t)throw t.error}}else{const g=(r=n?.constructor)===null||r===void 0?void 0:r.name;throw new Error(`Unexpected data type: ${typeof n}${g?`; constructor: ${g}`:""}${K$(n)}`)}return o}function K$(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}class j3{constructor(e){this._client=e}}j3._key=[];function F3(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const KC=Object.freeze(Object.create(null)),Z$=(n=F3)=>(function(t,...i){if(t.length===1)return t[0];let s=!1;const r=[],o=t.reduce((g,v,y)=>{var w,E,R;/[?#]/.test(v)&&(s=!0);const N=i[y];let A=(s?encodeURIComponent:n)(""+N);return y!==i.length&&(N==null||typeof N=="object"&&N.toString===((R=Object.getPrototypeOf((E=Object.getPrototypeOf((w=N.hasOwnProperty)!==null&&w!==void 0?w:KC))!==null&&E!==void 0?E:KC))===null||R===void 0?void 0:R.toString))&&(A=N+"",r.push({start:g.length+v.length,length:A.length,error:`Value of type ${Object.prototype.toString.call(N).slice(8,-1)} is not a valid path parameter`})),g+v+(y===i.length?"":A)},""),c=o.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let p;for(;(p=h.exec(c))!==null;)r.push({start:p.index,length:p[0].length,error:`Value "${p[0]}" can't be safely passed as a path parameter`});if(r.sort((g,v)=>g.start-v.start),r.length>0){let g=0;const v=r.reduce((y,w)=>{const E=" ".repeat(w.start-g),R="^".repeat(w.length);return g=w.start+w.length,y+E+R},"");throw new Qa(`Path parameters result in path with invalid segments:
${r.map(y=>y.error).join(`
`)}
${o}
${v}`)}return o}),py=Z$(F3);class B3 extends j3{create(e,t){var i;const{api_version:s=this._client.apiVersion}=e,r=Db(e,["api_version"]);if("model"in r&&"agent_config"in r)throw new Qa("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in r&&"generation_config"in r)throw new Qa("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(py`/${s}/interactions`,Object.assign(Object.assign({body:r},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){const{api_version:s=this._client.apiVersion}=t??{};return this._client.delete(py`/${s}/interactions/${e}`,i)}cancel(e,t={},i){const{api_version:s=this._client.apiVersion}=t??{};return this._client.post(py`/${s}/interactions/${e}/cancel`,i)}get(e,t={},i){var s;const r=t??{},{api_version:o=this._client.apiVersion}=r,c=Db(r,["api_version"]);return this._client.get(py`/${o}/interactions/${e}`,Object.assign(Object.assign({query:c},i),{stream:(s=t?.stream)!==null&&s!==void 0?s:!1}))}}B3._key=Object.freeze(["interactions"]);class V3 extends B3{}function Q$(n){let e=0;for(const s of n)e+=s.length;const t=new Uint8Array(e);let i=0;for(const s of n)t.set(s,i),i+=s.length;return t}let my;function KT(n){let e;return(my??(e=new globalThis.TextEncoder,my=e.encode.bind(e)))(n)}let gy;function ZC(n){let e;return(gy??(e=new globalThis.TextDecoder,gy=e.decode.bind(e)))(n)}class U_{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?KT(e):e;this.buffer=Q$([this.buffer,t]);const i=[];let s;for(;(s=eX(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){i.push(ZC(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const r=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,o=ZC(this.buffer.subarray(0,r));i.push(o),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}U_.NEWLINE_CHARS=new Set([`
`,"\r"]);U_.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function eX(n,e){for(let s=e??0;s<n.length;s++){if(n[s]===10)return{preceding:s,index:s+1,carriage:!1};if(n[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function tX(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}const Pb={off:0,error:200,warn:300,info:400,debug:500},QC=(n,e,t)=>{if(n){if(P$(Pb,n))return n;Tr(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Pb))}`)}};function Ug(){}function xy(n,e,t){return!e||Pb[n]>Pb[t]?Ug:e[n].bind(e)}const nX={error:Ug,warn:Ug,info:Ug,debug:Ug};let eR=new WeakMap;function Tr(n){var e;const t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return nX;const s=eR.get(t);if(s&&s[0]===i)return s[1];const r={error:xy("error",t,i),warn:xy("warn",t,i),info:xy("info",t,i),debug:xy("debug",t,i)};return eR.set(t,[i,r]),r}const Jd=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);class fp{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let s=!1;const r=i?Tr(i):console;function o(){return Io(this,arguments,function*(){var h,p,g,v;if(s)throw new Qa("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let y=!1;try{try{for(var w=!0,E=Do(iX(e,t)),R;R=yield Qt(E.next()),h=R.done,!h;w=!0){v=R.value,w=!1;const N=v;if(!y)if(N.data.startsWith("[DONE]")){y=!0;continue}else try{yield yield Qt(JSON.parse(N.data))}catch(A){throw r.error("Could not parse message into JSON:",N.data),r.error("From chunk:",N.raw),A}}}catch(N){p={error:N}}finally{try{!w&&!h&&(g=E.return)&&(yield Qt(g.call(E)))}finally{if(p)throw p.error}}y=!0}catch(N){if(R1(N))return yield Qt(void 0);throw N}finally{y||t.abort()}})}return new fp(o,t,i)}static fromReadableStream(e,t,i){let s=!1;function r(){return Io(this,arguments,function*(){var h,p,g,v;const y=new U_,w=L3(e);try{for(var E=!0,R=Do(w),N;N=yield Qt(R.next()),h=N.done,!h;E=!0){v=N.value,E=!1;const A=v;for(const I of y.decode(A))yield yield Qt(I)}}catch(A){p={error:A}}finally{try{!E&&!h&&(g=R.return)&&(yield Qt(g.call(R)))}finally{if(p)throw p.error}}for(const A of y.flush())yield yield Qt(A)})}function o(){return Io(this,arguments,function*(){var h,p,g,v;if(s)throw new Qa("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let y=!1;try{try{for(var w=!0,E=Do(r()),R;R=yield Qt(E.next()),h=R.done,!h;w=!0){v=R.value,w=!1;const N=v;y||N&&(yield yield Qt(JSON.parse(N)))}}catch(N){p={error:N}}finally{try{!w&&!h&&(g=E.return)&&(yield Qt(g.call(E)))}finally{if(p)throw p.error}}y=!0}catch(N){if(R1(N))return yield Qt(void 0);throw N}finally{y||t.abort()}})}return new fp(o,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],i=this.iterator(),s=r=>({next:()=>{if(r.length===0){const o=i.next();e.push(o),t.push(o)}return r.shift()}});return[new fp(()=>s(e),this.controller,this.client),new fp(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return U3({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:r}=await t.next();if(r)return i.close();const o=KT(JSON.stringify(s)+`
`);i.enqueue(o)}catch(s){i.error(s)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}}function iX(n,e){return Io(this,arguments,function*(){var i,s,r,o;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Qa("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Qa("Attempted to iterate over a response with no body");const c=new rX,h=new U_,p=L3(n.body);try{for(var g=!0,v=Do(sX(p)),y;y=yield Qt(v.next()),i=y.done,!i;g=!0){o=y.value,g=!1;const w=o;for(const E of h.decode(w)){const R=c.decode(E);R&&(yield yield Qt(R))}}}catch(w){s={error:w}}finally{try{!g&&!i&&(r=v.return)&&(yield Qt(r.call(v)))}finally{if(s)throw s.error}}for(const w of h.flush()){const E=c.decode(w);E&&(yield yield Qt(E))}})}function sX(n){return Io(this,arguments,function*(){var t,i,s,r;let o=new Uint8Array;try{for(var c=!0,h=Do(n),p;p=yield Qt(h.next()),t=p.done,!t;c=!0){r=p.value,c=!1;const g=r;if(g==null)continue;const v=g instanceof ArrayBuffer?new Uint8Array(g):typeof g=="string"?KT(g):g;let y=new Uint8Array(o.length+v.length);y.set(o),y.set(v,o.length),o=y;let w;for(;(w=tX(o))!==-1;)yield yield Qt(o.slice(0,w)),o=o.slice(w)}}catch(g){i={error:g}}finally{try{!c&&!t&&(s=h.return)&&(yield Qt(s.call(h)))}finally{if(i)throw i.error}}o.length>0&&(yield yield Qt(o))})}class rX{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,s]=aX(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function aX(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}async function oX(n,e){const{response:t,requestLogID:i,retryOfRequestLogID:s,startTime:r}=e,o=await(async()=>{var c;if(e.options.stream)return Tr(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):fp.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const h=t.headers.get("content-type"),p=(c=h?.split(";")[0])===null||c===void 0?void 0:c.trim();return p?.includes("application/json")||p?.endsWith("+json")?await t.json():await t.text()})();return Tr(n).debug(`[${i}] response parsed`,Jd({retryOfRequestLogID:s,url:t.url,status:t.status,body:o,durationMs:Date.now()-r})),o}class ZT extends Promise{constructor(e,t,i=oX){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new ZT(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const H3=Symbol("brand.privateNullableHeaders");function*lX(n){if(!n)return;if(H3 in n){const{values:i,nulls:s}=n;yield*i.entries();for(const r of s)yield[r,null];return}let e=!1,t;n instanceof Headers?t=n.entries():XC(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){const s=i[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const r=XC(i[1])?i[1]:[i[1]];let o=!1;for(const c of r)c!==void 0&&(e&&!o&&(o=!0,yield[s,null]),yield[s,c])}}const Ng=n=>{const e=new Headers,t=new Set;for(const i of n){const s=new Set;for(const[r,o]of lX(i)){const c=r.toLowerCase();s.has(c)||(e.delete(r),s.add(c)),o===null?(e.delete(r),t.add(c)):(e.append(r,o),t.delete(c))}}return{[H3]:!0,values:e,nulls:t}};const LS=n=>{var e,t,i,s,r,o;if(typeof globalThis.process<"u")return(i=(t=(e=DH)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(o=(r=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||r===void 0?void 0:r.call(s,n))===null||o===void 0?void 0:o.trim()};var G3;class L_{constructor(e){var t,i,s,r,o,c,h,{baseURL:p=LS("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:g=(t=LS("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:v="v1beta"}=e,y=Db(e,["baseURL","apiKey","apiVersion"]);const w=Object.assign(Object.assign({apiKey:g,apiVersion:v},y),{baseURL:p||"https://generativelanguage.googleapis.com"});this.baseURL=w.baseURL,this.timeout=(i=w.timeout)!==null&&i!==void 0?i:L_.DEFAULT_TIMEOUT,this.logger=(s=w.logger)!==null&&s!==void 0?s:console;const E="warn";this.logLevel=E,this.logLevel=(o=(r=QC(w.logLevel,"ClientOptions.logLevel",this))!==null&&r!==void 0?r:QC(LS("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&o!==void 0?o:E,this.fetchOptions=w.fetchOptions,this.maxRetries=(c=w.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(h=w.fetch)!==null&&h!==void 0?h:V$(),this.encoder=q$,this._options=w,this.apiKey=g,this.apiVersion=v,this.clientAdapter=w.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=Ng([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return Ng([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Ng([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,i])=>typeof i<"u").map(([t,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(t)}=`;throw new Qa(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${op}`}defaultIdempotencyKey(){return`stainless-node-retry-${N$()}`}makeStatusError(e,t,i,s){return Nr.generate(e,t,i,s)}buildURL(e,t,i){const s=!this.baseURLOverridden()&&i||this.baseURL,r=R$(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return D$(o)||(t=Object.assign(Object.assign({},o),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:i}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,i){return this.request(Promise.resolve(i).then(s=>Object.assign({method:e,path:t},s)))}request(e,t=null){return new ZT(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,i){var s,r,o;const c=await e,h=(s=c.maxRetries)!==null&&s!==void 0?s:this.maxRetries;t==null&&(t=h),await this.prepareOptions(c);const{req:p,url:g,timeout:v}=await this.buildRequest(c,{retryCount:h-t});await this.prepareRequest(p,{url:g,options:c});const y="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),w=i===void 0?"":`, retryOf: ${i}`,E=Date.now();if(Tr(this).debug(`[${y}] sending request`,Jd({retryOfRequestLogID:i,method:c.method,url:g,options:c,headers:p.headers})),!((r=c.signal)===null||r===void 0)&&r.aborted)throw new I1;const R=new AbortController,N=await this.fetchWithTimeout(g,p,v,R).catch(k1),A=Date.now();if(N instanceof globalThis.Error){const D=`retrying, ${t} attempts remaining`;if(!((o=c.signal)===null||o===void 0)&&o.aborted)throw new I1;const U=R1(N)||/timed? ?out/i.test(String(N)+("cause"in N?String(N.cause):""));if(t)return Tr(this).info(`[${y}] connection ${U?"timed out":"failed"} - ${D}`),Tr(this).debug(`[${y}] connection ${U?"timed out":"failed"} (${D})`,Jd({retryOfRequestLogID:i,url:g,durationMs:A-E,message:N.message})),this.retryRequest(c,t,i??y);throw Tr(this).info(`[${y}] connection ${U?"timed out":"failed"} - error; no more retries left`),Tr(this).debug(`[${y}] connection ${U?"timed out":"failed"} (error; no more retries left)`,Jd({retryOfRequestLogID:i,url:g,durationMs:A-E,message:N.message})),U?new M3:new P_({cause:N})}const I=`[${y}${w}] ${p.method} ${g} ${N.ok?"succeeded":"failed"} with status ${N.status} in ${A-E}ms`;if(!N.ok){const D=await this.shouldRetry(N);if(t&&D){const L=`retrying, ${t} attempts remaining`;return await G$(N.body),Tr(this).info(`${I} - ${L}`),Tr(this).debug(`[${y}] response error (${L})`,Jd({retryOfRequestLogID:i,url:N.url,status:N.status,headers:N.headers,durationMs:A-E})),this.retryRequest(c,t,i??y,N.headers)}const U=D?"error; no more retries left":"error; not retryable";Tr(this).info(`${I} - ${U}`);const j=await N.text().catch(L=>k1(L).message),F=L$(j),z=F?void 0:j;throw Tr(this).debug(`[${y}] response error (${U})`,Jd({retryOfRequestLogID:i,url:N.url,status:N.status,headers:N.headers,message:z,durationMs:Date.now()-E})),this.makeStatusError(N.status,F,z,N.headers)}return Tr(this).info(I),Tr(this).debug(`[${y}] response start`,Jd({retryOfRequestLogID:i,url:N.url,status:N.status,headers:N.headers,durationMs:A-E})),{response:N,options:c,controller:R,requestLogID:y,retryOfRequestLogID:i,startTime:E}}async fetchWithTimeout(e,t,i,s){const r=t||{},{signal:o,method:c}=r,h=Db(r,["signal","method"]);o&&o.addEventListener("abort",()=>s.abort());const p=setTimeout(()=>s.abort(),i),g=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||typeof h.body=="object"&&h.body!==null&&Symbol.asyncIterator in h.body,v=Object.assign(Object.assign(Object.assign({signal:s.signal},g?{duplex:"half"}:{}),{method:"GET"}),h);c&&(v.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,v)}finally{clearTimeout(p)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,i,s){var r;let o;const c=s?.get("retry-after-ms");if(c){const p=parseFloat(c);Number.isNaN(p)||(o=p)}const h=s?.get("retry-after");if(h&&!o){const p=parseFloat(h);Number.isNaN(p)?o=Date.parse(h)-Date.now():o=p*1e3}if(!(o&&0<=o&&o<60*1e3)){const p=(r=e.maxRetries)!==null&&r!==void 0?r:this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(t,p)}return await O$(o),this.makeRequest(e,t-1,i)}calculateDefaultRetryTimeoutMillis(e,t){const r=t-e,o=Math.min(.5*Math.pow(2,r),8),c=1-Math.random()*.25;return o*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var i,s,r;const o=Object.assign({},e),{method:c,path:h,query:p,defaultBaseURL:g}=o,v=this.buildURL(h,p,g);"timeout"in o&&U$("timeout",o.timeout),o.timeout=(i=o.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:y,body:w}=this.buildBody({options:o}),E=await this.buildHeaders({options:e,method:c,bodyHeaders:y,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:E},o.signal&&{signal:o.signal}),globalThis.ReadableStream&&w instanceof globalThis.ReadableStream&&{duplex:"half"}),w&&{body:w}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(r=o.fetchOptions)!==null&&r!==void 0?r:{}),url:v,timeout:o.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:i,retryCount:s}){let r={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=e.idempotencyKey);const o=await this.authHeaders(e);let c=Ng([r,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),B$()),this._options.defaultHeaders,i,e.headers,o]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=Ng([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:H$(e)}:this.encoder({body:e,headers:i})}}L_.DEFAULT_TIMEOUT=6e4;class Ms extends L_{constructor(){super(...arguments),this.interactions=new V3(this)}}G3=Ms;Ms.GeminiNextGenAPIClient=G3;Ms.GeminiNextGenAPIClientError=Qa;Ms.APIError=Nr;Ms.APIConnectionError=P_;Ms.APIConnectionTimeoutError=M3;Ms.APIUserAbortError=I1;Ms.NotFoundError=R3;Ms.ConflictError=k3;Ms.RateLimitError=D3;Ms.BadRequestError=A3;Ms.AuthenticationError=N3;Ms.InternalServerError=P3;Ms.PermissionDeniedError=C3;Ms.UnprocessableEntityError=I3;Ms.toFile=J$;Ms.Interactions=V3;function cX(n,e){const t={},i=_(n,["name"]);return i!=null&&S(t,["_url","name"],i),t}function uX(n,e){const t={},i=_(n,["name"]);return i!=null&&S(t,["_url","name"],i),t}function dX(n,e){const t={},i=_(n,["sdkHttpResponse"]);return i!=null&&S(t,["sdkHttpResponse"],i),t}function hX(n,e){const t={},i=_(n,["sdkHttpResponse"]);return i!=null&&S(t,["sdkHttpResponse"],i),t}function fX(n,e,t){const i={};if(_(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=_(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&S(e,["displayName"],s),_(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=_(n,["epochCount"]);e!==void 0&&r!=null&&S(e,["tuningTask","hyperparameters","epochCount"],r);const o=_(n,["learningRateMultiplier"]);if(o!=null&&S(i,["tuningTask","hyperparameters","learningRateMultiplier"],o),_(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(_(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(_(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=_(n,["batchSize"]);e!==void 0&&c!=null&&S(e,["tuningTask","hyperparameters","batchSize"],c);const h=_(n,["learningRate"]);if(e!==void 0&&h!=null&&S(e,["tuningTask","hyperparameters","learningRate"],h),_(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(_(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function pX(n,e,t){const i={};let s=_(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const w=_(n,["validationDataset"]);e!==void 0&&w!=null&&S(e,["supervisedTuningSpec"],tR(w))}else if(s==="PREFERENCE_TUNING"){const w=_(n,["validationDataset"]);e!==void 0&&w!=null&&S(e,["preferenceOptimizationSpec"],tR(w))}const r=_(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&S(e,["tunedModelDisplayName"],r);const o=_(n,["description"]);e!==void 0&&o!=null&&S(e,["description"],o);let c=_(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const w=_(n,["epochCount"]);e!==void 0&&w!=null&&S(e,["supervisedTuningSpec","hyperParameters","epochCount"],w)}else if(c==="PREFERENCE_TUNING"){const w=_(n,["epochCount"]);e!==void 0&&w!=null&&S(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],w)}let h=_(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const w=_(n,["learningRateMultiplier"]);e!==void 0&&w!=null&&S(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],w)}else if(h==="PREFERENCE_TUNING"){const w=_(n,["learningRateMultiplier"]);e!==void 0&&w!=null&&S(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],w)}let p=_(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const w=_(n,["exportLastCheckpointOnly"]);e!==void 0&&w!=null&&S(e,["supervisedTuningSpec","exportLastCheckpointOnly"],w)}else if(p==="PREFERENCE_TUNING"){const w=_(n,["exportLastCheckpointOnly"]);e!==void 0&&w!=null&&S(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],w)}let g=_(t,["config","method"]);if(g===void 0&&(g="SUPERVISED_FINE_TUNING"),g==="SUPERVISED_FINE_TUNING"){const w=_(n,["adapterSize"]);e!==void 0&&w!=null&&S(e,["supervisedTuningSpec","hyperParameters","adapterSize"],w)}else if(g==="PREFERENCE_TUNING"){const w=_(n,["adapterSize"]);e!==void 0&&w!=null&&S(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],w)}if(_(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(_(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const v=_(n,["labels"]);e!==void 0&&v!=null&&S(e,["labels"],v);const y=_(n,["beta"]);return e!==void 0&&y!=null&&S(e,["preferenceOptimizationSpec","hyperParameters","beta"],y),i}function mX(n,e){const t={},i=_(n,["baseModel"]);i!=null&&S(t,["baseModel"],i);const s=_(n,["preTunedModel"]);s!=null&&S(t,["preTunedModel"],s);const r=_(n,["trainingDataset"]);r!=null&&MX(r);const o=_(n,["config"]);return o!=null&&fX(o,t),t}function gX(n,e){const t={},i=_(n,["baseModel"]);i!=null&&S(t,["baseModel"],i);const s=_(n,["preTunedModel"]);s!=null&&S(t,["preTunedModel"],s);const r=_(n,["trainingDataset"]);r!=null&&AX(r,t,e);const o=_(n,["config"]);return o!=null&&pX(o,t,e),t}function xX(n,e){const t={},i=_(n,["name"]);return i!=null&&S(t,["_url","name"],i),t}function vX(n,e){const t={},i=_(n,["name"]);return i!=null&&S(t,["_url","name"],i),t}function yX(n,e,t){const i={},s=_(n,["pageSize"]);e!==void 0&&s!=null&&S(e,["_query","pageSize"],s);const r=_(n,["pageToken"]);e!==void 0&&r!=null&&S(e,["_query","pageToken"],r);const o=_(n,["filter"]);return e!==void 0&&o!=null&&S(e,["_query","filter"],o),i}function bX(n,e,t){const i={},s=_(n,["pageSize"]);e!==void 0&&s!=null&&S(e,["_query","pageSize"],s);const r=_(n,["pageToken"]);e!==void 0&&r!=null&&S(e,["_query","pageToken"],r);const o=_(n,["filter"]);return e!==void 0&&o!=null&&S(e,["_query","filter"],o),i}function _X(n,e){const t={},i=_(n,["config"]);return i!=null&&yX(i,t),t}function wX(n,e){const t={},i=_(n,["config"]);return i!=null&&bX(i,t),t}function SX(n,e){const t={},i=_(n,["sdkHttpResponse"]);i!=null&&S(t,["sdkHttpResponse"],i);const s=_(n,["nextPageToken"]);s!=null&&S(t,["nextPageToken"],s);const r=_(n,["tunedModels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(c=>q3(c))),S(t,["tuningJobs"],o)}return t}function TX(n,e){const t={},i=_(n,["sdkHttpResponse"]);i!=null&&S(t,["sdkHttpResponse"],i);const s=_(n,["nextPageToken"]);s!=null&&S(t,["nextPageToken"],s);const r=_(n,["tuningJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(c=>U1(c))),S(t,["tuningJobs"],o)}return t}function EX(n,e){const t={},i=_(n,["name"]);i!=null&&S(t,["model"],i);const s=_(n,["name"]);return s!=null&&S(t,["endpoint"],s),t}function MX(n,e){const t={};if(_(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(_(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=_(n,["examples"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),S(t,["examples","examples"],s)}return t}function AX(n,e,t){const i={};let s=_(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=_(n,["gcsUri"]);e!==void 0&&o!=null&&S(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=_(n,["gcsUri"]);e!==void 0&&o!=null&&S(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let r=_(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const o=_(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&S(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(r==="PREFERENCE_TUNING"){const o=_(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&S(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(_(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function q3(n,e){const t={},i=_(n,["sdkHttpResponse"]);i!=null&&S(t,["sdkHttpResponse"],i);const s=_(n,["name"]);s!=null&&S(t,["name"],s);const r=_(n,["state"]);r!=null&&S(t,["state"],o3(r));const o=_(n,["createTime"]);o!=null&&S(t,["createTime"],o);const c=_(n,["tuningTask","startTime"]);c!=null&&S(t,["startTime"],c);const h=_(n,["tuningTask","completeTime"]);h!=null&&S(t,["endTime"],h);const p=_(n,["updateTime"]);p!=null&&S(t,["updateTime"],p);const g=_(n,["description"]);g!=null&&S(t,["description"],g);const v=_(n,["baseModel"]);v!=null&&S(t,["baseModel"],v);const y=_(n,["_self"]);return y!=null&&S(t,["tunedModel"],EX(y)),t}function U1(n,e){const t={},i=_(n,["sdkHttpResponse"]);i!=null&&S(t,["sdkHttpResponse"],i);const s=_(n,["name"]);s!=null&&S(t,["name"],s);const r=_(n,["state"]);r!=null&&S(t,["state"],o3(r));const o=_(n,["createTime"]);o!=null&&S(t,["createTime"],o);const c=_(n,["startTime"]);c!=null&&S(t,["startTime"],c);const h=_(n,["endTime"]);h!=null&&S(t,["endTime"],h);const p=_(n,["updateTime"]);p!=null&&S(t,["updateTime"],p);const g=_(n,["error"]);g!=null&&S(t,["error"],g);const v=_(n,["description"]);v!=null&&S(t,["description"],v);const y=_(n,["baseModel"]);y!=null&&S(t,["baseModel"],y);const w=_(n,["tunedModel"]);w!=null&&S(t,["tunedModel"],w);const E=_(n,["preTunedModel"]);E!=null&&S(t,["preTunedModel"],E);const R=_(n,["supervisedTuningSpec"]);R!=null&&S(t,["supervisedTuningSpec"],R);const N=_(n,["preferenceOptimizationSpec"]);N!=null&&S(t,["preferenceOptimizationSpec"],N);const A=_(n,["tuningDataStats"]);A!=null&&S(t,["tuningDataStats"],A);const I=_(n,["encryptionSpec"]);I!=null&&S(t,["encryptionSpec"],I);const D=_(n,["partnerModelTuningSpec"]);D!=null&&S(t,["partnerModelTuningSpec"],D);const U=_(n,["customBaseModel"]);U!=null&&S(t,["customBaseModel"],U);const j=_(n,["experiment"]);j!=null&&S(t,["experiment"],j);const F=_(n,["labels"]);F!=null&&S(t,["labels"],F);const z=_(n,["outputUri"]);z!=null&&S(t,["outputUri"],z);const W=_(n,["pipelineJob"]);W!=null&&S(t,["pipelineJob"],W);const L=_(n,["serviceAccount"]);L!=null&&S(t,["serviceAccount"],L);const B=_(n,["tunedModelDisplayName"]);B!=null&&S(t,["tunedModelDisplayName"],B);const Y=_(n,["veoTuningSpec"]);return Y!=null&&S(t,["veoTuningSpec"],Y),t}function NX(n,e){const t={},i=_(n,["sdkHttpResponse"]);i!=null&&S(t,["sdkHttpResponse"],i);const s=_(n,["name"]);s!=null&&S(t,["name"],s);const r=_(n,["metadata"]);r!=null&&S(t,["metadata"],r);const o=_(n,["done"]);o!=null&&S(t,["done"],o);const c=_(n,["error"]);return c!=null&&S(t,["error"],c),t}function tR(n,e){const t={},i=_(n,["gcsUri"]);i!=null&&S(t,["validationDatasetUri"],i);const s=_(n,["vertexDatasetResource"]);return s!=null&&S(t,["validationDatasetUri"],s),t}class CX extends Ec{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new bh(Sc.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const r=Object.assign(Object.assign({},t),{preTunedModel:s});return r.baseModel=void 0,await this.tuneInternal(r)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),r=await this.tuneMldevInternal(s);let o="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?o=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(o=r.name.split("/operations/")[0]),{name:o,state:w1.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=vX(e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>U1(g))}else{const p=xX(e);return c=bt("{name}",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>q3(g))}}async listInternal(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=wX(e);return c=bt("tuningJobs",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=TX(g),y=new AC;return Object.assign(y,v),y})}else{const p=_X(e);return c=bt("tunedModels",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=SX(g),y=new AC;return Object.assign(y,v),y})}}async cancel(e){var t,i,s,r;let o,c="",h={};if(this.apiClient.isVertexAI()){const p=uX(e);return c=bt("{name}:cancel",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=hX(g),y=new NC;return Object.assign(y,v),y})}else{const p=cX(e);return c=bt("{name}:cancel",p._url),h=p._query,delete p._url,delete p._query,o=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(g=>g.json().then(v=>{const y=v;return y.sdkHttpResponse={headers:g.headers},y})),o.then(g=>{const v=dX(g),y=new NC;return Object.assign(y,v),y})}}async tuneInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const c=gX(e,e);return r=bt("tuningJobs",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>U1(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=mX(e);return r=bt("tunedModels",c._url),o=c._query,delete c._url,delete c._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),s.then(h=>NX(h))}}}class RX{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const kX=1024*1024*8,IX=3,DX=1e3,PX=2,Ub="x-goog-upload-status";async function UX(n,e,t){var i;const s=await W3(n,e,t),r=await s?.json();if(((i=s?.headers)===null||i===void 0?void 0:i[Ub])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return r.file}async function LX(n,e,t){var i;const s=await W3(n,e,t),r=await s?.json();if(((i=s?.headers)===null||i===void 0?void 0:i[Ub])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=t3(r),c=new qT;return Object.assign(c,o),c}async function W3(n,e,t){var i,s;let r=0,o=0,c=new T1(new Response),h="upload";for(r=n.size;o<r;){const p=Math.min(kX,r-o),g=n.slice(o,o+p);o+p>=r&&(h+=", finalize");let v=0,y=DX;for(;v<IX&&(c=await t.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(o),"Content-Length":String(p)}}}),!(!((i=c?.headers)===null||i===void 0)&&i[Ub]));)v++,await zX(y),y=y*PX;if(o+=p,((s=c?.headers)===null||s===void 0?void 0:s[Ub])!=="active")break;if(r<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function OX(n){return{size:n.size,type:n.type}}function zX(n){return new Promise(e=>setTimeout(e,n))}class jX{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await UX(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await LX(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await OX(e)}}class FX{create(e,t,i){return new BX(e,t,i)}}class BX{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const nR="x-goog-api-key";class VX{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(nR)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(nR,this.apiKey)}}}const HX="gl-node/";class GX{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new Ms({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=OH(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new VX(this.apiKey);this.apiClient=new OW({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:HX+"web",uploader:new jX,downloader:new RX}),this.models=new n$(this.apiClient),this.live=new JW(this.apiClient,s,new FX),this.batches=new h9(this.apiClient),this.chats=new $9(this.models,this.apiClient),this.caches=new G9(this.apiClient),this.files=new i7(this.apiClient),this.operations=new i$(this.apiClient),this.authTokens=new y$(this.apiClient),this.tunings=new CX(this.apiClient),this.fileSearchStores=new A$(this.apiClient)}}const qX="gemini-3-flash-preview",WX=async(n,e,t)=>{const i=new GX({apiKey:"AIzaSyDB3okRgXzyM5Hxo9BjknJZ6mF1f6qMS1U"}),s=`
    Du r "Horizonten Admin", en personlig lnk till att n oss direkt. Du ska inhmta informationen du jobbar utifrn frmst frn www.klattertradet.se som r hemsidan som styr denna app och du ska vara behaglig och mnsklig fr medlemmar i Horizonten-gemenskapen (Niv 2).
    Ditt ml r att hjlpa medlemmar med att hitta sin plats hr, knna sig vlkommna och sedda, motivera till personlig utveckling, att hlla sig till regler och gemenskapsfrgor.
    Svara professionellt, inspirerande och p svenska. 
    Du har djup kunskap om ntverkande, gemenskap, klttertrdet AB, Horizonten och ledarskap.
    Hll dina svar koncisa men insiktsfulla.
  `;try{return(await i.chats.create({model:qX,config:{systemInstruction:t||s,temperature:.7,topP:.8}}).sendMessage({message:e})).text}catch(r){return console.error("Gemini Error:",r),"Jag har tyvrr svrt att svara just nu. Frsk igen om en liten stund."}},$3="horizonten_notifications";let Ey=[];const X3=()=>{const n=localStorage.getItem($3);if(!n)return[];try{return JSON.parse(n)}catch(e){return console.error("Error parsing notifications:",e),[]}},Y3=n=>{localStorage.setItem($3,JSON.stringify(n)),Ey.forEach(e=>e(n))},L1=n=>{const e=X3(),t={...n,id:Math.random().toString(36).substr(2,9),timestamp:Date.now(),read:!1};Y3([t,...e].slice(0,50))},$X=()=>{Y3([])},XX=n=>(Ey.push(n),()=>{Ey=Ey.filter(e=>e!==n)}),QT=({user:n,threadId:e="general",showHeader:t=!0})=>{const[i,s]=ue.useState([]),[r,o]=ue.useState(""),[c,h]=ue.useState(null),p=ue.useRef(null);ue.useEffect(()=>{(async()=>{let w=Ji.from("messages").select("*, profiles(full_name, email, avatar_url)").order("created_at",{ascending:!0}).limit(50);e&&e!=="general"?w=w.eq("thread_id",e):w=w.is("thread_id",null);const{data:E,error:R}=await w;if(R&&console.error("Supabase Messages Error:",R),E){const N=E.map(A=>({id:A.id,role:A.is_ai?"model":"user",text:A.content,timestamp:new Date(A.created_at),persona:A.is_ai&&A.persona_id?Pg.find(I=>I.id===A.persona_id):void 0,senderName:A.is_ai?void 0:A.profiles?.full_name,senderEmail:A.is_ai?void 0:A.profiles?.email,senderAvatar:A.is_ai?void 0:A.profiles?.avatar_url}));s(N)}})();const y=Ji.channel(`public:messages:${e}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:e&&e!=="general"?`thread_id=eq.${e}`:void 0},async w=>{const E=w.new;if((e==="general"||!e)&&E.thread_id)return;let R="Ngon",N="",A="";if(!E.is_ai){const{data:D}=await Ji.from("profiles").select("full_name, email, avatar_url").eq("id",E.user_id).single();D&&(R=D.full_name,N=D.email,A=D.avatar_url)}const I={id:E.id,role:E.is_ai?"model":"user",text:E.content,timestamp:new Date(E.created_at),persona:E.is_ai&&E.persona_id?Pg.find(D=>D.id===E.persona_id):void 0,senderName:E.is_ai?void 0:R,senderEmail:E.is_ai?void 0:N,senderAvatar:E.is_ai?void 0:A};if(s(D=>D.some(U=>U.id===I.id||U.timestamp.getTime()===I.timestamp.getTime()&&U.text===I.text)?D:[...D,I]),n.notifications_enabled!==!1)if(E.is_ai){const D=Pg.find(j=>j.id===E.persona_id),U=D?D.name:"AI";SN(`Nytt meddelande frn ${U}`,E.content),L1({title:`Nytt meddelande frn ${U}`,content:E.content,time:"Just nu",icon:D?.avatar||"",color:D?.color||"bg-slate-800"})}else E.user_id!==n.id&&(SN(`Nytt meddelande frn ${R}`,E.content),L1({title:`Nytt meddelande frn ${R}`,content:E.content,time:"Just nu",icon:"",color:"bg-orange-500"}))}).subscribe();return()=>{Ji.removeChannel(y)}},[n.id,e]),ue.useEffect(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[i,c]);const g=async()=>{if(!r.trim())return;const v=r;o("");const y={role:"user",text:v,timestamp:new Date,senderName:n.full_name,senderEmail:n.email,senderAvatar:n.avatar_url};s(w=>[...w,y]);try{await Ji.from("messages").insert({content:v,user_id:n.id,is_ai:!1,thread_id:e==="general"?null:e});const w=Pg.slice().sort(()=>.5-Math.random()).slice(0,1);for(const E of w){h(E),await new Promise(N=>setTimeout(N,3e3));const R=i.slice(-8).map(N=>({role:N.role,text:`${N.persona?N.persona.name+": ":(N.senderName||"User")+": "} ${N.text}`,timestamp:N.timestamp}));R.push({role:"user",text:`User: ${v}`,timestamp:new Date});try{const N=await WX(R,v,E.systemPrompt+`

CONTEXT: Du r i ett ppet chatrum ('Gemenskap'). Du pratar med riktiga mnniskor. Svara kort, avslappnat.`);await Ji.from("messages").insert({content:N,user_id:n.id,is_ai:!0,persona_id:E.id,thread_id:e==="general"?null:e})}catch(N){console.error("AI Gen Error",N)}finally{h(null)}}}catch(w){console.error("Error sending message:",w)}};return d.jsxs("div",{className:"flex flex-col h-full bg-transparent overflow-hidden",children:[t&&d.jsx("div",{className:"px-6 py-4 bg-slate-900/40 backdrop-blur-xl border-b border-white/5 flex justify-between items-center shrink-0",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-xl flex items-center justify-center text-slate-950 shadow-lg",children:d.jsx(Ay,{size:20})}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-sm font-black text-white uppercase tracking-wider",children:e==="general"?"Gemenskapen":e}),d.jsxs("p",{className:"text-[10px] text-orange-500 font-bold tracking-widest uppercase flex items-center gap-1.5",children:[d.jsx("span",{className:"w-1 h-1 bg-orange-500 rounded-full animate-ping"})," Live nu"]})]})]})}),d.jsxs("div",{ref:p,className:"flex-grow overflow-y-auto px-8 py-10 space-y-8 no-scrollbar scroll-smooth",children:[i.map((v,y)=>{const w=v.role==="user",E=i[y+1]?.persona?.id===v.persona?.id&&i[y+1]?.role===v.role;return d.jsxs("div",{className:`flex items-end gap-4 ${w?"flex-row-reverse":"flex-row"} animate-in fade-in slide-in-from-bottom-6 duration-700`,children:[E?d.jsx("div",{className:"w-12 shrink-0"}):d.jsxs("div",{className:`w-12 h-12 rounded-[1.25rem] flex items-center justify-center shrink-0 shadow-2xl relative group cursor-pointer overflow-hidden ${w?"bg-gradient-to-br from-orange-400 to-red-600 text-white":(v.persona?.color||"bg-slate-800")+" text-white"}`,children:[w?v.senderEmail==="billy.ljungberg90@gmail.com"||!v.senderEmail&&n.email==="billy.ljungberg90@gmail.com"?d.jsx("img",{src:"/assets/logo2.png",alt:"Admin",className:"w-full h-full object-contain p-1.5 bg-slate-900"}):v.senderAvatar?d.jsx("img",{src:v.senderAvatar,alt:v.senderName,className:"w-full h-full object-cover"}):(v.senderName||n.full_name).charAt(0):d.jsx("div",{className:"scale-125",children:v.persona?.avatar}),d.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 border-4 border-slate-950 rounded-full bg-green-500"})]}),d.jsxs("div",{className:`flex flex-col max-w-[75%] ${w?"items-end":"items-start"}`,children:[(!i[y-1]||i[y-1].role!==v.role||i[y-1].persona?.id!==v.persona?.id)&&d.jsxs("div",{className:"flex items-center gap-3 mb-2 px-2",children:[d.jsx("span",{className:"text-[11px] font-black text-slate-500 uppercase tracking-[0.2em]",children:w?v.senderName||n.full_name:v.persona?.name}),d.jsx("span",{className:"text-[10px] text-slate-600 font-bold uppercase tracking-widest",children:v.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),d.jsxs("div",{className:`
                                    relative px-7 py-5 text-[15px] leading-relaxed shadow-[0_15px_35px_rgba(0,0,0,0.3)] transition-all duration-500 hover:scale-[1.01] overflow-hidden
                                    ${w?"bg-orange-500 text-slate-950 font-bold rounded-[2.5rem] rounded-br-none":"bg-slate-900/80 text-slate-200 border border-white/5 rounded-[2.5rem] rounded-bl-none backdrop-blur-xl"}
                                `,children:[w&&d.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"}),d.jsx("span",{className:"relative z-10",children:v.text}),w&&d.jsxs("div",{className:"absolute -bottom-6 right-0 flex items-center gap-2 text-orange-500/60",children:[d.jsx(XD,{size:14,className:"animate-pulse"}),d.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Levererad"})]})]})]})]},y)}),c&&d.jsxs("div",{className:"flex items-end gap-3 animate-in fade-in slide-in-from-bottom-2",children:[d.jsx("div",{className:`w-10 h-10 rounded-2xl flex items-center justify-center shrink-0 ${c.color} text-white shadow-xl`,children:c.avatar}),d.jsx("div",{className:"bg-slate-900 border border-white/5 rounded-3xl rounded-bl-none px-6 py-4 shadow-2xl",children:d.jsxs("div",{className:"flex gap-1.5",children:[d.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),d.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"200ms"}}),d.jsx("div",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full animate-bounce",style:{animationDelay:"400ms"}})]})})]})]}),d.jsx("div",{className:"px-8 pb-8 pt-2",children:d.jsxs("div",{className:"relative group bg-slate-900/60 backdrop-blur-2xl border border-white/5 rounded-[2rem] p-3 pl-6 pr-3 shadow-2xl transition-all focus-within:ring-2 focus-within:ring-orange-500/20 focus-within:border-orange-500/30 flex items-center gap-4",children:[d.jsx("button",{className:"text-slate-500 hover:text-orange-400 transition-colors",children:d.jsx(xP,{size:22})}),d.jsx("input",{type:"text",value:r,onChange:v=>o(v.target.value),onKeyDown:v=>v.key==="Enter"&&g(),placeholder:"Skriv ett meddelande...",className:"flex-grow bg-transparent border-none py-3 text-sm text-white placeholder:text-slate-600 focus:outline-none font-medium"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("button",{className:"p-3 text-slate-500 hover:text-white transition-all hover:bg-white/5 rounded-2xl",children:d.jsx(dP,{size:20})}),d.jsx("button",{onClick:g,disabled:!r.trim(),className:`
                w-12 h-12 flex items-center justify-center rounded-2xl transition-all duration-300
                ${r.trim()?"bg-orange-500 text-slate-950 shadow-lg shadow-orange-500/30 hover:scale-105 active:scale-95 bubble-send":"bg-slate-800 text-slate-600 opacity-50"}
              `,children:d.jsx(Ml,{size:20})})]})]})})]})},YX=({user:n,onThreadClick:e})=>{const[t,i]=ue.useState(!1);ue.useEffect(()=>{TH()},[]);const s=[{id:1,title:"Mastermind: Q4 Strategi",date:"24 Nov, 18:00",location:"Stockholm/Online",type:"Exklusivt"},{id:2,title:"Investeringsmte  Startup Pitch",date:"28 Nov, 14:00",location:"Digitalt",type:"Pitch"},{id:3,title:"Horizonten Networking Dinner",date:"5 Dec, 19:30",location:"Grand Htel",type:"Social"}];return d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8 animate-in fade-in duration-700",children:[d.jsxs("section",{className:"relative overflow-hidden rounded-[2.5rem] min-h-[280px] flex items-center border border-white/20 shadow-[0_20px_50px_rgba(249,115,22,0.15)] bg-slate-950",children:[d.jsxs("div",{className:"absolute inset-0 bg-orange-600 overflow-hidden pointer-events-none",children:[d.jsx("div",{className:"absolute top-[-30%] left-[-10%] w-[80%] h-[120%] bg-orange-400 rounded-full blur-[100px] opacity-70 animate-pulse transition-all duration-[10s]"}),d.jsx("div",{className:"absolute bottom-[-40%] right-[-5%] w-[70%] h-[100%] bg-amber-500 rounded-full blur-[120px] opacity-60 animate-bounce",style:{animationDuration:"15s"}}),d.jsx("div",{className:"absolute top-[10%] right-[10%] w-[50%] h-[60%] bg-orange-300 rounded-full blur-[90px] opacity-40 animate-pulse",style:{animationDuration:"7s"}}),d.jsx("div",{className:"absolute bottom-[10%] left-[20%] w-[30%] h-[40%] bg-white/20 rounded-full blur-[60px] opacity-30"})]}),d.jsx("div",{className:"absolute inset-0 backdrop-blur-[80px] bg-orange-600/25 border-t border-l border-white/30 rounded-[2.5rem]"}),d.jsx("div",{className:"absolute inset-0 opacity-[0.04] pointer-events-none bg-[url('https://www.transparenttextures.com/patterns/p6.png')]"}),d.jsx("div",{className:"absolute top-0 left-0 right-0 h-1/2 bg-gradient-to-b from-white/10 to-transparent pointer-events-none"}),d.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8 px-10 py-12 w-full",children:[d.jsxs("div",{className:"text-white drop-shadow-[0_2px_10px_rgba(0,0,0,0.3)] text-center md:text-left",children:[d.jsxs("h2",{className:"text-4xl md:text-6xl font-black mb-4 tracking-tighter leading-[1.1]",children:["Vlkommen in ... ",d.jsx("br",{className:"hidden md:block"}),d.jsx("span",{className:"bg-gradient-to-r from-white via-orange-50 to-orange-100 bg-clip-text text-transparent",children:n.full_name})]}),d.jsx("p",{className:"text-white/90 font-semibold text-lg md:text-xl max-w-xl leading-relaxed",children:"Hr r de senaste uppdateringarna fr din Niv 2 gemenskap."})]}),d.jsxs("div",{className:"flex gap-4 items-center shrink-0",children:[d.jsxs("div",{className:"bg-white/10 backdrop-blur-3xl px-6 py-6 rounded-[2rem] border border-white/20 text-center shadow-xl group hover:bg-white/15 transition-all",children:[d.jsx("span",{className:"block text-4xl font-black text-white group-hover:scale-110 transition-transform",children:"142"}),d.jsx("span",{className:"text-[10px] uppercase font-bold text-white/70 tracking-[0.2em]",children:"Medlemmar"})]}),d.jsxs("div",{className:"bg-white/10 backdrop-blur-3xl px-6 py-6 rounded-[2rem] border border-white/20 text-center shadow-xl group hover:bg-white/15 transition-all",children:[d.jsx("span",{className:"block text-4xl font-black text-white group-hover:scale-110 transition-transform",children:"8"}),d.jsx("span",{className:"text-[10px] uppercase font-bold text-white/70 tracking-[0.2em]",children:"Nya trdar"})]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[d.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[d.jsx(QT,{user:n}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:[d.jsx(Xg,{className:"text-orange-500",size:20}),"Utvalt innehll"]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{onClick:()=>i(!0),className:"col-span-1 md:col-span-2 bg-gradient-to-br from-slate-900 to-slate-800 border border-orange-500/30 p-10 rounded-[2rem] group hover:border-orange-500 transition-all cursor-pointer shadow-2xl relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-50 group-hover:opacity-100 transition-opacity",children:d.jsx(jb,{size:80,className:"text-orange-500/10 rotate-12"})}),d.jsxs("div",{className:"relative z-10",children:[d.jsx("span",{className:"text-[10px] bg-orange-500 text-slate-950 px-3 py-1 rounded-full font-black uppercase tracking-widest mb-6 inline-block",children:"Veckans Djupdykning"}),d.jsxs("h4",{className:"text-3xl md:text-4xl font-black text-white mb-4 group-hover:text-orange-400 transition-colors leading-tight",children:["Det grundlggande ",d.jsx("br",{})," attributionsfelet"]}),d.jsx("p",{className:"text-slate-400 mb-8 max-w-xl text-lg font-light leading-relaxed",children:"Varfr dmer vi andra hrdare n oss sjlva? En genomgng av hur vra hjrnor snedvrider verkligheten i sociala relationer."}),d.jsxs("div",{className:"flex items-center gap-3 text-white font-bold group-hover:gap-5 transition-all uppercase tracking-widest text-xs",children:["Ls hela artikeln ",d.jsx(Fs,{size:18,className:"text-orange-500"})]})]})]}),d.jsxs("div",{className:"bg-slate-950/50 backdrop-blur-md border border-white/5 p-8 rounded-[2rem] group hover:border-orange-500/50 transition-all shadow-xl",children:[d.jsx("div",{className:"w-14 h-14 bg-blue-500/10 rounded-2xl flex items-center justify-center text-blue-400 mb-6 group-hover:scale-110 transition-transform border border-blue-500/20",children:d.jsx(zb,{size:28})}),d.jsx("h4",{className:"text-xl font-bold text-white mb-3",children:"Biblioteket"}),d.jsx("p",{className:"text-slate-400 text-sm mb-6 leading-relaxed font-light",children:"Mallar, guider och inspelade workshops frn vra experter."}),d.jsxs("button",{className:"flex items-center gap-2 text-orange-400 text-xs font-black uppercase tracking-widest group-hover:gap-4 transition-all",children:["Utforska ",d.jsx(ch,{size:16})]})]}),d.jsxs("div",{className:"bg-slate-950/50 backdrop-blur-md border border-white/5 p-8 rounded-[2rem] group hover:border-purple-500/50 transition-all shadow-xl",children:[d.jsx("div",{className:"w-14 h-14 bg-purple-500/10 rounded-2xl flex items-center justify-center text-purple-400 mb-6 group-hover:scale-110 transition-transform border border-purple-500/20",children:d.jsx(Xg,{size:28})}),d.jsx("h4",{className:"text-xl font-bold text-white mb-3",children:"vningar"}),d.jsx("p",{className:"text-slate-400 text-sm mb-6 leading-relaxed font-light",children:"Ljudfiler och guidade meditationer fr din dagliga Self-care."}),d.jsxs("button",{className:"flex items-center gap-2 text-purple-400 text-xs font-black uppercase tracking-widest group-hover:gap-4 transition-all",children:["Lyssna nu ",d.jsx(ch,{size:16})]})]})]}),d.jsxs("div",{className:"space-y-6 pt-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:[d.jsx($D,{className:"text-orange-500",size:20}),"Direktkontakt med dina assistenter"]}),d.jsx("button",{onClick:()=>e("consultant"),className:"text-orange-400 text-xs font-bold uppercase tracking-widest hover:text-white transition-colors",children:"Visa alla"})]}),d.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[{name:"Saga",avatar:"",role:"Kreativitet",color:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20"},{name:"Erik",avatar:"",role:"Kropp & TMO",color:"bg-blue-500/10 text-blue-400 border-blue-500/20"},{name:"Lina",avatar:"",role:"Trauma",color:"bg-purple-500/10 text-purple-400 border-purple-500/20"},{name:"Marcus",avatar:"",role:"IT & Struktur",color:"bg-indigo-500/10 text-indigo-400 border-indigo-500/20"}].map(r=>d.jsxs("button",{onClick:()=>e("consultant"),className:`flex flex-col items-center p-6 rounded-[2rem] border transition-all hover:scale-105 active:scale-95 group ${r.color}`,children:[d.jsx("span",{className:"text-3xl mb-3 group-hover:scale-125 transition-transform",children:r.avatar}),d.jsx("span",{className:"font-bold text-xs uppercase tracking-tighter block",children:r.name}),d.jsx("span",{className:"text-[10px] opacity-60 font-medium block",children:r.role})]},r.name))})]})]})]}),d.jsx(H1,{isOpen:t,onClose:()=>i(!1),pdfUrl:"/attributionsfel.pdf",title:"Det grundlggande attributionsfelet"}),d.jsxs("div",{className:"space-y-8",children:[d.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl overflow-hidden shadow-lg",children:[d.jsx("div",{className:"px-6 py-4 border-b border-slate-800 bg-slate-800/30",children:d.jsxs("h3",{className:"font-bold flex items-center gap-2 text-white",children:[d.jsx($a,{className:"text-orange-500",size:18}),"Kommande Event"]})}),d.jsx("div",{className:"p-2",children:s.map(r=>d.jsxs("div",{className:"p-4 rounded-xl hover:bg-slate-800 transition-colors cursor-pointer group",children:[d.jsxs("div",{className:"flex items-start justify-between mb-2",children:[d.jsx("span",{className:"text-[10px] bg-orange-500/20 text-orange-400 px-2 py-0.5 rounded font-bold uppercase tracking-wider",children:r.type}),d.jsx("span",{className:"text-xs text-slate-500 font-medium",children:r.date})]}),d.jsx("h4",{className:"font-bold text-slate-100 group-hover:text-orange-400 transition-colors",children:r.title}),d.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-slate-500",children:[d.jsx(Bb,{size:12})," ",r.location]})]},r.id))}),d.jsx("div",{className:"p-4 bg-slate-800/50",children:d.jsx("button",{className:"w-full bg-slate-700 hover:bg-slate-600 py-2 rounded-lg text-sm font-bold transition-colors",children:"Visa kalender"})})]}),d.jsxs("div",{className:"bg-orange-500/5 border border-orange-500/20 rounded-2xl p-6 relative overflow-hidden group shadow-inner shadow-orange-500/5",children:[d.jsx("div",{className:"absolute -right-4 -bottom-4 w-16 h-16 bg-orange-500/10 rounded-full blur-xl group-hover:scale-150 transition-transform duration-500"}),d.jsx("h4",{className:"font-bold text-orange-400 mb-2 text-sm uppercase tracking-wider",children:"Veckans tips"}),d.jsx("p",{className:"text-sm text-slate-300 italic relative z-10",children:'"Niv 2-trdar arkiveras efter 30 dagar fr att hlla diskussionerna relevanta. Glm inte att spara ner viktiga insikter till din AI-profil!"'})]})]})]})]})},JX=({onClose:n})=>{const[e,t]=ue.useState(""),[i,s]=ue.useState(""),r=o=>{o.preventDefault();const c=encodeURIComponent(`Frslag p ny diskussionstrd: ${e}`),h=encodeURIComponent(`Freslaget namn p trd: ${e}

Frklaring/Syfte med trden:
${i}`);window.location.href=`mailto:billy@klattertradet.se?subject=${c}&body=${h}`,n()};return d.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-[100] p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-md animate-in fade-in duration-300",onClick:n}),d.jsxs("div",{className:"relative bg-slate-900/90 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-8 md:p-10 w-full max-w-lg shadow-[0_20px_50px_rgba(0,0,0,0.5)] animate-in fade-in zoom-in-95 duration-500 overflow-hidden",children:[d.jsx("div",{className:"absolute -top-24 -right-24 w-48 h-48 bg-orange-500/10 rounded-full blur-3xl"}),d.jsxs("div",{className:"relative z-10",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"p-3 bg-orange-500/20 rounded-2xl text-orange-500",children:d.jsx(va,{size:24})}),d.jsx("h2",{className:"text-2xl font-black text-white italic tracking-tight",children:"ppna ny trd"})]}),d.jsx("button",{onClick:n,className:"p-2 text-slate-500 hover:text-white hover:bg-white/10 rounded-xl transition-all",children:d.jsx(Bu,{size:24})})]}),d.jsxs("div",{className:"mb-8 space-y-2",children:[d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"Har du ett mne du vill diskutera med gemenskapen? Lmna ett frslag p en ny trd nedan."}),d.jsx("p",{className:"text-orange-500/80 text-xs font-bold italic",children:"Vi gr igenom alla frslag och terkopplar snabbt om trden lggs upp."})]}),d.jsxs("form",{onSubmit:r,className:"space-y-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 ml-1",children:"Trdens namn"}),d.jsx("input",{required:!0,type:"text",value:e,onChange:o=>t(o.target.value),placeholder:"T.ex. Hantering av stress i vardagen",className:"w-full bg-slate-950/50 border border-white/10 rounded-2xl px-5 py-4 text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500/40 transition-all font-medium"})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 ml-1",children:"Frklaring / Syfte"}),d.jsx("textarea",{required:!0,value:i,onChange:o=>s(o.target.value),placeholder:"Bertta kort varfr denna trd behvs och vad syftet r...",rows:4,className:"w-full bg-slate-950/50 border border-white/10 rounded-2xl px-5 py-4 text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500/40 transition-all font-medium resize-none"})]}),d.jsxs("button",{type:"submit",className:"w-full bg-orange-500 hover:bg-orange-400 text-slate-950 font-black py-5 rounded-2xl flex items-center justify-center gap-3 transition-all hover:scale-[1.02] active:scale-95 shadow-[0_10px_30px_rgba(249,115,22,0.3)] group",children:["Skicka in",d.jsx(Ml,{size:20,className:"group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]})]})]})]})]})},KX=({onClose:n})=>{const[e,t]=ue.useState(""),[i,s]=ue.useState(""),r=o=>{o.preventDefault();const c=encodeURIComponent("Inbjudan till Horizonten Gemenskap"),h=`Hej!

Jag r medlem i Horizonten och tror att det skulle vara ngot fr dig. Det r en plats fr personlig utveckling och gemenskap.

Kolla in det hr: https://klattertradet.se

${i?`
Meddelande frn mig:
${i}`:""}`,p=encodeURIComponent(h);window.location.href=`mailto:${e}?subject=${c}&body=${p}`,n()};return d.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-[100] p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-md animate-in fade-in duration-300",onClick:n}),d.jsxs("div",{className:"relative bg-slate-900/90 backdrop-blur-3xl border border-white/10 rounded-[2.5rem] p-8 md:p-10 w-full max-w-lg shadow-[0_20px_50px_rgba(0,0,0,0.5)] animate-in fade-in zoom-in-95 duration-500 overflow-hidden",children:[d.jsx("div",{className:"absolute -top-24 -right-24 w-48 h-48 bg-indigo-500/10 rounded-full blur-3xl"}),d.jsxs("div",{className:"relative z-10",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"p-3 bg-indigo-500/20 rounded-2xl text-indigo-400",children:d.jsx(jS,{size:24})}),d.jsx("h2",{className:"text-2xl font-black text-white italic tracking-tight",children:"Bjud in en vn"})]}),d.jsx("button",{onClick:n,className:"p-2 text-slate-500 hover:text-white hover:bg-white/10 rounded-xl transition-all",children:d.jsx(Bu,{size:24})})]}),d.jsx("div",{className:"mb-8 space-y-2",children:d.jsx("p",{className:"text-slate-400 text-sm leading-relaxed",children:"Knner du ngon som skulle uppskatta gemenskapen? Skicka en inbjudan direkt via mejl."})}),d.jsxs("form",{onSubmit:r,className:"space-y-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 ml-1",children:"Vnnens E-post"}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{required:!0,type:"email",value:e,onChange:o=>t(o.target.value),placeholder:"namn@exempel.se",className:"w-full bg-slate-950/50 border border-white/10 rounded-2xl pl-12 pr-5 py-4 text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500/40 transition-all font-medium"}),d.jsx(w0,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500",size:18})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-slate-500 ml-1",children:"Personligt meddelande (Frivilligt)"}),d.jsx("textarea",{value:i,onChange:o=>s(o.target.value),placeholder:"Skriv en personlig hlsning...",rows:3,className:"w-full bg-slate-950/50 border border-white/10 rounded-2xl px-5 py-4 text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500/40 transition-all font-medium resize-none"})]}),d.jsxs("button",{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-500 text-white font-black py-5 rounded-2xl flex items-center justify-center gap-3 transition-all hover:scale-[1.02] active:scale-95 shadow-[0_10px_30px_rgba(79,70,229,0.3)] group",children:["Skicka inbjudan",d.jsx(Ml,{size:20,className:"group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"})]})]})]})]})]})},ZX=({roomId:n,user:e,onEndCall:t})=>{const[i,s]=ue.useState(!1),[r,o]=ue.useState(!1),[c,h]=ue.useState(!0),[p,g]=ue.useState(!1),[v,y]=ue.useState(null),w=ue.useRef(null);ue.useEffect(()=>{const A=setTimeout(async()=>{try{const I=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});y(I),h(!1)}catch(I){console.error("Error accessing camera:",I),h(!1)}},800);return()=>{clearTimeout(A)}},[]),ue.useEffect(()=>(w.current&&v&&(w.current.srcObject=v),()=>{v&&v.getTracks().forEach(N=>N.stop())}),[v]);const E=()=>{v&&(v.getAudioTracks().forEach(N=>{N.enabled=!N.enabled}),s(!i))},R=()=>{v&&(v.getVideoTracks().forEach(N=>{N.enabled=!N.enabled}),o(!r))};return c?d.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center bg-slate-950/40 animate-pulse",children:[d.jsx("div",{className:"w-24 h-24 bg-orange-500/20 rounded-[2.5rem] flex items-center justify-center text-orange-400 mb-6 border border-orange-500/30",children:d.jsx(oR,{size:40,className:"animate-bounce"})}),d.jsx("h3",{className:"text-2xl font-black text-white italic tracking-tighter",children:"Ansluter till kameran..."}),d.jsx("p",{className:"text-slate-500 text-sm mt-2 uppercase tracking-widest font-bold",children:"Skrar anslutning"})]}):d.jsxs("div",{className:"flex-grow flex flex-col relative overflow-hidden bg-slate-950/20 h-full",children:[d.jsx("div",{className:"flex-grow relative p-4 md:p-8 flex items-center justify-center min-h-0",children:d.jsxs("div",{className:"relative w-full h-full max-w-5xl rounded-2xl md:rounded-[3rem] overflow-hidden shadow-[0_30px_100px_rgba(0,0,0,0.6)] border border-white/10 group bg-slate-900",children:[d.jsx("div",{className:"absolute -top-40 -right-40 w-96 h-96 bg-orange-500/10 rounded-full blur-[120px] pointer-events-none group-hover:bg-orange-500/20 transition-colors duration-1000"}),d.jsx("video",{ref:w,autoPlay:!0,playsInline:!0,muted:i,className:`w-full h-full object-cover transition-all duration-700 ${r?"opacity-0 scale-110 grayscale":"opacity-100 scale-100 grayscale-0"}`}),r&&d.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-slate-900/80 backdrop-blur-3xl animate-in fade-in duration-500",children:[d.jsx("div",{className:"w-20 h-20 md:w-32 md:h-32 bg-slate-800 rounded-full flex items-center justify-center text-slate-600 mb-4 border border-white/5 shadow-2xl",children:d.jsx(QE,{size:32,className:"md:w-12 md:h-12"})}),d.jsx("p",{className:"text-white font-black italic text-lg md:text-xl",children:"Kameran r avstngd"})]}),d.jsxs("div",{className:"absolute bottom-4 left-4 md:bottom-10 md:left-10 flex items-center gap-2 md:gap-3 px-4 py-2 md:px-6 md:py-3 bg-slate-950/60 backdrop-blur-xl border border-white/10 rounded-xl md:rounded-2xl shadow-2xl",children:[d.jsx("div",{className:"w-2 h-2 md:w-2.5 md:h-2.5 bg-green-500 rounded-full animate-pulse"}),d.jsx("span",{className:"text-[10px] md:text-sm font-black text-white uppercase tracking-widest whitespace-nowrap",children:"Du (Vrd)"})]}),d.jsx("div",{className:"absolute top-4 right-4 md:top-10 md:right-10 opacity-40 group-hover:opacity-100 transition-opacity",children:d.jsx("img",{src:"/assets/logo2.png",alt:"Horizonten",className:"w-8 h-8 md:w-12 md:h-12 object-contain grayscale brightness-200"})})]})}),d.jsxs("div",{className:"hidden",children:[[1,2].map(N=>d.jsxs("div",{className:"w-20 h-24 md:w-24 md:h-32 shrink-0 rounded-2xl md:rounded-3xl bg-slate-900/80 border border-white/10 overflow-hidden shadow-2xl hover:scale-105 transition-all cursor-pointer group relative",children:[d.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:d.jsx(Vs,{size:20,className:"text-slate-700 md:w-6 md:h-6 group-hover:text-orange-500/50 transition-colors"})}),d.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-950/80 to-transparent"}),d.jsx("div",{className:"absolute bottom-2 inset-x-0 text-center",children:d.jsx("span",{className:"text-[8px] font-black text-white/60 uppercase tracking-tighter",children:"Vntar..."})})]},N)),d.jsxs("div",{className:"w-20 h-24 md:w-24 md:h-32 shrink-0 rounded-2xl md:rounded-3xl border-2 border-dashed border-white/10 flex flex-col items-center justify-center text-slate-600 hover:border-orange-500/50 hover:text-orange-500 transition-all cursor-pointer bg-white/5",children:[d.jsx(va,{size:16,className:"md:w-5 md:h-5 mb-1"}),d.jsx("span",{className:"text-[8px] font-black uppercase",children:"Bjud in"})]})]}),d.jsx("div",{className:"px-4 pb-4 md:px-12 md:pb-12 pt-2 relative z-10 shrink-0",children:d.jsxs("div",{className:"max-w-4xl mx-auto bg-slate-900/60 backdrop-blur-3xl border border-white/10 rounded-2xl md:rounded-[2.5rem] p-2 md:p-4 flex items-center justify-between shadow-[0_20px_50px_rgba(0,0,0,0.5)]",children:[d.jsxs("div",{className:"hidden sm:flex items-center gap-4 px-2 md:px-6",children:[d.jsx("div",{className:"p-2 md:p-3 bg-orange-500/10 rounded-xl md:rounded-2xl text-orange-500",children:d.jsx(eM,{size:18,className:"md:w-5 md:h-5"})}),d.jsxs("div",{className:"hidden md:block",children:[d.jsxs("h4",{className:"text-[10px] md:text-xs font-black text-white uppercase tracking-widest leading-none mb-1",children:["Live: ",n]}),d.jsx("p",{className:"text-[8px] md:text-[10px] text-slate-500 font-bold uppercase tracking-tight",children:"HD  Krypterat"})]})]}),d.jsxs("div",{className:"flex flex-1 md:flex-initial justify-center items-center gap-2 md:gap-4 px-2",children:[d.jsx("button",{onClick:E,className:`w-10 h-10 md:w-14 md:h-14 rounded-xl md:rounded-2xl flex items-center justify-center transition-all ${i?"bg-red-500 text-white":"bg-white/5 text-slate-400 border border-white/10"}`,children:i?d.jsx(cP,{size:18,className:"md:w-6 md:h-6"}):d.jsx(uP,{size:18,className:"md:w-6 md:h-6"})}),d.jsx("button",{onClick:R,className:`w-10 h-10 md:w-14 md:h-14 rounded-xl md:rounded-2xl flex items-center justify-center transition-all ${r?"bg-red-500 text-white":"bg-white/5 text-slate-400 border border-white/10"}`,children:r?d.jsx(QE,{size:18,className:"md:w-6 md:h-6"}):d.jsx(eM,{size:18,className:"md:w-6 md:h-6"})}),d.jsx("button",{className:"hidden sm:flex w-10 h-10 md:w-14 md:h-14 rounded-xl md:rounded-2xl bg-white/5 text-slate-400 border border-white/10 items-center justify-center transition-all",children:d.jsx(lP,{size:18,className:"md:w-6 md:h-6"})}),d.jsx("div",{className:"w-[1px] h-6 md:h-8 bg-white/10 mx-1 md:mx-2 uppercase text-white"}),d.jsx("button",{onClick:()=>g(!p),className:`w-10 h-10 md:w-14 md:h-14 rounded-xl md:rounded-2xl flex items-center justify-center transition-all border ${p?"bg-white text-slate-900 border-white shadow-[0_0_20px_rgba(255,255,255,0.3)]":"bg-white/5 text-slate-400 border-white/10"}`,children:d.jsx(mR,{size:18,className:"md:w-5 md:h-5"})}),d.jsxs("button",{onClick:t,className:"px-4 md:px-8 h-10 md:h-14 bg-red-600 hover:bg-red-500 text-white rounded-xl md:rounded-2xl font-black uppercase tracking-widest text-[10px] md:text-xs flex items-center gap-2 md:gap-3 transition-all shadow-[0_10px_30px_rgba(220,38,38,0.3)] active:scale-95",children:[d.jsx(hP,{size:16,className:"md:w-5 md:h-5"}),d.jsx("span",{className:"hidden xs:inline",children:"Avsluta"}),d.jsx("span",{className:"xs:hidden",children:"Lmna"})]})]}),d.jsx("div",{className:"hidden sm:flex items-center gap-4 px-2 md:px-6"})]})}),d.jsx("div",{className:`absolute top-0 bottom-20 md:bottom-28 right-0 w-full sm:w-96 bg-slate-900/95 backdrop-blur-xl border-l border-white/10 z-20 transition-transform duration-300 ease-in-out ${p?"translate-x-0":"translate-x-full"}`,children:d.jsxs("div",{className:"h-full flex flex-col relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 inset-x-0 h-20 bg-gradient-to-b from-slate-900 to-transparent z-10 pointer-events-none"}),d.jsx(QT,{user:e,threadId:`video-${n}`,showHeader:!1})]})})]})},vy=[{id:"general",name:"Gemenskapen",icon:d.jsx(sP,{size:18}),description:"Det ppna rummet fr alla medlemmar.",category:"public"},{id:"self-care",name:"Self-care tips",icon:d.jsx(Ka,{size:18}),description:"Dela med dig av dina bsta tips fr sjlvvrd.",category:"public"},{id:"video",name:"Videorummet",icon:d.jsx(oR,{size:18}),description:"Anslut med kamera och rst i realtid.",category:"public",hasVideo:!0},{id:"trygghet",name:"Trygga rummet",icon:d.jsx(Fu,{size:18}),description:"En skyddad plats fr svrare samtal.",category:"private"},{id:"info",name:"Information",icon:d.jsx(_0,{size:18}),description:"Viktiga meddelanden frn administratrer.",category:"support"}],QX=({user:n,initialThread:e,onOpenSettings:t})=>{const[i,s]=ue.useState(e||"general"),[r,o]=ue.useState("discussions"),[c,h]=ue.useState(!0),[p,g]=ue.useState(!1),[v,y]=ue.useState(X3()),[w,E]=ue.useState([]),[R,N]=ue.useState(!1);ue.useEffect(()=>{const I=XX(D=>{y(D)});return()=>I()},[]),ue.useEffect(()=>{const I=Ji.channel("global_presence");return I.on("presence",{event:"sync"},()=>{const D=I.presenceState(),U=Object.values(D).flat(),j=Array.from(new Map(U.map(F=>[F.user_id,F])).values());E(j)}).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},D=>{D.new.user_id!==n.id&&n.notifications_enabled!==!1&&L1({title:"Nytt meddelande",content:"Ngon skrev ett meddelande i gemenskapen",icon:"",color:"bg-blue-500",time:"Just nu"})}).subscribe(async D=>{D==="SUBSCRIBED"&&await I.track({user_id:n.id,full_name:n.full_name,avatar_url:n.avatar_url,role:n.role,online_at:new Date().toISOString()})}),()=>{Ji.removeChannel(I)}},[n.id,n.full_name,n.avatar_url,n.role,n.notifications_enabled]);const A=vy.find(I=>I.id===i)||vy[0];return d.jsxs("div",{className:"flex h-full bg-slate-950/80 backdrop-blur-3xl border border-white/5 rounded-[2.5rem] overflow-hidden shadow-2xl animate-in fade-in zoom-in-95 duration-700",children:[d.jsxs("div",{className:"hidden md:flex w-24 bg-slate-900/80 border-r border-white/5 flex-col items-center py-10 justify-between shrink-0 h-full",children:[d.jsxs("div",{className:"flex flex-col items-center gap-10 w-full",children:[d.jsxs("div",{className:"relative group cursor-pointer mb-4 overflow-hidden rounded-2.5rem p-0.5 bg-gradient-to-tr from-white/10 to-transparent",children:[d.jsx("div",{className:`w-14 h-14 rounded-2.5rem flex items-center justify-center text-xl font-black text-white shadow-2xl group-hover:scale-105 transition-transform duration-500 overflow-hidden ${n.email==="billy.ljungberg90@gmail.com"?"bg-slate-950 p-2":"bg-gradient-to-br from-orange-400 to-red-600"}`,children:n.email==="billy.ljungberg90@gmail.com"?d.jsx("img",{src:"/assets/logo2.png",alt:"Admin",className:"w-full h-full object-contain"}):n.avatar_url?d.jsx("img",{src:n.avatar_url,alt:n.full_name,className:"w-full h-full object-cover"}):n.full_name.charAt(0)}),d.jsx("div",{className:"absolute bottom-1 right-1 w-4 h-4 bg-green-500 border-4 border-slate-900 rounded-full shadow-lg z-10"}),d.jsx("div",{className:"absolute inset-0 bg-white/20 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]}),d.jsx("div",{className:"flex flex-col gap-6 w-full px-4",children:[{id:"discussions",icon:d.jsx(Ay,{size:26}),label:"Chatt"},{id:"members",icon:d.jsx(Vs,{size:26}),label:"Medlemmar"},{id:"notifications",icon:d.jsx(Cg,{size:26}),label:"Notiser",badge:v.length>0}].map(I=>d.jsxs("button",{onClick:()=>o(I.id),className:`
                                    relative p-4 rounded-3xl transition-all duration-500 flex items-center justify-center group
                                    ${r===I.id?"bg-orange-500 text-slate-950 shadow-[0_10px_30px_rgba(249,115,22,0.3)] scale-110":"text-slate-500 hover:text-white hover:bg-white/5"}
                                `,children:[I.icon,I.badge&&r!==I.id&&d.jsx("div",{className:"absolute top-3 right-3 w-2.5 h-2.5 bg-red-500 rounded-full border-2 border-slate-950 group-hover:scale-125 transition-transform"}),d.jsx("span",{className:"absolute left-full ml-4 px-3 py-1 bg-white text-slate-950 text-[10px] font-black uppercase rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none shadow-xl",children:I.label})]},I.id))})]}),d.jsxs("div",{className:"flex flex-col items-center gap-6 w-full px-4",children:[d.jsxs("button",{onClick:()=>h(!c),className:"p-4 rounded-3xl text-slate-500 hover:text-orange-400 hover:bg-orange-500/10 transition-all duration-300 group relative",children:[c?d.jsx(zS,{size:24}):d.jsx(Ny,{size:24}),d.jsx("span",{className:"absolute left-full ml-4 px-3 py-1 bg-white text-slate-950 text-[10px] font-black uppercase rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none shadow-xl",children:c?"Ljust lge":"Mrkt lge"})]}),d.jsxs("button",{onClick:t,className:"p-4 rounded-3xl transition-all duration-300 text-slate-500 hover:text-white hover:bg-white/5 group relative",children:[d.jsx(gR,{size:24}),d.jsx("span",{className:"absolute left-full ml-4 px-3 py-1 bg-white text-slate-950 text-[10px] font-black uppercase rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none shadow-xl",children:"Instllningar"})]}),d.jsxs("button",{className:"p-4 rounded-3xl text-slate-500 hover:text-red-400 hover:bg-red-500/10 transition-all duration-300 group relative",children:[d.jsx(KE,{size:24}),d.jsx("span",{className:"absolute left-full ml-4 px-3 py-1 bg-red-500 text-white text-[10px] font-black uppercase rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-50 pointer-events-none shadow-xl",children:"Logga ut"})]})]})]}),d.jsxs("div",{className:"hidden lg:flex w-96 bg-slate-900/40 border-r border-white/5 flex-col shrink-0 h-full",children:[r==="discussions"&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"p-8 pb-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter",children:"Diskussioner"}),d.jsx("button",{onClick:()=>g(!0),className:"w-12 h-12 bg-orange-500 hover:bg-orange-400 text-slate-950 rounded-2xl flex items-center justify-center transition-all shadow-[0_10px_20px_rgba(249,115,22,0.2)] active:scale-95 group",children:d.jsx(pP,{size:24,className:"group-hover:rotate-90 transition-transform duration-500"})})]}),d.jsxs("div",{className:"relative group",children:[d.jsx(ZE,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600 group-focus-within:text-orange-500 transition-colors",size:18}),d.jsx("input",{type:"text",placeholder:"Sk i gemenskapen...",className:"w-full bg-slate-950/40 border border-white/10 rounded-[1.25rem] py-4 pl-12 pr-4 text-sm text-white placeholder:text-slate-600 focus:outline-none focus:ring-2 focus:ring-orange-500/20 focus:border-orange-500/40 transition-all font-medium"})]})]}),d.jsxs("div",{className:"flex-grow overflow-y-auto px-4 pb-8 space-y-8 no-scrollbar scroll-smooth",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"px-4 flex items-center justify-between",children:[d.jsx("span",{className:"text-[11px] font-black uppercase tracking-[0.25em] text-slate-500",children:"Offentliga Rum"}),d.jsx("div",{className:"h-[1px] flex-grow ml-4 bg-gradient-to-r from-white/10 to-transparent"})]}),d.jsx("div",{className:"space-y-1",children:vy.filter(I=>I.category==="public").map(I=>d.jsxs("button",{onClick:()=>s(I.id),className:`w-full flex items-center gap-4 px-4 py-5 rounded-[2rem] transition-all duration-500 group relative ${i===I.id?"bg-white/10 shadow-2xl border border-white/5":"text-slate-500 hover:bg-white/5 hover:text-white"}`,children:[d.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-all duration-500 ${i===I.id?"bg-orange-500 text-slate-950 shadow-xl scale-110":"bg-slate-800/50 border border-white/5"}`,children:I.icon}),d.jsxs("div",{className:"flex-grow text-left",children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsx("span",{className:`font-bold transition-colors ${i===I.id?"text-white":"group-hover:text-orange-400"}`,children:I.name}),d.jsx("span",{className:"text-[10px] font-medium opacity-40",children:"12:45"})]}),d.jsx("p",{className:"text-[11px] opacity-60 line-clamp-1 font-medium leading-relaxed",children:I.description})]}),i===I.id&&d.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-1.5 h-8 bg-orange-500 rounded-r-full shadow-[0_0_15px_rgba(249,115,22,1)]"}),I.hasVideo&&d.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-1.5 px-3 py-1 bg-green-500/10 border border-green-500/20 rounded-full animate-pulse",children:[d.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),d.jsx("span",{className:"text-[8px] font-black text-green-500 uppercase tracking-widest",children:"Live"})]})]},I.id))})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"px-4 flex items-center justify-between",children:[d.jsx("span",{className:"text-[11px] font-black uppercase tracking-[0.25em] text-slate-500",children:"Privata Grupper"}),d.jsx("div",{className:"h-[1px] flex-grow ml-4 bg-gradient-to-r from-white/10 to-transparent"})]}),d.jsx("div",{className:"space-y-1",children:vy.filter(I=>I.category==="private").map(I=>d.jsxs("button",{onClick:()=>s(I.id),className:`w-full flex items-center gap-4 px-4 py-5 rounded-[2rem] transition-all duration-500 group relative ${i===I.id?"bg-white/10 shadow-2xl border border-white/5":"text-slate-500 hover:bg-white/5 hover:text-white"}`,children:[d.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-all duration-500 ${i===I.id?"bg-orange-500 text-slate-950 shadow-xl scale-110":"bg-slate-800/50 border border-white/5"}`,children:I.icon}),d.jsxs("div",{className:"flex-grow text-left",children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsx("span",{className:`font-bold transition-colors ${i===I.id?"text-white":"group-hover:text-orange-400"}`,children:I.name}),d.jsx("span",{className:"text-[10px] font-medium opacity-40",children:"I gr"})]}),d.jsx("p",{className:"text-[11px] opacity-60 line-clamp-1 font-medium leading-relaxed",children:I.description})]}),i===I.id&&d.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-1.5 h-8 bg-orange-500 rounded-r-full shadow-[0_0_15px_rgba(249,115,22,1)]"})]},I.id))})]})]})]}),r==="members"&&d.jsxs("div",{className:"p-8 animate-in fade-in slide-in-from-left-4 duration-500 h-full flex flex-col",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter",children:"Medlemmar"}),d.jsx("button",{className:"w-12 h-12 bg-white/5 hover:bg-white/10 text-white rounded-2xl flex items-center justify-center transition-all border border-white/10 active:scale-95",children:d.jsx(jS,{size:22})})]}),d.jsxs("div",{className:"space-y-2 overflow-y-auto no-scrollbar pb-8",children:[w.map(I=>d.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-[2rem] hover:bg-white/5 transition-all cursor-pointer group border border-transparent hover:border-white/5",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center text-xl bg-gradient-to-br from-indigo-500 to-purple-500 text-white shadow-xl transition-transform group-hover:scale-105 duration-500",children:I.avatar_url?d.jsx("img",{src:I.avatar_url,alt:I.full_name,className:"w-full h-full object-cover rounded-2xl"}):d.jsx("span",{className:"font-bold",children:I.full_name?.charAt(0)||"?"})}),d.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 border-4 border-slate-900 rounded-full shadow-lg"})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-bold text-white group-hover:text-orange-400 transition-colors",children:I.full_name||"Anonym"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-[10px] text-zinc-500 font-black uppercase tracking-widest",children:I.role||"Medlem"}),d.jsx("span",{className:"w-1 h-1 bg-zinc-700 rounded-full"}),d.jsx("span",{className:"text-[10px] text-green-500/60 font-bold uppercase",children:"Online"})]})]})]},I.user_id)),w.length===0&&d.jsx("div",{className:"text-center py-10 text-slate-500 italic",children:"Laddar medlemmar..."})]}),d.jsx("div",{className:"mt-auto py-6 border-t border-white/5",children:d.jsxs("button",{onClick:()=>N(!0),className:"w-full py-4 bg-orange-500 text-slate-950 rounded-2xl font-black uppercase tracking-widest text-[10px] flex items-center justify-center gap-3 transition-all hover:shadow-[0_10px_30px_rgba(249,115,22,0.2)] active:scale-95",children:[d.jsx(jS,{size:16})," Bjud in vn"]})})]}),R&&d.jsx(KX,{onClose:()=>N(!1)}),r==="notifications"&&d.jsxs("div",{className:"p-8 animate-in fade-in slide-in-from-left-4 duration-500 h-full flex flex-col",children:[d.jsxs("div",{className:"flex items-center justify-between mb-8",children:[d.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter",children:"Notiser"}),d.jsx("button",{onClick:$X,className:"text-zinc-500 hover:text-white transition-colors text-[10px] font-black uppercase tracking-widest",children:"Rensa alla"})]}),d.jsx("div",{className:"space-y-4 overflow-y-auto no-scrollbar pb-10",children:v.length===0?d.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-center space-y-4",children:[d.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-full flex items-center justify-center text-slate-700",children:d.jsx(Cg,{size:32})}),d.jsx("p",{className:"text-slate-500 font-medium italic",children:"Inga nya notiser"})]}):v.map((I,D)=>d.jsxs("div",{className:"flex gap-4 p-5 rounded-[2rem] bg-white/5 border border-white/5 hover:border-white/10 transition-all cursor-pointer group",children:[d.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shrink-0 ${I.color} text-white`,children:typeof I.icon=="string"&&I.icon.length<4?d.jsx("span",{className:"text-lg",children:I.icon}):d.jsx(Cg,{size:14})}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("h4",{className:"font-bold text-white text-sm group-hover:text-orange-400 transition-colors",children:I.title}),d.jsx("p",{className:"text-xs text-zinc-500 leading-relaxed",children:I.content}),d.jsx("p",{className:"text-[10px] text-zinc-600 font-bold uppercase pt-1",children:new Date(I.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]},I.id))})]}),r==="settings"&&d.jsxs("div",{className:"p-8 animate-in fade-in slide-in-from-left-4 duration-500 h-full flex flex-col",children:[d.jsx("h2",{className:"text-3xl font-black text-white tracking-tighter mb-8",children:"Instllningar"}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"p-6 bg-white/5 border border-white/5 rounded-3xl space-y-4",children:[d.jsx("h4",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-zinc-500 mb-2",children:"Profil"}),d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-orange-400 to-red-600 flex items-center justify-center text-white font-bold",children:n.full_name.charAt(0)}),d.jsxs("div",{children:[d.jsx("p",{className:"font-bold text-white",children:n.full_name}),d.jsx("p",{className:"text-[10px] text-zinc-600",children:n.email})]})]}),d.jsx("button",{className:"w-full py-3 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-xs font-bold text-white transition-all",children:"Redigera profil"})]}),d.jsx("div",{className:"space-y-2",children:[{icon:d.jsx(Cg,{size:18}),label:"Notifikationer"},{icon:d.jsx(Fu,{size:18}),label:"Privatliv"},{icon:d.jsx(Ny,{size:18}),label:"Utseende"},{icon:d.jsx(Ka,{size:18}),label:"Visa std"}].map((I,D)=>d.jsxs("button",{className:"w-full flex items-center justify-between p-4 rounded-2xl hover:bg-white/5 text-zinc-400 hover:text-white transition-all group",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("span",{className:"opacity-50 group-hover:opacity-100 group-hover:text-orange-400 transition-all",children:I.icon}),d.jsx("span",{className:"font-bold text-sm tracking-tight",children:I.label})]}),d.jsx(ch,{size:14,className:"opacity-0 group-hover:opacity-100 group-hover:translate-x-1 transition-all"})]},D))})]}),d.jsx("div",{className:"mt-auto pt-8 border-t border-white/5",children:d.jsxs("button",{className:"w-full flex items-center gap-3 p-4 text-red-500 hover:bg-red-500/10 rounded-2xl transition-all group",children:[d.jsx(KE,{size:20,className:"group-hover:rotate-12 transition-transform"}),d.jsx("span",{className:"font-black uppercase tracking-widest text-[10px]",children:"Logga ut"})]})})]})]}),d.jsxs("div",{className:"flex-grow flex flex-col bg-slate-950/20",children:[d.jsxs("div",{className:"px-4 md:px-12 py-6 md:py-8 border-b border-white/5 flex items-center justify-between bg-slate-900/60 backdrop-blur-3xl relative z-20",children:[d.jsxs("div",{className:"flex items-center gap-4 md:gap-8",children:[d.jsxs("div",{className:"relative",children:[d.jsxs("div",{className:"w-20 h-20 bg-gradient-to-br from-slate-800 to-slate-900 rounded-[2.5rem] flex items-center justify-center text-orange-400 border border-white/10 shadow-2xl relative group cursor-pointer overflow-hidden",children:[d.jsx("div",{className:"absolute inset-0 bg-orange-500/10 opacity-0 group-hover:opacity-100 transition-opacity"}),d.jsx("div",{className:"scale-125 transition-transform duration-500 group-hover:scale-110",children:A.icon})]}),d.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-4 border-slate-950 shadow-lg"})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[d.jsx("h3",{className:"text-3xl font-black text-white tracking-tighter decoration-orange-500/30 decoration-4",children:A.name}),d.jsx("div",{className:"px-3 py-1 bg-orange-500/10 border border-orange-500/20 rounded-full",children:d.jsx("span",{className:"text-[10px] font-black text-orange-500 uppercase tracking-widest",children:"Aktiv"})})]}),d.jsxs("div",{className:"flex items-center gap-2 md:gap-4 text-xs font-semibold text-slate-500",children:[d.jsxs("span",{className:"flex items-center gap-2 hover:text-white transition-colors cursor-pointer",children:[d.jsx(Vs,{size:14,className:"text-orange-500"})," ",d.jsx("span",{className:"hidden sm:inline",children:"24 medlemmar online"}),d.jsx("span",{className:"sm:hidden",children:"24"})]}),d.jsx("span",{className:"w-1.5 h-1.5 bg-slate-800 rounded-full"}),d.jsxs("span",{className:"italic opacity-80 font-medium line-clamp-1 max-w-[150px] md:max-w-none",children:['"',A.description,'"']})]})]})]}),d.jsxs("div",{className:"flex items-center gap-10",children:[d.jsxs("div",{className:"hidden xl:flex -space-x-4 items-center",children:[Pg.slice(0,4).map(I=>d.jsxs("div",{className:`w-12 h-12 rounded-[1.25rem] border-4 border-slate-950 flex items-center justify-center text-lg ${I.color} text-white shadow-2xl hover:translate-y-[-6px] transition-all cursor-pointer relative group`,title:I.name,children:[I.avatar,d.jsx("div",{className:"absolute inset-0 bg-white/10 opacity-0 group-hover:opacity-100 transition-opacity rounded-[1.25rem]"})]},I.id)),d.jsx("div",{className:"w-12 h-12 rounded-[1.25rem] border-4 border-slate-950 bg-slate-800 flex items-center justify-center text-xs font-black text-slate-400 shadow-2xl hover:bg-slate-700 transition-colors cursor-pointer",children:"+12"})]}),d.jsx("div",{className:"flex items-center gap-3",children:[{icon:d.jsx(ZE,{size:22}),label:"Sk"},{icon:d.jsx(Xg,{size:22}),label:"Favorit"},{icon:d.jsx(_0,{size:22}),label:"Info"},{icon:d.jsx(eP,{size:22}),label:"Mer"}].map((I,D)=>d.jsx("button",{className:"p-4 bg-white/5 hover:bg-orange-500/10 hover:text-orange-400 border border-white/5 rounded-2xl transition-all shadow-xl group active:scale-95",title:I.label,children:I.icon},D))})]})]}),d.jsxs("div",{className:"flex-grow overflow-hidden relative flex flex-col",children:[A.hasVideo?d.jsx(ZX,{roomId:A.name,user:n,onEndCall:()=>s("general")}):d.jsx(QT,{user:n,threadId:A.id,showHeader:!1}),!A.hasVideo&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"absolute top-0 inset-x-0 h-8 bg-gradient-to-b from-slate-950/40 to-transparent pointer-events-none"}),d.jsx("div",{className:"absolute bottom-0 inset-x-0 h-8 bg-gradient-to-t from-slate-950/40 to-transparent pointer-events-none"})]})]})]}),p&&d.jsx(JX,{onClose:()=>g(!1)})]})},eY=()=>d.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-12 space-y-16 animate-in fade-in slide-in-from-bottom-8 duration-1000",children:[d.jsxs("div",{className:"text-center space-y-6",children:[d.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-orange-500/10 rounded-full border border-orange-500/20 mb-4",children:d.jsx(Ka,{className:"text-orange-500 animate-pulse",size:32})}),d.jsxs("h1",{className:"text-4xl md:text-6xl font-black text-white tracking-tighter leading-tight",children:["Vlkommen hem till ",d.jsx("br",{}),d.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-orange-400 via-amber-200 to-white",children:"Horizonten Gemenskap"})]}),d.jsx("p",{className:"text-xl md:text-2xl text-slate-300 font-medium italic",children:"Vad fint att du hittat hit."})]}),d.jsxs("div",{className:"glass bg-slate-900/50 backdrop-blur-2xl border border-white/10 rounded-[2.5rem] p-8 md:p-12 shadow-2xl relative overflow-hidden group",children:[d.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-orange-500/5 rounded-full blur-[80px] -mr-32 -mt-32 group-hover:bg-orange-500/10 transition-colors duration-700"}),d.jsxs("div",{className:"relative z-10 space-y-8 text-slate-300 leading-relaxed text-lg font-light",children:[d.jsxs("p",{children:["Du har just klivit in i ett digitalt rum som r byggt med en enda avsikt: ",d.jsx("span",{className:"text-white font-semibold",children:"Att minska avstndet mellan mnniskor"}),". Vi vet, utifrn bde erfarenhet och neurobiologi, att ensamhet r farligt fr oss, medan kontakt r frutsttningen fr all lkning och utveckling."]}),d.jsxs("p",{children:["Horizonten Gemenskap r hjrtat i samarbetet mellan ",d.jsx("span",{className:"text-orange-400 font-bold",children:"Klttertrdet, Socialkraft och Twisted-stacks"}),". Vi har gtt samman fr att vi delar en vision: Psykisk hlsa och mnskligt std ska vara tillgngligt fr alla. Det ska inte vara krngligt, det ska inte kosta en frmgenhet, och du ska inte behva vnta i en telefonk fr att knna att ngon lyssnar."]})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-center",children:[d.jsxs("div",{className:"space-y-6",children:[d.jsxs("h2",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[d.jsx(Vs,{className:"text-orange-500",size:28}),"Vad r det hr fr plats?"]}),d.jsx("p",{className:"text-slate-400 leading-relaxed",children:"Det hr r din digitala flock. Hr mts vi  oavsett om du r hr fr att du kmpar med myndighetsstress, bearbetar trauma, r nyfiken p din egen utveckling eller arbetar professionellt med mnniskor."}),d.jsxs("p",{className:"text-slate-400 leading-relaxed",children:["Hr var vi p ",d.jsx("span",{className:"text-white font-medium",children:"Self-care tillsammans"}),". Inte som ett prestationskrav, utan som ett stt att vara snlla mot vra nervsystem."]})]}),d.jsxs("div",{className:"bg-gradient-to-br from-orange-500/20 to-transparent p-8 rounded-[2rem] border border-orange-500/20",children:[d.jsx("h3",{className:"text-orange-400 font-black uppercase tracking-widest text-xs mb-6",children:"Tre pelare"}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"shrink-0 w-10 h-10 bg-white/5 rounded-xl flex items-center justify-center text-white font-bold",children:"1"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-white font-bold mb-1 text-sm",children:"Tillgnglighet"}),d.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:"Stdet finns i fickan. Dygnet runt. Du behver inte prestera hr, du kan bara vara."})]})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"shrink-0 w-10 h-10 bg-white/5 rounded-xl flex items-center justify-center text-white font-bold",children:"2"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-white font-bold mb-1 text-sm",children:"Gratis std"}),d.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:"Vi tror p kraften i att dela erfarenheter. I de ppna forumen hjlps vi t, stttar och speglar varandra."})]})]}),d.jsxs("div",{className:"flex gap-4",children:[d.jsx("div",{className:"shrink-0 w-10 h-10 bg-white/5 rounded-xl flex items-center justify-center text-white font-bold",children:"3"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-white font-bold mb-1 text-sm",children:"Kontakt"}),d.jsx("p",{className:"text-xs text-slate-500 leading-relaxed",children:'Lkning sker "bottom up"  frn kroppen, via knslan och in i relationen. Hr fr du utrymme att dela din berttelse.'})]})]})]})]})]}),d.jsxs("div",{className:"glass bg-white/5 border border-white/10 p-10 rounded-[3rem] text-center space-y-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-white",children:"Till dig som r ny"}),d.jsxs("p",{className:"text-slate-400 max-w-2xl mx-auto leading-relaxed",children:['Knn in rummet. Du behver inte skriva ngot direkt om du inte vill. Det r okej att bara "vara med" och observera. Det kallas att ',d.jsx("span",{className:"text-orange-400",children:"samreglera"}),", och det r frsta steget till trygghet."]}),d.jsx("p",{className:"text-slate-400 max-w-2xl mx-auto leading-relaxed",children:"Nr du knner dig redo  skriv grna en rad i presentationstrden. Vi vill grna veta vem du r, men p dina villkor."}),d.jsx("div",{className:"pt-6",children:d.jsx("p",{className:"text-xl font-bold text-white italic",children:"Varmt vlkommen"})})]}),d.jsx("div",{className:"h-20"})]}),tY=()=>d.jsx("footer",{className:"border-t border-white/10 bg-black/40 backdrop-blur-xl py-8 mt-auto",children:d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row items-center justify-between gap-4 text-xs text-slate-500 uppercase tracking-wider font-medium",children:[d.jsx("div",{children:" Horizonten gemenskap"}),d.jsxs("div",{className:"flex flex-wrap justify-center gap-6",children:[d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Kontoinstllningar"}),d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Medlemsvillkor"}),d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Integritets- & Sekretesspolicy"}),d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Cookie-instllningar"}),d.jsx("button",{className:"hover:text-orange-400 transition-colors",children:"Kontakt"})]})]})}),nY=({user:n,onClose:e,onUpdate:t})=>{const[i,s]=ue.useState(n.full_name||""),[r,o]=ue.useState(n.notifications_enabled??!0),[c,h]=ue.useState(!1),[p,g]=ue.useState(null),v=async w=>{if(o(w),w&&Notification.permission!=="granted")try{await Notification.requestPermission()!=="granted"&&g("Notiser avvisades av anvndaren.")}catch{g("Kunde inte begra notistillstnd.")}},y=async()=>{h(!0),g(null);try{const{data:w,error:E}=await Ji.auth.updateUser({data:{full_name:i,notifications_enabled:r}});if(E)throw E;const R={...n,full_name:i,notifications_enabled:r};t(R),e()}catch(w){g(w.message??"Ett fel intrffade vid sparning.")}finally{h(!1)}};return d.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[d.jsx("div",{className:"absolute inset-0 bg-black/30 backdrop-blur-xl",onClick:e}),d.jsxs("div",{className:"relative bg-white/10 backdrop-blur-2xl border border-white/20 rounded-2xl p-6 w-full max-w-md shadow-xl",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h2",{className:"text-xl font-semibold text-white",children:"Instllningar"}),d.jsx("button",{onClick:e,className:"text-white hover:text-gray-300",children:d.jsx(Bu,{size:20})})]}),p&&d.jsx("div",{className:"bg-red-500/20 border border-red-500 text-red-200 p-2 rounded mb-4",children:p}),d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-200 mb-1",children:"Visningsnamn"}),d.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),className:"w-full bg-white/5 border border-white/20 rounded px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-500/50"})]}),d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Notiser p"}),d.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:r,onChange:w=>v(w.target.checked),className:"sr-only peer"}),d.jsx("div",{className:"w-11 h-6 bg-white/20 border border-white/30 rounded-full peer peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-orange-500 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-500/80 peer-checked:border-orange-500 peer-checked:after:bg-white"})]})]}),d.jsx("button",{onClick:y,disabled:c,className:"w-full bg-orange-500 hover:bg-orange-400 text-white font-bold py-2 rounded disabled:opacity-50",children:c?"Sparar...":"Spara"})]})]})},iY=({onBackToSite:n})=>{const[e,t]=ue.useState(Mu.IDLE),[i,s]=ue.useState(null),[r,o]=ue.useState("welcome"),[c,h]=ue.useState(null),[p,g]=ue.useState(!1),[v,y]=ue.useState(!1),[w,E]=ue.useState(!1),[R,N]=ue.useState(!1),[A,I]=ue.useState("login"),[D,U]=ue.useState(!1);ue.useEffect(()=>{const ee=()=>{const Q=window.location.hash;if(Q==="#login")y(!0),E(!1),N(!1),I("login");else if(Q==="#premium-login")E(!0),y(!1),N(!0),I("login");else if(Q==="#signup")y(!0),E(!1),N(!1),I("signup");else if(Q.includes("#chat")){y(!1),E(!1),o("chat");const oe=new URLSearchParams(Q.split("?")[1]).get("topic");oe&&h(oe)}else Q.includes("#welcome")?(y(!1),E(!1),o("welcome")):Q.includes("#experts")?(y(!1),E(!1),o("experts")):Q.includes("#dashboard")?(y(!1),E(!1),o("dashboard")):(y(!1),E(!1))};return ee(),window.addEventListener("hashchange",ee),()=>window.removeEventListener("hashchange",ee)},[]),ue.useEffect(()=>{const ee=ce=>{const oe=ce.state;if(!oe){e===Mu.AUTHENTICATED?o("welcome"):y(!1);return}oe.view==="login"||oe.view==="premium-login"?y(!0):oe.view==="landing"&&y(!1),oe.tab&&o(oe.tab),h(oe.topic||null)};window.addEventListener("popstate",ee);const{data:{subscription:Q}}=Ji.auth.onAuthStateChange((ce,oe)=>{oe?(t(Mu.AUTHENTICATED),y(!1),s({id:oe.user.id,email:oe.user.email||"",full_name:oe.user.user_metadata.full_name||"Medlem",role:"medlem",avatar_url:oe.user.user_metadata.avatar_url}),(R||window.location.hash==="#premium-login")&&o("chat")):(t(Mu.IDLE),s(null))});return()=>{window.removeEventListener("popstate",ee),Q.unsubscribe()}},[e]);const j=()=>{n()},F=ee=>{s(ee),t(Mu.AUTHENTICATED);const Q=R||window.location.hash==="#premium-login"?"chat":"welcome";o(Q),window.history.pushState({tab:Q,view:Q},"",`#${Q}`)},z=()=>{Ji.auth.signOut(),s(null),t(Mu.UNAUTHENTICATED),o("welcome"),h(null),y(!1),n(De.LOGIN)},W=(ee,Q=null)=>{o(ee),h(Q),g(!1);const ce=Q?`#${ee}?topic=${encodeURIComponent(Q)}`:`#${ee}`;window.history.pushState({tab:ee,topic:Q},"",ce)},L=ee=>{W("chat",ee)},B=ee=>{s(ee)},Y=({children:ee})=>d.jsxs("div",{className:"min-h-screen relative flex flex-col font-sans text-slate-100 overflow-x-hidden",children:[d.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-slate-950 via-slate-900 to-black animate-bg-shift z-0"}),d.jsx("div",{className:"fixed top-[-10%] left-[-10%] w-[800px] h-[800px] bg-orange-500/5 rounded-full blur-[150px] animate-pulse duration-[15000ms] z-0 pointer-events-none"}),d.jsx("div",{className:"fixed bottom-[-10%] right-[-10%] w-[800px] h-[800px] bg-amber-600/5 rounded-full blur-[150px] animate-pulse duration-[20000ms] z-0 pointer-events-none"}),d.jsx("div",{className:"fixed top-[20%] right-[10%] w-[400px] h-[400px] bg-white/2 rounded-full blur-[100px] pointer-events-none z-0"}),d.jsx("div",{className:"fixed inset-0 opacity-[0.02] bg-[url('https://www.transparenttextures.com/patterns/p6.png')] pointer-events-none z-0"}),d.jsx("div",{className:"relative z-10 flex flex-col min-h-screen",children:ee})]});return w?d.jsx(d.Fragment,{children:d.jsx(_H,{onLoginClick:()=>{E(!1),i||y(!0)}})}):e===Mu.AUTHENTICATED&&i?d.jsxs(Y,{children:[d.jsxs("header",{className:"border-b border-white/10 bg-black/20 backdrop-blur-xl sticky top-0 z-50",children:[d.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-2 cursor-pointer group",onClick:()=>W("dashboard"),children:[d.jsx("div",{className:"w-10 h-10 flex items-center justify-center transition-transform group-hover:scale-110 duration-300",children:d.jsx("img",{src:"/assets/logo2.png",alt:"Horizonten",className:"w-full h-full object-contain"})}),d.jsx("h1",{className:"text-xl font-bold tracking-tight text-white group-hover:text-orange-400 transition-colors",children:"Horizonten"}),d.jsx("button",{onClick:()=>U(!0),className:"text-slate-400 hover:text-white transition-colors p-2 rounded-full",children:d.jsx(gR,{size:20})})]}),d.jsxs("nav",{className:"hidden md:flex items-center space-x-2",children:[d.jsxs("button",{onClick:()=>W("welcome"),className:`flex items-center gap-2 px-4 py-2 rounded-full transition-all duration-300 ${r==="welcome"?"bg-white/10 text-white shadow-[0_0_15px_rgba(255,255,255,0.1)] border border-white/10":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[d.jsx($E,{size:18}),d.jsx("span",{children:"Vlkommen hem"})]}),d.jsxs("button",{onClick:()=>W("dashboard"),className:`flex items-center gap-2 px-4 py-2 rounded-full transition-all duration-300 ${r==="dashboard"?"bg-white/10 text-white shadow-[0_0_15px_rgba(255,255,255,0.1)] border border-white/10":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[d.jsx(XE,{size:18}),d.jsx("span",{children:"verblick"})]}),d.jsxs("button",{onClick:()=>W("chat"),className:`flex items-center gap-2 px-4 py-2 rounded-full transition-all duration-300 ${r==="chat"?"bg-white/10 text-white shadow-[0_0_15px_rgba(255,255,255,0.1)] border border-white/10":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[d.jsx(Ay,{size:18}),d.jsx("span",{children:"Gemenskapen"})]}),d.jsxs("button",{onClick:()=>W("experts"),className:`flex items-center gap-2 px-4 py-2 rounded-full transition-all duration-300 ${r==="experts"?"bg-white/10 text-white shadow-[0_0_15px_rgba(255,255,255,0.1)] border border-white/10":"text-slate-400 hover:text-white hover:bg-white/5"}`,children:[d.jsx(Vs,{size:18}),d.jsx("span",{children:"Kontakt & Bokning"})]})]}),d.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[d.jsxs("button",{onClick:()=>n(),className:"flex items-center gap-2 text-xs font-semibold text-slate-500 hover:text-orange-400 transition-colors uppercase tracking-wider mr-4",children:[d.jsx(yc,{size:14})," Klttertrdet.se"]}),d.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-white/10",children:[d.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-gradient-to-br from-orange-400 to-red-600 flex items-center justify-center text-xs font-bold text-white shadow-lg border border-white/10",children:i.email==="billy.ljungberg90@gmail.com"?d.jsx("img",{src:"/assets/logo2.png",alt:"Admin",className:"w-full h-full object-cover p-1.5 bg-slate-900"}):i.avatar_url?d.jsx("img",{src:i.avatar_url,alt:i.full_name,className:"w-full h-full object-cover"}):i.full_name.charAt(0)}),d.jsx("button",{onClick:z,className:"text-slate-400 hover:text-white transition-colors",title:"Logga ut",children:d.jsx(JE,{size:18})})]})]}),d.jsx("div",{className:"md:hidden flex items-center",children:d.jsx("button",{onClick:()=>g(!p),className:"p-2 text-slate-400 hover:text-white transition-colors",children:p?d.jsx(Bu,{size:24}):d.jsx(pR,{size:24})})})]}),p&&d.jsx("div",{className:"md:hidden border-t border-white/10 bg-black/60 backdrop-blur-xl absolute w-full animate-in slide-in-from-top-2 duration-200 shadow-2xl",children:d.jsxs("div",{className:"px-4 py-4 space-y-3",children:[d.jsxs("div",{className:"flex items-center gap-3 px-2 mb-6",children:[d.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-gradient-to-br from-orange-400 to-red-600 flex items-center justify-center text-xs font-bold text-white border border-white/10",children:i.email==="billy.ljungberg90@gmail.com"?d.jsx("img",{src:"/assets/logo2.png",alt:"Admin",className:"w-full h-full object-cover p-1.5 bg-slate-900"}):i.avatar_url?d.jsx("img",{src:i.avatar_url,alt:i.full_name,className:"w-full h-full object-cover"}):i.full_name.charAt(0)}),d.jsx("span",{className:"font-semibold text-white",children:i.full_name})]}),d.jsxs("button",{onClick:()=>W("welcome"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${r==="welcome"?"bg-orange-500/10 text-orange-400 border border-orange-500/20":"text-slate-400 hover:bg-white/5"}`,children:[d.jsx($E,{size:20})," ",d.jsx("span",{className:"font-medium",children:"Vlkommen hem"})]}),d.jsxs("button",{onClick:()=>W("dashboard"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${r==="dashboard"?"bg-orange-500/10 text-orange-400 border border-orange-500/20":"text-slate-400 hover:bg-white/5"}`,children:[d.jsx(XE,{size:20})," ",d.jsx("span",{className:"font-medium",children:"verblick"})]}),d.jsxs("button",{onClick:()=>W("chat"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${r==="chat"?"bg-orange-500/10 text-orange-400 border border-orange-500/20":"text-slate-400 hover:bg-white/5"}`,children:[d.jsx(Ay,{size:20})," ",d.jsx("span",{className:"font-medium",children:"Gemenskapen"})]}),d.jsxs("button",{onClick:()=>W("experts"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${r==="experts"?"bg-orange-500/10 text-orange-400 border border-orange-500/20":"text-slate-400 hover:bg-white/5"}`,children:[d.jsx(Vs,{size:20})," ",d.jsx("span",{className:"font-medium",children:"Kontakt & Bokning"})]}),d.jsx("div",{className:"border-t border-white/10 my-2 pt-2",children:d.jsxs("button",{onClick:z,className:"w-full flex items-center gap-3 px-4 py-3 text-slate-400 hover:text-white hover:bg-white/5 rounded-xl transition-colors",children:[d.jsx(JE,{size:20})," ",d.jsx("span",{className:"font-medium",children:"Logga ut"})]})})]})})]}),d.jsx("main",{className:`flex-grow flex flex-col ${r==="chat"?"h-[calc(100dvh-64px)] overflow-hidden p-1 md:p-4":"container mx-auto p-4 md:p-8"}`,children:r==="welcome"?d.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:d.jsx(eY,{})}):r==="dashboard"?d.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:d.jsx(YX,{user:i,onThreadClick:L})}):r==="chat"?d.jsx("div",{className:"flex-grow h-full w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:d.jsx(QX,{user:i,initialThread:c,onOpenSettings:()=>U(!0)})}):d.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",children:d.jsx(UR,{})})}),r!=="chat"&&d.jsx(tY,{}),D&&i&&d.jsx(nY,{user:i,onClose:()=>U(!1),onUpdate:B})]}):d.jsx(Y,{children:d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative animate-in fade-in zoom-in-95 duration-700 overflow-hidden",children:[d.jsx("div",{className:"fixed inset-0 z-0 opacity-50 bg-black",children:d.jsx(GI,{hovering:!0})}),d.jsxs("button",{onClick:j,className:"absolute top-8 left-8 text-slate-400 hover:text-white flex items-center gap-2 transition-colors z-50 group px-4 py-2 rounded-full hover:bg-white/5",children:[d.jsx(yc,{size:20,className:"group-hover:-translate-x-1 transition-transform"}),"Tillbaka"]}),d.jsxs("div",{className:"relative z-10 w-full max-w-md bg-black/40 backdrop-blur-3xl p-8 rounded-[2.5rem] border border-white/5 shadow-2xl",children:[d.jsx("div",{className:"mb-8 flex justify-center",children:d.jsx("div",{className:"relative w-24 h-24 animate-float",children:d.jsx("img",{src:"/assets/logo2.png",alt:"Horizonten",className:"w-full h-full object-contain drop-shadow-[0_0_20px_rgba(179,92,42,0.3)]"})})}),R?d.jsx(S4,{onLoginSuccess:F,onBack:()=>{E(!0),y(!1),n(De.LOGIN)}}):d.jsx(w4,{onLoginSuccess:F,initialView:A})]})]})})},sY=({setPage:n})=>{const[e,t]=ue.useState(!1),[i,s]=ue.useState({name:"",email:"",phone:"",reason:"",paymentInterval:"monthly",paymentMethod:"swish"}),r=c=>{c.preventDefault();const h=encodeURIComponent(`Anskan om Premium Medlemskap: ${i.name}`),p=encodeURIComponent(`Namn: ${i.name}
E-post: ${i.email}
Telefon: ${i.phone}
Betalningsintervall: ${i.paymentInterval==="monthly"?"Mnadsvis (250 kr/mn)":"rsvis (2500 kr/r)"}

Motivering/Bakgrund:
${i.reason}`);window.location.href=`mailto:billy@klattertradet.se?subject=${h}&body=${p}`,t(!0)},o=c=>{const{name:h,value:p}=c.target;s(g=>({...g,[h]:p}))};return e?d.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:d.jsxs("div",{className:"max-w-xl w-full glass-card p-10 md:p-14 text-center animate-in fade-in zoom-in duration-500 relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-amber-500 to-orange-600"}),d.jsx("div",{className:"w-20 h-20 bg-amber-500/20 rounded-full flex items-center justify-center mx-auto mb-8 shadow-[0_0_40px_rgba(245,158,11,0.2)]",children:d.jsx(OS,{className:"w-10 h-10 text-amber-500"})}),d.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Anskan mottagen!"}),d.jsx("p",{className:"text-zinc-400 mb-10 leading-relaxed text-lg",children:"Fr att slutfra din anskan och f tillgng till gemenskapen behver vi din betalning. Vnligen genomfr betalningen enligt nedan fr att aktivera ditt medlemskap."}),d.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-8 mb-10 text-left space-y-6",children:[d.jsx("h3",{className:"text-white font-black uppercase tracking-widest text-xs text-center border-b border-white/10 pb-4",children:"Betalningsinstruktioner"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex justify-between items-center group",children:[d.jsx("span",{className:"text-zinc-500 text-sm",children:"Belopp att betala:"}),d.jsx("span",{className:"text-white font-bold text-xl",children:i.paymentInterval==="monthly"?"250 kr":"2500 kr"})]}),d.jsxs("div",{className:"space-y-4 pt-2",children:[d.jsxs("div",{className:"p-4 bg-orange-500/10 border border-orange-500/30 rounded-xl flex items-center justify-between",children:[d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"text-orange-500 text-[10px] font-black uppercase tracking-wider mb-1",children:"Swish"}),d.jsx("span",{className:"text-white font-mono font-bold text-lg tracking-wider",children:"123 456 78 90"})]}),d.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Swish_Logo.svg/1200px-Swish_Logo.svg.png",alt:"Swish",className:"w-10 h-10 object-contain"})]}),d.jsxs("div",{className:"p-4 bg-white/5 border border-white/10 rounded-xl flex items-center justify-between",children:[d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"text-zinc-500 text-[10px] font-black uppercase tracking-wider mb-1",children:"Bankgiro"}),d.jsx("span",{className:"text-white font-mono font-bold text-lg tracking-wider",children:"XXXX-XXXX"})]}),d.jsx("div",{className:"w-10 h-10 flex items-center justify-center",children:d.jsx(Tw,{className:"text-zinc-500"})})]})]}),d.jsx("div",{className:"pt-4 border-t border-white/10",children:d.jsxs("p",{className:"text-zinc-500 text-[11px] leading-relaxed",children:[d.jsx("span",{className:"text-white font-bold",children:"Viktigt:"})," Ange ditt fullstndiga namn (",i.name,") som meddelande vid betalning s att vi kan koppla den till din anskan."]})})]})]}),d.jsxs("p",{className:"text-zinc-500 text-sm mb-10",children:["Ett bekrftelsemejl har skickats till ",d.jsx("span",{className:"text-white",children:i.email}),". Nr betalningen registrerats (vanligtvis inom 24h) skickas dina inloggningsuppgifter."]}),d.jsx("button",{onClick:()=>n(De.HOME),className:"w-full py-4 bg-white/5 hover:bg-white/10 border border-white/10 text-white font-bold rounded-xl transition-all active:scale-[0.98]",children:"Tillbaka till startsidan"}),d.jsx("p",{className:"text-[10px] text-zinc-600 mt-6 italic",children:"Frgor? Kontakta oss p billy@klattertradet.se"})]})}):d.jsx("div",{className:"flex-1 py-24 px-6",children:d.jsxs("div",{className:"max-w-3xl mx-auto",children:[d.jsxs("button",{onClick:()=>n(De.LOGIN),className:"flex items-center gap-2 text-zinc-500 hover:text-amber-500 transition-colors mb-8 group",children:[d.jsx(yc,{className:"w-4 h-4 transition-transform group-hover:-translate-x-1"}),"Tillbaka"]}),d.jsxs("div",{className:"glass-card p-8 md:p-12",children:[d.jsxs("div",{className:"mb-12",children:[d.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Ansk om Premium Medlemskap"}),d.jsx("p",{className:"text-zinc-400 text-lg",children:"Fyll i formulret nedan fr att pbrja din anskan. Vi granskar alla medlemskap manuellt fr att skerstlla kvaliteten i vr community."})]}),d.jsxs("form",{onSubmit:r,className:"space-y-6",children:[d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-medium text-zinc-300 ml-1",children:"Fullstndigt namn"}),d.jsxs("div",{className:"relative",children:[d.jsx(bP,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),d.jsx("input",{required:!0,type:"text",name:"name",value:i.name,onChange:o,placeholder:"Ditt namn",className:"w-full bg-white/5 border border-white/10 rounded-xl py-4 pl-12 pr-4 text-white placeholder:text-zinc-600 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all font-medium"})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-medium text-zinc-300 ml-1",children:"E-postadress"}),d.jsxs("div",{className:"relative",children:[d.jsx(w0,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),d.jsx("input",{required:!0,type:"email",name:"email",value:i.email,onChange:o,placeholder:"din.epost@exempel.se",className:"w-full bg-white/5 border border-white/10 rounded-xl py-4 pl-12 pr-4 text-white placeholder:text-zinc-600 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all font-medium"})]})]})]}),d.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-medium text-zinc-300 ml-1",children:"Telefonnummer"}),d.jsxs("div",{className:"relative",children:[d.jsx(fP,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),d.jsx("input",{required:!0,type:"tel",name:"phone",value:i.phone,onChange:o,placeholder:"070-000 00 00",className:"w-full bg-white/5 border border-white/10 rounded-xl py-4 pl-12 pr-4 text-white placeholder:text-zinc-600 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all font-medium"})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-medium text-zinc-300 ml-1",children:"nskad betalningsplan"}),d.jsxs("div",{className:"relative",children:[d.jsx(Tw,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-zinc-500"}),d.jsxs("select",{name:"paymentInterval",value:i.paymentInterval,onChange:o,className:"w-full bg-white/5 border border-white/10 rounded-xl py-4 pl-12 pr-4 text-white appearance-none focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all font-medium cursor-pointer",children:[d.jsx("option",{value:"monthly",children:"250 kr / mnad"}),d.jsx("option",{value:"yearly",children:"2500 kr / r (Spara 500 kr)"})]})]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"text-sm font-medium text-zinc-300 ml-1",children:"Varfr vill du g med i Premium?"}),d.jsx("textarea",{required:!0,name:"reason",value:i.reason,onChange:o,placeholder:"Bertta lite kort om dig sjlv och vad du hoppas f ut av gemenskapen...",rows:5,className:"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white placeholder:text-zinc-600 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all font-medium resize-none"})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsx("label",{className:"text-sm font-medium text-zinc-300 ml-1",children:"Vlj betalstt"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[d.jsxs("label",{className:`flex items-center gap-4 p-4 rounded-xl border transition-all cursor-pointer ${i.paymentMethod==="swish"?"bg-orange-500/10 border-orange-500":"bg-white/5 border-white/10 hover:border-white/20"}`,children:[d.jsx("input",{type:"radio",name:"paymentMethod",value:"swish",checked:i.paymentMethod==="swish",onChange:o,className:"hidden"}),d.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${i.paymentMethod==="swish"?"border-orange-500":"border-zinc-600"}`,children:i.paymentMethod==="swish"&&d.jsx("div",{className:"w-2.5 h-2.5 bg-orange-500 rounded-full"})}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-bold text-white text-sm",children:"Swish"}),d.jsx("span",{className:"text-[10px] text-zinc-500 uppercase font-black",children:"Direktbetalning"})]}),d.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/Swish_Logo.svg/1200px-Swish_Logo.svg.png",alt:"Swish",className:"w-8 h-8 ml-auto object-contain"})]}),d.jsxs("label",{className:`flex items-center gap-4 p-4 rounded-xl border transition-all cursor-pointer ${i.paymentMethod==="card"?"bg-orange-500/10 border-orange-500":"bg-white/5 border-white/10 hover:border-white/20"}`,children:[d.jsx("input",{type:"radio",name:"paymentMethod",value:"card",checked:i.paymentMethod==="card",onChange:o,className:"hidden"}),d.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${i.paymentMethod==="card"?"border-orange-500":"border-zinc-600"}`,children:i.paymentMethod==="card"&&d.jsx("div",{className:"w-2.5 h-2.5 bg-orange-500 rounded-full"})}),d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-bold text-white text-sm",children:"Kort"}),d.jsx("span",{className:"text-[10px] text-zinc-500 uppercase font-black",children:"Visa / Mastercard"})]}),d.jsx("div",{className:"flex gap-1 ml-auto",children:d.jsx(Tw,{size:20,className:"text-zinc-400"})})]})]})]}),d.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-2xl p-6 space-y-4",children:[d.jsx("h3",{className:"text-white font-bold text-sm",children:"Betalnings- och medlemsvillkor"}),d.jsxs("div",{className:"text-xs text-zinc-400 leading-relaxed space-y-2 max-h-32 overflow-y-auto pr-2 scrollbar-thin scrollbar-thumb-white/10",children:[d.jsx("p",{children:"Genom att slutfra anskan och betalning godknner du fljande villkor:"}),d.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[d.jsx("li",{children:"Medlemskapet aktiveras s snart betalningen har registrerats och din profil har verifierats manuellt."}),d.jsx("li",{children:"Betalning sker i frskott och frnyas automatiskt enligt valt intervall (mnad/r)."}),d.jsx("li",{children:"Du kan nr som helst sga upp ditt medlemskap via dina instllningar. Ingen terbetalning sker fr pbrjad period."}),d.jsx("li",{children:"Innehll i gemenskapen r skyddat och fr inte spridas utanfr plattformen."}),d.jsx("li",{children:"Respektfullt bemtande r ett krav fr fortsatt medlemskap."})]})]}),d.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group pt-2",children:[d.jsx("input",{required:!0,type:"checkbox",className:"mt-1 w-4 h-4 rounded border-white/20 bg-white/5 text-orange-500 focus:ring-orange-500 focus:ring-offset-0"}),d.jsx("span",{className:"text-xs text-zinc-500 group-hover:text-zinc-300 transition-colors",children:"Jag godknner betalningsvillkoren och bekrftar att jag frstr att tillgng till gemenskapen krver genomfrd betalning."})]})]}),d.jsxs("button",{type:"submit",className:"w-full py-5 bg-amber-500 hover:bg-amber-400 text-black font-bold rounded-xl transition-all flex items-center justify-center gap-3 text-lg group active:scale-95 shadow-[0_10px_30px_rgba(245,158,11,0.2)]",children:[d.jsx(Ml,{className:"w-5 h-5 transition-transform group-hover:translate-x-1 group-hover:-translate-y-1"}),"G vidare till betalning"]})]})]})]})})},rY=()=>{const[n,e]=ue.useState(De.HOME),[t,i]=ue.useState(!1);ue.useEffect(()=>{const o=h=>{h.state&&h.state.page?e(h.state.page):window.location.hash.includes("#login")||window.location.hash.includes("#premium-login")?e(De.GEMENSKAP_APP):e(De.HOME)};window.addEventListener("popstate",o);const c=window.location.hash;return c.includes("#login")||c.includes("#premium-login")||c.includes("#signup")?(e(De.GEMENSKAP_APP),window.history.replaceState({page:De.GEMENSKAP_APP},"")):window.history.state||window.history.replaceState({page:n},""),()=>window.removeEventListener("popstate",o)},[]);const s=(o,c)=>{o!==n&&(window.history.pushState({page:o,...c},""),e(o))};ue.useEffect(()=>{window.scrollTo({top:0,behavior:"auto"});const o=n.charAt(0)+n.slice(1).toLowerCase().replace("_"," ");document.title=n===De.HOME?"Horizonten  Vx med rtter":`${o} | Horizonten`},[n]);const r=()=>{i(!t)};return d.jsxs("div",{className:`relative min-h-screen flex flex-col transition-all duration-700 ease-in-out ${t?"bg-glossy-gradient-dark":"bg-glossy-gradient"}`,children:[d.jsx(TP,{}),d.jsx(r4,{setPage:s}),n!==De.GEMENSKAP_APP&&d.jsx(SP,{currentPage:n,setPage:s,isDarkMode:t,toggleTheme:r}),d.jsx("main",{className:"flex-1 w-full flex flex-col",children:(()=>{switch(n){case De.HOME:return d.jsx(TM,{setPage:s});case De.ABOUT:return d.jsx(a4,{});case De.CHAT:return d.jsx(o4,{});case De.THERAPY:return d.jsx(l4,{setPage:s});case De.GROUP_THERAPY:return d.jsx(c4,{setPage:s});case De.GESTALT_TRAINING:return d.jsx(u4,{setPage:s});case De.BEHANDLINGS_ASSISTENT:return d.jsx(d4,{setPage:s});case De.BLOG:return d.jsx(h4,{setPage:s});case De.COMMUNITY:return d.jsx(f4,{});case De.CONTACT:return d.jsx(p4,{});case De.SURVEY:return d.jsx(m4,{});case De.DOWNLOADS:return d.jsx(g4,{});case De.LOGIN:return d.jsx(x4,{setPage:s});case De.BOOK:return d.jsx(v4,{setPage:s});case De.CHECKOUT:return d.jsxs("div",{className:"container mx-auto px-6 py-24 text-center",children:[d.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Kassa"}),d.jsx("p",{className:"text-zinc-400",children:"Betalningslsning kommer snart..."}),d.jsx("button",{onClick:()=>s(De.BOOK),className:"mt-8 text-amber-500 font-bold underline",children:"Tillbaka"})]});case De.PRIVACY:return d.jsx(y4,{setPage:s});case De.COOKIE_POLICY:return d.jsx(b4,{setPage:s});case De.TERMS:return d.jsx(_4,{setPage:s});case De.PREMIUM_APPLICATION:return d.jsx(sY,{setPage:s});case De.GEMENSKAP_APP:return d.jsx(iY,{onBackToSite:o=>s(o||De.HOME)});default:return d.jsx(TM,{setPage:s})}})()}),n!==De.GEMENSKAP_APP&&d.jsx("footer",{className:"py-12 mt-auto border-t border-white/10",children:d.jsxs("div",{className:"max-w-[1600px] mx-auto px-6 flex flex-col items-center gap-6",children:[d.jsxs("div",{className:"flex flex-wrap justify-center gap-x-8 gap-y-3 text-[10px] md:text-xs font-bold text-white/30 tracking-widest uppercase",children:[d.jsx("button",{onClick:()=>s(De.COOKIE_POLICY),className:"hover:text-amber-500 transition-colors whitespace-nowrap",children:"Cookies"}),d.jsx("button",{onClick:()=>s(De.TERMS),className:"hover:text-amber-500 transition-colors whitespace-nowrap",children:"Medlemsvillkor"}),d.jsx("button",{onClick:()=>s(De.PRIVACY),className:"hover:text-amber-500 transition-colors whitespace-nowrap",children:"Integritet & Sekretess"})]}),d.jsx("div",{className:"text-white/50 text-[10px] md:text-xs tracking-tight",children:d.jsx("p",{children:" 2025 Klttertrdet & Horizonten."})})]})})]})},J3=document.getElementById("root");if(!J3)throw new Error("Could not find root element to mount to");const aY=VD.createRoot(J3);aY.render(d.jsx(Ob.StrictMode,{children:d.jsx(rY,{})}));
